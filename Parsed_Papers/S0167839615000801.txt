@&#MAIN-TITLE@&#A hierarchical construction of LR meshes in 2D

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The paper discusses bivariate LR splines with the non-nested support (N2S) property.


                        
                        
                           
                           Conditions on LR mesh refinement for preserving this property are presented.


                        
                        
                           
                           A hierarchical construction for LR meshes with the N2S property is proposed and analyzed.


                        
                        
                           
                           We prove the completeness of LR splines on the resulting hierarchical meshes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

LR B-spline

Local linear independence

Completeness

Hierarchical B-splines

@&#ABSTRACT@&#


               
               
                  We describe a construction of LR-spaces whose bases are composed of locally linearly independent B-splines which also form a partition of unity. The construction conforms to given refinement requirements associated to subdomains. In contrast to the original LR-paper (Dokken et al., 2013) and similarly to the hierarchical B-spline framework (Forsey and Bartels, 1988) the construction of the mesh is based on a priori choice of a sequence of nested tensor B-spline spaces.
               
            

@&#INTRODUCTION@&#

In the last decade the use of spline spaces has spread from the field of applied geometry, in particular Computer Aided Design (CAD), to that of numerical analysis of Partial Differential Equations (PDEs). This is largely due to the influence of the seminal paper by Hughes et al. (2005). The use of B-spline generated spaces in Galerkin methods was attempted before by Höllig (2003), but Hughes et al. (2005) recognized it as a possible way to remove the compatibility layer that is in-between the CAD tools and the Finite Element Method (FEM). The compatibility layer contains the mesh generation process and, in some cases, can be computationally more expensive than the simulation itself (Hughes et al., 2005). The method that reduces the compatibility layer proposed by Hughes et al. (2005) is called IsoGeometric Analysis (IGA) and is based on the isoparametric approach: the solution fields of the PDE are in the same B-spline or NURBS space used for the parametrization of the geometry.

IGA sprouted new research in numerical methods due to the availability of basis functions with higher smoothness and with strong algebraic properties that allow for new numerical schemes like compatible discretizations. It had the same effect in the applied geometry field: the numerical simulation of PDEs requires high quality parametrizations of the domain while in CAD it is common to parametrize only the boundary and to allow both for small gaps and singularities.

Both CAD and IGA applications require the use of function spaces that allow for local changes in spatial resolution. This is necessary to obtain a good approximation with fewer degrees of freedom. The standard tensor-product B-spline spaces do not allow for local changes in spatial resolution and thus different generalizations providing adaptive refinement were proposed in the last 25 years. Forsey and Bartels (1988) introduced the hierarchical splines, later studied by Kraft (1997) and more recently by Giannelli et al. (2012) and Mokriš et al. (2014), Sederberg et al. (2003, 2004) introduced T-splines of which an Analysis Suitable subset (AST) was described by Beirão da Veiga et al. (2012), Deng et al. (2008) introduced PHT-splines and Dokken et al. (2013) introduced LR-splines whose local linear independence was studied by Bressan (2013). Each of these approaches has their own strengths and weaknesses determined by the focus with which they were developed. In this article we try to combine the LR-splines framework with the hierarchical approach.

Our aim is to obtain a space that has strong properties such as local linear independence and that can be efficiently implemented. Johannessen et al. (2014) applied LR-spline spaces to IGA and explored different refinement techniques. In contrast to their work, we study refinement strategies that are based on theoretical guarantees. In detail we present a method to construct a box mesh 
                        M
                      on a domain Ω whose element size is small in a neighborhood of some given regions and for which the associated LR-spline collection 
                        
                           LR
                        
                        (
                        M
                        )
                      is a basis composed of locally linearly independent functions. This implies that the basis is also a partition of unity.

In Section 2 we recall LR-spline definitions and results. Compared to the paper of Dokken et al. (2013) we only target the bi-variate case and we can therefore use a simpler notation. In particular we focus on the equivalence for the LR-spline collection to be a partition of unity, to be a set of locally linearly independent B-splines, and the non-nested support property (N2S for short).

In Section 3 we describe a subset of the domain Ω in which it is possible to add vertical segments while preserving the N2S property. We describe another subset that behaves similarly for the addition of horizontal segments.

In Section 4 we define a hierarchical approach to the construction of box meshes. Then we provide sufficient conditions under which the associated LR-spline space has the N2S property.

In Section 5 we study the completeness of the hierarchically constructed LR-space, that is, whether it equals the piecewise polynomial space that is associated to the mesh.

Section 6 describes our construction of LR meshes that guarantees both the N2S property (and thus local linear independence of the basis functions) and completeness. We comment on the locality of the refinement and show some examples in the case of dyadic refinement.

Section 7 compares the proposed space with the truncated hierarchical B-spline space (THB) on the same Bézier mesh.

We use 
                        
                           
                              P
                           
                           
                              d
                           
                        
                      to denote the space of polynomials of degree less than or equal to d. The space of bivariate polynomials of degree 
                        
                           
                              d
                           
                           
                              x
                           
                        
                      in the x variable and degree 
                        
                           
                              d
                           
                           
                              y
                           
                        
                      in the y variable is denoted using a vector 
                        d
                        =
                        (
                        
                           
                              d
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              y
                           
                        
                        )
                      for the degree:
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                              ⊗
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                              .
                           
                        
                      For our purpose the degree 
                        d
                        =
                        (
                        
                           
                              d
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              d
                           
                           
                              y
                           
                        
                        )
                      can be considered fixed at the beginning and it will be omitted in the notation.

A knot vector Θ is a monotone non-decreasing sequence of real numbers
                        
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ≤
                              …
                              ≤
                              
                                 
                                    θ
                                 
                                 
                                    n
                                 
                              
                              .
                           
                        
                      The number of repetitions of a knot z in a knot vector Θ is called the multiplicity of z in Θ and denoted with:
                        
                           (1)
                           
                              
                                 
                                    μ
                                 
                                 
                                    Θ
                                 
                              
                              (
                              z
                              )
                              =
                              #
                              {
                              j
                              :
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              =
                              z
                              }
                              .
                           
                        
                      We say that two knot vectors 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        ≤
                        …
                        ≤
                        
                           
                              θ
                           
                           
                              n
                           
                        
                      and 
                        
                           
                              ξ
                           
                           
                              1
                           
                        
                        ≤
                        …
                        ≤
                        
                           
                              ξ
                           
                           
                              m
                           
                        
                      are compatible on the overlap
                     
                        1
                     
                     
                        1
                        In the context of T-splines this property is called overlap (Beirão da Veiga et al., 2012). We prefer the name compatible because two separate knot vectors with 
                              
                                 
                                    θ
                                 
                                 
                                    n
                                 
                              
                              <
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                            or 
                              
                                 
                                    ξ
                                 
                                 
                                    m
                                 
                              
                              <
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                            are compatible, but it would be counter-intuitive to call them overlapping.
                      if they can be seen as two parts of a larger knot vector 
                        
                           
                              ζ
                           
                           
                              1
                           
                        
                        ≤
                        …
                        ≤
                        
                           
                              ζ
                           
                           
                              m
                              +
                              n
                           
                        
                     . More precisely if there exists 
                        
                           
                              ζ
                           
                           
                              1
                           
                        
                        ≤
                        …
                        ≤
                        
                           
                              ζ
                           
                           
                              m
                              +
                              n
                           
                        
                     , and two indexes 
                        s
                        ,
                        t
                      such that
                        
                           (2)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                ζ
                                             
                                             
                                                s
                                                +
                                                i
                                             
                                          
                                          ,
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                ζ
                                             
                                             
                                                t
                                                +
                                                i
                                             
                                          
                                          ,
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Note that if 
                        
                           
                              θ
                           
                           
                              n
                           
                        
                        ≤
                        
                           
                              ξ
                           
                           
                              1
                           
                        
                      or if 
                        
                           
                              ξ
                           
                           
                              m
                           
                        
                        ≤
                        
                           
                              θ
                           
                           
                              1
                           
                        
                      than the two knot vectors are compatible.

The B-spline of degree d defined by the knot vector 
                        Θ
                        =
                        (
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              θ
                           
                           
                              d
                              +
                              2
                           
                        
                        )
                      (with 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        <
                        
                           
                              θ
                           
                           
                              d
                              +
                              2
                           
                        
                     ) is denoted with 
                        B
                        [
                        Θ
                        ]
                     . Bi-variate B-splines 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        →
                        R
                      are the product of two univariate B-splines and are defined by a pair of knot vectors 
                        Θ
                        =
                        (
                        
                           
                              Θ
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                        )
                     
                     
                        
                           
                              B
                              [
                              Θ
                              ]
                              (
                              x
                              ,
                              y
                              )
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              ]
                              (
                              x
                              )
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              (
                              y
                              )
                              .
                           
                        
                     
                  

The definition of the LR-spline spaces is based on knot insertion. More precisely, two new knot vectors 
                        
                           
                              Θ
                           
                           
                              +
                           
                        
                      and 
                        
                           
                              Θ
                           
                           
                              −
                           
                        
                      are defined by inserting 
                        
                           
                              θ
                           
                           
                              ¯
                           
                        
                        ∈
                        ]
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              k
                              +
                              2
                           
                        
                        [
                      into a given knot vector 
                        Θ
                        =
                        (
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              θ
                           
                           
                              k
                              +
                              2
                           
                        
                        )
                     . The new knot vectors 
                        
                           
                              Θ
                           
                           
                              +
                           
                        
                      and 
                        
                           
                              Θ
                           
                           
                              −
                           
                        
                      contain the knots 
                        
                           
                              θ
                           
                           
                              ¯
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              θ
                           
                           
                              k
                              +
                              1
                           
                        
                      and 
                        
                           
                              θ
                           
                           
                              ¯
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              θ
                           
                           
                              k
                              +
                              2
                           
                        
                      in non-decreasing order, respectively.

There is a linear relation involving the B-splines 
                        B
                        [
                        Θ
                        ]
                     , 
                        B
                        [
                        
                           
                              Θ
                           
                           
                              +
                           
                        
                        ]
                      and 
                        B
                        [
                        
                           
                              Θ
                           
                           
                              −
                           
                        
                        ]
                     . In the bivariate setting, given 
                        B
                        [
                        
                           
                              Θ
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                        ]
                      and 
                        
                           
                              θ
                           
                           
                              ¯
                           
                        
                      in 
                        [
                        
                           
                              θ
                           
                           
                              x
                              ,
                              i
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              x
                              ,
                              i
                              +
                              1
                           
                        
                        [
                      it holds
                        
                           (3)
                           
                              B
                              [
                              Θ
                              ]
                              =
                              
                                 
                                    α
                                 
                                 
                                    +
                                 
                              
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              +
                              
                                 
                                    α
                                 
                                 
                                    −
                                 
                              
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    −
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ,
                           
                        
                      where
                        
                           
                              
                                 
                                    α
                                 
                                 
                                    +
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          i
                                          =
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          otherwise
                                          ,
                                       
                                    
                                 
                              
                              
                              
                              
                                 
                                    α
                                 
                                 
                                    −
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                      +
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      x
                                                      ,
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                      We say that 
                        B
                        [
                        
                           
                              Θ
                           
                           
                              x
                           
                           
                              +
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                        ]
                      and 
                        B
                        [
                        
                           
                              Θ
                           
                           
                              x
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                        ]
                      are obtained from 
                     
                        B
                        [
                        
                           
                              Θ
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                        ]
                      
                     by the insertion of 
                     
                        
                           
                              θ
                           
                           
                              ¯
                           
                        
                     . The insertion of knots in 
                        
                           
                              Θ
                           
                           
                              y
                           
                        
                      works similarly. Based on the knot insertion is the notion of nested B-splines.


                     
                        Definition 1
                        Let S be a space of functions. A B-spline B is nested in a B-spline 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            relatively to S and it is written 
                              B
                              
                                 
                                    ≺
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            if there exists a sequence of B-splines 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    B
                                 
                                 
                                    n
                                 
                              
                              =
                              B
                            such that:
                              
                                 •
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       S
                                    , for 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    ;


                                    
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is obtained from 
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                     by the insertion of a knot, 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                       −
                                       1
                                    .

Note that 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                      is a partial order relation on B-splines. As such it is possible to describe 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                      using a directed acyclic graph. Minimal and maximal elements of S with respect of 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                      correspond to sinks and sources of the graph. Comparable pairs, i.e. pairs 
                        
                           
                              B
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              B
                           
                           
                              2
                           
                        
                      such that 
                        
                           
                              B
                           
                           
                              1
                           
                        
                        ≺
                        
                           
                              B
                           
                           
                              2
                           
                        
                      or 
                        
                           
                              B
                           
                           
                              2
                           
                        
                        ≺
                        
                           
                              B
                           
                           
                              1
                           
                        
                     , correspond to pairs of elements that are connected by an oriented path in the graph.

It is important to note that 
                        B
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                        
                           
                              B
                           
                           
                              ′
                           
                        
                      implies 
                        B
                        ≺
                        
                           
                              B
                           
                           
                              ′
                           
                        
                     , but not vice versa. In particular if B is a maximal or a minimal element in S with respect to ≺ then it is also a maximal or minimal element for 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                     . The minimal elements for 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                      in S are called minimal support B-splines in S.

The definition of LR-spline spaces is based on 
                        
                           
                              ≺
                           
                           
                              S
                           
                        
                      where S is an appropriate piecewise polynomial space over box elements. A box η is a Cartesian product of two closed intervals: 
                        [
                        a
                        ,
                        b
                        ]
                        ×
                        [
                        e
                        ,
                        f
                        ]
                     . A box in 
                        
                           
                              R
                           
                           
                              2
                           
                        
                      can be:
                        
                           •
                           a vertex if 
                                 a
                                 =
                                 b
                               and 
                                 e
                                 =
                                 f
                              ;

a horizontal segment if 
                                 a
                                 <
                                 b
                               and 
                                 e
                                 =
                                 f
                              ;

a vertical segment if 
                                 a
                                 =
                                 b
                               and 
                                 e
                                 <
                                 f
                              ;

a rectangle if 
                                 a
                                 <
                                 b
                               and 
                                 e
                                 <
                                 f
                              .

A box mesh 
                     
                        R
                      on a rectangle Ω is a finite collection of rectangles such that:
                        
                           •
                           
                              
                                 
                                    
                                       ⋃
                                    
                                    
                                       η
                                       ∈
                                       R
                                    
                                 
                                 η
                                 =
                                 Ω
                              ;


                              
                                 ∀
                                 
                                    
                                       η
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 
                                    
                                       η
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 R
                              , 
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       ∘
                                    
                                 
                                 ∩
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ∘
                                    
                                 
                                 =
                                 ∅
                              .


                     
                        Definition 2
                        A box mesh with multiplicity 
                           
                              M
                            on Ω is a pair 
                              (
                              R
                              ,
                              σ
                              )
                            where 
                              R
                            is a box mesh and 
                              σ
                              :
                              E
                              (
                              R
                              )
                              →
                              N
                            is a function representing the multiplicity of the edges. The spline space of degree d associated to a box mesh with multiplicity is
                              
                                 
                                    S
                                    (
                                    M
                                    )
                                    =
                                    
                                       {
                                       f
                                       :
                                       Ω
                                       →
                                       R
                                       :
                                       
                                       ∀
                                       η
                                       ∈
                                       R
                                       ,
                                       
                                       f
                                       
                                          
                                             |
                                          
                                          
                                             η
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                       ∀
                                       γ
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       M
                                       )
                                       ,
                                       
                                       
                                          
                                             ∂
                                          
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             σ
                                             (
                                             γ
                                             )
                                          
                                       
                                       f
                                        is continuous on 
                                       
                                          
                                             γ
                                          
                                          
                                             ∘
                                          
                                       
                                       ,
                                       
                                       ∀
                                       γ
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       M
                                       )
                                       ,
                                       
                                       
                                          
                                             ∂
                                          
                                          
                                             y
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             σ
                                             (
                                             γ
                                             )
                                          
                                       
                                       f
                                        is continuous on 
                                       
                                          
                                             γ
                                          
                                          
                                             ∘
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                            We say that a B-spline 
                              B
                              :
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              →
                              R
                            is in 
                              S
                              (
                              M
                              )
                            when 
                              supp
                              
                              B
                              ⊆
                              Ω
                            and 
                              B
                              
                                 
                                    |
                                 
                                 
                                    Ω
                                 
                              
                              ∈
                              S
                              (
                              M
                              )
                           . When the component of 
                              M
                            are not specified we will refer to 
                              E
                              (
                              R
                              )
                            by 
                              E
                              (
                              M
                              )
                           .

Throughout this paper we will assume that the multiplicity of horizontal and vertical edges does not exceed 
                        
                           
                              d
                           
                           
                              y
                           
                        
                        +
                        1
                      and 
                        
                           
                              d
                           
                           
                              x
                           
                        
                        +
                        1
                     , respectively.

Box meshes with multiplicity can be refined by adding mesh-lines to them. Given a mesh 
                        M
                        =
                        (
                        R
                        ,
                        σ
                        )
                      and a segment γ we define 
                        M
                        +
                        γ
                      as the mesh 
                        
                           
                              M
                           
                           
                              ˜
                           
                        
                        =
                        (
                        
                           
                              R
                           
                           
                              ˜
                           
                        
                        ,
                        
                           
                              σ
                           
                           
                              ˜
                           
                        
                        )
                      obtained by dividing all rectangles split by γ into two. More precisely
                        
                           (5)
                           
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              =
                              
                                 {
                                 
                                    C
                                    ¯
                                 
                                 :
                                 
                                 ∃
                                 η
                                 ∈
                                 R
                                 :
                                 
                                 C
                                  is a connected component of 
                                 η
                                 ∖
                                 γ
                                 }
                              
                           
                        
                      and for 
                        α
                        ∈
                        E
                        (
                        
                           
                              R
                           
                           
                              ˜
                           
                        
                        )
                     
                     
                        
                           (6)
                           
                              
                                 
                                    σ
                                 
                                 
                                    ˜
                                 
                              
                              (
                              α
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          σ
                                          (
                                          β
                                          )
                                       
                                       
                                          α
                                          ⊈
                                          γ
                                          
                                          ∧
                                          ∃
                                          β
                                          ∈
                                          E
                                          (
                                          M
                                          )
                                          :
                                          α
                                          ⊆
                                          β
                                       
                                    
                                    
                                       
                                          σ
                                          (
                                          β
                                          )
                                          +
                                          1
                                       
                                       
                                          α
                                          ⊆
                                          γ
                                          
                                          ∧
                                          ∃
                                          β
                                          ∈
                                          E
                                          (
                                          M
                                          )
                                          :
                                          α
                                          ⊆
                                          β
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          α
                                          ⊆
                                          γ
                                          
                                          ∧
                                          ∄
                                          β
                                          ∈
                                          E
                                          (
                                          M
                                          )
                                          :
                                          α
                                          ⊆
                                          β
                                          .
                                       
                                    
                                 
                              
                           
                        
                      An LR mesh is a box mesh with multiplicity that can be constructed by a sequence of additions starting from a tensor mesh.

For all meshes 
                        M
                      the space 
                        S
                        (
                        M
                        )
                      contains the Bernstein polynomials on Ω. Moreover they are always maximal elements in 
                        S
                        (
                        M
                        )
                      for both ≺ and 
                        
                           
                              ≺
                           
                           
                              S
                              (
                              M
                              )
                           
                        
                     .


                     
                        Definition 3
                        The LR-spline collection 
                           
                              
                                 LR
                              
                              (
                              M
                              )
                            is the set of the minimal support B-spline that are comparable with respect to 
                              
                                 
                                    ≺
                                 
                                 
                                    S
                                    (
                                    M
                                    )
                                 
                              
                            to at least one Bernstein polynomial. The LR-spline space is
                              
                                 
                                    
                                       LR
                                    
                                    (
                                    M
                                    )
                                    =
                                    span
                                    
                                    
                                       LR
                                    
                                    (
                                    M
                                    )
                                    .
                                 
                              
                           
                        

With this definition the LR-spline collection can be constructed using a recursive algorithm that, starting from the set of Bernstein polynomials, replaces at each step a non-minimal support B-spline with two B-splines obtained by knot insertion. This iterative construction is described in detail by Dokken et al. (2013). The set of minimal support B-splines can indeed be larger than 
                        LR
                     , see for an example Fig. 2 of Bressan (2013). The question of completeness of the LR-space, i.e. if 
                        
                           LR
                        
                        (
                        M
                        )
                      is 
                        S
                        (
                        M
                        )
                      is not trivial. Dokken et al. (2013) described sufficient conditions for the equality, these are the base of our discussion on completeness.

Linear independence of the B-splines in 
                        
                           LR
                        
                        (
                        M
                        )
                      is also a not fully resolved issue. Dokken et al. (2013) provided an algorithm that allows to check for linear relation efficiently, but in the literature there is no (non-trivial) construction that guarantees linear independence. The construction we describe is based on the theoretical results from Bressan (2013) where it is proved that local linear independence is equivalent to the fact that all B-splines in 
                        
                           LR
                        
                        (
                        M
                        )
                      are minimal elements with respect to ≺, see Theorem 4 below for details.

Recall that a finite system of functions is linearly independent on a set A if the fact that a linear combination of these functions is equal to zero on the set A implies that the coefficients of all functions with a support intersecting A vanish. This property is preserved by taking the union of two sets: If the system of functions is linearly independent on two open sets A and 
                        
                           
                              A
                           
                           
                              ′
                           
                        
                      then it is also linearly independent on 
                        A
                        ∪
                        
                           
                              A
                           
                           
                              ′
                           
                        
                     . A system of functions is said to be locally linearly independent if it is linearly independent on any open set A.


                     
                        Theorem 4
                        
                           Let 
                           
                              M
                            
                           be a box mesh with multiplicity, then the following are equivalent:
                           
                              
                                 1.
                                 
                                    
                                       ∀
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          LR
                                       
                                       (
                                       M
                                       )
                                    
                                    : 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       ≺
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       ⇒
                                       
                                          
                                             B
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    ;
                                 


                                    
                                       ∀
                                       f
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             d
                                          
                                       
                                    
                                    , 
                                    
                                       f
                                       =
                                       
                                          ∑
                                          
                                             B
                                             ∈
                                             
                                                LR
                                             
                                          
                                       
                                       B
                                       [
                                       f
                                       ]
                                       (
                                       B
                                       )
                                       B
                                     
                                    where 
                                    
                                       B
                                       [
                                       f
                                       ]
                                       (
                                       B
                                       )
                                     
                                    is the blossom of f evaluated at the internal knots of B (
                                    
                                       Ramshaw, 1989
                                    
                                    );
                                 


                                    
                                       
                                          LR
                                       
                                       (
                                       M
                                       )
                                     
                                    is a partition of unity;
                                 


                                    the functions in 
                                    
                                       
                                          LR
                                       
                                       (
                                       M
                                       )
                                     
                                    are locally linearly independent;
                                 


                                    
                                       ∀
                                       η
                                       ∈
                                       R
                                    
                                    , 
                                    
                                       #
                                       {
                                       B
                                       ∈
                                       
                                          LR
                                       
                                       (
                                       M
                                       )
                                       :
                                       supp
                                       
                                       B
                                       ⊇
                                       
                                          
                                             η
                                          
                                          
                                             ∘
                                          
                                       
                                       }
                                       =
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       )
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                    .
                                 


                     
                        Proof
                        For the equivalence of the statements 
                              1
                              ,
                              2
                              ,
                              3
                            and 5 we refer to Bressan (2013). We prove the equivalence of the fourth statement with statement No. 5. On the one hand, if the latter one is not satisfied, then there exists a rectangle η, which is contained in the support of at least 
                              (
                              
                                 
                                    d
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              )
                              +
                              1
                            B-spline functions. Since 
                              
                                 LR
                              
                              (
                              M
                              )
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ∘
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                            they are not linearly independent on the open set 
                              
                                 
                                    η
                                 
                                 
                                    ∘
                                 
                              
                           , hence the condition in the fourth statement is violated. On the other hand, assume the latter statement is satisfied. Since 
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              ⊂
                              
                                 LR
                              
                              (
                              M
                              )
                           , we conclude that the functions in 
                              
                                 LR
                              
                              (
                              M
                              )
                            are linearly independent on any set that is contained in any rectangle 
                              η
                              ∈
                              R
                            and possesses a non-empty interior. This observation extends to any open set since linear independence of functions on sets is preserved when taking unions of sets and the intersections of an open set with the rectangles 
                              η
                              ∈
                              R
                            are either empty or have a non-empty interior.  □

The property described in the first statement of this theorem will be called the non-nested support (N
                     
                        2
                     
                     S) property. The support can actually be nested in the physical space (this requires that some mesh edges have multiplicity >1), but they cannot be nested in the “index space”. Box meshes with multiplicity for which 
                        LR
                      has the N2S property will be called N
                     
                        2
                     
                     S meshes.

The functions involved in the linear dependency relation from Dokken et al. (2013, Example 6.4) violate the N2S property. All the B-splines in Dokken et al. (2013, Equation (40)) are in 
                        
                           LR
                        
                        (
                        M
                        )
                     , but all the functions on the right-hand side of the equality are nested (≺) in the function on the left-hand side.

In the following sections we will avoid specifying the mesh when there is no ambiguity: we will use the shorter notation 
                        S
                      instead of 
                        S
                        (
                        M
                        )
                     , similarly 
                        E
                      for 
                        E
                        (
                        M
                        )
                      etc.

In this section we describe the set 
                        
                           
                              R
                           
                           
                              x
                           
                        
                      of horizontally refinable rectangles. Our result is that if 
                        M
                      is an N2S mesh and γ is a vertical segment “well contained” in 
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                      then 
                        M
                        +
                        γ
                      is an N2S mesh.
                        2
                     
                     
                        2
                        We use the convention that 
                              ⋃
                              A
                              =
                              
                                 
                                    ⋃
                                 
                                 
                                    a
                                    ∈
                                    A
                                 
                              
                              a
                           .
                      Similarly we define the set 
                        
                           
                              R
                           
                           
                              y
                           
                        
                      of vertically refinable rectangles. Here “well contained” means that only the vertices of γ can be in 
                        ∂
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                      or equivalently that 
                        
                           
                              γ
                           
                           
                              ∘
                           
                        
                        ⊂
                        
                           
                              (
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              )
                           
                           
                              ∘
                           
                        
                     . We also provide additional conditions that guarantee that the N2S property is preserved for the limit case: when the intersection of γ with the boundary of 
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                      is a union of segments (and similarly for horizontal γ).


                     
                        Definition 5
                        Consider a rectangle 
                              η
                              =
                              [
                              a
                              ,
                              b
                              ]
                              ×
                              [
                              e
                              ,
                              f
                              ]
                              ∈
                              R
                            and let
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          η
                                       
                                    
                                    =
                                    max
                                    ⁡
                                    {
                                    σ
                                    (
                                    γ
                                    )
                                    :
                                    γ
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          h
                                       
                                    
                                    ∧
                                    γ
                                    ⊆
                                    [
                                    a
                                    ,
                                    b
                                    ]
                                    ×
                                    {
                                    e
                                    }
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          η
                                       
                                    
                                    =
                                    max
                                    ⁡
                                    {
                                    σ
                                    (
                                    γ
                                    )
                                    :
                                    γ
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          h
                                       
                                    
                                    ∧
                                    γ
                                    ⊆
                                    [
                                    a
                                    ,
                                    b
                                    ]
                                    ×
                                    {
                                    f
                                    }
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          Ξ
                                       
                                       
                                          η
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                e
                                                ,
                                                …
                                                ,
                                                e
                                             
                                             ︸
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   η
                                                
                                             
                                             
                                             times
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                f
                                                ,
                                                …
                                                ,
                                                f
                                             
                                             ︸
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   η
                                                
                                             
                                             
                                             times
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            See Fig. 1
                            for a graphical representation. We say that 
                              η
                              ∈
                              R
                            is horizontally refinable if for all 
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            with 
                              supp
                              
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ⊇
                              η
                            it holds that 
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                            is compatible with 
                              
                                 
                                    Ξ
                                 
                                 
                                    η
                                 
                              
                           . The set of horizontally refinable rectangles is 
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                           . The set 
                              
                                 
                                    R
                                 
                                 
                                    y
                                 
                              
                            of vertically refinable rectangles is defined similarly.

Note that from the definition it follows that for all 
                        η
                        =
                        [
                        a
                        ,
                        b
                        ]
                        ×
                        [
                        e
                        ,
                        f
                        ]
                        ∈
                        
                           
                              R
                           
                           
                              x
                           
                        
                      and 
                        α
                        ∈
                        
                           
                              E
                           
                           
                              h
                           
                        
                      contained in 
                        [
                        a
                        ,
                        b
                        ]
                        ×
                        {
                        e
                        }
                      it holds that 
                        σ
                        (
                        α
                        )
                        =
                        
                           
                              s
                           
                           
                              η
                           
                        
                     . Similarly if 
                        α
                        ⊆
                        [
                        a
                        ,
                        b
                        ]
                        ×
                        {
                        f
                        }
                      then 
                        σ
                        (
                        α
                        )
                        =
                        
                           
                              t
                           
                           
                              η
                           
                        
                     .


                     Fig. 2
                      shows the region covered by the rectangles in 
                        
                           
                              R
                           
                           
                              x
                           
                        
                      and in 
                        
                           
                              R
                           
                           
                              y
                           
                        
                      for a simple mesh. Note that 
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                      does not contain the regions near the endpoints of horizontal mesh lines and similarly 
                        ⋃
                        
                           
                              R
                           
                           
                              y
                           
                        
                      does not contain the regions near the endpoints of vertical mesh lines.


                     
                        Lemma 6
                        
                           Let 
                           
                              M
                            
                           be an N
                           
                              2
                           
                           S mesh. If γ is a vertical edge such that 
                           
                              
                                 
                                    γ
                                 
                                 
                                    ∘
                                 
                              
                              ⊆
                              
                                 
                                    (
                                    ⋃
                                    
                                       
                                          R
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    M
                                    )
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            
                           then 
                           
                              M
                              +
                              γ
                            
                           is an N
                           
                              2
                           
                           S-mesh and 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                              ⊇
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                           
                           . Moreover all the B-splines in 
                           
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            
                           either are in 
                           
                              
                                 LR
                              
                              (
                              M
                              )
                            
                           or are obtained from B-splines in 
                           
                              
                                 LR
                              
                              (
                              M
                              )
                            
                           by the insertion of the abscissa of γ in the horizontal knot vector. Similarly if γ is a horizontal segment.
                        

Note that the addition of a vertical γ (satisfying the hypothesis) cannot reduce the region covered by 
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                     . This means that once 
                        ⋃
                        
                           
                              R
                           
                           
                              x
                           
                        
                      is computed it is possible to add many vertical segments well contained in it while preserving the N2S property. Conversely nothing is said about the behavior of 
                        ⋃
                        
                           
                              R
                           
                           
                              y
                           
                        
                      and thus it should be recomputed after each addition of a vertical segment. Similarly for horizontal segments.


                     
                        Proof
                        We prove the lemma only for the addition of a vertical segment 
                              γ
                              =
                              {
                              a
                              }
                              ×
                              [
                              e
                              ,
                              f
                              ]
                           . Consider a B-spline 
                              B
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            whose support is cut by γ in two connected components. This means that B is not a minimal support B-spline with respect to the mesh 
                              M
                              +
                              γ
                              =
                              (
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    ˜
                                 
                              
                              )
                            and thus there are two B-splines that are obtained from B by inserting a, the abscissa of γ, into 
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                           . Let 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            be one of the two B-splines obtained from B. First we prove by contradiction that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            is a minimal support B-spline for 
                              S
                              (
                              M
                              +
                              γ
                              )
                            and then that there is no φ in 
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            such that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                           . Let 
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                            be the horizontal knot vector of 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           .

Assume that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            is not a minimal support B-spline for 
                              S
                              (
                              M
                              +
                              γ
                              )
                           . Then there exists 
                              φ
                              ∈
                              S
                              (
                              M
                              +
                              γ
                              )
                            that is obtained from 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            by knot insertion. Consider first the case of a horizontal knot insertion so that 
                              φ
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ″
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                            and let 
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                            be the knot that has been inserted in 
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           . Let A be the set of the vertical edges in 
                              
                                 
                                    E
                                 
                                 
                                    v
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                            that are contained in 
                              (
                              {
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                              }
                              ×
                              R
                              )
                              ∩
                              supp
                              
                              B
                           . The existence of φ implies
                              
                                 (7)
                                 
                                    ∀
                                    α
                                    ∈
                                    A
                                    ,
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    α
                                    )
                                    ≥
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                x
                                             
                                             
                                                ″
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    >
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    .
                                 
                              
                            From the definition of 
                              M
                              +
                              γ
                            it follows
                              
                                 (8)
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    +
                                    c
                                 
                              
                            where 
                              c
                              =
                              1
                            if 
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              a
                            and 0 otherwise. From the fact that B is in 
                              
                                 LR
                              
                              (
                              M
                              )
                            it follows (with the same c)
                              
                                 (9)
                                 
                                    ∃
                                    α
                                    ∈
                                    A
                                    :
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    α
                                    )
                                    =
                                    σ
                                    (
                                    α
                                    )
                                    +
                                    c
                                    .
                                 
                              
                            Equations (7), (8) and (9) are in contradiction.

Consider now the insertion of a vertical knot 
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                            and 
                              φ
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              ]
                           . Let A be set of horizontal edges in 
                              
                                 
                                    E
                                 
                                 
                                    h
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                            contained in 
                              (
                              R
                              ×
                              {
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                              }
                              )
                              ∩
                              supp
                              
                              B
                           . Since 
                              B
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            and 
                              
                                 
                                    γ
                                 
                                 
                                    ∘
                                 
                              
                              ⊆
                              
                                 
                                    (
                                    ⋃
                                    
                                       
                                          R
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    M
                                    )
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            it follows that for all 
                              α
                              ∈
                              A
                            such that 
                              α
                              ∩
                              γ
                              ≠
                              ∅
                            it holds
                              
                                 (10)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    α
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    .
                                 
                              
                            On the other hand for 
                              α
                              ⊂
                              supp
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            it must also hold
                              
                                 (11)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    α
                                    )
                                    ≥
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    >
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    .
                                 
                              
                            Equations (10) and (11) are in contradiction because there must be at least an α that is contained in 
                              supp
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            and intersects γ. We can now conclude that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            is in 
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                           . Thus the B-spline in 
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            whose support intersect 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            have the same vertical knot vector of a B-spline in 
                              
                                 LR
                              
                              (
                              M
                              )
                            and thus we can conclude that 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                              ⊇
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                           .

Assume the existence of 
                              φ
                              ∈
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            such that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                           . Then there exists 
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              =
                              B
                              [
                              
                                 
                                    Ξ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            such that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                           . Let 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                            be the ordinates of the horizontal edges contained in supp
                           B and intersecting γ. Let 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              a
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ]
                              ×
                              {
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              }
                            be the edge intersecting γ in the left endpoint at ordinate 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                           . From the hypothesis that 
                              
                                 
                                    γ
                                 
                                 
                                    ∘
                                 
                              
                              ⊂
                              
                                 
                                    (
                                    ⋃
                                    
                                       
                                          R
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    M
                                    )
                                    )
                                 
                                 
                                    ∘
                                 
                              
                            we conclude that 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            and thus that 
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                            is compatible with
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             σ
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                             times
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             σ
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                             
                                             times
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Moreover from 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            it follows that 
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              =
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                           . Since 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            and all have the same vertical knot vector we conclude that 
                              φ
                              =
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           . This proves that 
                              M
                              +
                              γ
                            is an N2S mesh.  □

In Lemma 6 we addressed the preservation of the N2S property for the addition of edges that are well contained in 
                        
                           
                              R
                           
                           
                              x
                           
                        
                      or 
                        
                           
                              R
                           
                           
                              y
                           
                        
                     . This does not cover the limit case, when the added edges intersect the boundary of the refinable region. The problem is that by adding a segment on the boundary of 
                        
                           
                              R
                           
                           
                              x
                           
                        
                      it is possible to obtain a new B-spline B whose support does not intersect 
                        
                           
                              (
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              )
                           
                           
                              ∘
                           
                        
                     . On these B-splines we have no control and they can be further refined and destroy the N2S property. We provide sufficient condition for this case in Lemma 7. In Fig. 3
                      there are some examples of vertical segments whose addition preserve the N2S property because they satisfy the hypothesis of Lemma 6 (left) or Lemma 7 (right).


                     
                        Lemma 7
                        
                           Let 
                           
                              γ
                              =
                              {
                              a
                              }
                              ×
                              [
                              e
                              ,
                              f
                              ]
                            
                           be a vertical segment contained in 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                           
                           . Let 
                           
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    η
                                 
                                 
                                    m
                                 
                              
                            
                           be the maximal (with respect to inclusion) vertical segments contained in 
                           
                              γ
                              ∩
                              ∂
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                           
                           . Finally let 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    n
                                 
                              
                            
                           be the horizontal edges in 
                           
                              
                                 
                                    E
                                 
                                 
                                    h
                                 
                              
                              (
                              M
                              )
                            
                           that intersect one of the 
                           
                              
                                 
                                    η
                                 
                                 
                                    i
                                 
                              
                            
                           and are not contained in 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            
                           (see the picture below where 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            
                           is filled with the chessboard pattern). If for each 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                            
                           there exists 
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    h
                                 
                              
                              (
                              M
                              )
                            
                           prolonging 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                            
                           and contained in 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            
                           such that
                           
                              
                                 
                                    σ
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ≥
                                    σ
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                            
                           then 
                           
                              M
                              +
                              γ
                            
                           is an N
                           
                              2
                           
                           S-mesh, 
                           
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                              ⊇
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            
                           and all B-splines in 
                           
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                              ∖
                              
                                 LR
                              
                              (
                              M
                              )
                            
                           are obtained from a B-splines in 
                           
                              
                                 LR
                              
                              (
                              M
                              )
                              ∖
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            
                           by inserting the abscissa of γ in the horizontal knot vector. Similarly if γ is a horizontal segment.
                           
                              
                                 
                              
                           
                        


                     
                        Proof
                        The proof follows the pattern of the proof of Lemma 6. First we prove that if 
                              B
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            is split by the insertion of γ then any obtained B-spline 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                            is in 
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                           .

Assuming that there is 
                              φ
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ″
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                              ]
                            in 
                              S
                              (
                              M
                              +
                              γ
                              )
                            obtained from 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            by inserting a horizontal knot we reach the same contradiction as in Lemma 6. Now assume the existence of 
                              φ
                              =
                              B
                              [
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              ]
                            in 
                              S
                              (
                              M
                              +
                              γ
                              )
                            obtained from 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            by inserting 
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                            in 
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                           . Let A be the set of the edges in 
                              
                                 
                                    E
                                 
                                 
                                    h
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                            contained in 
                              R
                              ×
                              {
                              
                                 
                                    θ
                                 
                                 
                                    ¯
                                 
                              
                              }
                              ∩
                              supp
                              
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           . Then for all α in A it holds
                              
                                 (12)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    α
                                    )
                                    =
                                    σ
                                    (
                                    α
                                    )
                                    ≥
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    >
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    .
                                 
                              
                            Let 
                              
                                 
                                    α
                                 
                                 
                                    ˆ
                                 
                              
                            be an edge in A that intersect γ. If it is possible to choose 
                              
                                 
                                    α
                                 
                                 
                                    ˆ
                                 
                              
                              ⊂
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                            then we reach a contradiction as in Lemma 6. Otherwise there must be an index i such that 
                              
                                 
                                    α
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                           . Then by the additional hypothesis it follows
                              
                                 (13)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    =
                                    σ
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ≤
                                    σ
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    .
                                 
                              
                            Equations (12) and (13) contradict. Thus 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                            is in 
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            and as in Lemma 6 we conclude that 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              +
                              γ
                              )
                              ⊇
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                           .

Let 
                              φ
                              ∈
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            be such that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                           . Then there exists 
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                              =
                              B
                              [
                              
                                 
                                    Ξ
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              M
                              )
                            with 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                           .

Let 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    a
                                 
                                 
                                    n
                                 
                              
                            be the ordinates of the horizontal edges contained in supp
                           B and intersecting γ. Let 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              a
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ]
                              ×
                              {
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              }
                            be the edge intersecting γ in the left endpoint at ordinate 
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                           . Note that if 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                            is not contained in 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            then it must be one of the 
                              
                                 
                                    ρ
                                 
                                 
                                    j
                                 
                              
                           . Call it 
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . Let
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                if 
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊂
                                                ⋃
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      x
                                                   
                                                
                                                (
                                                M
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Thus 
                              supp
                              
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            contains all of the 
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            and since they are contained in 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              M
                              )
                            its knot vector 
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                            is compatible with
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             σ
                                             (
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                             times
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             σ
                                             (
                                             
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                             
                                             times
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            This and the fact that 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            imply 
                              
                                 
                                    Ξ
                                 
                                 
                                    y
                                 
                              
                              =
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                           . Since 
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                              ≺
                              φ
                              ≺
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                            and all have the same vertical knot vector we conclude that 
                              φ
                              =
                              
                                 
                                    B
                                 
                                 
                                    ′
                                 
                              
                           . This proves that 
                              M
                              +
                              γ
                            is an N2S mesh.  □

When proving both Lemma 6 and Lemma 7 we derived the following partial result to which we will refer later.


                     
                        Corollary 8
                        
                           If γ satisfies the hypothesis of 
                           
                              Lemma 6
                            
                           or 
                           
                              Lemma 7
                            
                           then the B-splines obtained from B-splines in 
                           
                              
                                 LR
                              
                              (
                              M
                              )
                              ∖
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                            
                           by the insertion of the knot corresponding to γ (either into 
                           
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                              
                            
                           or 
                           
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                              
                            
                           depending on the direction of γ) belong to 
                           
                              
                                 LR
                              
                              (
                              M
                              +
                              γ
                              )
                           
                           .
                        

This means that, differently from the case of general LR splines, the addition of a segment does not trigger a chain of refinements, but only causes the refinement of the directly affected functions in 
                        
                           LR
                        
                        (
                        M
                        )
                     .

In this section we introduce a hierarchical construction of box meshes. By hierarchical we mean that it starts from a sequence of box meshes associated with nested tensor-product B-spline spaces (tensor meshes). After the definition we describe sufficient conditions for the N2S property.

Let 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           ⊂
                           …
                           ⊂
                           
                              
                                 V
                              
                              
                                 m
                              
                           
                         be a sequence of nested tensor-product B-spline spaces having the same degree d and defined on the same domain Ω. Let 
                           
                              
                                 B
                              
                              
                                 ℓ
                              
                           
                         be the canonical basis of the space 
                           
                              
                                 V
                              
                              
                                 ℓ
                              
                           
                        . Each space 
                           
                              
                                 V
                              
                              
                                 ℓ
                              
                           
                         is defined by a pair of knot vectors 
                           
                              
                                 Θ
                              
                              
                                 ℓ
                              
                           
                           =
                           (
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                              
                           
                           )
                         whose components are
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       x
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       x
                                       ,
                                       1
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       x
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       y
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       y
                                       ,
                                       1
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       y
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             y
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 .
                              
                           
                         In this construction we assume that at each step only one of the two components is refined: either 
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                         or 
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                              
                           
                        . We say that the refinement at step ℓ is horizontal if 
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                           ≠
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                              
                           
                           =
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                        . Similarly we say that it is vertical if 
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                           =
                           
                              
                                 Θ
                              
                              
                                 x
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                              
                           
                           ≠
                           
                              
                                 Θ
                              
                              
                                 y
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                        .

Let 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                           =
                           Ω
                           ⊇
                           …
                           ⊇
                           
                              
                                 Ω
                              
                              
                                 m
                              
                           
                         be a corresponding sequence of nested domains such that for each level ℓ the domain 
                           
                              
                                 Ω
                              
                              
                                 ℓ
                              
                           
                         is a union of Bézier elements for 
                           
                              
                                 V
                              
                              
                                 ℓ
                              
                           
                        . That means
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 
                                    ⋃
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       x
                                       ,
                                       s
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       x
                                       ,
                                       s
                                       +
                                       1
                                    
                                    
                                       ℓ
                                    
                                 
                                 ]
                                 ×
                                 [
                                 
                                    
                                       θ
                                    
                                    
                                       y
                                       ,
                                       t
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       y
                                       ,
                                       t
                                       +
                                       1
                                    
                                    
                                       ℓ
                                    
                                 
                                 ]
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 ℓ
                              
                           
                         is a subset of 
                           {
                           (
                           i
                           ,
                           j
                           )
                           :
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                           −
                           1
                           ,
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 y
                              
                              
                                 ℓ
                              
                           
                           −
                           1
                           }
                        . Let 
                           
                              
                                 R
                              
                              
                                 ℓ
                              
                           
                         be the set of the elements from level ℓ contained in 
                           
                              
                                 Ω
                              
                              
                                 ℓ
                              
                           
                        , that means
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 
                                    {
                                    η
                                    =
                                    [
                                    
                                       
                                          θ
                                       
                                       
                                          x
                                          ,
                                          s
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          x
                                          ,
                                          s
                                          +
                                          1
                                       
                                       
                                          ℓ
                                       
                                    
                                    ]
                                    ×
                                    [
                                    
                                       
                                          θ
                                       
                                       
                                          y
                                          ,
                                          t
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          y
                                          ,
                                          t
                                          +
                                          1
                                       
                                       
                                          ℓ
                                       
                                    
                                    ]
                                    :
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          η
                                       
                                       
                                          ∘
                                       
                                    
                                    ≠
                                    ∅
                                    }
                                 
                                 .
                              
                           
                        
                     


                        
                           Definition 9
                           Given a sequence of levels 
                                 0
                                 ,
                                 …
                                 ,
                                 m
                               as above, the associated hierarchical LR mesh is 
                                 H
                                 =
                                 (
                                 R
                                 ,
                                 σ
                                 )
                               with
                                 
                                    (15)
                                    
                                       R
                                       =
                                       
                                          ⋃
                                          
                                             ℓ
                                             =
                                             0
                                          
                                          m
                                       
                                       
                                          {
                                          η
                                          =
                                          
                                             
                                                β
                                                ∖
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      ℓ
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ¯
                                          
                                          :
                                          β
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                ℓ
                                             
                                          
                                          ,
                                          
                                          η
                                          ≠
                                          ∅
                                          }
                                       
                                    
                                 
                               and σ defined in terms of the knot multiplicities as follows
                                 
                                    (16)
                                    
                                       σ
                                       (
                                       α
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               x
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   a
                                                   )
                                                
                                                
                                                   if 
                                                   α
                                                   =
                                                   {
                                                   a
                                                   }
                                                   ×
                                                   [
                                                   e
                                                   ,
                                                   f
                                                   ]
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               y
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   e
                                                   )
                                                
                                                
                                                   if 
                                                   α
                                                   =
                                                   [
                                                   a
                                                   ,
                                                   b
                                                   ]
                                                   ×
                                                   {
                                                   e
                                                   }
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               where ℓ is the biggest index such that 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ⊃
                                 α
                              .

Note that all the elements of 
                           R
                         are rectangles because at each step only one direction is refined. Note also that the elements in 
                           R
                         are not necessarily Bézier elements for one of the spaces 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 V
                              
                              
                                 m
                              
                           
                        , see Fig. 4
                         for a counterexample.

Hierarchical LR meshes can be constructed by iteratively adding segments to a tensor mesh. This justifies the name. Let 
                           
                              
                                 M
                              
                              
                                 0
                              
                           
                         be the box mesh corresponding to 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                        . There are many possible choices of sequences of segments 
                           
                              
                                 γ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 γ
                              
                              
                                 N
                              
                           
                         such that
                           
                              
                                 
                                    (
                                    …
                                    
                                       (
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    …
                                    )
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 H
                                 .
                              
                           
                         For our purposes it is convenient to define a canonical sequence that we will use in induction proofs. Let 
                           
                              
                                 T
                              
                              
                                 ℓ
                              
                           
                        , 
                           ℓ
                           =
                           0
                           ,
                           …
                           ,
                           m
                         be the hierarchical box meshes associated to the levels 
                           0
                           ,
                           …
                           ,
                           ℓ
                        . Thus 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         is the mesh associated to 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                           =
                           H
                        . We describe a sequences of additions that construct 
                           
                              
                                 T
                              
                              
                                 ℓ
                              
                           
                         from 
                           
                              
                                 T
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                        . The canonical sequence is then the concatenation of these. Assume that the refinement at step ℓ is horizontal, then we add vertical segments. For each 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 x
                              
                              
                                 ℓ
                              
                           
                         we add the connected components of 
                           
                              
                                 Ω
                              
                              
                                 ℓ
                              
                           
                           ∩
                           (
                           {
                           
                              
                                 θ
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ℓ
                              
                           
                           }
                           ×
                           R
                           )
                         in order of increasing ordinate 
                           
                              
                                 μ
                              
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       x
                                    
                                    
                                       ℓ
                                    
                                 
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ℓ
                              
                           
                           )
                           −
                           
                              
                                 μ
                              
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       x
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 x
                                 ,
                                 i
                              
                              
                                 ℓ
                              
                           
                           )
                         times. Similarly for vertical refinement steps.

Restricting to hierarchical box meshes allows us to find sufficient conditions for the N2S property that can be expressed as constraints on the geometries of 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                           ,
                           …
                           
                              
                                 Ω
                              
                              
                                 m
                              
                           
                        . It is indeed sufficient for the N2S property that there is enough separation between the boundary of 
                           
                              
                                 Ω
                              
                              
                                 ℓ
                              
                           
                         and that of 
                           
                              
                                 Ω
                              
                              
                                 ℓ
                                 −
                                 1
                              
                           
                         in the direction of the refinement. To describe this we introduce a separation distance.


                        
                           Definition 10
                           Let 
                                 p
                                 =
                                 (
                                 a
                                 ,
                                 e
                                 )
                               and 
                                 q
                                 =
                                 (
                                 b
                                 ,
                                 f
                                 )
                               be points in Ω, then the vertical separation distance between p and q relative to level ℓ is a positive integer defined by
                                 
                                    
                                       
                                          
                                             sep
                                          
                                          
                                             y
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       p
                                       ,
                                       q
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   #
                                                   {
                                                   j
                                                   :
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         y
                                                         ,
                                                         j
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   ∈
                                                   [
                                                   e
                                                   ,
                                                   f
                                                   ]
                                                   }
                                                
                                                
                                                   a
                                                   =
                                                   b
                                                   ,
                                                
                                             
                                             
                                                
                                                   +
                                                   ∞
                                                
                                                
                                                   a
                                                   ≠
                                                   b
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Similarly the horizontal separation is
                                 
                                    
                                       
                                          
                                             sep
                                          
                                          
                                             x
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       p
                                       ,
                                       q
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   #
                                                   {
                                                   j
                                                   :
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         x
                                                         ,
                                                         j
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   ∈
                                                   [
                                                   a
                                                   ,
                                                   b
                                                   ]
                                                   }
                                                
                                                
                                                   e
                                                   =
                                                   f
                                                   ,
                                                
                                             
                                             
                                                
                                                   +
                                                   ∞
                                                
                                                
                                                   e
                                                   ≠
                                                   f
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               For a set of points 
                                 A
                                 ⊆
                                 Ω
                               the separation 
                                 
                                    
                                       sep
                                    
                                    
                                       y
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 p
                                 ,
                                 A
                                 )
                               is defined as
                                 
                                    
                                       
                                          
                                             sep
                                          
                                          
                                             y
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       p
                                       ,
                                       A
                                       )
                                       =
                                       
                                          inf
                                          
                                             q
                                             ∈
                                             A
                                          
                                       
                                       ⁡
                                       
                                       
                                          
                                             sep
                                          
                                          
                                             y
                                          
                                          
                                             ℓ
                                          
                                       
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                               and similarly for 
                                 
                                    
                                       sep
                                    
                                    
                                       x
                                    
                                    
                                       ℓ
                                    
                                 
                              .

Based on the above separations we define the shadow operators 
                           
                              
                                 S
                              
                              
                                 ℓ
                              
                           
                         that map subsets of Ω to bigger subsets of Ω:
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ℓ
                                    
                                 
                                 A
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   {
                                                   p
                                                   ∈
                                                   Ω
                                                   :
                                                   
                                                      
                                                         sep
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   (
                                                   p
                                                   ,
                                                   A
                                                   )
                                                   ≤
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   }
                                                
                                                ¯
                                             
                                          
                                          
                                             if the refinement at step 
                                             ℓ
                                             +
                                             1
                                              is horizontal
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   {
                                                   p
                                                   ∈
                                                   Ω
                                                   :
                                                   
                                                      
                                                         sep
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   (
                                                   p
                                                   ,
                                                   A
                                                   )
                                                   ≤
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   }
                                                
                                                ¯
                                             
                                          
                                          
                                             if the refinement at step 
                                             ℓ
                                             +
                                             1
                                              is vertical
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         See Fig. 5
                         for an example of 
                           
                              
                                 S
                              
                              
                                 ℓ
                              
                           
                         in which the refinement at step 
                           ℓ
                           +
                           1
                         is horizontal.


                        
                           Theorem 11
                           
                              If the domains associated to the levels are such that 
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ⊇
                                 
                                    
                                       S
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                              
                              , 
                              
                                 ℓ
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                               
                              then 
                              
                                 H
                               
                              has the N
                              
                                 2
                              
                              S property.
                           


                        
                           Proof
                           We prove the theorem by induction: we assume that
                                 
                                    •
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                2
                                             
                                          
                                        and 
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                        are N2S-meshes;

if the refinement at level 
                                          ℓ
                                          −
                                          1
                                        is horizontal then 
                                          
                                             
                                                Ω
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                          ⊆
                                          ⋃
                                          
                                             
                                                R
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                2
                                             
                                          
                                          )
                                       ;

if it is vertical 
                                          
                                             
                                                Ω
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                          ⊆
                                          ⋃
                                          
                                             
                                                R
                                             
                                             
                                                y
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                2
                                             
                                          
                                          )
                                       ;


                                       
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                             
                                          
                                        is an N2S-mesh


                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                ℓ
                                             
                                          
                                          ⊆
                                          ⋃
                                          
                                             
                                                R
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                          )
                                        if the refinement at step ℓ is horizontal;


                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                ℓ
                                             
                                          
                                          ⊆
                                          ⋃
                                          
                                             
                                                R
                                             
                                             
                                                y
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                          )
                                        if the refinement at step ℓ is vertical.

First we prove that 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ⊆
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              . There are two cases: either the refinement at step 
                                 ℓ
                                 −
                                 1
                               is horizontal and thus the above holds as stated in Lemma 6 and Lemma 7 or the refinement at step 
                                 ℓ
                                 −
                                 1
                               is vertical. In the second case we prove that all elements 
                                 η
                                 =
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ×
                                 [
                                 e
                                 ,
                                 f
                                 ]
                               of 
                                 R
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                               that intersect 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                               are in 
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              . Let 
                                 p
                                 =
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 )
                               be a point in 
                                 
                                    
                                       η
                                    
                                    
                                       ∘
                                    
                                 
                                 ∩
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                               and 
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                               be the vertical edges in 
                                 
                                    
                                       E
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                               that intersect 
                                 R
                                 ×
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 }
                                 ∩
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                              , see Fig. 6
                              .

Let 
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                               be their abscissa and 
                                 Z
                               be the knot vector
                                 
                                    (17)
                                    
                                       Z
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Since all 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                               are contained in 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 ⊆
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       2
                                    
                                 
                                 )
                               it follows that for all 
                                 B
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 ∈
                                 
                                    LR
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                               such that 
                                 supp
                                 
                                 B
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                                 ]
                                 ⊇
                                 η
                              , 
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                               is compatible with 
                                 Z
                              . Moreover by the definition of the shadow operator it holds
                                 
                                    (18)
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                :
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ℓ
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ≥
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                :
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                >
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      ℓ
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ≥
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          1
                                          ,
                                       
                                    
                                 
                               and thus we conclude that
                                 
                                    
                                       supp
                                       
                                       B
                                       [
                                       
                                          
                                             Ξ
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                       ]
                                       ⊂
                                       [
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             a
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                       ×
                                       R
                                       .
                                    
                                 
                              
                           

Since all edges in 
                                 
                                    
                                       R
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                               contained in 
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 ]
                                 ×
                                 {
                                 e
                                 }
                                 ∩
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                               have multiplicity 
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ℓ
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 e
                                 )
                               it follows that e must be a knot in 
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                               with maximum multiplicity: 
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             Ξ
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 (
                                 e
                                 )
                                 <
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             Θ
                                          
                                          
                                             ℓ
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 e
                                 )
                               implies that e is either the first or the last knot. Similarly for f and thus 
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                               is compatible with
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   e
                                                   ,
                                                   …
                                                   ,
                                                   e
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                e
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   f
                                                   ,
                                                   …
                                                   ,
                                                   f
                                                
                                                ︸
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            ℓ
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                f
                                                )
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Since 
                                 B
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       Ξ
                                    
                                    
                                       y
                                    
                                 
                                 ]
                               is arbitrary we conclude that η is contained in 
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              . Since also η is arbitrary we conclude that 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ⊂
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              .

Recall that 
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                    
                                 
                               can be obtained from 
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                               by a sequence of additions of segments. Let 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       N
                                    
                                 
                               be the segments described in Section 4.1 whose addition to 
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                               produces 
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                    
                                 
                              . Then the 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                               are contained in 
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ⊆
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              . The addition of the 
                                 
                                    
                                       γ
                                    
                                    
                                       i
                                    
                                 
                               such that 
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       ∘
                                    
                                 
                                 ⊂
                                 
                                    
                                       (
                                       ⋃
                                       
                                          
                                             R
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             ℓ
                                             −
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∘
                                    
                                 
                               preserves the N2S property according to Lemma 6. The others must satisfy the hypothesis of Lemma 7 because of the hierarchical construction. That is: γ cannot intercept pairs of aligned connected edges 
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       e
                                    
                                 
                                 )
                               with 
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 ⊂
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       δ
                                    
                                    
                                       e
                                    
                                 
                                 ⊄
                                 ⋃
                                 
                                    
                                       R
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 )
                               and 
                                 σ
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 >
                                 σ
                                 (
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              . So the induction is proved.  □

We are also interested in the completeness of the provided space, i.e. whether 
                        
                           LR
                        
                        (
                        H
                        )
                      equals 
                        S
                        (
                        H
                        )
                      or not. Describing which refinements preserve completeness was one of the themes of Dokken et al. (2013) and was pursued using homology based techniques. We restrict our attention to hierarchical LR meshes with the N2S property and we prove that if the 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                      are “thick enough” in the direction orthogonal to the refinement then the resulting space is 
                        
                           LR
                        
                        (
                        H
                        )
                        =
                        S
                        (
                        H
                        )
                     . This is made precise in the following result.


                     
                        Theorem 12
                        
                           Let 
                           
                              H
                            
                           be a hierarchical mesh satisfying the hypothesis of 
                           
                              Theorem 11
                           
                           : i.e. for all 
                           
                              ℓ
                              =
                              1
                              ,
                              …
                              ,
                              m
                            
                           it holds
                           
                              
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          ℓ
                                       
                                    
                                    ⊇
                                    
                                       
                                          S
                                       
                                       
                                          ℓ
                                       
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          ℓ
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                            
                           If for all horizontal refinement steps ℓ and all connected component 
                           
                              A
                              =
                              {
                              a
                              }
                              ×
                              [
                              e
                              ,
                              f
                              ]
                            
                           of 
                           
                              {
                              a
                              }
                              ×
                              R
                              ∩
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                 
                              
                            
                           it holds
                           
                              
                                 (19)
                                 
                                    
                                       
                                          sep
                                       
                                       
                                          y
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    (
                                    a
                                    ,
                                    e
                                    )
                                    ,
                                    (
                                    a
                                    ,
                                    f
                                    )
                                    )
                                    ≥
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    +
                                    2
                                    ,
                                 
                              
                            
                           and similarly for vertical refinement steps and all connected component 
                           
                              A
                              =
                              [
                              a
                              ,
                              b
                              ]
                              ×
                              {
                              e
                              }
                            
                           of 
                           
                              R
                              ×
                              {
                              e
                              }
                              ∩
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                 
                              
                            
                           it holds
                           
                              
                                 (20)
                                 
                                    
                                       
                                          sep
                                       
                                       
                                          y
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    (
                                    a
                                    ,
                                    e
                                    )
                                    ,
                                    (
                                    b
                                    ,
                                    e
                                    )
                                    )
                                    ≥
                                    
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                    +
                                    2
                                    ,
                                 
                              
                            
                           then 
                           
                              
                                 LR
                              
                              (
                              H
                              )
                              =
                              S
                              (
                              H
                              )
                           
                           . See 
                           
                              Fig. 7
                           
                            
                           for a graphical representation of the hypothesis.
                        


                     
                        Proof
                        As described in Section 4, 
                              H
                            can be obtained by refining the tensor mesh 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                            corresponding to the space 
                              
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                           :
                              
                                 
                                    H
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          n
                                       
                                    
                                    .
                                 
                              
                            Let 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           . We know that completeness holds for tensor meshes and thus that
                              
                                 
                                    #
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    .
                                 
                              
                            We prove the induction step
                              
                                 
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    =
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    
                                    ⇒
                                    
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

Assume that 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            is finer than 
                              
                                 
                                    T
                                 
                                 
                                    ℓ
                                    −
                                    1
                                 
                              
                            and coarser than 
                              
                                 
                                    T
                                 
                                 
                                    ℓ
                                 
                              
                            and that refinement at step ℓ is horizontal. Then 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                            is vertical segment contained in 
                              ⋃
                              
                                 
                                    R
                                 
                                 
                                    x
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                            and a connected component of 
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                 
                              
                              ∩
                              {
                              a
                              }
                              ×
                              R
                           . Let 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                            be the ordinates of the intersections of 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                            with horizontal edges in 
                              
                                 
                                    E
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                           , 
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              a
                              ,
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              a
                              ,
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                              )
                            be the endpoints of 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                            and
                              
                                 
                                    Ξ
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ℓ
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ℓ
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         ℓ
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            From Theorem 11 we know that 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            is an N2S mesh and thus from Theorem 4 that
                              
                                 
                                    #
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    dim
                                    ⁡
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ≤
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    .
                                 
                              
                            In order to prove the induction step we show that 
                              
                                 
                                    Δ
                                 
                                 
                                    LR
                                 
                              
                              ≥
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          LR
                                       
                                    
                                    =
                                    #
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    #
                                    
                                       LR
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                            and
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    dim
                                    ⁡
                                    S
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

Reasoning as in the proof of Theorem 11, we deduce that 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                            satisfies the hypotheses of Lemma 6 or Lemma 7. Thus Ξ is compatible with all the vertical knot vectors 
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                            of the B-splines 
                              B
                              [
                              
                                 
                                    Z
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                            such that 
                              (
                              supp
                              
                              B
                              [
                              
                                 
                                    Z
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                              ]
                              )
                              ∩
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                              ≠
                              ∅
                           . This means that all the 
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                            as above are composed of 
                              
                                 
                                    d
                                 
                                 
                                    y
                                 
                              
                              +
                              2
                            consecutive knots of Ξ.

Since 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            is an N2S mesh, it follows (Bressan, 2013, Lemma 3.4) that for each point 
                              v
                              =
                              (
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    y
                                 
                              
                              )
                            and integers 
                              s
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              }
                           , 
                              t
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              }
                            there exists 
                              B
                              [
                              
                                 
                                    Z
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                              ]
                              ∈
                              
                                 LR
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                            such that
                              
                                 
                                    #
                                    {
                                    ζ
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          x
                                       
                                    
                                    :
                                    ζ
                                    ≤
                                    
                                       
                                          v
                                       
                                       
                                          x
                                       
                                    
                                    }
                                    =
                                    s
                                    ,
                                    
                                    #
                                    {
                                    ζ
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          y
                                       
                                    
                                    :
                                    ζ
                                    ≤
                                    
                                       
                                          v
                                       
                                       
                                          y
                                       
                                    
                                    }
                                    =
                                    t
                                    .
                                 
                              
                            For each edge that is contained in 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                           , we apply this result to one inner point choosing 
                              s
                              =
                              
                                 
                                    d
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                            and considering all possible values of t. We then observe that for each knot vector composed of 
                              
                                 
                                    d
                                 
                                 
                                    y
                                 
                              
                              +
                              2
                            consecutive knots of Ξ, there exists at least one B-spline in 
                              
                                 LR
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                           , which is defined by this knot vector with respect to the y-direction and by another one with respect to the x-direction. This B-spline is refined by the addition of 
                              
                                 
                                    γ
                                 
                                 
                                    i
                                 
                              
                            and the obtained B-splines are in 
                              
                                 LR
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                           , see Corollary 8. Consequently
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          LR
                                       
                                    
                                    ≥
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                Θ
                                             
                                             
                                                y
                                             
                                             
                                                ℓ
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    −
                                    1
                                    =
                                    
                                       
                                          sep
                                       
                                       
                                          y
                                       
                                       
                                          ℓ
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    −
                                    1
                                    .
                                 
                              
                           
                        


                           Dokken et al. (2013, Theorem 5.5) provide a formula for 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                           . The formula is based on previous research from Mourrain (2014). From the formula it follows that
                              
                                 (21)
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    
                                       
                                          sep
                                       
                                       
                                          y
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    −
                                    1
                                    +
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          h
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                            where 
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            are two non-negative functions of the mesh that can be computed with homological techniques. According to Dokken et al. (2013, Note 1 after Theorem 5.5), 
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              0
                            if 
                              S
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                              ≠
                              {
                              0
                              }
                            and this is our case. The homological term 
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              )
                            is 0 (Note 2) since the initial mesh is a tensor-product mesh. Moreover 
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              )
                            is non-increasing with respect to i because of (19), (20) and Dokken et al. (2013, Note 3). Consequently, all homological terms vanish and we may complete the proof of the induction step by observing that
                              
                                 (22)
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          LR
                                       
                                    
                                    ≥
                                    
                                       
                                          sep
                                       
                                       
                                          y
                                       
                                       
                                          ℓ
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          y
                                       
                                    
                                    −
                                    1
                                    =
                                    
                                       
                                          Δ
                                       
                                       
                                          S
                                       
                                    
                                    .
                                 
                              
                             □

In a slightly different setting, the fact that the homological terms vanish when the mesh is constructed from a tensor mesh by adding a sequence of “long enough” segments was already stated by Mourrain (2014, Theorem 3.7).

In this subsection we present a construction for hierarchical box meshes that guarantees both the N2S property and completeness. We assume that the spaces 
                        
                           
                              V
                           
                           
                              0
                           
                        
                        ,
                        …
                        ,
                        
                           
                              V
                           
                           
                              m
                           
                        
                      are fixed and that a minimum refinement level is specified for some regions.

The input of our construction is a sequence of 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      of subsets of 
                        Ω
                        =
                        
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                           
                              2
                           
                        
                      and the output is a mesh such that all basis functions that are active on a point in 
                        
                           
                              ω
                           
                           
                              ℓ
                           
                        
                      are refinements of basis functions from 
                        
                           
                              B
                           
                           
                              ℓ
                           
                        
                     . The 
                        
                           
                              ω
                           
                           
                              ℓ
                           
                        
                      do not need to be nested and can be empty. For example they can be a discrete set of points, a curve or a region or a union of those.

From 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      we construct the domains 
                        
                           
                              Ω
                           
                           
                              1
                           
                        
                        ⊇
                        …
                        ⊇
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                      starting from 
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                      and back to 
                        
                           
                              Ω
                           
                           
                              1
                           
                        
                     . First we define the auxiliary sets 
                        
                           
                              
                                 
                                    ω
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              ℓ
                           
                        
                      for 
                        ℓ
                        =
                        1
                        ,
                        …
                        ,
                        m
                     :
                        
                           
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              ⋃
                              {
                              supp
                              
                              B
                              :
                              B
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                              supp
                              
                              B
                              ∩
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                 
                              
                              ≠
                              ∅
                              }
                              .
                           
                        
                      Set 
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                      to 
                        
                           
                              
                                 
                                    ω
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              m
                           
                        
                     . Then 
                        
                           
                              Ω
                           
                           
                              ℓ
                              −
                              1
                           
                        
                      with 
                        ℓ
                        =
                        m
                        −
                        1
                        ,
                        …
                        ,
                        1
                      is defined to be
                        
                           (23)
                           
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    ℓ
                                    −
                                    1
                                 
                              
                              ∪
                              
                                 
                                    S
                                 
                                 
                                    ℓ
                                    −
                                    1
                                 
                              
                              
                                 
                                    Ω
                                 
                                 
                                    ℓ
                                 
                              
                              .
                           
                        
                     
                  

By construction the domains associated to the levels satisfy Lemma 11 and Lemma 12 and thus 
                        H
                      is an N2S-mesh for which 
                        
                           LR
                        
                        (
                        H
                        )
                        =
                        S
                        (
                        H
                        )
                     .

We conclude this section with some examples of the meshes constructed with our method in case of dyadically refined knot vectors. Let
                        
                           
                              
                                 
                                    Θ
                                 
                                 
                                    x
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          0
                                          ,
                                          …
                                          ,
                                          0
                                       
                                       ︸
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       
                                       times
                                    
                                 
                                 ,
                                 …
                                 
                                    k
                                    
                                       
                                          2
                                       
                                       
                                          ⌈
                                          ℓ
                                          /
                                          2
                                          ⌉
                                       
                                    
                                 
                                 …
                                 ,
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          1
                                       
                                       ︸
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       1
                                       
                                       times
                                    
                                 
                                 ]
                              
                              ,
                              
                              0
                              <
                              k
                              <
                              
                                 
                                    2
                                 
                                 
                                    ⌈
                                    ℓ
                                    /
                                    2
                                    ⌉
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    Θ
                                 
                                 
                                    y
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          0
                                          ,
                                          …
                                          ,
                                          0
                                       
                                       ︸
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       1
                                       
                                       times
                                    
                                 
                                 ,
                                 …
                                 
                                    k
                                    
                                       
                                          2
                                       
                                       
                                          ⌊
                                          ℓ
                                          /
                                          2
                                          ⌋
                                       
                                    
                                 
                                 …
                                 ,
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          1
                                       
                                       ︸
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             y
                                          
                                       
                                       +
                                       1
                                       
                                       times
                                    
                                 
                                 ]
                              
                              ,
                              
                              0
                              <
                              k
                              <
                              
                                 
                                    2
                                 
                                 
                                    ⌊
                                    ℓ
                                    /
                                    2
                                    ⌋
                                 
                              
                              .
                           
                        
                      We show the meshes constructed from the input regions 
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      with
                        
                           
                              
                                 
                                    ω
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ℓ
                                          =
                                          m
                                          ,
                                       
                                    
                                    
                                       
                                          ∅
                                       
                                       
                                          otherwise
                                       
                                    
                                 
                              
                           
                        
                      for different choices of G and m.

In Fig. 8
                      the set G is a polygonal chain composed of two segments and m is 
                        4
                        ,
                        6
                        ,
                        8
                        ,
                        10
                        ,
                        12
                        ,
                        14
                     . In Fig. 9
                      it is a spiral centered in 
                        (
                        0.5
                        ,
                        0.5
                        )
                      and m is 
                        4
                        ,
                        6
                        ,
                        8
                        ,
                        10
                        ,
                        12
                        ,
                        14
                     . In both figures the degree is 
                        d
                        =
                        (
                        2
                        ,
                        2
                        )
                     .

As can be seen in Figs. 8 and 9 the refined region follows G closely and does not propagate. This statement can be made more precise. For simplicity we assume that the degree is the same in both coordinate directions 
                        
                           
                              d
                           
                           
                              x
                           
                        
                        =
                        
                           
                              d
                           
                           
                              y
                           
                        
                        =
                        d
                      and that the maximal level m is even.

The size of an element 
                        η
                        =
                        [
                        a
                        ,
                        b
                        ]
                        ×
                        [
                        e
                        ,
                        f
                        ]
                        ∈
                        R
                        (
                        H
                        )
                      contained in 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                        ∖
                        
                           
                              Ω
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      is bounded by
                        
                           
                              
                                 
                                    2
                                 
                                 
                                    −
                                    
                                       ⌈
                                       ℓ
                                       /
                                       2
                                       ⌉
                                    
                                    −
                                    1
                                 
                              
                              ≤
                              b
                              −
                              a
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    −
                                    
                                       ⌈
                                       ℓ
                                       /
                                       2
                                       ⌉
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    2
                                 
                                 
                                    −
                                    
                                       ⌊
                                       ℓ
                                       /
                                       2
                                       ⌋
                                    
                                    −
                                    1
                                 
                              
                              ≤
                              f
                              −
                              e
                              ≤
                              
                                 
                                    2
                                 
                                 
                                    −
                                    
                                       ⌊
                                       ℓ
                                       /
                                       2
                                       ⌋
                                    
                                 
                              
                              .
                           
                        
                      The distance of such an element from 
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      can be estimated using a geometric sum. Indeed the distance between 
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      and 
                        ∂
                        
                           
                              Ω
                           
                           
                              m
                           
                        
                      is in
                        
                           
                              [
                              d
                              
                                 
                                    2
                                 
                                 
                                    −
                                    m
                                    /
                                    2
                                 
                              
                              ,
                              
                              (
                              d
                              +
                              1
                              )
                              
                                 
                                    2
                                 
                                 
                                    −
                                    m
                                    /
                                    2
                                    +
                                    1
                                    /
                                    2
                                 
                              
                              ]
                              .
                           
                        
                      The operator 
                        
                           
                              S
                           
                           
                              ℓ
                              −
                              1
                           
                        
                      extends the domain 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                      in one direction by a length contained between 
                        d
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                              +
                              1
                           
                        
                      and 
                        (
                        d
                        +
                        1
                        )
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                              +
                              1
                           
                        
                     . It follows that the distance between 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                      and the boundary of 
                        
                           
                              Ω
                           
                           
                              ℓ
                              −
                              2
                           
                        
                      (in the case of ℓ even) is contained between 
                        d
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                              +
                              1
                           
                        
                      and 
                        (
                        d
                        +
                        1
                        )
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                              +
                              3
                              /
                              2
                           
                        
                     .

The distance between 
                        η
                        ⊆
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                        ∖
                        
                           
                              Ω
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      and 
                        
                           
                              ω
                           
                           
                              m
                           
                        
                      can be bounded using a geometric sum and for 
                        ℓ
                        <
                        m
                        −
                        1
                      it is contained in
                        
                           
                              [
                              d
                              (
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    /
                                    2
                                 
                              
                              −
                              
                                 
                                    2
                                 
                                 
                                    −
                                    m
                                    /
                                    2
                                 
                              
                              )
                              ,
                              
                                 
                                    2
                                 
                                 
                                    3
                                    /
                                    2
                                 
                              
                              (
                              d
                              +
                              1
                              )
                              
                                 
                                    2
                                 
                                 
                                    −
                                    ℓ
                                    /
                                    2
                                 
                              
                              ]
                              .
                           
                        
                      So we proved that any point contained in an element of size 
                        ≈
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                           
                        
                      is at a distance 
                        ≈
                        
                           
                              2
                           
                           
                              −
                              ℓ
                              /
                              2
                           
                        
                      from 
                        
                           
                              ω
                           
                           
                              m
                           
                        
                     . This means that the obtained meshes are geometrically refined only near the requested regions.

It is interesting to compare the described approach with the THB-spline approach developed by Giannelli et al. (2012) and Mokriš et al. (2014). We do this in the simplified setting in which 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                      is a union of rectangles of level 
                        ℓ
                        −
                        1
                     . In this setting we can compare the space 
                        
                           LR
                        
                        (
                        H
                        )
                      to the THB-spline space 
                        
                           TH
                        
                        (
                        H
                        )
                      having the same Bézier elements and defined from the same levels. This means that 
                        
                           LR
                        
                        (
                        H
                        )
                      and 
                        
                           TH
                        
                        (
                        H
                        )
                      are defined by the same sequence of tensor-product spaces 
                        
                           
                              V
                           
                           
                              ℓ
                           
                        
                      and domains 
                        
                           
                              Ω
                           
                           
                              ℓ
                           
                        
                     .

The hierarchical spline construction selects a subset 
                        
                           
                              C
                           
                           
                              ℓ
                           
                        
                      from the tensor-product basis 
                        
                           
                              B
                           
                           
                              ℓ
                           
                        
                      of 
                        
                           
                              V
                           
                           
                              ℓ
                           
                        
                     . Precisely
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              
                                 {
                                 B
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                                 :
                                 supp
                                 
                                 B
                                 ⊆
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∧
                                 supp
                                 
                                 B
                                 ⊈
                                 
                                    
                                       Ω
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 }
                              
                              .
                           
                        
                      The set of generators is then 
                        
                           
                              ⋃
                           
                           
                              ℓ
                              =
                              0
                           
                           
                              m
                           
                        
                        
                           
                              C
                           
                           
                              ℓ
                           
                        
                     .

The THB-spline approach uses the same selection procedure, but the selected B-splines are truncated in order to guarantee that they are a partition of unity and to obtain better locality. In particular each B-spline B selected from level ℓ whose support intersects 
                        
                           
                              Ω
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      is replaced by the function 
                        
                           
                              
                                 
                                    B
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      obtained by expressing B as a linear combination of B-splines from level 
                        ℓ
                        +
                        1
                      and by setting the coefficients of the B-splines in 
                        
                           
                              C
                           
                           
                              ℓ
                              +
                              1
                           
                        
                      to 0. The procedure is then repeated for each lower level 
                        ℓ
                        +
                        2
                        ,
                        …
                        ,
                        m
                     . At this point the collection of truncated B-splines is taken as the basis of the space. The truncated functions are always a partition of unity.

The space 
                        
                           TH
                        
                        (
                        H
                        )
                      is a subset of 
                        S
                        (
                        H
                        )
                      and equality is proved for meshes such that for each level ℓ and 
                        B
                        ∈
                        
                           
                              C
                           
                           
                              ℓ
                           
                        
                      the intersection 
                        
                           
                              (
                              supp
                              
                              B
                              )
                           
                           
                              ∘
                           
                        
                        ∩
                        (
                        Ω
                        ∖
                        
                           
                              Ω
                           
                           
                              ℓ
                              +
                              1
                           
                        
                        )
                      is connected. Sharper results can be obtained for specific degrees and weaker conditions are needed for the decoupled version of the THB-basis that was proposed by Mokriš et al. (2014). This condition is not always satisfied by the type of meshes we are considering as can be seen in Fig. 10
                     .

So in selected cases the space we are proposing is bigger than the THB-spline space. Two other advantages are that the basis functions are B-splines and that the basis functions are locally linearly independent.

On the other hand the locality of the refinement with our approach is degree dependent and decreases as the degree increase. This does not happen in the THB-spline setting. Related to this is the fact that THB-splines do not require “alternating” refinement and thus can be refined more locally.

@&#CONCLUSIONS@&#

We restrict our attention to the subset of bi-variate box meshes that have the N2S-property. We describe two subdomains of Ω where respectively vertical and horizontal refinement preserves the N2S property. Using this knowledge we provide an explicit construction that is based on a hierarchy of tensor spaces and domains. The LR-space associated to the constructed mesh 
                        H
                      has the N2S property, i.e. it has a basis of locally linearly independent functions. Moreover 
                        
                           LR
                        
                        (
                        H
                        )
                      is the whole space 
                        S
                        (
                        H
                        )
                      of piecewise polynomials associated to the mesh.

The fact that our construction guarantees the N2S property is based on the results from Bressan (2013) that apply to the n-variate case. It seems thus reasonable that the construction can be generalized to n-variate case with similar definitions and proofs. Future work will be devoted to the generalization of Lemmas 6 and 7 to this situation. The proof of completeness (Theorem 12), however, relies on the results from Mourrain (2014) that are available for bi-variate splines only. It is expected that more effort is required to extend the completeness proof to n-variate constructions. Some results concerning the homology term for 3D meshes are reported in Berdinsky et al. (2014).

@&#ACKNOWLEDGEMENTS@&#

The financial support of this research by the Austrian Science Fund (FWF) through the NFN “Geometry + Simulation” (S117) is gratefully acknowledged. Special thanks go to Dr. Michael Pauley for commenting on an earlier version of this paper.

@&#REFERENCES@&#

