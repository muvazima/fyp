@&#MAIN-TITLE@&#Visual discomfort relaxation for stereoscopic 3D images by adjusting zero-disparity plane for projection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Factors from spatial frequency, disparity energy and visual attention are considered.


                        
                        
                           
                           An optimal ZDP from the derived visual discomfort map is established.


                        
                        
                           
                           We adjust the convergence plane first based on the depth value of the ZDP.


                        
                        
                           
                           We reproject the disparity ranges of the crossed and uncrossed disparities.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Visual discomfort relaxation

Stereoscopic 3D images

Zero-disparity plane

Disparity remapping

@&#ABSTRACT@&#


               
               
                  It is a challenging task to improve the visual comfort of a stereoscopic 3D (S3D) image with satisfactory viewing experience. In this paper, we propose a visual comfort improvement scheme by adjusting zero-disparity plane (ZDP) for projection. The degree of visual discomfort is predicted by considering three factors: spatial frequency, disparity response, and visual attention. Then, the selection of an optimal ZDP is guided by the predicted visual discomfort map. Finally, the disparity ranges of the crossed and uncrossed disparities are automatically adjusted according to the ZDP as requirements. Experiment results show that the proposed scheme is effective in improving visual comfort while preserving the unchanged depth sensation.
               
            

@&#INTRODUCTION@&#

In recent years, stereoscopic 3D (S3D) images have become very popular. Many 3D television and displays are available, and many 3D movies are produced using sophisticated 3D video capture and stereography techniques. However, visual fatigue/discomfort is still an unsatisfactory experience in viewing a S3D image/video, which hinders the widespread promotion of 3D services. The issue of visual discomfort involves not only technical aspects, but also perceptual aspects [1,2]. As a result, the demand for visual comfort improvement is increasing in the fields of 3D content production, 3D display design, and so on.

There are several factors that induce visual discomfort in S3D images. (i) Disparity magnitude. It has been known that scenes with larger disparities tend to induce visual discomfort. The magnitude of crossed and uncrossed disparities has different impacts on visual discomfort, and the crossed disparity plays a more important role in affecting the visual discomfort [3]. If the disparity does not lie within the zone of comfort, the so-called Percival’s Zone of Comfort (PZC) [4], observers will experience visual discomfort. In addition, depth of focus (DOF) can serve as a threshold on accommodation to form comfortable viewing zone [5]. (ii) Spatial frequency. Schor et al. [6] have demonstrated that spatial frequency has a significant influence on binocular fusion limit with the visual stimuli created by the difference of Gaussians, i.e., the binocular fusion limit increase as spatial frequency decrease. (iii) Visual attention. The salient object attracts our eyes at the first glance, and our eyes try to adjust vergence to focus on the salient object [7]. Thus, conflict between accommodation and convergence will occur [8]. In addition, disparity gradient, object motion, etc, will all affect the visual comfort. Comprehensive factors affecting visual comfort can be found in [1,2,9,10].

Several visual comfort assessment (VCA) methods have been proposed to measure the degree of visual discomfort in an objective manner [11–16]. Kim and Sohn [11] proposed a visual fatigue prediction metric by considering excessive horizontal and vertical disparities. Lee et al. [12] exploited the effect of stimulus width on perceived visual comfort by measuring subjective visual comfort and binocular fusion limit. Sohn et al. [13] derived a VCA model based on relative disparity and object thickness features. Park et al. [14] extracted features accounting for both accommodation and vergence, and derived a 3D-VAM predictor for VCA. In our previous work, we trained a robust VCA model via learning a preference classification model [15]. Other relevant works can also be found in [16,17].

To improve visual comfort, disparity remapping is an essential postproduction technique to adjust the disparity range so as to provide a satisfactory viewing experience [18]. Linear disparity remapping is the simplest way to scale a disparity range to the visual comfort zone. However, unnatural visual artifacts may occur by the linear way. Recently, nonlinear disparity remapping schemes have been presented to enhance 3D viewing experience. Lang et al. [19] presented nonlinear disparity remapping operators to enhance the depth perception of salient object. Yan et al. [20] proposed a disparity remapping technique to adjust the depth range of a stereoscopic video according to the actual display setting, while preserving the relationship of neighboring features with line and plane bending constraints. Oh et al. [21] proposed a nonlinear remapping method that predicted a visual fatigue map based on spatial frequency, disparity magnitude and disparity motion, and compressed the disparity range of the problematic region. Jung et al. [22] proposed a new method for visual comfort improvement that adjusted (scaled and shifted) the disparity of a scene under the guidance of an objective VCA metric. Sohn et al. [23] used linear disparity remapping to adjust the disparity range, and nonlinear disparity remapping to selectively adjust disparities of local problematic disparity ranges. Other relevant works can also be found in [24,25].

In this paper, we propose a visual comfort improvement scheme which considers visual discomfort factors existing in a stereoscopic image. The main goal of this work is to offer a simple but effective solution for shifting the disparity of a stereoscopic image. Toward this end, visual discomfort is predicted by taking the factors from spatial frequency, disparity response, and visual attention. Then, the selection of an optimal ZDP is guided by the predicted visual discomfort map. Finally, the disparity ranges of the crossed and uncrossed disparities are automatically adjusted according to the ZDP, thus resulting in a comfortable viewing for a stereoscopic image.

The remainder of the paper is organized as follows. Section 2 introduces related background and works. Section 3 presents the proposed quality assessment approach. The experimental results are given and discussed in Section 4, and finally conclusions are drawn in Section 5.

The brain uses binocular disparity to extract depth information from the retinal images in binocular vision. As shown in Fig. 1
                        , depending on the distance from the plane of fixation, disparity has different forms of zero disparity, positive (uncrossed) disparity and negative (crossed) disparity. In the figure, α is the angle between the two eyes when verged at a fixation point on the display screen (to reflect accommodation distance) and β is the angle between projections onto the retina points which the viewer is looking at (to reflect convergence distance). Points with negative (α
                        −
                        β
                        <0), or positive (α
                        −
                        β
                        >0) disparities are perceived in front of or behind the display screen, respectively. Normally, human visual system (HVS) can tolerate some level of the accommodation-vergence conflict without a loss of visual comfort (e.g., within Percival’s Zone of Comfort (PZC)). However, when fusing and focusing the objects perceived outside the PZC, HVS can perceive the loss of accommodation and/or loss of binocular fusion, leading to visual discomfort (like eyestrain, headache, or diplopia).

In this paper, we focus on visual discomfort induced by accommodation-vergence conflict, and disparity characteristics (e.g., disparity range, display plane) are considered to reduce the visual discomfort. We divide the methods into two broad categories:
                           
                              (1)
                              
                                 Disparity remapping 
                                 [18–22]. The existing disparity remapping methods adjust (squeeze) the disparity range of a scene (Fig. 2
                                 (a)). The disparity range can be linearly or nonlinearly (also globally or locally) adjusted into the comfort zone to avoid excessive accommodation-vergence conflicts of the scene. However, since the range of comfort zone is limited (e.g., ±1° disparity for comfortable viewing zone), if large disparity range squeezing is performed, rendering artifacts will be appeared in the processed images.


                                 Disparity shifting 
                                 [24,25]. The existing disparity shifting methods adjust the ZDP of a scene but maintain its original disparity range (Fig. 2(b)). Excessive disparities can be reduced to minimize the accommodation–vergence conflicts in a scene. The main advantage of the disparity shifting is its low computational complexity. However, since the overall disparity range is not changed, disparity shifting alone cannot fully cover the range of comfort zone if the disparity range exceeds the range of a certain comfortable viewing zone.

In this paper, we focus on the latter for visual comfort improvement (or visual discomfort relaxation) for its simplicity and accessibility. However, directly applying the disparity shifting on the stereoscopic images cannot obtain satisfactory results. We make innovations in the following aspects:
                           
                              (1)
                              We comprehensively consider the visual discomfort factors from spatial frequency, disparity response and visual attention to characterize the degree of visual discomfort locally, and establish an optimal ZDP from the derived visual discomfort map.

Instead of directly adjusting the disparity values, we adjust the convergence plane first based on the depth value of the ZDP, and then reproject the disparity ranges of the crossed and uncrossed disparities, but maintain the overall disparity range unchanged.

The objective of the proposed visual discomfort relaxation scheme is to control the ZDP with respect to the predicted degree of visual discomfort. In other words, the proposed scheme is to relaxe the eye strain in fusing discomfortable objects. The overall framework of the proposed scheme is shown in Fig. 3
                        . In order to predict the degree of visual discomfort for a S3D image, three factors are taken into account: spatial frequency, disparity response, and visual attention. Then, a visual discomfort map is obtained to indicate the degree of discomfort in a local manner. In addition, a ZDP is selected from the derived visual discomfort map. Using the ZDP as benchmark, a disparity reprojection operation is performed to adjust the disparity ranges of the crossed (negative) and uncrossed (positive) disparities.

As investigated in earlier studies [3–10], visual discomfort in S3D images can be induced by many factors, such as excessive disparity, accommodation-convergence conflict, binocular mismatch and depth motion, etc. In this paper, we consider the following factors that may induce visual discomfort in S3D images: spatial frequency, disparity response and visual attention. Each factor can be visualized as an index map to indicate the degree of visual discomfort locally, i.e., the local value of the map is somewhat proportional to the degree of visual discomfort. Finally, these index maps are aggregated to generate an overall visual discomfort map.

Binocular fusion limit will be increased with the decreased spatial frequency [26]. Generally, regions with high spatial frequency tend to give more visual discomfort than those with low spatial frequency. Many methods have been proposed to extract spatial frequency. Here, we directly exploit phase congruency to extract the spatial frequency. In this paper, we use the method in [27] for phase congruency (PC) calculation using log-Gabor filter. A set of responses on different scales and along different orientations, denoted as 
                              
                                 [
                                 
                                    
                                       η
                                    
                                    
                                       s
                                       ,
                                       o
                                    
                                 
                                 ,
                                 
                                    
                                       ζ
                                    
                                    
                                       s
                                       ,
                                       o
                                    
                                 
                                 ]
                              
                           , can be obtained by applying the log-Gabor filter. Then, by modulating the scale and orientation, local amplitude at location x on scale α and along orientation o is given by
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             s
                                             ,
                                             o
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   s
                                                   ,
                                                   o
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   ξ
                                                
                                                
                                                   s
                                                   ,
                                                   o
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

At the same time, the local energy along orientation o is given by
                              
                                 (2)
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             o
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   o
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   H
                                                
                                                
                                                   o
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       F
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       s
                                       ,
                                       o
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       s
                                       ,
                                       o
                                    
                                 
                                 (
                                 x
                                 )
                              
                           . Then, the PC map is computed across all orientations by
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   P
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   o
                                                
                                             
                                             
                                                
                                                   E
                                                
                                                
                                                   o
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                          
                                             ε
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      o
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   s
                                                   ,
                                                   o
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                 
                              
                           where ε is a small positive constant, and NP
                            is the normalization factor of phase congruency. The design of the filter is based on the work in [27].

It is also known that visual discomfort is directly related to the stimulus from the amount of screen disparity, i.e., the accommodation–vergence conflict becomes more severe when increasing screen disparity [28]. Some psychophysical experiments have been conducted to investigate the relationship between subjective visual discomfort and the amount of binocular disparity. In this paper, we directly use the function in [29] to predict the degree of visual comfort with a varying amount of the angular disparities, i.e.,
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                VC
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      a
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  -
                                                                  0.020
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              d
                                                                           
                                                                           
                                                                              a
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        3
                                                                     
                                                                  
                                                                  -
                                                                  0.138
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              d
                                                                           
                                                                           
                                                                              a
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  +
                                                                  0.208
                                                                  (
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        a
                                                                     
                                                                  
                                                                  )
                                                                  +
                                                                  4.849
                                                                  ,
                                                                  
                                                                  if
                                                                  
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        a
                                                                     
                                                                  
                                                                  <
                                                                  0
                                                               
                                                            
                                                            
                                                               
                                                                  -
                                                                  0.009
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              d
                                                                           
                                                                           
                                                                              a
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        3
                                                                     
                                                                  
                                                                  +
                                                                  0.150
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              d
                                                                           
                                                                           
                                                                              a
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  -
                                                                  0.954
                                                                  (
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        a
                                                                     
                                                                  
                                                                  )
                                                                  +
                                                                  4.912
                                                                  ,
                                                                  
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Noted that in the subjective assessment [29], only the foreground is given a disparity in the range of +6° to −6°, and the background has zero disparity. The recorded visual comfort score at da
                              
                           =0 is the largest, however, depth sensation for this case does not exist. Thus, the above model will be still guaranteed when applied for versatile 3D contents. The angular disparity da
                           (x) of each pixel is obtained from pixel disparity dc
                           (x) via
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             a
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       2
                                       
                                          
                                             
                                                
                                                   
                                                      tan
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                               /
                                                               2
                                                            
                                                            
                                                               V
                                                            
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      tan
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                               /
                                                               2
                                                            
                                                            
                                                               V
                                                               -
                                                               Z
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where I and V are the inter-ocular distance and the viewing distance, respectively. The distance Z between an object and display is computed as
                              
                                 (6)
                                 
                                    
                                       Z
                                       =
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             x
                                             )
                                             ·
                                             V
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   m
                                                
                                             
                                             (
                                             x
                                             )
                                             -
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        

The displayed disparity dm
                           (x) is converted from dc
                           (x) by
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             d
                                          
                                          
                                             c
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                              
                           where XC
                            is the width of the image, and Xm
                            is the horizontal length of the display.

To reflect the degree of visual discomfort, the above visual comfort prediction function is inversely to obtain the disparity response map, denoted as f
                           2(x).
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       1
                                       -
                                       
                                          
                                             VC
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   a
                                                
                                             
                                             (
                                             x
                                             )
                                             )
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   V
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where NV
                            is the normalization factor of visual comfort prediction values.

It is also known that 3D visual attention plays an important role in determining the overall degree of visual discomfort [17], e.g., the salient regions tend to be comfortable or uncomfortable [30]. Refer to [31], we extract four features of color, luminance, texture and depth from DCT coefficients from an input stereoscopic image. The feature contrast of a basic region i is defined as a function of the region position p
                           
                              i
                            and feature vector f
                           
                              i
                           , i.e.,
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             f
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       ‖
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       ·
                                       w
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           where f
                           
                              i
                            and f
                           
                              j
                            are the feature vectors in regions Ri
                            and Rj
                           ; p
                           
                              i
                            and p
                           
                              j
                            are the positions of the regions; the Gaussian weight 
                              
                                 w
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 exp
                                 (
                                 -
                                 ‖
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 2
                                 
                                    
                                       σ
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , where σp
                            controls the range of feature contrast.

From another perspective, a salient region is also expected to be spatially compact. Thus, the spatial compactness of each region is calculated by
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             p
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       ‖
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       ·
                                       w
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           where the Gaussian weight 
                              
                                 w
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 exp
                                 (
                                 -
                                 ‖
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 2
                                 
                                    
                                       σ
                                    
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           ; σc
                            controls the range of spatial distance; μ
                           
                              i
                            is the weighted mean position of color c
                           
                              i
                           , which is calculated by
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                             ·
                                             w
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             w
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        

The final 3D saliency value for each region is computed by
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                       
                                       ·
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             f
                                          
                                       
                                       +
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                       ·
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                           where γ
                           1 and γ
                           2 are two parameters used to weight the two components. In the experiment, we consider the saliency map from feature contrast more important than the spatial compactness, and the parameters are set as γ
                           1
                           =0.7 and γ
                           2
                           =0.3 empirically.

Based on the above index maps computed in Eqs. (3), (8) and (12), a final visual discomfort map is obtained by
                              
                                 (13)
                                 
                                    
                                       F
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             
                                                ∏
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                              
                            denotes the normalized version of fi
                           (x). Rather than using linear combination of three index maps, it is more effective to compute the visual discomfort map by the multiplication combination. Fig. 4
                            shows the examples of each index maps and the final visual discomfort maps. Obviously, by combining these index maps using multiplication, regions with high visual discomfort will be highlighted effectively. It is worth emphasizing that the factors affecting visual discomfort are not limited to the above items, and other cues, such as accommodation-convergence conflict [32], unnatural blur/sharpness [33], crosstalk [34], can be investigated and included in the framework.

To achieve a comfortable viewing for the discomfortable S3D image, the ZDP should be adjusted to reduce the amount of negative disparities. Typically, excessive negative disparities may cause visual discomfort. In this research, the ZDP is directly setted on the key-point with the maximum visual discomfort value, because we regard that visual discomfort for this key-point should be particularly reduced. Thus, we have
                           
                              (14)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ZDP
                                       
                                    
                                    =
                                    
                                       
                                          
                                             arg
                                             max
                                          
                                          
                                             x
                                          
                                       
                                    
                                    F
                                    (
                                    x
                                    )
                                 
                              
                           
                        By assigning a zero or an expected disparity value for the ZDP (i.e., shifting the ZDP on the x
                        
                           ZDP
                        ), the targeted visual discomfort object is arranged to a comfortable position.

Regarding depth quantization, the relationship between the real depth value z and the quantized depth level v is expressed using a non-linear 8-bit depth quantization function in MPEG-3DV [35]
                        
                           
                              (15)
                              
                                 
                                    z
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                255
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               near
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               far
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      far
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where znear
                         and zfar
                         are the farthest and nearest depth values.

The horizontal disparity can be obtained from the real depth value by [35]
                        
                           
                              (16)
                              
                                 
                                    d
                                    =
                                    f
                                    ·
                                    l
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where f, l, and zc
                         represent the focal length of the camera, baseline length between the two views, and the depth value of the convergence plane.

Given the depth value vZDP
                         in the ZDP, its real depth value is computed by
                           
                              (17)
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ZDP
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ZDP
                                             
                                          
                                          ·
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    255
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   near
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   far
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          near
                                       
                                    
                                 
                              
                           
                        .By setting a zero disparity value for the ZDP (dZDP
                           
                        =0), the adjusted convergence plane is expressed as
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ZDP
                                             
                                          
                                          ·
                                          f
                                          ·
                                          l
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ZDP
                                             
                                          
                                          ·
                                          
                                             
                                                z
                                             
                                             
                                                ZDP
                                             
                                          
                                          +
                                          f
                                          ·
                                          l
                                       
                                    
                                 
                              
                           
                        
                     

We also set several non-zero disparity values for the ZDP, and find that their performances are not prominent (the results with different non-zero values will be analyzed in SubSection 4.4). Thus, we use a zero value for the ZDP in all sequences. With the adjusted convergence plane in (18), the subsequent disparity adjustment will be very simply by reprojecting the left image to its right side using the adjusted disparity. Considering the adjusted convergence plane in (18), the disparity distance after adjusting is represented as
                           
                              (19)
                              
                                 
                                    Δ
                                    d
                                    =
                                    f
                                    ·
                                    l
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Our scheme is especially suitable to adjust a parallel plane to be convergence. For example, in a parallel camera array (only with negative disparity that 
                           
                              1
                              /
                              
                                 
                                    z
                                 
                                 
                                    c
                                 
                              
                              ≈
                              0
                           
                        ), for the pixels with depth values larger than zZDP
                        , the adjusted disparity values will be positive, while the adjusted disparity values of other pixels will be still negative (to adjust the ratio between the negative and positive disparity ranges).

Different with the state-of-the-art disparity remapping methods that squeeze the disparity range [17–21], the overall disparity range after reprojection is not affected but placed into a comfortable disparity interval. The absolute disparity range is expressed as
                              
                                 (20)
                                 
                                    
                                       Φ
                                       =
                                       
                                          
                                             Φ
                                          
                                          
                                             -
                                          
                                       
                                       ∪
                                       
                                          
                                             Φ
                                          
                                          
                                             +
                                          
                                       
                                       =
                                       f
                                       ·
                                       l
                                       ·
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            near
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            far
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where the negative disparity range Φ
                           − and positive disparity range Φ
                           + are represented as
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      -
                                                   
                                                
                                                =
                                                f
                                                ·
                                                l
                                                ·
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     near
                                                                  
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      +
                                                   
                                                
                                                =
                                                f
                                                ·
                                                l
                                                ·
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           z
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     far
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The crossed disparities (perceived in front of the screen) and uncrossed disparities (perceived behind the screen) have different impacts on visual discomfort, and especially the crossed disparities will have greater impact on the visual discomfort. For the case only with negative disparity (e.g., 
                              
                                 1
                                 /
                                 
                                    
                                       z
                                    
                                    
                                       c
                                    
                                 
                                 ≈
                                 0
                              
                           ), the ratio between the crossed and uncrossed disparity ranges with or without adjusting is expressed as
                              
                                 (22)
                                 
                                    
                                       κ
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     far
                                                                  
                                                               
                                                            
                                                            
                                                               -
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     near
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         
                                                         without adjusting
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     ZDP
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     far
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     near
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     far
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     near
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     far
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     ZDP
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     near
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         
                                                         with adjusting
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Since we project the left image to its right side using the adjusted disparity, occlusion or disocclusion will be appeared unavoidably in the projected right image. In this research, we use the common hole filling algorithms in the view synthesis reference software (VSRS) to fill these occluded/disoccluded pixels. Even though the projected (or hole-filled) right image is somewhat different with the original right image, their influences on stereoscopic depth sensation can be omitted.

As stated in the above SubSection 2.2, the prominent advantage of disparity shifting is its low computational complexity. By omitting the computational complexity of the visual discomfort map prediction, the complexity of the disparity reprojection operation may be very low because it is only computed once without complex matrix operation.

@&#EXPERIMENTAL RESULTS@&#

In the experiment, four S3D images, ‘Balloon’, ‘Kendo’, ‘Dancer’ and ‘Poznanstreet’, are selected. The resolution of the ‘Balloon’ and ‘Kendo’ is 1024×768, and the resolution of other two sequences is 1920×1080. Meanwhile, the corresponding depth maps of each view and the camera parameters are provided. For ‘Balloon’ and ‘Kendo’, view1 and view2 are adopted as left and right views. For ‘Dancer’, view1 and view5 are adopted as left and right views (large baseline length). For ‘Poznanstreet’, view5 and view4 are adopted as left and right views. These sequences only have negative disparities.

The subjective tests were conducted in the laboratory designed for subjective quality tests according to the recommendations ITU-R BT.500-11 [36] and ITU-R 1438 [37]. All stereoscopic images were randomly displayed on Samsung UA65F9000 65 inch Ultra HD 3D-LED TV. 3D Shutter Glasses were used in the subjective experiments. The display had low crosstalk levels (left: 0.38% and right: 0.15%) compared to the visibility threshold of crosstalk in [38]. The peak luminance of this displayer was adjusted to 50cd/m2. The viewing distance was 3 times the height of the display screen.

A single-stimulus Absolute Category Rating (ACR) test methodology described in ITU-T P.910 [39] and ITU-T P.911 [40] was used in the experiment. Fifteen graduate students participated in this subjective evaluation. All participants in the experiment met the minimum stereo acuity less than 60 seconds of arc (sec-arc), and passed a color version test. The participants were asked to rate the stereoscopic images based on their experienced visual comfort on a scale from 1 to 5: 5=very comfortable, 4=comfortable, 3=mildly comfortable, 2=uncomfortable and 1=extremely uncomfortable. In the data processing stage, after detecting and discarding outliers of all opinion scores, the final mean opinion score (MOS) for each stereoscopic image was calculated as the mean of the remaining opinion scores.


                        Figs. 5 and 6
                        
                         show example results obtained by using our discomfort relaxation method by reprojecting the disparities of the scenes. In these examples, the regions (e.g., the white light in Fig. 5(a) and the dancer in Fig. 6(a)) have large negative disparities, which induce relatively high amounts of visual discomfort. By setting the red points (marked by yellow circles) in Figs. 5 and 6(b) as ZDP, the stereoscopic images will have both positive and negative disparity after the disparity reprojection. For example, the human and the tree in the left with a positive disparity will be viewed behind the screen in Fig. 5(b). Similarly, in Fig. 6(b), the windows and cylinder with a positive disparity will be viewed behind the screen and the pillar in the left with a negative disparity will be viewed in front of the screen. Overall, the adjusted stereoscopic images are comfortable and in accordance with visual experience.

The results of the subjective assessment for both depth sensation and visual comfort with or without our processing are presented in Table.1
                        . Since visual discomfort cannot be relaxed at the expense of degradation in depth sensation, depth sensation is also measured on a scale from 1 to 5: 5=very high, 4=high, 3=medium, 2=low and 1=very low. Since the original stereoscopic images have large negative disparities, and thus induce serious visual discomfort (the subjective comfort score is lower than 3, i.e., ‘uncomfortable’ in the five-grading scale). Contrarily, after the proposed processing, visual comfort is significantly improved (subjective comfort score is higher than 4, i.e., ‘comfortable’ in the five-grading scale). In addition, depth sensation for both discomfortable and comfortable stereoscopic images is almost unaffected.

In this paper, we set a zero disparity value for the ZDP (i.e., dZDP
                           
                        =0), and thus, it is worth analyzing the impact of different non-zero disparity values for the ZDP. We change dZDP
                         from −7 and +7, and adjust the convergence plane using the non-zero dZDP
                         value in (18). The results of processed images with different disparity values are shown in Fig. 7
                        . As we can see from the figure, if a negative disparity value is set for the ZDP, some visual discomfort regions will be still perceived in front of the screen plane with mass negative disparities, while if a positive disparity value is set for the ZDP, most of the scene will be perceived behind the screen plane with mass positive disparities. Overall, setting zero disparity value for the ZDP can achieve a better tradeoff between visual comfort and depth sensation.

@&#DISCUSSION@&#

As mentioned in the Introduction, many factors (e.g., excessive disparity gradient, small stimulus width, high spatial frequency, etc.) are related to visual discomfort. The proposed method improves visual comfort by changing the disparity ranges of the cross and uncrossed disparities, but the overall disparity range is unchanged. In fact, people expect to view the comfortable regions unchanged while only adjust the uncomfortable regions. Therefore, local adjustment can be another effective complement for more comprehensive demonstration.

If large negative disparity is the main cause of visual discomfort, the proposed method will result in better visual discomfort relaxation. Since the objects are not allowed to cross the ZDP, while the ZDP is selected on the point with the maximum visual discomfort value. Our method may lose it power when the ZDP crosses an object. Therefore, it is beneficial to generate an object-level ZDP, and adjust visual discomfort on different depth levels.

@&#CONCLUSIONS@&#

This paper proposes a novel visual discomfort relaxation method for stereoscopic 3D images. Firstly, factors from spatial frequency, disparity response, and visual attention, are considered to predict the degree of visual discomfort. Then, an optimal ZDP for the left image is selected guided by the predicted visual discomfort map, and the disparities are obtained with the ZDP. Finally, disparity reprojection is performed according to the adjusted disparities of left image to get the stereoscopic composite images. We have evaluated performance with subjective experiments. Experimental results showed that the depth sensation and visual comfort with the proposed method are easy to recognize and the stereo senses are high.

@&#ACKNOWLEDGEMENT@&#

This work was supported by the Natural Science Foundation of China (Grant 61271021, 61271270, U1301257). It was also sponsored by K.C. Wong Magna Fund in Ningbo University.

@&#REFERENCES@&#

