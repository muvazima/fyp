@&#MAIN-TITLE@&#The uniqueness property for networks with several origin–destination pairs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the uniqueness property for networks with several origin–destination pairs.


                        
                        
                           
                           We find a necessary condition for the uniqueness property in terms of excluded minors.


                        
                        
                           
                           We characterize completely bidirectional rings with the uniqueness property.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Congestion externalities

Nonatomic games

Ring

Transportation network

Uniqueness property

@&#ABSTRACT@&#


               
               
                  We consider congestion games on networks with nonatomic users and user-specific costs. We are interested in the uniqueness property defined by Milchtaich (2005) as the uniqueness of equilibrium flows for all assignments of strictly increasing cost functions. He settled the case with two-terminal networks. As a corollary of his result, it is possible to prove that some other networks have the uniqueness property as well by adding common fictitious origin and destination. In the present work, we find a necessary condition for networks with several origin–destination pairs to have the uniqueness property in terms of excluded minors or subgraphs. As a key result, we characterize completely bidirectional rings for which the uniqueness property holds: it holds precisely for nine networks and those obtained from them by elementary operations. For other bidirectional rings, we exhibit affine cost functions yielding to two distinct equilibrium flows. Related results are also proven. For instance, we characterize networks having the uniqueness property for any choice of origin–destination pairs.
               
            

@&#INTRODUCTION@&#

In many areas, different users share a common network to travel or to exchange information or goods. Each user wishes to select a path connecting a certain origin to a certain destination. However, the selection of paths in the network by the users induces congestion on the arcs, leading to an increase of the costs. Taking into account the choices of the other users, each user looks for a path of minimum cost. We expect therefore to reach a Nash equilibrium: each user makes the best reply to the actions chosen by the other users.

This kind of games is studied since the 1950s, with the seminal works by Wardrop (1952) and Beckmann, McGuire, and Winsten (1956). Their practical interest is high since the phenomena implied by the strategic interactions of users on a network are often nonintuitive and may lead to an important loss in efficiency. The Braess paradox (Braess, 1968) – adding an arc may deteriorate all travel times – is the classical example illustrating such a nonintuitive loss and it has been observed in concrete situations, for example in New York Kolata (1990). Koutsoupias and Papadimitriou (1999) initiated a precise quantitative study of this loss, which lead soon after to the notion of “Price of Anarchy” that is the cost of the worst equilibrium divided by the optimal cost, see (Roughgarden & Tardos, 2002) among many other references. Some recent researches proposed also ways to control this loss, see Bauso, Giarré, and Pesenti (2009) and Knight and Harper (2013) for instance.

When the users are assumed to be nonatomic – the effect of a single user is negligible – equilibrium is known to exist (Milchtaich, 2000). Moreover, when the users are affected equally by the congestion on the arcs, the costs supported by the users are the same in all equilibria (Aashtiani & Magnanti, 1981). In the present paper, we are interested in the case when the users may be affected differently by the congestion. In such a case, examples are known for which these costs are not unique. Various conditions have been found that ensure nevertheless uniqueness. For instance, if the user’s cost functions attached to the arcs are continuous, strictly increasing, and identical up to additive constants, then we have uniqueness of the equilibrium flows, and thus of the equilibrium costs (Altman & Kameda, 2001). In 2005, continuing a work initiated by Milchtaich (2000) and Konishi (2004) for networks with parallel routes, Milchtaich (2005) found a topological characterization of two-terminal networks for which, given any assignment of strictly increasing and continuous cost functions, the flows are the same in all equilibria. Such networks are said to enjoy the uniqueness property. Similar results with atomic users have been obtained by Orda, Rom, and Shimkin (1993) and Richman and Shimkin (2007).

The purpose of this paper is to find similar characterizations for networks with more than two terminals. We are able to characterize completely the ring networks having the uniqueness property, whatever the number of terminals is. Studying equilibria on rings can be seen as the decentralized counterpart of works on the optimization of multiflows on rings, like the one proposed by Myung, Kim, and Tcha (1997). Our main result for ring networks is that the uniqueness property holds precisely for nine networks and those obtained from them by elementary operations. For other rings, we exhibit affine cost functions yielding to two distinct equilibrium flows. It allows to describe infinite families of graphs for which the uniqueness property does not hold. For instance, there is a family of ring networks such that every network with a minor in this family does not have the uniqueness property.

An undirected graph is a pair 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      where V is a finite set of vertices and E is a family of unordered pairs of vertices called edges. A directed graph, or digraph for short, is a pair 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      where V is a finite set of vertices and A is a family of ordered pairs of vertices called arcs. A mixed graph is a graph having edges and arcs. More formally, it is a triple 
                        
                           M
                           =
                           (
                           V
                           ,
                           E
                           ,
                           A
                           )
                        
                      where V is a finite set of vertices, E is a family of unordered pairs of vertices (edges) and A is a family of ordered pairs of vertices (arcs). Given an undirected graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                     , we define the directed version of G as the digraph 
                        
                           D
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      obtained by replacing each (undirected) edge in E by two (directed) arcs, one in each direction. An arc of G is understood as an arc of its directed version. In these graphs, loops – edges or arcs having identical endpoints – are not allowed, but pairs of vertices occurring more than once – parallel edges or parallel arcs – are allowed.

A walk in a directed graph D is a sequence
                        
                           
                              P
                              =
                              (
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    k
                                 
                              
                              )
                           
                        
                     where 
                        
                           k
                           ⩾
                           0
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ∈
                           V
                           ,
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 k
                              
                           
                           ∈
                           A
                        
                     , and 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           k
                        
                     . If all 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                      are distinct, the walk is called a path. If no confusion may arise, we identify sometimes a path P with the set of its vertices or with the set of its arcs, allowing to use the notation 
                        
                           v
                           ∈
                           P
                        
                      (resp. 
                        
                           a
                           ∈
                           P
                        
                     ) if a vertex v (resp. an arc a) occurs in P.

An undirected graph 
                        
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                           =
                           (
                           
                              
                                 V
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 ′
                              
                           
                           )
                        
                      is a subgraph of an undirected graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      if 
                        
                           
                              
                                 V
                              
                              
                                 ′
                              
                           
                           ⊆
                           V
                        
                      and 
                        
                           
                              
                                 E
                              
                              
                                 ′
                              
                           
                           ⊆
                           E
                        
                     . An undirected graph 
                        
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        
                      is a minor of an undirected graph G if 
                        
                           
                              
                                 G
                              
                              
                                 ′
                              
                           
                        
                      is obtained by contracting edges (possibly none) of a subgraph of G. Contracting an edge uv means deleting it and identifying both endpoints u and v. Two undirected graphs are homeomorphic if they arise from the same undirected graph by subdivision of edges, where a subdivision of an edge uv consists in introducing a new vertex w and in replacing the edge uv by two new edges uw and wv.

The same notions hold for directed graphs and for mixed graphs.

Finally, let 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      be an undirected graph, and 
                        
                           H
                           =
                           (
                           T
                           ,
                           L
                           )
                        
                      be a directed graph with 
                        
                           T
                           ⊆
                           V
                        
                     , then 
                        
                           G
                           +
                           H
                        
                      denotes the mixed graph 
                        
                           (
                           V
                           ,
                           E
                           ,
                           L
                           )
                        
                     .

Similarly as in the multiflow theory (see for instance Schrijver (2003) or Korte & Vygen (2000)), we are given a supply graph 
                     
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      and a demand digraph 
                     
                        
                           H
                           =
                           (
                           T
                           ,
                           L
                           )
                        
                      with 
                        
                           T
                           ⊆
                           V
                        
                     . The graph G models the (transportation) network. The arcs of H model the origin–destination pairs, also called in the sequel the OD-pairs. H is therefore assumed to be simple, i.e. contains no loops and no multiple edges. A route is an 
                        
                           (
                           o
                           ,
                           d
                           )
                        
                     -path of the directed version of G with 
                        
                           (
                           o
                           ,
                           d
                           )
                           ∈
                           L
                        
                      and is called an 
                        
                           (
                           o
                           ,
                           d
                           )
                        
                     -route. The set of all routes (resp. 
                        
                           (
                           o
                           ,
                           d
                           )
                        
                     -routes) is denoted by 
                        
                           R
                        
                      (resp. 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                     ).

The population of users is modeled as a bounded real interval I endowed with the Lebesgue measure 
                        
                           λ
                        
                     , the population measure. The set I is partitioned into measurable subsets 
                        
                           
                              
                                 I
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                      with 
                        
                           (
                           o
                           ,
                           d
                           )
                           ∈
                           L
                        
                     , modeling the users wishing to select an 
                        
                           (
                           o
                           ,
                           d
                           )
                        
                     -route.

For a given pair of supply graph and demand digraph, and a given partition of users, we define a strategy profile as a measurable mapping 
                        
                           σ
                           :
                           I
                           →
                           R
                        
                      such that 
                        
                           σ
                           (
                           i
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                      for all 
                        
                           (
                           o
                           ,
                           d
                           )
                           ∈
                           L
                        
                      and 
                        
                           i
                           ∈
                           
                              
                                 I
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                     . For each arc 
                        
                           a
                           ∈
                           A
                        
                      of the directed version of G, the measure of the set of all users i such that a is in 
                        
                           σ
                           (
                           i
                           )
                        
                      is the flow on a in 
                        
                           σ
                        
                      and is denoted 
                        
                           
                              
                                 f
                              
                              
                                 a
                              
                           
                        
                     :
                        
                           
                              
                                 
                                    f
                                 
                                 
                                    a
                                 
                              
                              =
                              λ
                              {
                              i
                              ∈
                              I
                              :
                              
                              a
                              ∈
                              σ
                              (
                              i
                              )
                              }
                              .
                           
                        
                     
                  

The cost of each arc 
                        
                           a
                           ∈
                           A
                        
                      for each user 
                        
                           i
                           ∈
                           I
                        
                      is given by a nonnegative, continuous, and strictly increasing cost function 
                     
                        
                           
                              
                                 c
                              
                              
                                 a
                              
                              
                                 i
                              
                           
                           :
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     , such that 
                        
                           i
                           
                           ↦
                           
                           
                              
                                 c
                              
                              
                                 a
                              
                              
                                 i
                              
                           
                           (
                           x
                           )
                        
                      is measurable for all 
                        
                           a
                           ∈
                           A
                        
                      and 
                        
                           x
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                     . When the flow on a is 
                        
                           
                              
                                 f
                              
                              
                                 a
                              
                           
                        
                     , the cost for user i of traversing a is 
                        
                           
                              
                                 c
                              
                              
                                 a
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 f
                              
                              
                                 a
                              
                           
                           )
                        
                     . For user i, the cost of a route r is defined as the sum of the costs of the arcs contained in r. A class is a set of users having the same cost functions on all arcs, but not necessarily sharing the same OD-pair.

The game we are interested in is defined by the supply graph G, the demand digraph H, the population user set I with its partition, and the cost functions 
                        
                           
                              
                                 c
                              
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                      for 
                        
                           a
                           ∈
                           A
                        
                      and 
                        
                           i
                           ∈
                           I
                        
                     . If we forget the graph structure, we get a game for which we use the terminology nonatomic congestion game with user-specific cost functions, as in Milchtaich (1996).

A strategy profile is a (pure) Nash equilibrium if each route is only chosen by users for whom it is a minimal-cost route. In other words, a strategy profile 
                        
                           σ
                        
                      is a Nash equilibrium if for each pair 
                        
                           (
                           o
                           ,
                           d
                           )
                           ∈
                           L
                        
                      and each user 
                        
                           i
                           ∈
                           
                              
                                 I
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                      we have
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                       ∈
                                       σ
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    f
                                 
                                 
                                    a
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             (
                                             o
                                             ,
                                             d
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                       ∈
                                       r
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    f
                                 
                                 
                                    a
                                 
                              
                              )
                              .
                           
                        
                     
                  

Under the conditions stated above on the cost functions, a Nash equilibrium is always known to exist. It can be proven similarly as Theorem 3.1 in Milchtaich (2000), or as noted by Milchtaich (2005), it can be deduced from more general results (Theorem 1 of Schmeidler (1970) or Theorems 1 and 2 of Rath (1970)). However, such an equilibrium is not necessarily unique, and even the equilibrium flows are not necessarily unique.

@&#RESULTS@&#


                     Milchtaich (2005) raised the question whether it is possible to characterize networks having the uniqueness property, i.e. networks for which flows at equilibrium are unique. A pair 
                        
                           (
                           G
                           ,
                           H
                           )
                        
                      defined as in Section 3 is said to have the uniqueness property if, for any partition of I into measurable subsets 
                        
                           
                              
                                 I
                              
                              
                                 (
                                 o
                                 ,
                                 d
                                 )
                              
                           
                        
                      with 
                        
                           (
                           o
                           ,
                           d
                           )
                           ∈
                           L
                        
                     , and for any assignment of (strictly increasing) cost functions, the flow on each arc is the same in all equilibria.

Milchtaich found a positive answer for the two-terminal networks, i.e. when 
                        
                           |
                           L
                           |
                           =
                           1
                        
                     . More precisely, he gave a (polynomial) characterization of a family of two-terminal undirected graphs such that, for the directed versions of this family and for any assignment of (strictly increasing) cost functions, the flow on each arc is the same in all equilibria. For two-terminal undirected graphs outside this family, he gave explicit cost functions for which equilibria with different flows on some arcs exist.

The objective of this paper is to address the uniqueness property for networks having more than two terminals. We settle the case of ring networks and find a necessary condition for general networks to have the uniqueness property in terms of excluded minors or subgraphs.

In a ring network, each user has exactly two possible strategies. See Fig. 1
                      for an illustration of this kind of supply graph G, demand digraph H, and mixed graph 
                        
                           G
                           +
                           H
                        
                     . We prove the following theorem in Section 5.
                        Theorem 1
                        
                           Assume that the supply graph G is a cycle. Then, for any demand digraph H, the pair 
                           
                              
                                 (
                                 G
                                 ,
                                 H
                                 )
                              
                            
                           has the uniqueness property if and only if each arc of G is contained in at most two routes.
                        

Whether such a pair 
                        
                           (
                           G
                           ,
                           H
                           )
                        
                      of supply graph and demand digraph is such that each arc in contained in at most two routes is obviously polynomially checkable, since we can test each arc one after the other. We will show that it can actually be tested by making only one round trip, in any direction, see Section 6.2. More generally, Section 6 contains a further discussion on the combinatorial structure of such a pair 
                        
                           (
                           G
                           ,
                           H
                           )
                        
                     . Especially, we prove in Section 6.3 that such a pair 
                        
                           (
                           G
                           ,
                           H
                           )
                        
                      has the uniqueness property if and only if 
                        
                           G
                           +
                           H
                        
                      is homeomorphic to a minor of one of nine mixed graphs, see Figs. 2–5
                     
                     
                     
                     . Except for the smallest one, none of the uniqueness properties of these graphs can be derived from the results by Milchtaich (2005), even by adding fictitious vertices as suggested p. 235 of his article.

Furthermore, we find on our track a sufficient condition for congestion games with nonatomic users to have the uniqueness property when each user has exactly two available strategies (Proposition 2).

Section 7.1 proves a necessary condition for general graphs to have the uniqueness property in terms of excluded minors (Corollary 2). With the help of Theorem 1, it allows to describe infinite families of networks not having the uniqueness property. The remaining of Section 7 contains complementary results. For instance, Section 7.4 defines and studies a strong uniqueness property that may hold for general graphs independently of the demand digraph, i.e. of the OD-pairs.

In this section, we prove Theorem 1. The proof works in two steps. The first step, Section 5.2, consists in proving Proposition 1 below stating that, when each arc is contained in at most two routes, then the uniqueness property holds. The second step, Section 5.3, consists in exhibiting cost functions for which flows at equilibrium are non-unique for any pair 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         with an arc in at least three routes.

From now on, we assume that the cycle G is embedded in the plane. It allows to use an orientation for G. Each route is now either positive or negative. The same holds for arcs of G: we have positive arcs and negative arcs.
                           Claim 1
                           
                              For any 
                              
                                 
                                    (
                                    o
                                    ,
                                    d
                                    )
                                    ∈
                                    L
                                 
                              
                              , if 
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          +
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          -
                                       
                                    
                                 
                               
                              are the two arcs stemming from an edge 
                              
                                 
                                    e
                                    ∈
                                    E
                                 
                              
                              , then exactly one of 
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          +
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          -
                                       
                                    
                                 
                               
                              is in an 
                              
                                 
                                    (
                                    o
                                    ,
                                    d
                                    )
                                 
                              
                              -route.
                           

Indeed, given an 
                                 
                                    (
                                    o
                                    ,
                                    d
                                    )
                                    ∈
                                    L
                                 
                               and an edge 
                                 
                                    e
                                    ∈
                                    E
                                 
                              , exactly one of the positive and negative 
                                 
                                    (
                                    o
                                    ,
                                    d
                                    )
                                 
                              -routes contains e.□

For any subset 
                           
                              J
                              ⊆
                              L
                           
                        , we define 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                           
                         (resp. 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                           
                        ) as the set of positive (resp. negative) arcs that are exclusively used by OD-pairs in J. For each OD-pair 
                           
                              ℓ
                              ∈
                              L
                           
                        , define 
                           
                              
                                 
                                    r
                                 
                                 
                                    ℓ
                                 
                                 
                                    +
                                 
                              
                           
                         (resp. 
                           
                              
                                 
                                    r
                                 
                                 
                                    ℓ
                                 
                                 
                                    -
                                 
                              
                           
                        ) to be the unique positive (resp. negative) route connecting the origin of 
                           
                              ℓ
                           
                         to its destination. Then 
                           
                              a
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                           
                         if 
                           
                              a
                              ∈
                              
                                 
                                    r
                                 
                                 
                                    ℓ
                                 
                                 
                                    +
                                 
                              
                           
                         for all 
                           
                              ℓ
                              ∈
                              J
                           
                         and 
                           
                              a
                              
                              ∉
                              
                              
                                 
                                    r
                                 
                                 
                                    ℓ
                                 
                                 
                                    +
                                 
                              
                           
                         for all 
                           
                              ℓ
                              ∈
                              L
                              ⧹
                              J
                           
                        . We proceed similarly for 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                           
                        . We define moreover 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                              ∪
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                           
                        . In particular, 
                           
                              
                                 
                                    A
                                 
                                 
                                    ∅
                                 
                              
                           
                         is the set of arcs contained in no route. The sets 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                              
                           
                         form a partition of the set A of arcs of G.

Defining the positive direction as the counterclockwise one on Fig. 1, we have
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   (
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   ,
                                                   (
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   }
                                                
                                                
                                                   +
                                                
                                             
                                             =
                                             {
                                             (
                                             
                                                
                                                   o
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             v
                                             )
                                             ,
                                             (
                                             v
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   (
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   }
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             {
                                             (
                                             
                                                
                                                   o
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   o
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ∅
                                                
                                             
                                             =
                                             {
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             v
                                             )
                                             ,
                                             (
                                             v
                                             ,
                                             
                                                
                                                   o
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ,
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             w
                                             )
                                             ,
                                             (
                                             w
                                             ,
                                             u
                                             )
                                             ,
                                             (
                                             u
                                             ,
                                             
                                                
                                                   o
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             }
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The sets 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    ε
                                 
                              
                           
                         enjoy three useful properties.
                           Claim 2
                           
                              For any 
                              
                                 
                                    ε
                                    ∈
                                    {
                                    -
                                    ,
                                    +
                                    }
                                 
                               
                              and any 
                              
                                 
                                    ℓ
                                    ∈
                                    L
                                 
                              
                              , there is at least one 
                              
                                 
                                    J
                                    ⊆
                                    L
                                 
                               
                              containing 
                              
                                 
                                    ℓ
                                 
                               
                              such that 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          ε
                                       
                                    
                                 
                               
                              is nonempty.
                           

Indeed, there is at least one arc of G on the route 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ℓ
                                       
                                       
                                          ε
                                       
                                    
                                 
                              .□


                              For any 
                              
                                 
                                    J
                                    ⊆
                                    L
                                 
                              
                              , we have 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               
                              if and only if 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          L
                                          ⧹
                                          J
                                       
                                       
                                          -
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              
                              .
                           

It is a consequence of Claim 1: if 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          +
                                       
                                    
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          -
                                       
                                    
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          L
                                          ⧹
                                          J
                                       
                                       
                                          -
                                       
                                    
                                 
                              .□


                              For any distinct 
                              
                                 
                                    ℓ
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          ′
                                       
                                    
                                 
                               
                              in L, there is at least one J such that 
                              
                                 
                                    |
                                    {
                                    ℓ
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          ′
                                       
                                    
                                    }
                                    ∩
                                    J
                                    |
                                    =
                                    1
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              
                              .
                           

Indeed, let 
                                 
                                    ℓ
                                    =
                                    (
                                    o
                                    ,
                                    d
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               be two distinct OD-pairs of H. Since H is simple, it contains no multiple edges and 
                                 
                                    o
                                    
                                    ≠
                                    
                                    
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                 
                               or 
                                 
                                    d
                                    
                                    ≠
                                    
                                    
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . It means that there is at least one arc of G which is in exactly one of the four 
                                 
                                    (
                                    o
                                    ,
                                    d
                                    )
                                 
                              - and 
                                 
                                    (
                                    
                                       
                                          o
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              -routes.□

For each user i, we define 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    +
                                 
                              
                           
                         (resp. 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                                 
                                    -
                                 
                              
                           
                        ) to be the unique positive (resp. negative) route connecting the origin of i to its destination. For a strategy profile 
                           
                              σ
                           
                         and a subset 
                           
                              J
                              ⊆
                              L
                           
                        , we define 
                           
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                           
                         to be:
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       J
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       i
                                       ∈
                                       
                                          
                                             ∪
                                          
                                          
                                             ℓ
                                             ∈
                                             J
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       σ
                                       (
                                       i
                                       )
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                          
                                             +
                                          
                                       
                                       }
                                    
                                 
                                 d
                                 λ
                                 
                                 and
                                 
                                 
                                    
                                       f
                                    
                                    
                                       J
                                    
                                    
                                       -
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       i
                                       ∈
                                       
                                          
                                             ∪
                                          
                                          
                                             ℓ
                                             ∈
                                             J
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       {
                                       σ
                                       (
                                       i
                                       )
                                       =
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                          
                                             -
                                          
                                       
                                       }
                                    
                                 
                                 d
                                 λ
                                 .
                              
                           
                        The quantity 
                           
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                           
                         (resp. 
                           
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                           
                        ) is thus the number of users i in a 
                           
                              
                                 
                                    I
                                 
                                 
                                    ℓ
                                 
                              
                           
                         with 
                           
                              ℓ
                              ∈
                              J
                           
                         choosing a positive (resp. negative) route. Note that the quantity 
                           
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    +
                                 
                              
                              +
                              
                                 
                                    f
                                 
                                 
                                    J
                                 
                                 
                                    -
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    ℓ
                                    ∈
                                    J
                                 
                              
                              λ
                              (
                              
                                 
                                    I
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                         does not depend on the strategy 
                           
                              σ
                           
                        .

Assume that we have two distinct equilibria 
                           
                              σ
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . The flows induced by 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         are denoted with a hat: 
                           
                              
                                 
                                    f
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . We define for any subset 
                           
                              J
                              ⊆
                              L
                           
                        :
                           
                              (1)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       J
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       J
                                    
                                    
                                       +
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       J
                                    
                                    
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       J
                                    
                                    
                                       -
                                    
                                 
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       J
                                    
                                    
                                       -
                                    
                                 
                                 .
                              
                           
                        By a slight abuse of notation, we let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ℓ
                                 
                              
                              ≔
                              
                                 
                                    Δ
                                 
                                 
                                    {
                                    ℓ
                                    }
                                 
                              
                           
                         for 
                           
                              ℓ
                              ∈
                              L
                           
                        .

For each user i, we define 
                           
                              δ
                              (
                              i
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    {
                                    σ
                                    (
                                    i
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    }
                                 
                              
                              -
                              
                                 
                                    1
                                 
                                 
                                    {
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    }
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    {
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          -
                                       
                                    
                                    }
                                 
                              
                              -
                              
                                 
                                    1
                                 
                                 
                                    {
                                    σ
                                    (
                                    i
                                    )
                                    =
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          -
                                       
                                    
                                    }
                                 
                              
                           
                        . Then, the following lemma holds.
                           Lemma 1
                           
                              Let 
                              
                                 
                                    ℓ
                                    ∈
                                    L
                                 
                               
                              and 
                              
                                 
                                    i
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                               
                              be such that 
                              
                                 
                                    δ
                                    (
                                    i
                                    )
                                    
                                    ≠
                                    
                                    0
                                 
                              
                              . Then exactly one of the following alternatives holds.
                              
                                 
                                    •
                                    
                                       There is a 
                                       
                                          
                                             J
                                             ⊆
                                             L
                                          
                                        
                                       with 
                                       
                                          
                                             ℓ
                                             ∈
                                             J
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   J
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                       , and 
                                       
                                          
                                             δ
                                             (
                                             i
                                             )
                                             
                                                
                                                   Δ
                                                
                                                
                                                   J
                                                
                                             
                                             <
                                             0
                                          
                                       .


                                       For all 
                                       
                                          
                                             J
                                             ⊆
                                             L
                                          
                                        
                                       with 
                                       
                                          
                                             ℓ
                                             ∈
                                             J
                                          
                                        
                                       and 
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   J
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                       , we have 
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   J
                                                
                                             
                                             =
                                             0
                                          
                                       .

We briefly explain the intuition behind this lemma. Assume that we move from 
                           
                              σ
                           
                         to 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . If a user i changes his chosen route, we are in one of the following two situations.

The first situation is when the cost of the new route decreases or the cost of the old route increases. If the cost of a route decreases (resp. increases), there is at least one arc of this route whose flow decreases (resp. increases). Since an arc belongs to some set 
                           
                              
                                 
                                    A
                                 
                                 
                                    J
                                 
                                 
                                    ε
                                 
                              
                           
                        , we get the first point of Lemma 1.

The second situation is when the costs remain the same for both routes and both routes have same costs, which implies the second point of Lemma 1.
                           Proof of Lemma 1
                           As 
                                 
                                    σ
                                 
                               is an equilibrium, we have for each user i:
                                 
                                    (2)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                a
                                                ∈
                                                A
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             {
                                             a
                                             ∈
                                             σ
                                             (
                                             i
                                             )
                                             }
                                          
                                       
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             {
                                             a
                                             ∈
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             i
                                             )
                                             }
                                          
                                       
                                       )
                                       ⩽
                                       0
                                       .
                                    
                                 
                              For 
                                 
                                    a
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                 
                              , we have 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          a
                                          ∈
                                          σ
                                          (
                                          i
                                          )
                                          }
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          σ
                                          (
                                          i
                                          )
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                +
                                             
                                          
                                          }
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          {
                                          a
                                          ∈
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                +
                                             
                                          
                                          }
                                       
                                    
                                 
                              , and the same holds for 
                                 
                                    a
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          -
                                       
                                    
                                 
                              . By decomposing the sum (2), we obtain that
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                J
                                                ⊆
                                                L
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         a
                                                         ∈
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               +
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               +
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                                δ
                                                (
                                                i
                                                )
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         a
                                                         ∈
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               -
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               -
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      -
                                                   
                                                
                                                )
                                                δ
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       ⩽
                                       0
                                       .
                                    
                                 
                              We can write a similar equation for the equilibrium 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . By summing them, we obtain
                                 
                                    (3)
                                    
                                       δ
                                       (
                                       i
                                       )
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                J
                                                ⊆
                                                L
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         a
                                                         ∈
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               +
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               +
                                                            
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                                )
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         a
                                                         ∈
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               -
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               -
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               a
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               -
                                                            
                                                         
                                                         )
                                                         -
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               a
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              ˆ
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        -
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       0
                                       .
                                    
                                 
                              
                           

According to Eq. (1) and using the fact that the maps 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                 
                               are strictly increasing, both 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                             
                                                +
                                             
                                          
                                          ∩
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    )
                                    )
                                 
                               and 
                                 
                                    -
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                J
                                             
                                             
                                                -
                                             
                                          
                                          ∩
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          J
                                       
                                       
                                          -
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          J
                                       
                                       
                                          -
                                       
                                    
                                    )
                                    )
                                 
                               have the sign of 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          J
                                       
                                    
                                 
                              . Therefore, if all terms of the sum in Eq. (3) are equal to 0, the second point of the lemma holds. If at least one term of the sum is 
                                 
                                    <
                                    0
                                 
                              , we get the first point.□

With the help of this lemma, we get one direction of Theorem 1.
                           Proposition 1
                           
                              If each arc of G is contained in at most two routes, the uniqueness property holds.
                           

Note that the assumption of the proposition ensures that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                    
                                    =
                                    ∅
                                 
                               if 
                                 
                                    |
                                    J
                                    |
                                    ⩾
                                    3
                                 
                              . We want to prove that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          J
                                       
                                    
                                    =
                                    0
                                 
                               for all 
                                 
                                    J
                                    ⊆
                                    L
                                 
                               such that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              .

Assume for a contradiction that there is a 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                 
                               such that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    ≠
                                    
                                    0
                                 
                               and 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              . Then there is a 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          0
                                       
                                    
                                    ∈
                                    
                                       
                                          J
                                       
                                       
                                          0
                                       
                                    
                                 
                               such that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                    ≠
                                    
                                    0
                                 
                              . At least one user 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                               is such that 
                                 
                                    δ
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    >
                                    0
                                 
                              .

Suppose that the first case of Lemma 1 occurs. There exists 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    L
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                       
                                    
                                    
                                    ≠
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          0
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               and 
                                 
                                    δ
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          Δ
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    <
                                    0
                                 
                              . Then, 
                                 
                                    δ
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    
                                       
                                          Δ
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    =
                                    δ
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                    <
                                    0
                                 
                              , which implies that 
                                 
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    |
                                    <
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    |
                                 
                              . It follows that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                    ≠
                                    
                                    0
                                 
                              , and taking 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                               with 
                                 
                                    δ
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    >
                                    0
                                 
                              , only the first case of Lemma 1 can occur for 
                                 
                                    i
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    ℓ
                                    =
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                       
                                    
                                 
                              . Indeed, the second case would imply that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    =
                                    0
                                 
                               since 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              . Repeating the same argument, we build an infinite sequence 
                                 
                                    (
                                    
                                       
                                          ℓ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    )
                                 
                               of elements of L such that, for each 
                                 
                                    k
                                    ⩾
                                    0
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          }
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               and 
                                 
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    |
                                    <
                                    |
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    |
                                 
                              . This last condition implies that the 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                 
                               are distinct, which is impossible since 
                                 
                                    |
                                    L
                                    |
                                 
                               is finite.

Thus, the second case of Lemma 1 occurs for 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          0
                                       
                                    
                                 
                              , and hence 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              , which is in contradiction with the starting assumption. On any arc, we have a total flow that remains the same when changing from 
                                 
                                    σ
                                 
                               to 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .□

The only fact we use from the ring structure is that there are two sets 
                           
                              
                                 
                                    A
                                 
                                 
                                    +
                                 
                              
                           
                         (positive arcs) and 
                           
                              
                                 
                                    A
                                 
                                 
                                    -
                                 
                              
                           
                         (negative arcs) and that each user has exactly two possible strategies, each of them being included in one of these two sets. We can state a result holding for more general nonatomic congestion game with user-specific cost functions. We omit the proof since the one of Proposition 1 holds without any change.
                           Proposition 2
                           
                              Consider a nonatomic congestion game with user-specific (strictly increasing) cost functions. Let 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          +
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          -
                                       
                                    
                                 
                               
                              be two disjoint finite sets. Assume that every user i has exactly two available strategies 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          -
                                       
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          +
                                       
                                    
                                    ⊆
                                    
                                       
                                          A
                                       
                                       
                                          +
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                       
                                          -
                                       
                                    
                                    ⊆
                                    
                                       
                                          A
                                       
                                       
                                          -
                                       
                                    
                                 
                              
                              . Then, if all triples of pairwise distinct strategies have an empty intersection, the uniqueness property holds.
                           

We give an explicit construction of multiple equilibrium flows when an arc is contained in at least three routes.

In order to ease the notation, we use 
                              
                                 1
                                 ,
                                 2
                              
                           , and 3 to denote the three OD-pairs of H. We denote accordingly by 
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       3
                                    
                                 
                              
                            the three sets of users associated to each of these OD-pairs.

We can assume without loss of generality that 
                              
                                 
                                    
                                       A
                                    
                                    
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       }
                                    
                                    
                                       +
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           , and 
                              
                                 
                                    
                                       A
                                    
                                    
                                       {
                                       1
                                       ,
                                       3
                                       }
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           . The first assumption can be done since there is an arc in three routes. For the other ones: with the help of Claim 4, and if necessary of Claim 3, we get that there is at least a J of cardinality two such that 
                              
                                 
                                    
                                       A
                                    
                                    
                                       J
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           . Again, using Claim 4, this time with the two elements of J, and if necessary Claim 3, we get another 
                              
                                 
                                    
                                       J
                                    
                                    
                                       ′
                                    
                                 
                              
                            of cardinality two such that 
                              
                                 
                                    
                                       A
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           .

We define three classes of users. Each of these classes is attached to one of the OD-pairs. For a class 
                                 
                                    k
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                              , we define the cost functions 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          J
                                       
                                       
                                          k
                                          ,
                                          ε
                                       
                                    
                                 
                              , for all 
                                 
                                    J
                                    ⊆
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                               and 
                                 
                                    ε
                                    ∈
                                    {
                                    -
                                    ,
                                    +
                                    }
                                 
                              . The cost function for a class k user i on an arc a of 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          ε
                                       
                                    
                                 
                               is set to 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    
                                       
                                          c
                                       
                                       
                                          J
                                       
                                       
                                          k
                                          ,
                                          ε
                                       
                                    
                                 
                              . If the set 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          ε
                                       
                                    
                                 
                               is empty, the definition of 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          J
                                       
                                       
                                          k
                                          ,
                                          ε
                                       
                                    
                                 
                               is simply discarded.


                              Class 1: We define this class to be the users of the set 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                 
                              . We set 
                                 
                                    λ
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    1.5
                                 
                               and choose 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                    ⊆
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                               with 
                                 
                                    1
                                    ∈
                                    
                                       
                                          J
                                       
                                       
                                          1
                                       
                                    
                                 
                               such that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          -
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               (with the help of Claim 2).
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               {
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               3
                                                               }
                                                            
                                                            
                                                               1
                                                               ,
                                                               +
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         =
                                                         
                                                            
                                                               24
                                                               x
                                                               +
                                                               7
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     {
                                                                     1
                                                                     ,
                                                                     2
                                                                     ,
                                                                     3
                                                                     }
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               1
                                                               ,
                                                               +
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         =
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         
                                                         for any
                                                         
                                                         J
                                                         
                                                         ≠
                                                         
                                                         {
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         3
                                                         }
                                                         
                                                         with
                                                         
                                                         1
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                               ,
                                                               -
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         =
                                                         
                                                            
                                                               x
                                                               +
                                                               48
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           J
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               J
                                                            
                                                            
                                                               1
                                                               ,
                                                               -
                                                            
                                                         
                                                         (
                                                         x
                                                         )
                                                         =
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               |
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         
                                                         for any
                                                         
                                                         J
                                                         
                                                         ≠
                                                         
                                                         
                                                            
                                                               J
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                         with
                                                         
                                                         1
                                                         ∈
                                                         J
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Class 2: We define this class to be the users of the set 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                 
                              . We set 
                                 
                                    λ
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    1
                                 
                              . We have assumed that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              . We distinguish hereafter the cases 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               and 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                       
                                          -
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               (which may hold simultaneously, in which case we make an arbitrary choice).
                                 
                                    
                                       If
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   1
                                                   ,
                                                   2
                                                   }
                                                
                                                
                                                   +
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                       :
                                    We choose 
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   2
                                                
                                             
                                             ⊆
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                        with 
                                          
                                             2
                                             ∈
                                             
                                                
                                                   J
                                                
                                                
                                                   2
                                                
                                             
                                          
                                        such that 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   -
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                        (with the help of Claim 2).
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        {
                                                                        1
                                                                        ,
                                                                        2
                                                                        }
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        +
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        25
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              {
                                                                              1
                                                                              ,
                                                                              2
                                                                              }
                                                                           
                                                                           
                                                                              +
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        +
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                           
                                                                              +
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                                  
                                                                  for any
                                                                  
                                                                  J
                                                                  
                                                                  ≠
                                                                  
                                                                  {
                                                                  1
                                                                  ,
                                                                  2
                                                                  }
                                                                  
                                                                  with
                                                                  
                                                                  2
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              J
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        -
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                        +
                                                                        31
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    J
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              -
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        -
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                           
                                                                              -
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                                  
                                                                  for any
                                                                  
                                                                  J
                                                                  
                                                                  ≠
                                                                  
                                                                  
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                  with
                                                                  
                                                                  2
                                                                  ∈
                                                                  J
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        {
                                                                        1
                                                                        ,
                                                                        2
                                                                        ,
                                                                        3
                                                                        }
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        +
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                        +
                                                                        26
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              {
                                                                              1
                                                                              ,
                                                                              2
                                                                              ,
                                                                              3
                                                                              }
                                                                           
                                                                           
                                                                              +
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        +
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                           
                                                                              +
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                                  
                                                                  for any
                                                                  
                                                                  J
                                                                  
                                                                  ≠
                                                                  
                                                                  {
                                                                  1
                                                                  ,
                                                                  2
                                                                  ,
                                                                  3
                                                                  }
                                                                  
                                                                  with
                                                                  
                                                                  2
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        {
                                                                        1
                                                                        ,
                                                                        2
                                                                        }
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        -
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        22
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              {
                                                                              1
                                                                              ,
                                                                              2
                                                                              }
                                                                           
                                                                           
                                                                              -
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        J
                                                                     
                                                                     
                                                                        2
                                                                        ,
                                                                        -
                                                                     
                                                                  
                                                                  (
                                                                  x
                                                                  )
                                                                  =
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        |
                                                                        
                                                                           
                                                                              A
                                                                           
                                                                           
                                                                              J
                                                                           
                                                                           
                                                                              -
                                                                           
                                                                        
                                                                        |
                                                                     
                                                                  
                                                                  
                                                                  for any
                                                                  
                                                                  J
                                                                  
                                                                  ≠
                                                                  
                                                                  {
                                                                  1
                                                                  ,
                                                                  2
                                                                  }
                                                                  
                                                                  with
                                                                  
                                                                  2
                                                                  ∈
                                                                  J
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       Class 3: We define this class to be the users of the set 
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       . We set 
                                          
                                             λ
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                             =
                                             1
                                          
                                       . We have assumed that 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   1
                                                   ,
                                                   3
                                                   }
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                       . We distinguish hereafter the cases 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   1
                                                   ,
                                                   3
                                                   }
                                                
                                                
                                                   +
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                        and 
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   {
                                                   1
                                                   ,
                                                   3
                                                   }
                                                
                                                
                                                   -
                                                
                                             
                                             
                                             ≠
                                             
                                             ∅
                                          
                                        (which may hold simultaneously, in which case we make an arbitrary choice).
                                          
                                             
                                                If 
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            {
                                                            1
                                                            ,
                                                            3
                                                            }
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                :
                                             We choose 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ⊆
                                                      {
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      3
                                                      }
                                                   
                                                 with 
                                                   
                                                      3
                                                      ∈
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                 such that 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                 (with the help of Claim 2).
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 {
                                                                                 1
                                                                                 ,
                                                                                 3
                                                                                 }
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 +
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 25
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       {
                                                                                       1
                                                                                       ,
                                                                                       3
                                                                                       }
                                                                                    
                                                                                    
                                                                                       +
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 J
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 +
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       +
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                           
                                                                           for any
                                                                           
                                                                           J
                                                                           
                                                                           ≠
                                                                           
                                                                           {
                                                                           1
                                                                           ,
                                                                           3
                                                                           }
                                                                           
                                                                           with
                                                                           
                                                                           3
                                                                           ∈
                                                                           J
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       3
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 -
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                                 +
                                                                                 31
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             J
                                                                                          
                                                                                          
                                                                                             3
                                                                                          
                                                                                       
                                                                                    
                                                                                    
                                                                                       -
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 J
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 -
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       -
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                           
                                                                           for any
                                                                           
                                                                           J
                                                                           
                                                                           ≠
                                                                           
                                                                           
                                                                              
                                                                                 J
                                                                              
                                                                              
                                                                                 3
                                                                              
                                                                           
                                                                           with
                                                                           
                                                                           3
                                                                           ∈
                                                                           J
                                                                           .
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             


                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 {
                                                                                 1
                                                                                 ,
                                                                                 2
                                                                                 ,
                                                                                 3
                                                                                 }
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 +
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                                 +
                                                                                 26
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       {
                                                                                       1
                                                                                       ,
                                                                                       2
                                                                                       ,
                                                                                       3
                                                                                       }
                                                                                    
                                                                                    
                                                                                       +
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 J
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 +
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       +
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                           
                                                                           for any
                                                                           
                                                                           J
                                                                           
                                                                           ≠
                                                                           
                                                                           {
                                                                           1
                                                                           ,
                                                                           2
                                                                           ,
                                                                           3
                                                                           }
                                                                           
                                                                           with
                                                                           
                                                                           3
                                                                           ∈
                                                                           J
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 {
                                                                                 1
                                                                                 ,
                                                                                 3
                                                                                 }
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 -
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 22
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       {
                                                                                       1
                                                                                       ,
                                                                                       3
                                                                                       }
                                                                                    
                                                                                    
                                                                                       -
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 c
                                                                              
                                                                              
                                                                                 J
                                                                              
                                                                              
                                                                                 3
                                                                                 ,
                                                                                 -
                                                                              
                                                                           
                                                                           (
                                                                           x
                                                                           )
                                                                           =
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       A
                                                                                    
                                                                                    
                                                                                       J
                                                                                    
                                                                                    
                                                                                       -
                                                                                    
                                                                                 
                                                                                 |
                                                                              
                                                                           
                                                                           
                                                                           for any
                                                                           
                                                                           J
                                                                           
                                                                           ≠
                                                                           
                                                                           {
                                                                           1
                                                                           ,
                                                                           3
                                                                           }
                                                                           
                                                                           with
                                                                           
                                                                           3
                                                                           ∈
                                                                           J
                                                                           .
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             

We define now two strategy profiles 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              , inducing distinct flows on some arcs. We check in the next paragraph that each of them is an equilibrium.
                                 
                                    Strategy profile 
                                          
                                             σ
                                          
                                       :
                                    For all 
                                          
                                             i
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       , we set 
                                          
                                             σ
                                             (
                                             i
                                             )
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   +
                                                
                                             
                                          
                                        and for all 
                                          
                                             i
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                             ∪
                                             
                                                
                                                   I
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       , we set 
                                          
                                             σ
                                             (
                                             i
                                             )
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       . Then, the flows are the following:
                                          
                                             
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      {1}
                                                      {2}
                                                      {3}
                                                      {1,2}
                                                      {1,3}
                                                      {2,3}
                                                      {1,2,3}
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      1.5
                                                      0
                                                      0
                                                      1.5
                                                      1.5
                                                      0
                                                      1.5
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      0
                                                      1
                                                      1
                                                      1
                                                      1
                                                      2
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    

For all 
                                          
                                             i
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       , we set 
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             i
                                             )
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   -
                                                
                                             
                                          
                                        and for all 
                                          
                                             i
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   2
                                                
                                             
                                             ∪
                                             
                                                
                                                   I
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       , we set 
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ˆ
                                                
                                             
                                             (
                                             i
                                             )
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       . Then, the flows are the following:
                                          
                                             
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      {1}
                                                      {2}
                                                      {3}
                                                      {1,2}
                                                      {1,3}
                                                      {2,3}
                                                      {1,2,3}
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           f
                                                                        
                                                                        
                                                                           ˆ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      0
                                                      1
                                                      1
                                                      1
                                                      1
                                                      2
                                                      2
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           f
                                                                        
                                                                        
                                                                           ˆ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     J
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      1.5
                                                      0
                                                      0
                                                      1.5
                                                      1.5
                                                      0
                                                      1.5
                                                   
                                                
                                             
                                          
                                       
                                    

We check now that 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               are equilibria, by computing the cost of each of the two possible routes for each class.

For a class 
                                 
                                    k
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                              , we denote with a slight abuse of notation the common positive (resp. negative) route of the class k users by 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          k
                                       
                                       
                                          +
                                       
                                    
                                 
                               (resp. 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          k
                                       
                                       
                                          -
                                       
                                    
                                 
                              ).


                              Class 1: We put in the following tables, the costs experienced by the class 1 users on the various arcs of G for each of 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . For a given 
                                 
                                    J
                                    ⊆
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                               with 
                                 
                                    1
                                    ∈
                                    J
                                 
                               and 
                                 
                                    ε
                                    ∈
                                    {
                                    -
                                    ,
                                    +
                                    }
                                 
                              , we indicate the cost experienced by any class 1 user on the whole collection of arcs in 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          ε
                                       
                                    
                                 
                              . For instance in 
                                 
                                    σ
                                 
                              , if 
                                 
                                    J
                                    =
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                              , then 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    1.5
                                 
                              , and the cost of all arcs together in 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                 
                               is 
                                 
                                    |
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          J
                                       
                                       
                                          1
                                          ,
                                          +
                                       
                                    
                                    (
                                    1.5
                                    )
                                    =
                                    43
                                 
                              .

For the strategy profile 
                                 
                                    σ
                                 
                              , we get the following flows and costs on the arcs of G for a class 1 user.
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      1
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2,3}
                                             other
                                             
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             1.5
                                             1.5
                                             0, 1, or 2
                                             0, 1, or 2
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             43
                                             1.5
                                             48, 49, or 50
                                             0, 1, or 2
                                          
                                       
                                    
                                 
                              
                           

Using the fact that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          }
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              , the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                       
                                          +
                                       
                                    
                                 
                               in 
                                 
                                    σ
                                 
                               for a class 1 user is equal to
                                 
                                    
                                       43
                                       +
                                       1.5
                                       ×
                                       
                                          
                                             
                                                {
                                                J
                                                
                                                ≠
                                                
                                                {
                                                1
                                                ,
                                                2
                                                ,
                                                3
                                                }
                                                
                                                such that
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      +
                                                   
                                                
                                                
                                                ≠
                                                
                                                ∅
                                                
                                                and
                                                
                                                1
                                                ∈
                                                J
                                                }
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

Since there are at most three sets 
                                 
                                    J
                                    
                                    ≠
                                    
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                               such that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          J
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                               and 
                                 
                                    1
                                    ∈
                                    J
                                 
                              , we get that the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                       
                                          +
                                       
                                    
                                 
                               lies in 
                                 
                                    [
                                    43
                                    ;
                                    47.5
                                    ]
                                 
                              . Similarly, using the fact that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          -
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              , we get that the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                       
                                          -
                                       
                                    
                                 
                               for a class 1 user lies in 
                                 
                                    [
                                    48
                                    ;
                                    54
                                    ]
                                 
                              . Therefore the users of class 1 are not incited to change their choice in 
                                 
                                    σ
                                 
                              .

For the strategy profile 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              , we get the following flows and costs.
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      1
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2,3}
                                             other
                                             
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             2
                                             0 or 1
                                             1.5
                                             1.5
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             55
                                             0 or 1
                                             49.5
                                             1.5
                                          
                                       
                                    
                                 
                              
                           

The total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                       
                                          +
                                       
                                    
                                 
                               for a class 1 user lies in 
                                 
                                    [
                                    55
                                    ;
                                    58
                                    ]
                                 
                               and the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                       
                                          -
                                       
                                    
                                 
                               for a class 1 user lies in 
                                 
                                    [
                                    49.5
                                    ;
                                    54
                                    ]
                                 
                              . Therefore the users of class 1 are not incited to change their choice in 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .


                              Class 2: If 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              
                              : We put in the following tables, the costs experienced by the class 2 users on the various arcs of G for each of 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .

For the strategy profile 
                                 
                                    σ
                                 
                              :
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      2
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2}
                                             other
                                             
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             1.5
                                             0 or 1.5
                                             1 or 2
                                             1 or 2
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             37.5
                                             1.5
                                             32 or 33
                                             1 or 2
                                          
                                       
                                    
                                 
                              
                           

The total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          +
                                       
                                    
                                 
                               for a class 2 user is precisely 39 (we use the fact that 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          }
                                       
                                       
                                          +
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              ) and the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          -
                                       
                                    
                                 
                               lies in 
                                 
                                    [
                                    32
                                    ;
                                    38
                                    ]
                                 
                              . The users of class 2 are not incited to change their choice in 
                                 
                                    σ
                                 
                              .

For the strategy profile 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              :
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      2
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2}
                                             other
                                             
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             1
                                             1 or 2
                                             0 or 1.5
                                             0 or 1.5
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             25
                                             1 or 2
                                             31 or 32.5
                                             0 or 1.5
                                          
                                       
                                    
                                 
                              
                           

The total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          +
                                       
                                    
                                 
                               for a class 2 user lies in 
                                 
                                    [
                                    27
                                    ;
                                    30
                                    ]
                                 
                               and the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          -
                                       
                                    
                                 
                               lies in 
                                 
                                    [
                                    31
                                    ;
                                    34
                                    ]
                                 
                              . The users of class 2 are not incited to change their choice in 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .


                              If 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                       
                                          -
                                       
                                    
                                    
                                    ≠
                                    
                                    ∅
                                 
                              : We put in the following tables, the costs experienced by the class 2 users on the various arcs of G for each of 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .

For the strategy profile 
                                 
                                    σ
                                 
                              :
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      2
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2,3}
                                             other
                                             
                                                
                                                   
                                                      {
                                                      1
                                                      ,
                                                      2
                                                      }
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             1.5
                                             0 or 1.5
                                             1
                                             1 or 2
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             27.5
                                             0 or 1.5
                                             22
                                             1 or 2
                                          
                                       
                                    
                                 
                              
                           

The total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          +
                                       
                                    
                                 
                               for a class 2 user lies in 
                                 
                                    [
                                    27.5
                                    ;
                                    29
                                    ]
                                 
                               and the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          -
                                       
                                    
                                 
                               lies in 
                                 
                                    [
                                    22
                                    ;
                                    27
                                    ]
                                 
                              . The users of class 2 are not incited to change their choice in 
                                 
                                    σ
                                 
                              .

For the strategy profile 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              :
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      +
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ε
                                                      =
                                                      -
                                                   
                                                
                                             
                                          
                                          
                                             
                                                J with 
                                                   
                                                      2
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                             {1,2,3}
                                             other
                                             
                                                
                                                   
                                                      {
                                                      1
                                                      ,
                                                      2
                                                      }
                                                   
                                                
                                             
                                             other
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             2
                                             1 or 2
                                             1.5
                                             0 or 1.5
                                          
                                          
                                             Cost on 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            J
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             28
                                             1 or 2
                                             33
                                             0 or 1.5
                                          
                                       
                                    
                                 
                              
                           

The total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          +
                                       
                                    
                                 
                               for a class 2 user lies in 
                                 
                                    [
                                    28
                                    ;
                                    32
                                    ]
                                 
                               and the total cost of 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                       
                                          -
                                       
                                    
                                 
                               lies in 
                                 
                                    [
                                    33
                                    ;
                                    34.5
                                    ]
                                 
                              . The users of class 2 are not incited to change their choice in 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              .


                              Class 3: The symmetry of the cost functions for classes 2 and 3 gives the same tables for class 3 as for class 2, by substituting 
                                 
                                    {
                                    1
                                    ,
                                    3
                                    }
                                 
                               to 
                                 
                                    {
                                    1
                                    ,
                                    2
                                    }
                                 
                              . Therefore, we get the same conclusions: neither in 
                                 
                                    σ
                                 
                              , nor in 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              , the class 3 users are incited to change their choice.

Therefore, 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                               are equilibria and induce distinct flows. It proves that the uniqueness property does not hold. It remains to check the case when 
                                 
                                    |
                                    L
                                    |
                                    >
                                    3
                                 
                              .
                                 Remark 1
                                 A classical question when there are several equilibria is whether one of them dominates the others. An equilibrium is said to dominate another one if it is preferable for all users. In this construction, no equilibrium dominates the other, except when 
                                       
                                          
                                             
                                                A
                                             
                                             
                                                {
                                                1
                                                ,
                                                2
                                                ,
                                                3
                                                }
                                             
                                             
                                                +
                                             
                                          
                                          
                                          ≠
                                          
                                          ∅
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                {
                                                1
                                                ,
                                                2
                                                }
                                             
                                             
                                                -
                                             
                                          
                                          
                                          ≠
                                          
                                          ∅
                                       
                                    , and 
                                       
                                          
                                             
                                                A
                                             
                                             
                                                {
                                                1
                                                ,
                                                3
                                                }
                                             
                                             
                                                -
                                             
                                          
                                          
                                          ≠
                                          
                                          ∅
                                       
                                     where 
                                       
                                          σ
                                       
                                     dominates 
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    .

Denote 
                              
                                 1
                                 ,
                                 2
                              
                           , and 3 three OD-pairs of 
                              
                                 H
                                 =
                                 (
                                 T
                                 ,
                                 L
                                 )
                              
                            giving three routes containing the same arc of G. For these three arcs of H, we make the same construction as above, in the case 
                              
                                 |
                                 L
                                 |
                                 =
                                 3
                              
                           . For the other 
                              
                                 ℓ
                                 ∈
                                 L
                              
                           , we set 
                              
                                 
                                    
                                       I
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 ∅
                              
                            to get the desired conclusion.

However, note that we can also get multiple equilibrium flows, while requiring 
                              
                                 
                                    
                                       I
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                            for all 
                              
                                 ℓ
                                 ∈
                                 L
                              
                           . For 
                              
                                 ℓ
                                 
                                 ∉
                                 
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 }
                              
                           , we use a fourth class, whose costs are very small on all positive arcs of G and very large on all negative arcs of G, and whose measure is a small positive quantity 
                              
                                 δ
                              
                           . Each user of this class chooses always a positive route, whatever the other users do. For 
                              
                                 δ
                              
                            small enough, the users of this class have no impact on the choices of the users of the classes 
                              
                                 1
                                 ,
                                 2
                              
                           , and 3, as the difference of cost between the routes is always bounded below by 
                              
                                 0.5
                              
                           .

In this section, we provide a further combinatorial analysis of the characterization of the uniqueness property for ring graphs stated in Theorem 1.

We first state a corollary of Theorem 1.
                           Corollary 1
                           
                              Suppose that the supply graph is a cycle.
                              
                                 
                                    •
                                    
                                       If there are at most two OD-pairs, i.e. 
                                       
                                          
                                             |
                                             L
                                             |
                                             ⩽
                                             2
                                          
                                       
                                       , then the uniqueness property holds.
                                    


                                       If the uniqueness property holds, then the number of OD-pairs is at most 4, i.e. 
                                       
                                          
                                             |
                                             L
                                             |
                                             ⩽
                                             4
                                          
                                       
                                       .
                                    

The first point of Corollary 1 is straightforward. The second point is a direct consequence of Claim 1: if 
                           
                              |
                              L
                              |
                              ⩾
                              5
                           
                        , then there is necessarily an arc of G in three routes.

In an arc 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , vertex u is called the tail and vertex v is called the head. The algorithm starts at an arbitrary vertex of H and makes a round trip in an arbitrary direction, while maintaining a triple (list, min, max). In this triple, list is a set of arcs of H whose tail has already been encountered but whose head has not yet been encountered. At the beginning, list is empty and min and max are both zero. When the algorithm encounters a vertex v, it proceeds to three operations.


                        First operation. It computes the number of arcs in 
                           
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    -
                                 
                              
                              (
                              v
                              )
                           
                         (arcs of H having v as head) not in list. The corresponding routes were “forgotten”, since the tail is “before” the starting vertex of the algorithm. To take them into account, this number is added to the values min and max.


                        Second operation. All arcs of list being also in 
                           
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    -
                                 
                              
                              (
                              v
                              )
                           
                         are removed from list.


                        Third operation. All arcs in 
                           
                              
                                 
                                    δ
                                 
                                 
                                    H
                                 
                                 
                                    +
                                 
                              
                              (
                              v
                              )
                           
                         (arcs of H having v as tail) are added to list. The value of min is updated to the minimum between the previous value of min and the size of list, and similarly max is updated to the maximum between the previous value of max and the size of list.

The algorithm stops after one round trip. At the end, the values min and max are respectively the minimal and maximal number of routes containing an arc in the direction chosen. According to Claim 1, 
                           
                              max
                              (
                              |
                              L
                              |
                              -
                              min
                              ,
                              max
                              )
                           
                         is the maximal number of routes containing an arc of G.

Note that with a second round trip, this algorithm can specify the routes containing a given arc, by scanning the content of list.


                        
                           Proposition 3
                           
                              Let the supply graph G be a cycle. Then, for any demand digraph H, the pair 
                              
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               
                              is such that each arc of G is in at most two routes if and only if the mixed graph 
                              
                                 
                                    G
                                    +
                                    H
                                 
                               
                              is homeomorphic to a minor of one of the nine mixed graphs of 
                              Figs. 2–5.

Combined with Theorem 1, this proposition allows to describe explicitly all pairs 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         having the uniqueness property, when G is a cycle.
                           Proof
                           One direction is straightforward. Let us prove the other direction, namely that, if each arc of G is in at most two routes, then 
                                 
                                    G
                                    +
                                    H
                                 
                               is homeomorphic to a minor of one of the nine mixed graphs. We can assume that 
                                 
                                    V
                                    =
                                    T
                                 
                              . Moreover, if each arc is in at most two routes, Claim 1 implies that 
                                 
                                    |
                                    L
                                    |
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    }
                                 
                              , as already noted in the proof of Corollary 1.

If 
                                 
                                    |
                                    L
                                    |
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                 
                              , there is nothing to prove: all possible mixed graphs with 
                                 
                                    |
                                    L
                                    |
                                    =
                                    1
                                 
                               or 
                                 
                                    |
                                    L
                                    |
                                    =
                                    2
                                 
                               are homeomorphic to a minor of the graphs of Figs. 2 and 3.

If 
                                 
                                    |
                                    L
                                    |
                                    =
                                    3
                                 
                              , we can first assume that L contains two disjoint arcs that are crossing in the plane embedding. By trying all possibilities for the third arc, we get that the only possible configuration is the right one on Fig. 4 and the ones obtained from it by edge contraction. Second, we assume that there are no “crossing” arcs. The three heads of the arcs cannot be consecutive on the cycle otherwise we would have an arc of G in three routes. Again by enumerating all possibilities, we get that the only possible configuration is the left one on Fig. 4 and the ones obtained from it by edge contraction.

If 
                                 
                                    |
                                    L
                                    |
                                    =
                                    4
                                 
                              , Claim 3 shows that each arc of G belongs to exactly two routes. It implies that, in H, the indegree of any 
                                 
                                    ℓ
                                    ∈
                                    L
                                 
                               is equal to its outdegree. There are therefore circuits in H. It is straightforward to check that it is impossible to have a length 3 circuit. It remains to enumerate the possible cases for length 2 and length 4 circuits to get that the only possible configurations are the ones of Fig. 5 and the common one obtained from them by edge contraction.□

We can also describe the rings having the uniqueness property by minor exclusion, similarly as in Milchtaich (2005).
                           Proposition 4
                           
                              Let the supply graph G be a cycle. Then, for any demand digraph H, the pair 
                              
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               
                              is such that there exists an arc of G belonging to at least three routes if and only if 
                              
                                 
                                    G
                                    +
                                    H
                                 
                               
                              has one of the nine mixed graphs of 
                              
                                 Fig. 10 
                              as a minor.
                           

Suppose that one of the nine mixed graphs of Fig. 10 is a minor of the mixed graph 
                                 
                                    G
                                    +
                                    H
                                 
                              . The construction of Section 5.3.1 shows that we can build two distinct equilibria for this minor where all users of a given class have the same strategy. Then, we can extend this counterexample to the graph 
                                 
                                    G
                                    +
                                    H
                                 
                              , see Corollary 2 in Section 7.1 holding for more general graphs.

To prove that if an arc of G belongs to at least three routes, then one of the nine mixed graphs of Fig. 10 is a minor of 
                                 
                                    G
                                    +
                                    H
                                 
                              , we proceed to an explicit, but tedious, enumeration. We enumerate all possible mixed graphs with 
                                 
                                    |
                                    V
                                    |
                                    =
                                    6
                                 
                               and 
                                 
                                    |
                                    L
                                    |
                                    =
                                    3
                                 
                               such that each vertex is the tail or the head of exactly one arc in L.Then, we try all possible sequences of edge contractions leading to mixed graphs satisfying two properties: the demand graph is simple and an arc is in three routes. We keep the mixed graphs such that any additional edge contraction leads to a violation of these properties. The details are omitted.□

In particular, the construction in Section 5.3.1 cannot be simplified by exhibiting a counterexample for each mixed graph of Fig. 10, since the proof of Proposition 4 needs this tedious enumeration.

@&#DISCUSSION@&#

For the sake of simplicity, given a supply graph G and a demand digraph H, we say that the mixed graph 
                           
                              G
                              +
                              H
                           
                         has the uniqueness property if the pair 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         has it.

Using the results of Milchtaich (2005) and Theorem 1, we can derive results for more general graphs. Milchtaich suggests to add a fictitious origin, linked to all origins, and similarly for the destinations. If the new graph has the uniqueness property, the original one has it as well. However, this approach cannot be used to prove that a graph does not have the uniqueness property. For instance this method allows us to prove that the graph on the left in Fig. 6
                         has the uniqueness property, but fails to settle the status of the graph on the right. Indeed, the new graph does not have the uniqueness property, using the result of Milchtaich (2005), but the original one has it, using Theorem 1.

A way for proving that a pair 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         does not have the uniqueness property consists in using subgraphs or minors as obstructions to uniqueness property. If 
                           
                              G
                              +
                              H
                           
                         has a subgraph without the uniqueness property, then it does not have the property either since we can set prohibitive high costs on the arcs outside the subgraph. However, it is not clear whether having a minor without uniqueness property is an obstruction for having the uniqueness property. Indeed, the cost functions are strictly increasing and we do not see how in general a counterexample to uniqueness at the level of a minor can be extended at the level of the network itself. Yet, we can settle two specific cases.

The first case is when the contractions involve only bridges of G (a bridge is an edge whose deletion disconnects the graph). In this case, if the minor does not have the uniqueness property, the pair 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         does not have it either. Checking this property is easy.

A second case is formalized in the following proposition. An equilibrium is strict if each user as a unique best reply.
                           Proposition 5
                           
                              Let 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                 
                               
                              be respectively a supply and a demand graphs such that 
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                 
                               
                              is a minor of 
                              
                                 
                                    G
                                    +
                                    H
                                 
                              
                              . If there are counterexamples of uniqueness property for 
                              
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               
                              involving strict equilibria, then 
                              
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               
                              does not have the uniqueness property.
                           

We start with a counterexample for 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . We de-contract an edge. We assign to this edge a small enough cost function so that the route followed by any user remains a strict best reply for him, whether the route contains the edge or not. Therefore, we can de-contract all edges and get counterexamples to uniqueness property for subgraphs of 
                                 
                                    G
                                    +
                                    H
                                 
                              . As noted above, it allows to conclude that 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               does not have the uniqueness property.□

Note that Proposition 5 remains valid if we restrict the set of cost functions, as soon as this set is a cone. Indeed, we need to choose both functions sufficiently small and functions with prohibitive high costs.

Since the construction of Section 5.3.1 provides strict equilibria, we get the following corollary.
                           Corollary 2
                           
                              Any mixed graph containing one of the graphs of 
                              
                                 Fig. 10 
                              as a minor does not have the uniqueness property.
                           

Let us now give an example using some of these conditions. According to Corollary 2 or to the “bridge-contraction” condition above, the mixed graph of the Fig. 7
                         does not have the uniqueness property. Indeed, a ring with an arc in three routes is a minor of it. We can conclude that any network having the mixed graph of the Fig. 7 as a subgraph (or as a minor) does not have the uniqueness property.

However, there are still graphs for which none of the considerations above allows to conclude, see for example the graph of Fig. 8
                        .

We assume in this work that each edge in the graph can be traversed in both directions. When the supply graph is a cycle, this condition is not restrictive, since allowing one-way edges is equivalent to consider a game with fewer OD-pairs and modified cost functions. Indeed, if we delete for example an arc a, every user whose OD-pair has a route going through a has no choice and has to take the route in the other direction. Hence we can remove all such users and the associated OD-pairs, and modify the cost functions by adding the (fixed) congestion due to them.

Another way to extend the model is to add restrictions on the cost functions. As already noted in the Introduction, Altman and Kameda (2001) have shown that if the cost functions are equal for each user up to an additive constant, then the uniqueness property holds for every graph. We can try to extend this set of cost functions. The construction of Section 5.3.1 is made with affine cost functions, and can be extended with strictly convex cost functions, by adding 
                           
                              ε
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         at each cost functions, for 
                           
                              ε
                           
                         small enough. Using Proposition 5 or Remark 2, we can build two different equilibria with affine or strictly convex cost functions for any mixed graph having one of the graphs of Fig. 10 as a minor. Then, to ensure the uniqueness property for a larger class of graphs, we have to exclude both affine and strictly convex functions from the set of possible cost functions.

Let us assume that we have a finite set K of classes. We denote by 
                           
                              
                                 
                                    I
                                 
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                           
                         the set of class k users in 
                           
                              
                                 
                                    I
                                 
                                 
                                    ℓ
                                 
                              
                           
                         and we assume that all 
                           
                              
                                 
                                    I
                                 
                                 
                                    ℓ
                                 
                                 
                                    k
                                 
                              
                           
                         are measurable.

Let 
                           
                              σ
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         be two Nash equilibria. We define for an 
                           
                              ℓ
                              ∈
                              L
                           
                        , a class k, and an arc a the quantity
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ℓ
                                       ,
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 λ
                                 {
                                 i
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       ℓ
                                    
                                    
                                       k
                                    
                                 
                                 :
                                 
                                 a
                                 ∈
                                 σ
                                 (
                                 i
                                 )
                                 }
                                 ,
                              
                           
                        and
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ℓ
                                       ,
                                       a
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 λ
                                 
                                    
                                       
                                          i
                                          ∈
                                          
                                             
                                                I
                                             
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                          :
                                          
                                          a
                                          ∈
                                          
                                             
                                                σ
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        Following Milchtaich (2005), we say that the two equilibria are equivalent if not only the flow on each arc is the same but the contribution of each pair and each class to the flow on each arc is the same, i.e. 
                           
                              
                                 
                                    f
                                 
                                 
                                    ℓ
                                    ,
                                    a
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ℓ
                                    ,
                                    a
                                 
                                 
                                    k
                                 
                              
                           
                         for any arc a, OD-pair 
                           
                              ℓ
                           
                        , and class k. Milchtaich proved that a two-terminal network has the uniqueness property if and only if every two Nash equilibria are equivalent for generically all cost functions (Theorem 5.1 in Milchtaich (2005)). A property is considered generic if it holds on an open dense set. “Open” and “dense” are understood according to the following metric on the cost functions.

Define the set 
                           
                              G
                           
                         of assignments of continuous and strictly increasing cost functions 
                           
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    a
                                    ∈
                                    A
                                    ,
                                    i
                                    ∈
                                    I
                                 
                              
                           
                        , with 
                           
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              :
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         such that 
                           
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         whenever i and 
                           
                              
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         belong to the same class.

Given a particular element of 
                           
                              G
                           
                        , the function 
                           
                              i
                              
                              ↦
                              
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                           
                         is measurable for all 
                           
                              a
                              ∈
                              A
                           
                         and 
                           
                              x
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                        . Every element of 
                           
                              G
                           
                         has therefore a nonempty set of Nash equilibria. Note that the set 
                           
                              G
                           
                         depends on the partition of the population in classes. We can define the distance between two elements 
                           
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    a
                                    ∈
                                    A
                                    ,
                                    i
                                    ∈
                                    I
                                 
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    a
                                    ∈
                                    A
                                    ,
                                    i
                                    ∈
                                    I
                                 
                              
                           
                         of 
                           
                              G
                           
                         by 
                           
                              max
                              |
                              
                                 
                                    c
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              -
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              |
                           
                        , where the maximum is taken over all 
                           
                              a
                              ∈
                              A
                              ,
                              i
                              ∈
                              I
                           
                         and 
                           
                              x
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                        . This defines a metric for 
                           
                              G
                           
                        .
                           Theorem 2
                           
                              Assume that the supply graph G is a cycle. Then, for any demand digraph H, the following assertions are equivalent:
                              
                                 
                                    (i)
                                    
                                       
                                          
                                             (
                                             G
                                             ,
                                             H
                                             )
                                          
                                        
                                       has the uniqueness property.
                                    


                                       For every partition of the population into classes, there is an open dense set in 
                                       
                                          
                                             G
                                          
                                        
                                       such that for any assignment of cost functions that belongs to this set, every two equilibria are equivalent.
                                    

Up to slight adaptations, the proof is the same as the one of Theorem 5.1 in Milchtaich (2005).

If (i) does not hold, we can use the construction of Section 5.3 to build two distinct equilibria for an assignment in 
                                 
                                    G
                                 
                              . These equilibria are such that the gap between the costs of the two routes available to any user is uniformly bounded from below by a strictly positive number. The equilibria are said to be strict. Thus, in a ball centered on this assignment with radius 
                                 
                                    ρ
                                    >
                                    0
                                 
                               small enough, we still have two equilibria with distinct flows, which cannot be equivalent. Therefore (ii) does not hold either.

If (i) holds, three claims (Claims 1,2 of Milchtaich (2005)) lead to the desired conclusion, namely that (ii) holds. These three claims are now sketched. Their original proof does not need to be adapted, except for the second one, which is the only moment where the topology of the network is used. In our case the second claim gets a simpler proof.

For an assignment in 
                                 
                                    G
                                 
                              , we denote 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                 
                               the number of minimal-cost routes for users in 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                 
                              , which is in our case 1 or 2. Since the uniqueness property is assumed to hold, this number is fully determined by the assignment in 
                                 
                                    G
                                 
                              . Define the mean number of minimal-cost routes by
                                 
                                    
                                       ϕ
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                K
                                                ,
                                                ℓ
                                                ∈
                                                L
                                             
                                          
                                       
                                       λ
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             ℓ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             ϕ
                                          
                                          
                                             ℓ
                                          
                                          
                                             k
                                          
                                       
                                       .
                                    
                                 
                              
                           

The first claim states that the map by 
                                 
                                    ϕ
                                    :
                                    G
                                    →
                                    R
                                 
                               is upper semicontinuous and has finite range.

The second claim states that for every assignment of cost functions in 
                                 
                                    G
                                 
                               that is a point of continuity of 
                                 
                                    ϕ
                                 
                              , all Nash equilibria are equivalent. To prove this second claim, we consider two Nash equilibria assumed to be nonequivalent 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              . Using these two equilibria, a new one is built, 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              , such that for some 
                                 
                                    ℓ
                                    ∈
                                    L
                                 
                              , some class k and some 
                                 
                                    ℓ
                                 
                              -route 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                               we have 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ℓ
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    >
                                    0
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    >
                                    0
                                 
                              , but 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ℓ
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    0
                                 
                              . As the two 
                                 
                                    ℓ
                                 
                              -routes do not share any arc (Claim 1 of Section 5.1), we have 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ℓ
                                          ,
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    >
                                    0
                                    ,
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ℓ
                                          ,
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    >
                                    0
                                 
                              , and 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ℓ
                                          ,
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    0
                                 
                               for any a in 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              .

The second claim is achieved by choosing any 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                 
                               in 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                               and by adding a small value 
                                 
                                    δ
                                    >
                                    0
                                 
                               to the cost function 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                               for 
                                 
                                    i
                                    ∈
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                 
                              , while keeping the others unchanged. It can be checked that for 
                                 
                                    δ
                                 
                               small enough, the set of minimal-cost routes is the same as for 
                                 
                                    δ
                                    =
                                    0
                                 
                              , minus the route 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                               for users in 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                 
                              . The map 
                                 
                                    ϕ
                                 
                               has therefore a discontinuity of at least 
                                 
                                    λ
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          ℓ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                               at the original assignment of cost functions.

Finally, the third claim allows to conclude: in every metric space, the set of all points of continuity of a real-valued upper semicontinuous function with finite range is open and dense.□

A supply graph is said to have the strong uniqueness property if for any choice of the OD-pairs, the uniqueness property holds. In other words, 
                           
                              G
                              =
                              (
                              V
                              ,
                              E
                              )
                           
                         has the strong uniqueness property if, for any digraph 
                           
                              H
                              =
                              (
                              T
                              ,
                              L
                              )
                           
                         with 
                           
                              T
                              ⊆
                              V
                           
                        , the pair 
                           
                              (
                              G
                              ,
                              H
                              )
                           
                         has the uniqueness property.
                           Theorem 3
                           A graph has the strong uniqueness property if and only if no cycle is of length 3 or more.

Alternatively, this theorem states that a graph has the strong uniqueness property if and only it is obtained by taking a forest (a graph without cycles) and by replacing some edges by parallel edges.

Before proving this theorem, let us state a preliminary result allowing to extend the strong uniqueness property whenever one “glues” together two supply graphs on a vertex. This latter operation is called a 1-sum in the usual terminology of graphs.
                           Lemma 2
                           
                              The 1-sum operation preserves the strong uniqueness property.
                           

Let 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               be two graphs, and let 
                                 
                                    H
                                    =
                                    (
                                    T
                                    ,
                                    L
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          L
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               two directed graphs with 
                                 
                                    T
                                    ⊆
                                    V
                                 
                               and 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ⊆
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                 
                              , such that 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               have the uniqueness property. Assume that 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               and 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               have a unique common vertex v, i.e. 
                                 
                                    V
                                    ∩
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    T
                                    ∩
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    {
                                    v
                                    }
                                 
                              , and define 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ″
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                               as the 1-sum of them: 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    (
                                    V
                                    ∪
                                    
                                       
                                          V
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    E
                                    ∪
                                    
                                       
                                          E
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ″
                                       
                                    
                                    =
                                    (
                                    T
                                    ∪
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    L
                                    ∪
                                    
                                       
                                          L
                                       
                                       
                                          ′
                                       
                                    
                                    ∪
                                    
                                       
                                          L
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                               with 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          ″
                                       
                                    
                                    ≔
                                    {
                                    (
                                    u
                                    ,
                                    w
                                    )
                                    :
                                    
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    ∈
                                    L
                                    and
                                    (
                                    v
                                    ,
                                    w
                                    )
                                    ∈
                                    
                                       
                                          L
                                       
                                       
                                          ′
                                       
                                    
                                    }
                                 
                              .

Assume that we have an equilibrium on 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ″
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                               for some cost functions and some partition 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                (
                                                o
                                                ,
                                                d
                                                )
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          o
                                          ,
                                          d
                                          )
                                          ∈
                                          L
                                          ∪
                                          
                                             
                                                L
                                             
                                             
                                                ′
                                             
                                          
                                          ∪
                                          
                                             
                                                L
                                             
                                             
                                                ″
                                             
                                          
                                       
                                    
                                 
                               of the population. The restriction of this equilibrium on 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               is an equilibrium for 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               with the same cost functions and with a partition of the population obtained as follows.

When o and d are both in H, we keep the same 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          (
                                          o
                                          ,
                                          d
                                          )
                                       
                                    
                                 
                              . Moreover, we complete this collection of subsets. For each vertex o of H, we define 
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          (
                                          o
                                          ,
                                          v
                                          )
                                       
                                    
                                 
                               to be the union of all 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          (
                                          o
                                          ,
                                          w
                                          )
                                       
                                    
                                 
                               with w a vertex of 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . For each vertex d of H, we define 
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          (
                                          v
                                          ,
                                          d
                                          )
                                       
                                    
                                 
                               to be the union of all 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          (
                                          w
                                          ,
                                          d
                                          )
                                       
                                    
                                 
                               with w a vertex of 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We get the partition of the population I we are looking for. The restriction of the equilibrium on 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               is an equilibrium since for each user, the restriction of a minimum cost route of 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ″
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                               is a minimum cost route of 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                              .

The same property holds for 
                                 
                                    (
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          H
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . Therefore, if we had two equilibria inducing two distinct flows on some arc a of the directed version of 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ″
                                       
                                    
                                 
                              , we would get equilibria inducing two distinct flows on the arc a, which is in the directed version of G or 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . It is in contradiction with the assumption on G and 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .□

Suppose that there is a cycle C of length 3 in G with vertices 
                                 
                                    u
                                    ,
                                    v
                                 
                              , and w. Define H as the digraph with arcs 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    ,
                                    (
                                    u
                                    ,
                                    w
                                    )
                                 
                              , and 
                                 
                                    (
                                    v
                                    ,
                                    w
                                    )
                                 
                              . The mixed graph 
                                 
                                    C
                                    +
                                    H
                                 
                               is then the top left one of Fig. 10. Corollary 2 implies that 
                                 
                                    (
                                    G
                                    ,
                                    H
                                    )
                                 
                               does not have the uniqueness property, and thus that G does not have the strong uniqueness property.

Conversely, suppose that there is no cycle of length 3 or more. The graph G can then be obtained by successive 1-sums of a graph made of two vertices and parallel edges. Since a graph with two vertices and parallel edges has the uniqueness property for any demand digraph (see Konishi (2004) or Milchtaich (2005)), we can conclude with Lemma 2 that G has the strong uniqueness property.□

When exhibiting multiple equilibrium flows in the proof of Theorem 1, we need to define three classes. The same remark holds for the characterization of the two-terminal networks having the uniqueness property in the article by Milchtaich (2005): all cases of non-uniqueness are built with three classes. We may wonder whether there are also multiple equilibrium flows with only two classes of users. The answer is yes as shown by the following examples. The first example is in the framework of the ring network; according to Theorem 1, such an example requires at least three OD-pairs. Since it will contain exactly three OD-pairs, it is in a sense a minimum example for ring network. The second example involves a two-terminal network – 
                           
                              
                                 
                                    K
                                 
                                 
                                    4
                                 
                              
                           
                        , the complete graph on four vertices – as in Bhaskar, Fleischer, Hoy, and Huang (2009). They used it in order to answer a question by Cominetti, Correa, and Stier-Moses (2009) about the uniqueness of equilibrium in atomic player routing games. However, their cost functions do not suit our framework and we design specific ones.

Consider the graph on top on the left of Fig. 10. Define the two classes 1 and 2, with the following population measures.
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                       
                                          ℓ∈
                                             L
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   w
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   w
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          0
                                          1.5
                                          0
                                       
                                       
                                          
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          1
                                          0
                                          1
                                       
                                    
                                 
                              
                           
                        

Cost functions are:
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          Arc
                                          (u,
                                             w)
                                          (w,
                                             v)
                                          (v,
                                             u)
                                          (w,
                                             u)
                                          (u,
                                             v)
                                          (v,
                                             w)
                                       
                                    
                                    
                                       
                                          Class 1
                                          
                                             x
                                          
                                          
                                             x + 48
                                          
                                          
                                          24x + 7
                                          
                                       
                                       
                                          Class 2
                                          22x
                                          
                                          22x
                                          
                                          
                                          
                                             x
                                          
                                          
                                             x + 26
                                          
                                             x
                                          
                                       
                                    
                                 
                              
                           
                        

For a given class, arcs not used in any route lead to blanks in this table.

We define the strategy profile 
                              
                                 σ
                              
                            (resp. 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           ) such that all users of the class 1 select a negative (resp. positive) route and all users of the class 2 select a positive (resp. negative) route. We get the following (distinct) flows.
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          Arc a
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   w
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   w
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   w
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   w
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          1
                                          1
                                          0
                                          0
                                          1.5
                                          0
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          1.5
                                          1.5
                                          0
                                          1
                                          2
                                          1
                                       
                                    
                                 
                              
                           
                        

We check that 
                              
                                 σ
                              
                            is an equilibrium.

For users in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    
                                       1
                                    
                                 
                              
                           , the cost of the positive route is 50 and of the negative 43. For users in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       u
                                       ,
                                       w
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            and in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       w
                                       ,
                                       v
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           , the cost of the positive route is 22 and of the negative 
                              
                                 27.5
                              
                           . No user is incited to change its route choice.

We check that 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            is an equilibrium.

For users in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    
                                       1
                                    
                                 
                              
                           , the cost of the positive route is 51 and of the negative 55. For users in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       u
                                       ,
                                       w
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                            and in 
                              
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       w
                                       ,
                                       v
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           , the cost of the positive route is 33 and of the negative 29. No user is incited to change its route choice.
                              Remark 3
                              Actually, when we specialize the construction of Section 5.3 to the graph on top on the left of Fig. 10, we can merge classes 2 and 3 in a unique class 2 leading to the example above. More generally, using the symmetry of the cost functions for class 2 and class 3 users, we can merge the two classes for any graph such that 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             {
                                             1
                                             ,
                                             2
                                             }
                                          
                                          
                                             ε
                                          
                                       
                                       
                                       ≠
                                       
                                       ∅
                                    
                                  and 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             {
                                             1
                                             ,
                                             3
                                             }
                                          
                                          
                                             ε
                                          
                                       
                                       
                                       ≠
                                       
                                       ∅
                                    
                                 , with 
                                    
                                       ε
                                       ∈
                                       {
                                       -
                                       ,
                                       +
                                       }
                                    
                                  in order to get other ring examples with two classes and multiple equilibrium flows.

Consider the two-terminal network 
                              
                                 
                                    
                                       K
                                    
                                    
                                       4
                                    
                                 
                              
                            of Fig. 9
                           .

Suppose that we have two classes of users 
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                              
                           , with 
                              
                                 λ
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 3
                              
                            and 
                              
                                 λ
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 4
                              
                           , with the following cost functions on each arc, where “
                              
                                 ∞
                              
                           ” means a prohibitively high cost function.
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          Arc
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                       
                                    
                                    
                                       
                                          Class 1
                                          
                                             x
                                          
                                          “
                                                
                                                   ∞
                                                
                                             ”
                                          
                                             x
                                             +18
                                          “
                                                
                                                   ∞
                                                
                                             ”
                                          “
                                                
                                                   ∞
                                                
                                             ”
                                          
                                             x
                                          
                                          7x
                                          
                                          
                                       
                                       
                                          Class 2
                                          5x
                                          
                                          
                                             x
                                          
                                          “
                                                
                                                   ∞
                                                
                                             ”
                                          “
                                                
                                                   ∞
                                                
                                             ”
                                          
                                             x
                                          
                                          5x
                                          
                                          
                                             x
                                             +10
                                          
                                       
                                    
                                 
                              
                           
                        

Users of class 1 have only the choice between the two routes ouvd and od, while users of class 2 can choose between the three routes 
                              
                                 oud
                                 ,
                                 ovd
                              
                           , and od.

The strategy profile 
                              
                                 σ
                              
                            is defined such that all class 1 users select the route ouvd and all class 2 users select the route od.

The strategy profile 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            is defined such that all class 1 users select the route od, half of class 2 users select the route oud, and the other half select the route ovd. We get the following (distinct) flows.
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          Arc a
                                          
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   v
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   o
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          3
                                          0
                                          3
                                          0
                                          0
                                          3
                                          4
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          2
                                          2
                                          0
                                          0
                                          2
                                          2
                                          3
                                       
                                    
                                 
                              
                           
                        

We check that 
                              
                                 σ
                              
                            is an equilibrium.

For users of the class 1, the cost of ouvd is 27, and the cost of od is 28. For users of the class 2, the cost of oud is 15, the cost of ovd is 15, and the cost of od is 14. No user is incited to change its route choice.

We check that 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            is an equilibrium.

For users of the class 1, the cost of ouvd is 22, and the cost of od is 21. For users of the class 2, the cost of oud is 12, the cost of ovd is 12, and the cost of od is 13. No user is incited to change its route choice.

@&#ACKNOWLEDGEMENT@&#

We thank the anonymous referees for their useful comments.

See Fig. 10
                     .

@&#REFERENCES@&#

