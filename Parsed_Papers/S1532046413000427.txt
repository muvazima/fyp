@&#MAIN-TITLE@&#EXpectation Propagation LOgistic REgRession (EXPLORER): Distributed privacy-preserving online model learning

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           EXPLORER handles learning from distributed sources without sharing raw data.


                        
                        
                           
                           EXPLORER allows client sites dynamically shift from online to offline modes.


                        
                        
                           
                           EXPLORER offers online learning capability for efficient model update.


                        
                        
                           
                           EXPLORER provides high estimation accuracy and strong privacy protection.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clinical information systems

Decision support systems

Distributed privacy-preserving modeling

Logistic regression

Expectation propagation

@&#ABSTRACT@&#


               
               
                  We developed an EXpectation Propagation LOgistic REgRession (EXPLORER) model for distributed privacy-preserving online learning. The proposed framework provides a high level guarantee for protecting sensitive information, since the information exchanged between the server and the client is the encrypted posterior distribution of coefficients. Through experimental results, EXPLORER shows the same performance (e.g., discrimination, calibration, feature selection, etc.) as the traditional frequentist logistic regression model, but provides more flexibility in model updating. That is, EXPLORER can be updated one point at a time rather than having to retrain the entire data set when new observations are recorded. The proposed EXPLORER supports asynchronized communication, which relieves the participants from coordinating with one another, and prevents service breakdown from the absence of participants or interrupted communications.
               
            

@&#INTRODUCTION@&#

Frequentist logistic regression [1] has a long and successful history of useful applications in biomedicine, including various decision support applications, e.g., anomaly detection [2] survival analysis [3], and early diagnosis of myocardial infarction [4]. Despite its simplicity and interpretability, the frequentist logistic regression approach has limitations. It requires training data to be combined in a centralized repository and cannot directly handle distributed data (the scenario in many biomedical applications [5]). It has been shown in last decade that data privacy cannot be maintained by simply removing patient identities. For example, Sweeney showed that a simple combination of [date of birth, sex, and 5-digit zip code] was sufficient to uniquely identify over 87% of US citizens [6]. Due to privacy concerns, training data in one institute cannot be exchanged or shared with other institutes directly for the purposes of global model learning. To address such a challenge, many privacy-preserving models have been studied [7–10]. Among the most popular ones, privacy-preserving methods based on secure multiparty computing (SMC) [11–15] (i.e., building accurate predictive models without sharing raw data) do not change the results and seem practical compared to solutions based on data generalization and perturbation [16–19] that change results.

For distributed model learning with multiple sites, a common scenario is that each site has a subset of records with the same fields, which is usually referred to as horizontally partitioned data. In this paper, we focus on the horizontally partitioned data for distributed logistic regression learning in Bayesian paradigm. During the past decade, numerous privacy-preserving/secure distributed frequentist regression models for horizontally partitioned data [20–26] have been studied. For example, the DataSHIELD framework [20] provides a secure multi-site regression solution without sacrificing the model learning accuracy. However, in the above multi-site regression frameworks, the information matrix and score vector exchanged among multiple sites may result in information leakage during each learning iteration [27,28]. To mitigate privacy and security risks, Karr and Fienberg et al. studied numerous SMC based distributed regression model [21–25]. Unfortunately, as mentioned by El Emam et al. in [26], aforementioned approaches can still potentially leak sensitive personal information. Therefore, the authors [26] proposed a secure distributed logistic regression protocol to offer stronger privacy/security protection. The computational complexity of the above protocol grows exponentially with the increase of site number.

The closest work for the method presented here is the Grid LOgistic REgression (GLORE) model [29] and the Secure Pooled Analysis acRoss K-site (SPARK) protocol [26], which train frequentist logistic regression model in a distributed, privacy-preserving manner. GLORE leverages non-sensitive decomposable intermediary results (i.e., calculated at an individual participating site) to build an accurate global model. However, as GLORE does not use any SMC protocol, there is no provable privacy guarantee. SPARK protocol uses secure building block (e.g., secure matrix operation, etc.) to develop a secure distributed logistic regression protocol. However, SPARK will not scale well for a large distributed network, as its complexity grows exponentially with the network size. Both GLORE and SPARK require synchronized communication among participants (i.e., all parties had to be simultaneously online for multiple iterations of training until convergence). Additionally, the frequentist logistic regression approach is inefficient in learning data that are frequently being updated, because the model needs to be completely retrained when they receive any additional observations.

We propose a Bayesian alternative for the distributed frequentist logistic regression model, which we call EXpectation Propagation LOgistic REgRession (EXPLORER). EXPLORER offers distributed privacy-preserving online model learning. The Bayesian logistic regression model was described previously by Ambrose et al. [30], who compared it with the frequentist logistic regression model in terms of performance. Marjerison also discussed Bayesian logistic regression [31] and suggested a Gibbs sampling based optimization, which unfortunately is very time-consuming operation. However, both papers assumed a centralized computation environment, and privacy was not taken into consideration. In comparison, EXPLORER focuses on privacy preservation and it is based on an efficient state-of-the-art inference technique (i.e., expectation propagation [32]). To the best of our knowledge, EXPLORER is the first paper addressing distributed logistic regression in the Bayesian setting. EXPLORER handles some shortcomings of the frequentist logistic regression approach and other frequentist SMC models, as illustrated in Table 1
                     .

The major contributions of this paper are as follows: we propose a Bayesian approach for logistic regression that takes the privacy issue into account. Just like GLORE and SPARK, the EXPLORER model learns from distributed sources, and it does not require access to raw patient data. In addition, it provides online learning capability to avoid the need for training on the entire database when a single record is updated. Furthermore, EXPLORER supports asynchronous communication so that participants do not have to coordinate one another. This prevents service breakdowns that result from absence of participants or communication interruptions. Finally, we introduced Secured Intermediate iNformation Exchange (SINE) protocol to enhance the security of the proposed EXPLORER framework, in order to further reduce the risk of information leak during the exchange of unprotected aggregated statistics. The proposed SINE protocol offers provable security and light-weighted computation overhead to ensure the scalability of the EXPLORER framework.

@&#METHODOLOGY@&#

We start with a quick review of the logistic regression (LR) model. Assume a training dataset D
                     ={(x
                     1,
                     y
                     1),(x
                     2,
                     y
                     2),…,(x
                     
                        m
                     ,
                     y
                     
                        m
                     )}, where y
                     
                        i
                     
                     ∈{0,1} and x
                     
                        i
                      are the binary label and the feature vector of each record, respectively, with i
                     =1,…,
                     m. We denote by Y
                     ={y
                     1,…, 
                     y
                     
                        m
                     } the set of binary labels. The posterior probability of a binary event (i.e., class label) y
                     
                        i
                     
                     =1 given observation of a feature vector x
                     
                        i
                      can be expressed as a logistic function acting on a linear function 
                        β
                     
                     
                        T
                     
                     x
                     
                        i
                      so that
                        
                           (1)
                           
                              P
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              |
                              β
                              )
                              =
                              π
                              (
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          -
                                          
                                             
                                                β
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where the parameter vector 
                        β
                      corresponds to the set of coefficients that need to be estimated and that will be multiplied by the feature vector x
                     
                        i
                      (i.e., 
                        β
                     
                     
                        T
                     
                     x
                     
                        i
                     ) to make predictions. In this paper, we drop the feature vector x
                     
                        i
                      from the likelihood function and denote P(y
                     
                        i
                     
                     =1∣x
                     
                        i
                     , 
                        β
                     ) as P(y
                     
                        i
                     
                     =1∣
                        β
                     ) to allow a more compact notation.

To estimate 
                        β
                      from training datasets, existing learning algorithms can be categorized into two classes, Maximum Likelihood (ML) estimation and Maximum a Posterior (MAP) estimation. The procedures of estimating model coefficients through ML and MAP estimators are elaborated in Supplementary materials – Sections S3 and S4. In this paper, we focus on the MAP estimation for the proposed EXPLORER framework.

In this section, we introduce the EXPLORER framework based on a factor graph, which enables the independent inter-site update of all the participating sites without performance loss. In a nutshell, a factor graph is a bipartite graph (see Supplementary materials – Sections S1 and S2) that comprises two different kinds of nodes (i.e., a factor node (square) and a variable node (circle)). In a factor graph, each edge must connect a factor node and a variable node. The joint probability over all variables can be expressed as products of some factor functions in which each contains only a subset of all variables as arguments and is represented by a factor node. Each variable node expresses a random variable. EXPLORER requires two phases: initially the updates on coefficients must be made on each site (i.e., intra-site update), and then updated across sites (i.e., inter-site update).

Although we are interested in the distributed online model learning, let us first explain how each participating site updates its own posterior distribution (i.e., intra-site update). In general, the posterior probability of the jth site with j
                        =1,2,…,
                        n can be expressed as
                           
                              (2)
                              
                                 p
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 Y
                                 )
                                 =
                                 
                                    
                                       p
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       p
                                       (
                                       Y
                                       |
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       p
                                       (
                                       Y
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       Z
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                       
                                       →
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                j
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                              
                           
                        where we introduce 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    →
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         to capture the prior probability and the likelihood function, respectively. Moreover, m
                        
                           j
                         is the total number of records in the first j sites with m
                        0
                        =0. However, the direct evaluation of the above posterior is mathematically intractable, thus we need to resort to the expectation propagation (EP) algorithm, a deterministic approximate inference method. In the proposed EXPLORER framework, we introduce an approximate function 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         representing a normal distribution for each true likelihood function 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . Therefore, the approximate posterior distribution can be expressed as
                           
                              (3)
                              
                                 q
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       Z
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                       
                                       →
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                j
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 .
                              
                           
                        Based on the above factorization, we first introduce a variable node B
                        
                           j
                         (i.e., site header) to capture the approximate posterior distribution q(
                           β
                        
                        
                           j
                        ). We introduce extra factor nodes h
                        
                           j
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           
                         to capture the prior probability and the likelihood function (see Fig. 1
                        ), respectively. The update of the approximate likelihood function 
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         relies on the factor graph based-EP algorithm (see Appendix A for details).

The details of intra-site update rules in EXPLORER are listed in Algorithm 1(A1). Since we are using the Normal distribution as our approximate distribution, messages exchanged between the factor nodes and the variable nodes can be parameterized by the mean vector and its covariance matrix. The intra-site update starts from the initialization step (A1: line 1), where all the messages are initialized as uniform distributions with zero mean and infinite variance for a new model learning task. However, for an online learning task with previous results, we need to initialize the messages using their previous status. The approximate posterior is initialized as the product of prior and all the approximate likelihood functions. We can iteratively update the approximate posterior distribution of each site until it converges through A1 from lines 2–7. The key idea of EP is to sequentially update the approximate posterior distribution q
                        
                           i
                        (
                           β
                        
                        
                           j
                        ) by incorporating a single true likelihood function 
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         as shown in line 5. For more details about EP-based LR, please refer to Appendix A.
                           Algorithm 1
                           Intra-site Posterior update in EXPLORER 
                                 
                                    
                                       
                                       
                                          
                                             1: Initialize: each approximate likelihood function 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                 and approximate posterior 
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            →
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            i
                                                            =
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                                  -
                                                                  1
                                                               
                                                            
                                                            +
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             2: Repeat
                                             
                                          
                                          
                                             3: for all records i
                                                =
                                                m
                                                
                                                   j−1
                                                +1,…,
                                                
                                                m
                                                
                                                   j
                                                 do
                                          
                                          
                                             4: 
                                                Get partial posterior function q
                                                ⧹i
                                                (
                                                   β
                                                
                                                
                                                   j
                                                ) by removing the approximate factor 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                 from the approximate posterior:
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ⧹
                                                            i
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      q
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      /
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             5:
                                                Update q(
                                                   β
                                                
                                                
                                                   j
                                                ) by incorporating a single true likelihood function 
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                 according to Assumed Density Filtering (ADF) [33]:
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                   
                                                      q
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      Proj
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           Z
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     ⧹
                                                                     i
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               )
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               (
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             6:
                                                Set the approximate factor: 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            q
                                                            (
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             7: end for
                                          
                                          
                                             8:
                                                Until parameters converge
                                             
                                          
                                       
                                    
                                 
                              
                           

To achieve asynchronous inter-site update (see Fig. 1), we introduce an additional variable node B (i.e., server node) to capture the global posterior probability learnt from all sites. Then, we connect each factor node h
                        
                           j
                         with the server variable node B for exchanging messages among sites. We assume that all sites share the same prior information, which is captured by the factor node g
                        0. The inter-site update of each approximate posterior q
                        
                           j
                        (
                           β
                        
                        
                           j
                        ) relies on a powerful message passing algorithm (i.e., belief propagation (BP)), which has been widely used in Bayesian inference on factor graphs (see Appendix B for details). Based on this framework, we can update sites in an asynchronous way.
                           Algorithm 2
                           Inter-site posterior update in asynchronous EXPLORER 
                                 
                                    
                                       
                                       
                                          
                                             1: Global initialization:
                                             
                                          
                                          
                                             
                                                
                                                Initialize all the messages 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            B
                                                            →
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      β
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            →
                                                            B
                                                         
                                                      
                                                      (
                                                      β
                                                      )
                                                   
                                                 between server variable node B and clients factor nodes h
                                                
                                                   j
                                                , where the subscriptions B
                                                →
                                                h
                                                
                                                   j
                                                 and h
                                                
                                                   j
                                                
                                                →
                                                B indicate the message directions.
                                          
                                          
                                             2: Local initialization for all the online sites:
                                             
                                          
                                          
                                             3: Initialize messages 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            →
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      β
                                                      )
                                                   
                                                 and each approximate likelihood function 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                 with i
                                                =mj−1
                                                +1,…,
                                                m
                                                
                                                   j
                                                .
                                          
                                          
                                             4: Repeat:
                                             
                                          
                                          
                                             5: for all the online sites (parallel update)
                                             
                                          
                                          
                                             6: Update intra-site message: 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            →
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      ∫
                                                      δ
                                                      (
                                                      β
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            B
                                                            →
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      β
                                                      )
                                                      d
                                                      β
                                                   
                                                
                                             
                                          
                                          
                                             7: Set approximate posterior: 
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            →
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             8: Update approximate posterior q
                                                
                                                   j
                                                (
                                                   β
                                                
                                                
                                                   j
                                                ) according to Algorithm 1.
                                          
                                          
                                             9: Update intra-site messages at variable node B
                                                
                                                   j
                                                :
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               →
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         =
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         /
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               →
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             10: Upload message at factor node h
                                                
                                                   j
                                                :
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               →
                                                               B
                                                            
                                                         
                                                         (
                                                         β
                                                         )
                                                         =
                                                         ∫
                                                         δ
                                                         (
                                                         β
                                                         ,
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     B
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               →
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         d
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             11: end for
                                             
                                          
                                          
                                             12: Send out message at server node B:
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               B
                                                               →
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         β
                                                         )
                                                         =
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     g
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               →
                                                               B
                                                            
                                                         
                                                         (
                                                         β
                                                         )
                                                         
                                                            
                                                               
                                                                  ∏
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           k
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           k
                                                                           ≠
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               →
                                                               B
                                                            
                                                         
                                                         (
                                                         β
                                                         )
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             13: Until parameters converge
                                             
                                          
                                          
                                             14: Get the final approximate posterior distribution by multiplying all the incoming messages at the server node 
                                                B.
                                          
                                       
                                    
                                 
                              
                           

The details of the proposed asynchronous EXPLORER are listed in Algorithm 2 (A2). The asynchronous inter-site update starts from the global and local initialization steps (A2: line 1–2), which follow the same initialization rules as those for the intra-site update. Then, we can iteratively update the approximate posterior distribution of each site until it converges via A2 from lines 4–12. In A2 line 6, we choose delta function δ(
                           β
                        
                        
                           j
                        , 
                           β
                        ) as a factor function of the factor node h
                        
                           j
                        , which follows the suggestion in [34] for mathematical convenience (see Appendix B for details). Lines 6 and 7 show the factor node and variable node updates according to the BP algorithm. In line 8, we perform an intra-site update according to Algorithm 1. Then, in line 9, we update the message from variable node B
                        
                           j
                         to factor node h
                        
                           j
                        . Finally, factor node h
                        
                           j
                         commits its message to the server node according to line 10, where the message can be interpreted as the belief that the server node should take value 
                           β
                         from the jth site. When the server node has collected all the updates from the corresponding online sites, it can send the aggregated information back to each site as in line 12. Finally, the approximate posterior can be obtained by multiplying all the incoming messages at the server node B as in line 14. The asynchronous EXPLORER allows client sites to dynamically shift from online to offline modes as needed. The impacts of sites with different data size on convergence speed have been studied in the results section. The proposed EXPLORER framework is based on the EP algorithm, which is guaranteed to converge to a fixed point for any given dataset [32].

Feature selection is important to logistic regression analysis. In this sub-section, we introduce the distributed forward feature selection (DFFS) protocol, which is based on the traditional forward feature selection (FFS) algorithm [35], but tailored for the EXPLORER framework. To better understand DFFS protocol, let us start with a quick review of traditional FFS algorithm.

Suppose there are d candidate features (i.e., x
                        
                           all
                        
                        ={x
                        1,
                        x
                        2,…,
                        x
                        
                           d
                        }). In the first iteration, the FFS algorithm starts by taking only one feature into account at each time, so that one can find the best individual feature 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    1
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              }
                           
                         for s
                        1
                        =1,2,…,
                        d, which could result in the best classification performance. Then, in the second iteration, FFS algorithm tries to find the best subset 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    2
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              }
                           
                         in terms of classification performance, where 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         is chosen from the remaining d
                        −1 features in x
                        
                           all
                        . We repeat the aforementioned procedures, until the currently best subset 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              }
                           
                         at iteration k
                        +1 degrades the classification performance obtained through the subset 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              }
                           
                        . Finally, the 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              }
                           
                         is treated as the output of FFS algorithm. In traditional centralized regression model, the classification performance is usually measured through averaged classification accuracy using cross validation. However, in a distributed environment, it is usually infeasible to perform cross validation over distributed sites, which motivated us to develop the following DFFS protocol.

In our proposed DFFS, suppose there are n participant sites. Then, we create n EXPLORER instances at the server side with n
                        −1 participant sites in each instance in parallel, where the jth site is excluded from the jth EXPLORE instance, but it serves as the testing data for the jth EXPLORE instance. For example, given a candidate feature subset with l features, the jth EXPLORER instance can first learn a logistic regression model based on all the participant sites except the jth site. The jth EXPLORER instance can send its learnt model to the jth site to verify its classification performance. Then, the jth site can report the classification accuracy back to the server. It is worth mentioning that the information exchanged between the jth site and the server node are aggregated information. Since there are n parallel EXPLORER instances at the server side, the server can calculate an averaged classification accuracy based on the reports from each instance, which is analogous to a centralized n cross validation. The averaged classification accuracy can be used as the criteria for selecting the best 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    l
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          l
                                       
                                    
                                 
                              
                              }
                           
                         at the l DFFS iteration. Then, all the EXPLORER instances will move to the (l
                        +1)th DFFS iteration. By repeating the above procedures, we can find the best feature subset 
                           
                              
                                 
                                    x
                                 
                                 
                                    sub
                                 
                                 
                                    k
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              }
                           
                         with the maximum classification performance.

The information exchanged among all participant sites in EXPLORER framework are the posterior distribution of the model parameter 
                           β
                        , which is assumed as normal distribution and captured by the mean vector and the covariance matrix. Compared with raw data, the posterior distribution (i.e., the mean vector and the covariance matrix) only reflects the aggregated information of the raw data rather than information based on individual patients, which has already reduced the privacy risk. However, as identified by previous studies [27,28,26], aggregated information may potentially leak private information. We propose a Secured Intermediate iNformation Exchange (SINE) protocol as an optional module for further enhancing the confidentiality of the EXPLORER framework.

As we illustrated in Section 3.2, the posterior distribution of the global model parameter is calculated by multiplying all the incoming messages from n sites at the server node. In the context of Gaussian distribution, the global distribution obtained through the multiplication of all the incoming messages [36] can be captured by its mean vector 
                           μ
                         and covariance matrix V as follows,
                           
                              (4)
                              
                                 
                                    
                                       V
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 μ
                                 =
                                 V
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                              
                           
                        where V
                        
                           j
                         and 
                           μ
                        
                        
                           j
                         are the covariance matrix and the mean vector obtained from the jth site (j
                        =1,2,…,
                        n), respectively. The proposed SINE protocol is mainly based on the modified secure sum algorithm, which offers provable security guarantee [37,24].

The SINE protocol, as shown in Fig. 2
                        , begins by generating a pair of secure random matrices 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         (with size d
                        × 
                        d) and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         (with size d
                        ×1) at each participant site before the start of each learning iteration, where d is the dimension of 
                           μ
                        
                        
                           j
                        . Meanwhile, the server also generates a pair of random matrix 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                           
                         and random vector 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         with the same size as these of 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        . Then, the server sends 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         to a randomly selected site (e.g., the jth site). The jth site adds its own 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         with the received 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         and sends the summation to its neighboring site according to the standard secure sum protocol. Finally, the last site send its summation (i.e., 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        ) back to the server node. According to the secure sum protocol, the server can easily recover the summation 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        , as 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    0
                                 
                              
                           
                         were generated at the server side.

Now, for secure information exchange among client sites and server, each client site can send out the secured information 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         instead of the raw information 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        , respectively. Then, at the server side, one can easily recover the true summation 
                           
                              
                                 
                                    V
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              μ
                              =
                              V
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                        , where the aggregations of 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         are obtained in the current step and the summations of 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         are already obtained in the previous step. It is worth mentioning that unlike frequentist LR where the information matrix must be passed through all participant sites, in EXPLORER, each V
                        
                           j
                         and 
                           μ
                        
                        
                           j
                         can be updated independently by each site and aggregated at the server node, which reduces the privacy and collusion risks by avoiding the inter-site communication of sensitive information. The following is the proof of security of the proposed SINE protocol based on secure summation principle [38].


                        Proof of security of the SINE protocol. Let’s suppose r
                        
                           k,l
                         and v
                        
                           k,l
                         are two elements at the kth row and the lth column of the secure random matrix 
                           
                              
                                 
                                    R
                                 
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         and the covariance matrix 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                        , respectively. We also suppose that v
                        
                           k,l
                         is known to lie in the range [−10
                           M
                        ,10
                           M
                        ), which can be validated by selecting a significantly large number for M (e.g., M
                        =50). Then, r
                        
                           k,l
                         is a randomly selected floating number with maximum precision at 10−N
                        th digits from the range [−10
                           M
                        ,10
                           M
                        ), which means there are total 2×10
                           N+M
                         possible choices for any r
                        
                           k,l
                        . Given the summation 
                           
                              
                                 
                                    v
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                         at the attacker side, the probability to gain the original information (i.e., 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                        ) can be expressed as,
                           
                              
                                 P
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          |
                                          
                                             
                                                v
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 =
                                 P
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                             
                                                s
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                k
                                                ,
                                                l
                                             
                                          
                                       
                                    
                                 
                                 =
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       k
                                       ,
                                       l
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ×
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       (
                                       N
                                       +
                                       M
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                           
                         are the estimates of v
                        
                           k,l
                         and r
                        
                           k,l
                         at the attacker side, respectively. Moreover, since there are total d
                        2 elements in 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                        , the probability to recover the original covariance matrix can be calculated as 
                           
                              P
                              (
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    ∏
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              P
                              (
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                              
                              |
                              
                                 
                                    v
                                 
                                 
                                    k
                                    ,
                                    l
                                 
                                 
                                    s
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    N
                                    +
                                    M
                                    )
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         is the estimate of 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         at the attacker side. Then, we can always select some large numbers for both N and M (e.g., M
                        +
                        N
                        =100), such that the probability 
                           
                              P
                              (
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                                 
                                    -
                                    1
                                 
                              
                              )
                           
                         that an attacker can gain the original information is sufficiently small. □

@&#EXPERIMENTAL RESULTS@&#

We evaluated EXPLORER in 5 perspectives with 6 simulated datasets and 5 clinical datasets. Specifically, the perspectives we evaluated include: (1) distributed feature selection, (2) modeling interaction, (3) classification performance, (4) model coefficients estimation, and (5) model convergence. A summary of these 6 simulated and 5 clinical datasets [1,4,39] can be found in Table 2
                     , which includes the information of dataset description, number of covariates, number of samples and class distribution for each dataset. The rule of simulated dataset generation will be introduced within each experimental task, where we considered three different types of simulated datasets i.e., independent and identically distributed (i.i.d.) dataset [40], correlated dataset [41] and binary dataset [42]. Moreover, Table 3
                      shows the detailed descriptions of covariates in each clinical dataset used in our experiment, where numerical covariates are indicated with “*” and categorical variables are converted into binary covariates through dummy coding [43]. For example, a categorical variable with c possible values (e.g., 0, 1 and 2 for c
                     =3), in dummy coding, will be converted into c
                     −1 binary covariates (e.g., 0→(0,0), 1→(1,0) and 2→(0,1)).

In our experiment, each training dataset was created by randomly choosing 80% records from a given dataset and the corresponding testing dataset was generated through the remaining 20% records. Moreover, in order to obtain more reliable results and to be able to compare the results in a statistical way, we conducted each experimental task over 30 trials through the aforementioned method of training/testing datasets generation. Unless explicitly stated, each training dataset was evenly partitioned [29,26] among all the participant EXPLORER sites. For example, if there are m records in a given training dataset and n participant sites in a task, the sub-dataset possessed by each site is equal to 
                           
                              
                                 
                                    m
                                 
                                 
                                    n
                                 
                              
                           
                        , where we assume that m is divisible by n. In addition, for all 2-site EXPLORER setups of datasets 3–11, the difference between means (DBM) of class distribution and covariates of the 2 sites has been shown in Figs. D.6–D.14 in Appendix D, which offers an intuitive sense about how heterogeneous these sites are.

Feature selection is an important part of logistic regression analysis. In this sub-section, we studied the distributed feature selection capability of a 5-site EXPLORER setup based on a simulated dataset with 5 covariates, 500 number of records (i.e., the dataset 1 in Table 2). The simulated dataset 1 was generated by drawing samples from 5 independent normally distributed variables [44] with zero means and unit variances, where similar dataset generation strategy has been repeatedly employed in many previous studies [29,26,40]. Then, we randomly drew 4 values for the model parameter 
                           β
                         from a normal distribution with mean 0 and variance 5 as 
                           β
                        
                        =[1.7813,−2.2428,0,3.1668,0,−1.8701]
                           T
                        , where β
                        0
                        =1.7813 is the intercept, β
                        2 and β
                        4 are assigned by zeros for the purpose of studying feature selection. Finally, the outcome variable (i.e., classification label) was drawn from a normal distribution with probability of success equal to π(
                           βx
                        
                           i
                        ), where π(·) is a logistic function as show in (1) and x
                        
                           i
                         is a vector composed of a constant “1” followed by the aforementioned 5 covariates. As we are interested in the study of feature selection in this task, we treat all 500 records in the simulated dataset 1 as training data and randomly split them into 5 sub-datasets with equal sizes for all participant EXPLORER sites (i.e., 100 records per site) in each experimental trial.


                        Table 4
                         shows the feature selection results for simulated dataset 1 using Ordinary LR with FFS algorithm and EXPLORER with DFFS protocol as described in Section 3.3, where 
                           β
                        ′ and 
                           β
                        ″ are model parameters averaged over 30 trials learnt by Ordinary LR and EXPLORER, respectively, the Prob. indicates the chance of a given covariate to be selected by either FFS or DFFS algorithms during the 30 trials, and two-sample Z-tests are performed between 
                           β
                        ′ and 
                           β
                        ″. In two-sample Z-test, the null and the alternative hypotheses are “
                           β
                        ′=
                        
                           β
                        ″” and “
                           β
                        ′≠
                        
                           β
                        ″”, receptively. In Table 4, we can see both FFS algorithm and the proposed DFFS protocol achieved similar feature selection performance in terms of both qualitative and statistical comparisons, where the model parameters (i.e., β
                        1–β
                        5) used for generating outcome variable are also listed as a reference. The two-sample Z-test results show that there is no statistically significant difference between 
                           β
                        ′ and 
                           β
                        ″. Moreover, for both FFS and DFFS algorithms, the covariates with non-zero model parameters (i.e., β
                        
                           i
                        
                        ≠0 for i
                        =1,2,…,5) are fully selected over all 30 trials (i.e., Prob. equals to 1). However, for these covariates with zero model parameters (i.e., β
                        
                           i
                        
                        =0 for i
                        =1,2,…,5), the chances of selection are quite small (e.g., Prob. is less than 0.3). As we have demonstrated the DFFS capability of the proposed EXPLORER framework, in the rest of our experiments, we assume that all covariates in remaining datasets have been pre-selected.

Interaction effects in regression reflects the combined impact of variables, which is very important for understanding the relationships among the variables. In this section, we studied a 4-site EXPLORER setup with interaction based on a simulated dataset (i.e., the dataset 2 in Table 2). The simulated dataset 2 was generated by first drawing 500 samples from 3-dimension multivariate normal distribution (i.e., x
                        1, x
                        2, x
                        3) with zero means and randomly generated covariance matrix. Second, we consider the interaction between x
                        1 and x
                        2, x
                        1 and x
                        3, and x
                        2 and x
                        3. Finally, a record vector x
                        
                           i
                         can be represented as x
                        
                           i
                        
                        =[1, x
                        1, x
                        2, x
                        3, x
                        1
                        x
                        2, x
                        1
                        x
                        3, x
                        2
                        x
                        3]
                           T
                        . Moreover, we randomly drew 7 values for the model parameter 
                           β
                        
                        =[−1.2078,2.9080,0.8252,1.3790−1.0582,−0.4686,−0.2725]
                           T
                        , where β
                        0
                        =−1.2078 is the intercept. Then, the outcome variable was drawn from a normal distribution with probability of success equal to π(
                           βx
                        
                           i
                        ).

In Table 5
                        , we performed side-by-side comparisons of Hosmer–Lemeshow (H–L) Goodness-of-fit test [45] (i.e., H–L test), and AUCs between model learning with and without interaction for both Ordinary LR and EXPLORER. In an H–L test, the null and alternative hypotheses are “ the model fits the data well” and “ the model does not provide an adequate fit”, respectively. In a two-sample Z-test of AUCs, the null and alternative hypotheses are “ AUCs of Ordinary LR and EXPLORER are equal” and “AUCs of both models are unequal”, respectively. In Table 5, we can see that both EXPLORER and Ordinary LR achieve good H–L test performances. For AUCs, the two-sample Z-test results show that there is no statistically significant difference between AUCs of Ordinary LR and EXPLORER. As the simulated dataset 2 was generated with interaction, the AUCs of model with interaction outperform that of model without interaction, which demonstrated that interaction would be an important factor in some regression studies.

Since EXPLORER is proposed for distributed privacy-preserving classification, we are very interested in its classification accuracy and how well the model fits the datasets compared with Ordinary LR. In this section, the classification performances are verified over 4 simulated datasets and 4 clinical datasets for total 8 datasets. A brief summary of all aforementioned 8 datasets can be found in Table 2, and the detailed descriptions of covariates of each clinical dataset have been listed in Table 3. Besides the simulated i.i.d. and correlated datasets used in previous tasks, we also included several simulated binary datasets using binomial distribution in this task. Moreover, we carefully chose these simulated and clinical datasets to provide a wider range of class distribution, sample size and number of covariates. All the model parameters 
                           β
                        ’s for generating outcome variables are randomly sampled from the normal distributions. In this experimental task, we only considered the 2-site EXPLORER setup, where the impact of using different number of participant EXPLORER sites on the model convergence will be discussed shortly in Section 4.6.

First, the H–L test [45] was used to verify the model fit for the proposed EXPLORER. In our experiment, we perform an H–L test at a 5% significance level. Table 6
                         shows the H–L tests results (i.e., test statistic and p-value) for both EXPLORER and Ordinary LR based on aforementioned 8 datasets. There are no conspicuous differences on p-value and test statistic between EXPLORER and Ordinary LR for all 8 datasets.

Second, Table 7
                         illustrates both the qualitative and statistical comparison of AUCs between Ordinary LR and 2-site EXPLORER based on 8 datasets, where the standard deviation of AUCs are obtained over 30 trials. For qualitative comparison, we can see the maximum difference of AUCs between Ordinary LR and EXPLORER is only 0.007. Similarly, in two-sample Z-test of AUCs between Ordinary LR and EXPLORER, no statistically significant differences have been observed.

From results above, we demonstrated that the proposed EXPLORER can achieve similar classification and model fit performance when compared with the Ordinary LR model. However, in biomedical research, another important aspect of LR is the interpretability of the estimated coefficients 
                           β
                        , where the linear function 
                           β
                        
                        
                           T
                        
                        x
                        
                           i
                         can be interoperated as the log odds ratios of a binary event y
                        
                           i
                        
                        =1. Thus, it is also very important to verify that estimated coefficients using the proposed EXPLORER are compatible with those of Ordinary LR.


                        Tables 8–11
                        
                        
                        
                         compare the estimated model coefficients 
                           β
                        , their standard deviation over 30 trials, two-sample Z-test of these estimated coefficients between the Ordinary LR and 2-site EXPLORER on simulated datasets 3–6. The same results for clinical datasets 7–10 can be found in Appendix C through Tables C.13–C.16. The results shown in Tables 8–11 and Tables C.13–C.16 further confirm that EXPLORER and Ordinary LR are compatible.

In this section, we focus on the study of convergence for the inter-site update. Although, as shown in [32], the EP algorithm can always converge to a fixed point, we wanted to verify through experimental results that the convergence accuracy of EXPLORER does not depend on the data order or on the number of participating sites. Table 12
                         shows the two-sample Z-tests of estimated coefficients between 2- and 4-site, 2- and 6-site, and 2- and 8-site EXPLORER setups, respectively, where the dataset partitioning strategies can been found in Section 4.1. We can see that there is no difference in terms of the statistical comparison of estimated coefficients among different settings.

We analyzed the convergence speed of asynchronous n-site EXPLORER with n
                        =2,3,…,8 using Edinburgh dataset. Fig. 3
                         depicted the convergence of all 11 coefficients based on an 8-site setup. In Fig. 3, we can see that the convergence speeds for all 11 coefficients and all 8 participant sites are very fast, although the initial coefficients from different sites are quite different. Usually, within 4 or 5 iterations, all the coefficients will converge to their fixed points. To reach a tolerance of Mean Squared Error (MSE) level of 10−8, EXPLORER takes 9 iterations on average, where the MSE of each inter-site update is calculated using the estimated coefficients after each inter-site update in the asynchronous EXPLORER phase and their converged values.

We also studied the impact of evenly partitioned dataset sizes on the convergence speed. Fig. 4
                         shows the convergence speed of an evenly partitioned Edinburgh dataset with n
                        =2–8, where each participant site has approximately 1128/n randomly partitioned records. Fig. 4a and b shows that the MSE decays very fast, and it is less than 10−4 within 3 iterations. These results, especially Fig. 4b, also illustrate that the MSEs for each site at the 1st iteration are mainly data-driven. Fig. 4c illustrates the MSE of each site after the 1st iteration update for n-site setups with n
                        =2,3,…,8 in box plots. As the total number of records in our experimental dataset is fixed, the amount of data that each site holds is inversely proportional to number of involved sites. In Fig. 4c, we can see the larger amount of data that each site holds, the smaller the divergence of the estimated coefficients among different sites.

Finally, we studied the impact of unevenly partitioned Edinburgh dataset on the convergence speed. As shown in Fig. 5
                        a–c, we randomly selected 500, 750 and 1000 records for the first site, respectively. The remaining n
                        −1 sites shared the rest of the records evenly. Fig. 5a–c shows, as expected, that the MSE of the first site decreases as the number of records it holds increases. As the number of records in the first site reaches 1000, the MSE drops from 2.5 to less than 10−2 within 1 iteration update. Please note that in our asynchronous EXPLORER, the inter-site information exchange starts at the 2nd iteration. This observation illustrates how the online learning works, where the model learnt from a large dataset can be used to improve the model learnt from a relatively smaller dataset. For example, in Fig. 5c, the models from site 2, 3, 4 learnt at the first iteration have been significantly improved at the second iteration with the information obtained from the site 1, where their MSE reduced from 100 to 10−4. However, the improvement of site 1 resulting from other sites is small, as its MSE reduction is only from the order of 10−2–10−4. The complexity analysis can be found in Supplementary materials – Section S5.

There is currently great interest in sharing healthcare and biomedical research data to expedite discoveries that improve quality of care [46–49,29,50,51]. Unfortunately, healthcare institutions cannot share their data easily due to government regulations and privacy concerns. In this paper, we investigated an EXpectation Propagation LOgistic REgRession (EXPLORER) model for distributed privacy-preserving online learning. The proposed framework provides a high level guarantee for protecting sensitive information. Through experimental results, EXPLORER shows the same performance (i.e., classification accuracy, model parameter estimation) as the traditional frequentist logistic regression model. Practical applications of privacy-preserving predictive models can benefit from methods such as the ones employed in EXPLORER, since there it does not require re-training every time a new data point is added, and it does not need to rely on synchronous communication as its predecessor distributed logistic regression model [29].

The proposed EXPLORER provides strong privacy protection, since the exchanged statistics are always aggregated over a local population of m
                        
                           j
                        
                        −
                        m
                        
                           j−1 records. This is analogous to the generalization operation used for table de-identification (i.e., k-anonymization [49]) and the aggregated statistics reduce the risk of privacy breach of individual patient. For example, when a malicious user is eavesdropping at the server side, he can only observe the difference between 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    →
                                    B
                                 
                              
                              (
                              β
                              )
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    B
                                    →
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              (
                              β
                              )
                           
                         at each inter-site update, where 
                           
                              
                                 
                                    m
                                 
                                 
                                    B
                                    →
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              (
                              β
                              )
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    →
                                    B
                                 
                              
                              
                                 
                                    
                                       β
                                    
                                 
                              
                           
                         are the messages from server node at the previous iteration and the message uploaded to server node at the current iteration, respectively. Therefore, the malicious user cannot match this aggregated difference back to each individual record in EXPLORER. A very interesting direction is to extend EXPLORER to satisfy objective privacy criteria like ∊-differential privacy. We plan to investigate in future work how differential privacy can be applied.

Moreover, we introduced secured intermediate information exchange (i.e., SINE) protocol to enhance the security of the proposed EXPLORER framework, which could significantly reduce the risk of information leak due to the exchange of unprotected aggregated statistics among EXPLORER clients and server. SINE protocol is based on the modified secure sum algorithm in secure multi-parity computation, which offers a high level provable security guarantee [52].

Since EXPLORER is working in a distributed fashion, it introduced additional communication overhead between server and clients. In general, the communication overhead between server and clients is proportional to the number of participating sites. Since we use the Normal distribution as the approximate distribution, the messages propagated between the server and the clients consist of the d dimensional mean vector 
                           β
                         and its covariance matrix V with d(d
                        +1)/2 unique elements. Moreover, unlike SPARK protocol [26] with exponentially increased complexity against network size, SINE protocol is light-weighted with linearly grown complexity against network size, which offers a much better scalability.

Although EXPLORER showed comparable performance to LR, it has some theoretical limitations: its optimization procedure is not convex, and therefore there is no guarantee for global optimal solutions. The proposed EXPLORER also introduced communication overhead, which is proportional to the number of participant sites. The convergence speed of EXPLORER depends on the partition size of each involved site.

@&#CONCLUSIONS@&#

In summary, EXPLORER offers an additional tool for privacy-preserving distributed statistical learning. We showed empirically on two relatively data sets that the results are very similar to those of ordinary logistic regression. These promising results warrant further validation in larger data sets and further refinement of the methodology. Inability to openly share (i.e., transmit) patient data without onerous processes involving pair-wise agreements between institutions may significantly slow down analyses that could produce important results for healthcare improvement and biomedical research advances. EXPLORER provides a means to mitigate this problem by relying on multiparty computation without need for extensive re-training of models, nor reliance on synchronous communications among sites.

Assumed-density filtering (ADF) method is a sequential technique for fast computing an approximate posterior distribution in Bayesian inference. However, the performance of ADF technique depends on the data order. Expectation propagation (EP) algorithm [53], as an extension of ADF, exploits a good approximation to the posterior by incorporating iterative refinement on the solution produced by ADF. Thus, EP is usually much more accurate than ADF. EP works by approximating each likelihood term through minimizing Kullback Leibler (KL) divergence between true posterior and approximate posterior within a tractable distribution (e.g., distributions in exponential family). Then by iteratively performing this approximation process, the approximate distribution will finally reach a fixed point [32].

In our Bayesian logistic regression problem, parameter 
                        β
                      is associated with a Gaussian prior distribution as
                        
                           
                              p
                              (
                              β
                              )
                              =
                              N
                              (
                              β
                              ,
                              0
                              ,
                              V
                              )
                              .
                           
                        
                     
                  

Given a training dataset D
                     ={(x
                     1,
                     y
                     1),(x
                     2,
                     y
                     2),…,(x
                     
                        N
                     ,
                     y
                     
                        N
                     )}, the likelihood function for parameter 
                        β
                      is written as
                        
                           
                              p
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              |
                              β
                              )
                              =
                              σ
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    1
                                    +
                                    exp
                                    (
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              .
                           
                        
                     
                  

Then let us denote the true posterior distribution of 
                        β
                      by 
                        
                           p
                           (
                           β
                           |
                           y
                           )
                           ∝
                           p
                           (
                           β
                           )
                           
                              
                                 ∏
                              
                              
                                 i
                              
                           
                           p
                           (
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           |
                           β
                           )
                           =
                           p
                           (
                           β
                           )
                           
                              
                                 ∏
                              
                              
                                 i
                              
                           
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           (
                           β
                           )
                        
                      and approximate posterior by 
                        
                           q
                           (
                           β
                           |
                           y
                           )
                           ∝
                           p
                           (
                           β
                           )
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           (
                           β
                           )
                        
                     . It is mathematically convenient to choose a Guassian distribution for approximation term 
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           (
                           β
                           )
                        
                      such that the resulted approximate posterior will also be a Gaussian. To perform an efficient EP process, 
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           (
                           β
                           )
                        
                      can be parameterized as
                        
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              β
                              )
                              =
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             1
                                          
                                          
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

The procedure to obtain the posterior approximation through EP algorithm is shown as follows [54]:
                        
                           1.
                           Initialize the prior distribution: 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    β
                                    )
                                    =
                                    N
                                    (
                                    β
                                    ,
                                    0
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          0
                                       
                                    
                                    I
                                    )
                                 
                              ,

set 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    
                                       
                                          V
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          0
                                       
                                    
                                    I
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                2
                                                π
                                             
                                          
                                       
                                    
                                 
                              , where v
                              0 is a hyper prior.

Initialize the term approximations 
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    β
                                    )
                                 
                               to 1:


                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    β
                                    )
                                    =
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

set m
                              
                                 i
                              
                              =0, v
                              
                                 i
                              
                              =∞ and Z
                              
                                 i
                              
                              =1,

Initialize the posterior probability distribution q(
                                 β
                              ):

set m
                              
                                 new
                              
                              =
                              m
                              0, V
                              
                                 new
                              
                              =
                              V
                              0 and Z
                              =
                              Z
                              0.

Until all (m
                              
                                 i
                              , v
                              
                                 i
                              , Z
                              
                                 i
                              ) converge:

for i
                              =1,…,
                              N:
                                 
                                    (a)
                                    Remove 
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             w
                                             )
                                          
                                        from the posterior q(
                                          β
                                       )
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              V
                                                                           
                                                                           
                                                                              new
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              )
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        -
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              T
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            (
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  )
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  )
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            +
                                                            (
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Update m
                                       new and V
                                       new according to ADF
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            -
                                                            (
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  )
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       where 
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   σ
                                                   (
                                                   -
                                                   z
                                                   )
                                                
                                                
                                                   
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         (
                                                         π
                                                         /
                                                         8
                                                         )
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               ⧹
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ;
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            (
                                                            π
                                                            /
                                                            8
                                                            )
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  new
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            (
                                                            π
                                                            /
                                                            8
                                                            )
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Update the approximated terms f
                                       
                                          i
                                       (w)
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  ⧹
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            =
                                                            Z
                                                            
                                                               
                                                                  1
                                                                  +
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        ⧹
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            exp
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 1
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

In this section, we will introduce the details of the factor graph construction and message passing in the EXPLORER. Let us write down the factorization of the posterior distribution of each site as follows:
                        
                           (B.1)
                           
                              p
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    3
                                 
                              
                              )
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (B.2)
                           
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              p
                              (
                              
                                 
                                    Y
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    3
                                 
                              
                              |
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (B.3)
                           
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (B.4)
                           
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    ∫
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    β
                                    |
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    d
                                    β
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (B.5)
                           
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ∫
                              p
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              |
                              β
                              )
                              p
                              (
                              β
                              |
                              
                                 
                                    Y
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    3
                                 
                              
                              )
                              d
                              β
                              ,
                           
                        
                     
                     
                        
                           (B.6)
                           
                              =
                              
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              p
                              (
                              
                                 
                                    Y
                                 
                                 
                                    1
                                 
                              
                              |
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                              ∫
                              δ
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              ,
                              β
                              )
                              p
                              (
                              β
                              |
                              
                                 
                                    Y
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    3
                                 
                              
                              )
                              d
                              β
                              ,
                           
                        
                     
                     
                        
                           (B.7)
                           
                              =
                              
                                 
                                    1
                                 
                                 
                                    Z
                                 
                              
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              p
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                              ∫
                              δ
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              ,
                              β
                              )
                              p
                              (
                              β
                              |
                              
                                 
                                    Y
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    3
                                 
                              
                              )
                              d
                              β
                              ,
                           
                        
                     where 
                        
                           Z
                           =
                           
                              
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              
                                 p
                                 (
                                 
                                    
                                       Y
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           
                        
                      is a normalization constant. In the above equation, p(
                        β
                     
                     
                        j
                     ∣Y
                     1
                     Y
                     2
                     Y
                     3) is equivalent to belief b(
                        β
                     
                     
                        j
                     ) in the BP algorithm, which is captured by the variable node B
                        j
                     . Therefore, in the context of factor graph and BP algorithm, we can interpret the product term 
                        
                           
                              
                                 ∏
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           p
                           (
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           )
                        
                      as the message collected from all the factor nodes 
                        
                           
                              
                                 f
                              
                              
                                 i
                              
                              
                                 j
                              
                           
                        
                      and the integral term 
                        
                           ∫
                           δ
                           (
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ,
                           β
                           )
                           p
                           (
                           β
                           |
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                           )
                        
                      as the message sent from factor node h
                     
                        j
                     . Moreover, according to the factor node update rule in BP algorithm, we can identify the delta function δ(
                        β
                     
                     
                        j
                     , 
                        β
                     ) as the factor function and p(
                        β
                     ∣Y
                     2
                     Y
                     3) as the message sent from server node B. In practice, there are many ways to select factor functions to reflect the contribution of p(
                        β
                     
                     
                        j
                     ∣
                        β
                     ). In this paper, we follow the suggestion in Loeliger [34] and choose δ(
                        β
                     
                     
                        j
                     , 
                        β
                     ) to represent the probability p(
                        β
                     
                     
                        j
                     ∣
                        β
                     ) for mathematical convenience, because of 
                        
                           ∫
                           δ
                           (
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ,
                           β
                           )
                           p
                           (
                           β
                           |
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                           )
                           d
                           β
                           =
                           p
                           (
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           
                              
                                 Y
                              
                              
                                 3
                              
                           
                           )
                        
                     .

See Tables C.13–C.16
                     
                     
                     
                     .

For all 2-site EXPLORER setups of datasets 3–11, the difference between means (DBM) of class distribution and covariates of the 2 sites has been shown in Figs. D.6–D.14
                     
                     
                     
                     
                     
                     
                     
                     
                      in this section, which offers an intuitive sense about how heterogeneous these sites are.

Supplementary material associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.jbi.2013.03.008.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

