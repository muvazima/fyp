@&#MAIN-TITLE@&#LED image display system with mobile APP control

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Three LED lighting strips perform the LED imaging function on the wheel.


                        
                        
                           
                           The LED lighting strip is controlled by the mobile APP via a Wi-Fi wireless network.


                        
                        
                           
                           It can work normally with wheel speed up to 35km/hr.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

LED

Wi-Fi wireless network

Image display

Embedded system

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

As environmental awareness increases, people are increasingly using bicycles rather than cars, motorcycles or other fuelled vehicles to travel short distances. Numerous people ride bicycles on the road as their main leisure activity. Today's roads also have dedicated road cycling lanes. Bikes are unlike other form of conveyance, because they only have faint lights. Insufficient lighting at night commonly puts cyclists in danger. In Taiwan, approximately 170 people have died from cycling accidents in the last three years. More than half of fatal cycling accidents happen at night. No traffic law requires cyclists to use sufficient lighting. The main cause of cycling accidents is insufficient lighting on bicycles at night, which causes collisions with cars.

Most bicycles have a reflecting board mounted in the rear of them, but its range is less than 30 m. When the reflecting board is covered with dust, it becomes much less reflective. Both sides of the bicycle lack lighting to warn other vehicles from perpendicular directions. Therefore, it is necessary to equip lights on both sides of the bike wheels to avoid side impact caused by other vehicles. Many wheel-based LED lights are designed to meet the requirements and many bikes are also equipped with strips of LED lights. A very bright LED strip helps other people notice the bike at night. The use of such a strip can reduce the chances of a cycling accident. Additionally, the wheels of a bicycle can be designed to display graphics or text by the appropriate colors of the various LEDs. This design does not only increase driving safety, but also improves the appearance of the bike.

The rest of this paper is organized as follows. Section 2 surveys previous LED applications in image display. Section 3 introduces the proposed system architecture. Section 4 describes the hardware and software of the system. Section 5 summarizes experimental results obtained using the proposed system and compares them with those obtained using other systems. Section 6 draws conclusions and makes recommendations about future research.

@&#RELATED WORKS@&#

Many works have focused on the efficient control of LED lighting [5,8â€“10], and its applications in displaying two-dimensional (2D) [2,3,6,7,11] and three-dimensional (or called 3D) [4] images. High-power white LEDs can be used for indoor positioning [5] by calculating their corresponding coordinates. Four LEDs transmit three-dimensional coordinate information, which is received and demodulated by two image sensors close to an unspecified position. The unknown position is calculated from the geometrical relationships among the images of the LEDs that are formed at the image sensors close to the unknown position. Another lighting application of LEDs saves energy by the use of an interactive LED lighting interface that uses a Zigbee-based wireless sensor network (WSN) both to monitor and to control the lighting system [8]. Each board for controlling the LED lamps comprises a microcontroller, a sensor, and a Zigbee WSN unit. Signals from Zigbee can automatically turn of an unused lamp to save energy. Similarly, streetlights that use LED lighting systems can save energy since they allow control of the real-time operation system (RTOS) [10]. Such an LED streetlight system can be automatically controlled using sensor data that provide information about the environment.

A 2D image display system that involves three rotating columns of colored LEDs has been developed [2,11]. The frequency of scanning and the speed of rotation are sufficiently high to be indeterminable by the human eye. The display data processing is implemented in a Complex Programmable Logic Device (CPLD). A remote PC can rearrange a new pattern and transmit it to the display system via RS232, USB, and a wireless network. The 2D image display can also be used on a car wheel [3]. Such a display system utilizes one, two or three strips of LEDs, each of which is composed of high-resolution grayscale LEDs. Experimental results reveal that the breakage image is obtained when the wheel rotates at less than 5km/hr. The rate of rotation is required to produce a complete pattern is between 5km/hr and 60km/hr. This display system can be utilized on applied to other moving mechanical equipment [6,7]; it comprises three main parts, which are an electronic board with a microcontroller, drivers and an array of LEDs, a brushless electrical motor with stabilized speed to ensure proper rotation of the LED assembly, and a power supply module. The system displays a pattern that includes image and text at a stable rate of rotation. The specialized 3D display system comprises a 2D rotating panel of LEDs and it relies on the ``persistence of vision'' to generate a 3D image [4]. The graphical control sub-system consists of PC software, FPGAs, and supporting circuitry. The system can display 3D images and videos with a full 360 degree viewing angle.

The proposed system combines embedded system and circuit design technologies. The designed LED lighting strips are mounted on a bicycle wheel, and provide various patterns. The user can control the pattern changes using a mobile application program. The pattern is obtained by rotating the LED light strips that are mounted on the spokes relying on human visual persistence. A cyclist, who wants to change the image on the wheel, can push the buttons on the main control board that is mounted on the wheel before riding. The ARM-based microprocessor that is embedded on the main control board executes the imaging algorithm and sends the control commands to three LED light strips through an I2C (Inter-Integrated Circuit) interface. The proposed system improves safety, and generates a beautiful image.

As presented in Fig. 1
                     , the architecture of the proposed LED imaging system comprises five hardware and software components, including the main control board, the LED lighting strip, the speed sensing unit, the 802.11 wireless network (or Wi-Fi) transmission interface, and the mobile application program. The system can be made to display various images by rotating the LED light strips that are mounted on the bike wheel, on account of human visual persistence. The display on the wheel can also be controlled using a remote mobile application program (called a mobile APP) over a Wi-Fi wireless network.

The five components that support LED imaging are as follows.

                        
                           
                              (a)	Main control board
                           

The main control board controls all of the hardware devices that are mounted on the wheel, including the LED lighting strip, the speed sensing unit, and the wireless network interface. The main controller is an STM32 ARM microcontroller, which receives control commands from remote mobile APP or receives other commands that are sent by the manual pushing of buttons.


                              (b)	LED lighting strip
                           

The LED lighting strip receives control signals from the main control board, causing it to change the image on the bike wheel. The control signals govern the switching on and off of the LEDs and their colors and are transmitted according to the I2C interface protocol.


                              (c)	Speed sensing unit
                           

The speed sensing unit uses a magnetic sensor to detect the speed of a wheel. The sensor comprises a reed switch and a magnet. When the magnet is less than 13mm away from the reed switch, a specific signal is generated to indicate that the wheel has rotated through one revolution. Consequently, the rotation speed of the wheel can be calculated using a mathematical equation and time-keeping. The rotation speed is transmitted to the microcontroller of the main control board and the specific control signals to the LED lighting strip.


                              (d)	Wireless network transmission interface
                           

The wireless network transmission interface is the communication interface between the remote APP and the main control board. All commands or image data are transmitted by the unit over a Wi-Fi wireless network [1].


                              (e)	Mobile application program
                           

The mobile application program (mobile APP) is used to control the image that is displayed by the LED lighting module. The mobile APP has a graphic user interface that is based on the Android operating platform. A user can install the program on a mobile phone or a Tablet PC and use it to control the hardware of the LED imaging system via a Wi-Fi network.


                     Fig. 1 presents the major functional units of the system. The hardware and software of the system must cooperate with each other to display efficiently the specified image on the wheel. The speed and angle of rotated are calculated using an STM32 ARM microcontroller to ensure that the image is stably displayed. The efficient control of hardware and software depend on accurate knowledge of the operational flow of the system.


                        Fig. 2
                         presents the operational flow of the image display system. The LED lighting strip executes the image display processes. The proposed system initializes all of the hardware devices and software programs when the system is booted. The two control modes of this system are the manual control mode and the remote control mode. The manual control can be set using the external button on the main control board. Another remote control is executed by a mobile APP that is installed on a mobile phone, over a Wi-Fi connection. The application program can establish a connection between the mobile phone and the main control board. When the main board receives packets from the mobile APP, it determines which image will be generated by the LED lighting strip.

These two control modes select the corresponding image patterns that are stored in the memory of the STM32 microcontroller. An interrupt delay ensures that the imaged patterns are transmitted at the correct time from the main control board to the LED lighting module. The interrupt delay changes with the rate of rotation of the wheel. The interrupt delay is shortened as the rate of rotation increases to ensure that the displayed image is as specified. Therefore, the rate of rotation in all instances dominates the interrupt delay to display an image.

Several hardware components for this system are developed. They include the main control board and three LED lighting strips. Three LED lighting strips perform the LED imaging function on the wheel; pairs of boards are separated by an angle of 120 degrees. The two kinds of major circuit board that perform the imaging function are described as follows.

                           
                              
                                 (a)	Main control board
                              


                                 Fig. 3
                                  presents the main control board. The board receives control commands from the remote application program and executes the imaging algorithm, before transmitting the control signals to the LED lighting strips. The main control board also receives feedback signals from the speed sensing device. The ARM STM32 microcontroller provides the major communication interface between circuit boards and executes the imaging algorithm to control the LED image that is displayed on the wheel. General-purpose input/output (GPIO) ports in this board connect the board to other circuit boards. A wireless network module (Wi-Fi) is also deployed in the main control board to transmit commands or data between the main control board and the mobile APP.


                                 (b)	LED lighting strip
                              


                                 Fig. 4
                                  presents the designed LED lighting strip. The LED lighting strip comprises sixteen LED chips. The system comprises three LED lighting strips that display the image. The size of the wheel determines the numbers of LED chips and the length of the light column. A larger wheel needs more LED chips to display the image. Each LED lighting strip has three decoding ICs (or called decoders) to resolve the incoming packets and the control commands from the STM32 microcontroller on the main control board. The decoders receive the control commands, decode them, control the corresponding LED chips, and set their colors. The strip uses an I/O expander to control all LED chips.


                        Fig. 5
                         presents the graphic user interface of the Android-based mobile application program. The mobile APP is installed on a mobile phone. When the Wi-Fi wireless network connection function on the phone connects the corresponding Wi-Fi interface on the main control board, the cyclist can control the LED lighting strip on the spokes of the bike. The mobile APP firstly enters the basic mode in which the user can select one of six patterns. When the user selects a pattern, the LED lighting module displays that pattern once the rotational speed of the wheel reaches a particular value. The advanced mode also enables the user to set a cycle of various patterns and the duration of each.

The LED lighting strip is controlled by the mobile APP via a Wi-Fi wireless network. The control program of the LED lighting strip is installed in the main control board. Commands from the control interface and feedback information from the LED module are packaged using the TCP/IP and Wi-Fi protocols for wireless communication. A specific packet format is used for communication between the mobile APP and the main control board. The sockets of the Android operating system serve as the communication interface between these two remote units. When the LED lighting system starts up, the APP in the phone connects with the bike over the Wi-Fi network. The GUI is used to select patterns and to set the period for which each is displayed. The APP also receives error or warning signals from the main control board when the system is abnormally executed. The user can further control a cyclic change among various patterns for specified durations after selecting the advanced mode.

The system uses two major LED lighting control programs, which are the mobile control and pattern generation programs.

                           
                              (a)	Mobile control program


                                 Fig. 6
                                  presents a pseudo code of the mobile control program. The program performs basic and advanced display selections. While the mobile APP connects to the main control board via Wi-Fi network, the interface of the APP can be used to select the display pattern. Six display patterns can be selected in the basic selection mode by sending the corresponding command from the APP. The selected pattern is displayed on the wheel until a new pattern is selected. The advanced selection mode is used to select multiple patterns and display them for a particular interval.

(b)	Pattern generation program


                                 Fig. 7
                                  presents the pseudo code of the proposed pattern generation program. The program is installed and executed in the ARM microcontroller of the main control board; it receives the pattern selection commands from the mobile APP or from the manually pressed buttons on the main control board. When the program receives the commands, it receives the information about the initial colors in the patterns by performing the corresponding color function (or called GetColor() function). The reed switch on the wheel activates the external interrupt to calculate the time taken by the wheel to rotate once. The time taken by the wheel to rotate by one degree is calculated as follows.
                                    
                                       (1)
                                       
                                          
                                             AngleTime
                                             =
                                             
                                                CircleTime
                                                360
                                             
                                          
                                       
                                    
                                 
                              

The variable AngleTime represents that the time taken for the wheel to rotate through one degree. It is used to calculate the current angle calculated from the time when the rotation of the wheel began. The relevant equation is as follows.

                           
                              (2)
                              
                                 
                                    CurrentAngle
                                    =
                                    
                                       
                                          SystemTimeCalculation
                                          (
                                          Timer
                                          )
                                       
                                       AngleTime
                                    
                                 
                              
                           
                        
                     

The parameter CurrentAngle is calculated from the time when the interrupt is activated by the reed switch, which can be obtained using the SystemTimeCalculation function, and the AngleTime in Eq. (2), which can be obtained using Eq. (1). The CurrentAngle is also a parameter in the GetColor function is used in the program to obtain corresponding color information from the memory unit in the ARM microcontroller. In the proposed system, two neighboring mounted LED lighting strips are separated by an angle of 120 degrees. The first LED strip obtains the color information using the GetColor function and the angle parameter CurrentAngle. The second strip obtains color information using the GetColor function and CurrentAngle plus 120 degrees. The final strip obtains the color information using CurrentAngle plus 240 degrees. Each angle is associated with particular color information that is required to display the desired pattern using the LED lighting strips. The main controller transmits color information to the three lighting strips using the I2C protocol. When the wheel has rotated once, the complete pattern is displayed on the wheel, relying on human visual persistence.

In the proposed system, two LED control programs efficiently activate the hardware units to display the specific patterns. The ARM STM32 microcontroller that is deployed on the main control board is a major control and communication interface for receiving commands from the mobile APP; executing the pattern generation program, calculating angle-related information, and transmitting control signals to activate LED lighting rapidly.

@&#EXPERIMENTAL RESULTS@&#

The proposed LED lighting module is mounted on the spokes of a unicycle as presented in Fig. 8
                     . The main control board is deployed close to the center of the wheel. Three LED lighting strips are mounted on the spokes, separated by angles of 120 degrees. Power is supplied to all modules from a 2000 mAh polymer lithium-ion battery via a 3.3V to 5V voltage regulator. The battery is stable, slim, and extremely light and therefore, suitable to use in portable devices. In the experiment, the LED lighting module is operated continuously for over 36 hours using the 2000 mAh battery, without wireless network communication. The module also has a charging interface via a Micro USB port. When a cyclist rides the unicycle for exercise or performance, the patterns on the wheel can be rapidly changed using the mobile APP control.


                     Fig. 9
                      presents six patterns that are displayed by the module; these are images of a butterfly, spade, heart, leaf, ring, and shield. These patterns can be selected by the mobile APP or manually pressed buttons. The selected pattern persists when the rotational speed of the wheel exceeds 10km/hr without external interruption. Six patterns can be displayed by rotating the LED lighting strips that are mounted on the wheel, on account of human visual persistence.


                     Table 1
                      shows the experimental results concerning the six patterns obtained at various wheel speeds. The system is tested for 100, 200, 300, 400, and 500 rotations at each wheel speed. The experimental results thus obtained reveal that the system can operate normally when the wheel speed does not exceed 35km/hr. When the wheel speed exceeds 40km/hr, the patterns are incorrectly displayed during 7% of the rotations. High-speed rotation of the wheel causes errors in the measurements made using the magnetic sensing device, because the device does not have enough time to sense the contact signal from the magnet that is tied to the pillar close to the wheel. The errors prevent the lighting module from forming a complete pattern at the request of the remote application program. The proposed system can effectively generate the desired pattern on the wheel up to 40km/hr. For exercise purposes, most cyclists ride bikes arbitrarily. Most of them do not ride bikes faster than 40km/hr except in contests. Therefore, if the system tries to display patterns correctly for speeds exceeding 40km/hr, it should include error correction technologies such as 3-axis accelerometer or use more expensive LEDs with the capacity for higher response time.


                     Table 2
                      shows the performance comparison of different LED bicycle wheel light designs. Product number 1 in Table 2 has the cheapest price which also has the longest working hours to display the images or words on the wheel. It cannot be charged by the external power supply. Product number 2 has the most expensive price compared with the others without more attractive functions. Product number 5 uses only one LED lighting strip to display the patterns. It uses 32 LEDs and has 8550 mAh battery capacities to provide lighting for up to 30 hours. All of the previous designs have not provided the ability to change patterns via wireless network. The best bike riding speed of the previous designs for displaying the normal images or words is between 10â€“30km/hr. Our design provides remote android-based application program (APP) to change the patterns immediately via Wi-Fi wireless network. The design also has the cheapest price compared with previous designs. It can work normally with wheel speed up to 35km/hr and can be charged via a Micro USB interface. Overall, our design has better performance with regard to the ratio of working hours via battery capacities, as well as the mobile APP control capacity.

@&#CONCLUSIONS@&#

The proposed LED image display system can effectively display six patterns by rotating the LED light strips that are mounted on the bike wheel, on account of human visual persistence. A polymer lithium-ion battery supplies power for thirty-six hours to efficiently display the patterns on the wheel of a bicycle. A remote APP design is used to control the patterns displayed on the wheel via a Wi-Fi wireless network. The mobile control and pattern generation programs are designed to select the pattern(s), calculate angle-related information, and transmit control signals to activate LED lighting instantaneously. Experimental results reveal that the system can operate normally when the wheel speed does not exceed 35km/hr. But when the wheel speed exceeds 40km/hr, the patterns are incorrectly displayed during 7% of the rotations. The proposed system is also compared with different LED bicycle wheel light products. All of the previous designs have not provided the ability to change patterns via wireless network. The best bike riding speed of the previous products for displaying the images or words correctly is between 10â€“30km/hr. Our proposed design has the lowest price compared with previous designs. It also has better performance with regard to the ratio between working hours and battery capacities, as well as the mobile APP control capacity. To increase the resolution of the patterns in the future, more LED chips will be attached close to each other and a speedy signal transmitting protocol will be developed.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the Ministry of Education of the Republic of China, Taiwan, for financially supporting this research under Contract No. 104E018-02. Ted Knoy is appreciated for his editorial assistance.

@&#REFERENCES@&#

