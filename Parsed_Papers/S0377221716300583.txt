@&#MAIN-TITLE@&#Optimal production planning for assembly systems with uncertain capacities and random demand


@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a general setting of assembly systems with uncertain capacities.


                        
                        
                           
                           We characterize the structure of its optimal policy and derive analytical solution.


                        
                        
                           
                           The solution provides an effective tool for managing complicated assembly systems.


                        
                        
                           
                           The results fill a void in the literature for an important research area.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supply chain management

Assembly system

Uncertain capacity

Production planning

@&#ABSTRACT@&#


               
               
                  We study the optimal production planning for an assembly system consisting of n components in a single period setting. Demand for the end-product is random and production and assembly capacities are uncertain due to unexpected breakdowns, repairs and reworks, etc. The cost-minimizing firm (she) plans components production before the production capacities are realized, and after the outputs of components are observed, she decides the assembly amount before the demand realization. We start with a simplified system of selling two complementary products without an assembly stage and find that the firm's best choices can only be: (a) producing no products or producing only the product of less stock such that its target amount is not higher than the other product's initial stock level, or (b) producing both products such that their target amounts are equal. Leveraging on these findings, the two-dimensional optimization problem is reduced to two single-dimensional sub-problems and the optimal solution is characterized. For a general assembly system with n components, we show that if initially the firm has more end-products than a certain level, she will neither produce any component nor assemble end-product; if she does not have that many end-products but does have enough mated components, she will produce nothing and assemble up to that level; otherwise she will try to assemble all mated components and plan production of components accordingly. We characterize the structure of optimal solutions and find the solutions analytically.
               
            

@&#INTRODUCTION@&#

In manufacturing, capacity can be uncertain due to factors such as unexpected breakdowns of unreliable machinery, unplanned maintenance of uncertain duration, rework of randomly defective items etc. (Ciarallo, Akella & Morton 1994, Hu, Duenyas & Kapuscinski 2008). Such uncertainties complicate production planning in that the output is not necessarily equal to the planned amount. The effect of uncertain capacities on production planning in serial systems has been investigated (see e.g., Hwang & Singh 1998, Wang & Gerchak 1996a); however, little is known for assembly systems which happen to be more prevalent in modern manufacturing.

We study optimal production planning in a single period setting for an assembly system where demand for the end-product is random and all components production and end-product assembly capacities are uncertain. Given abundant input, each item's (components and the end-product) output is random and equal to the minimum of its planned amount and the realization of its uncertain capacity. The firm chooses production amounts of components before production capacities are realized, and after outputs of components are observed, she decides the planned assembly amount before realization of the assembly capacity and demand. Unmet demand incurs penalty cost while unused items result in disposal costs. Production and assembly costs are charged based on outputs of components and the end-product, respectively.

A direct motivation of our paper comes from a problem faced by cell phone producers in China. In the highly-competitive cell phone market, all competitors strive to introduce new products quite frequently to stimulate demand and attract consumers. A producer's ability of having abundant new products ready for a coming selling season is a precondition for the success of her business. One of cell phone producers’ difficulties is that their components production suffers from uncertain capacities due to increased internal uncertainties arising from immature technologies, complex control and lack of production experience, etc. As a result, late deliveries of components may happen and firms lose not only sales but also valuable market shares. Nonetheless, firms are reluctant to use expensive mitigation measures such as stockpiling and backup capacity/supplier because margin is dropping throughout the industry. They need to plan their productions by taking into account not only random demand but also uncertain capacities. One may find cell phone producers’ story echoes in other competitive industries (e.g., innovative consumer electronics) where the end-products have short life-cycles. Our model presented here tries to address the production planning problems in such environments.

We start with a system where the firm sells two perfectly complementary products as a set to the market. This corresponds to a two-component system where assembly is unnecessary. We show that the optimal production plan can only be: (a) producing no products at all or producing only the product of less stock such that its target amount is at most as high as the other product's initial stock level, or (b) producing both products such that their target amounts are equal. We then use these facts to reduce the two-dimensional optimization problem into two interconnected one-dimensional sub-problems that are analytically tractable. Each sub-problem is solved and the optimal solution to the original problem is then fully characterized. We then extend the model to consider a general assembly system with n components where the firm engages in two-stage decision-making (components production planning in stage 1 and end-product assembly planning in stage 2) with uncertain production and assembly capacities. We find that if the initial stock of end-product is lower than a certain level, she will act in an assemble-as-many-as-possible fashion in stage 2 and will choose components’ planned amounts accordingly in stage 1. Otherwise, she will neither assemble any end-product nor produce any components. When producing is necessary for some or all components, we fully characterize the optimal solution.

This research is closely related to the literature on production/inventory systems under uncertain capacities. In the seminal work of Ciarallo et al. (1994), they show that for a single-stage, single-item system with uncertain capacity and random demand, an order-up-to policy is optimal for a periodic review finite-horizon problem, and a so-called “extended myopic” policy(which requires the consideration of review periods of uncertain length) is optimal for the infinite horizon problem. For the same system, Güllü (1998) presents a procedure for computing the optimal base stock level under expected average cost per period criterion, while Iida (2002) extends the model to consider non-stationary demand and develops upper and lower bounds of optimal policies for infinite horizon problems. Wang and Gerchak (1996a) consider uncertain capacity as well as random yield and show that the optimal policy is of a reorder-point type. Erdem and Özekici (2002) develop a rather general periodic-review model that incorporates both uncertain capacity and random environment which is a time-homogeneous Markov chain. They show that the optimal policy is the well-known base-stock policy where the optimal order-up-to level depends on the state of the environment. For a single-period multi-stage system with setup costs and uncertain capacities at all stages, Hwang and Singh (1998) prove that the optimal policy is characterized by a sequence of imbedded critical numbers. Hu et al. (2008) address the optimal joint control of inventory and transshipment for a firm that produces in two locations whose capacities are uncertain. Under Markovian production capacity, Yang, Qi and Xia (2005) study the optimal inventory-outsourcing policy while Yang, Qi and Xia (2006) study inventory control with an option of order rejection. Under the EOQ framework, Wang and Gerchak (1996b) analyze the effects of uncertain capacity on optimal lot sizing with single supplier while Erdem, Fadiloglu and Özekici (2006) consider multiple suppliers. From a strategic point of view, in a single period setting, Wang, Gilland and Tomlin (2010) examine which mitigation strategy, dual sourcing or process improvement, is favorable for a firm facing uncertain capacity or random yield as supplier cost/reliability varies.

The above-mentioned papers are mainly about serial systems, little is known about the optimal policies for assembly systems with uncertain capacities. Bollapragada, Rao and Zhang (2004) study an assembly system with uncertain capacities at component stage, but their system is assumed to be operating under a periodic-review installation base-stock policy, and their goal is to minimize the total steady-state surrogate holding cost subject to a service level constraint. We, on the other hand, aim to fully characterize the optimal solution for the system. Xiao, Chen and Lee (2010) is another paper on assembly systems with uncertain capacity, but the uncertainty lies in only the assembly stage. In our system, both the component production capacities and assembly capacity can be uncertain. Recently, Bollapragada, Kuppusamy and Rao (2015) numerically illustrate the impacts of lead times and capacity on the performance of a complicated assembly system with supply uncertainty. However, no optimal policies or behaviors are provided.

In a broader sense, our paper is also related to research on production/inventory decisions in assembly systems with random yield (another common internal cause for random output besides uncertain capacity). In his seminal work, Yao (1988) applies a chance-constrained optimization approach to minimize the cost of procuring components subject to a given probability of achieving a fixed target yield on the assembly stage. Gurnani, Akella and Lehoczky (2000) extend Yao's model to optimize components ordering and assembly target level decisions simultaneously under random demand. Gerchak, Wang and Yano (1994) address lot sizing decisions in assembly systems with random yield both at component stage and assembly stage, they prove that the cost functions are jointly concave under certain circumstances and the optimal lot sizes are then given by the first order conditions. Pan and So (2010) study joint pricing-production decisions in a two-component assembly system where one of the components faces random yield. All of these papers are conducted in a single-period setting except for DeCroix (2013), in which the optimal policies for an assembly system subject to supply disruptions (considered as a special “all-or-nothing” case of random yield) are characterized.

In these random yield models, the optimal solutions are about “inflating the planned production amounts”. Moreover, the targeted amounts (equal to planned amount plus initial inventory) of the complementary components are generally not equal. These are not true in our uncertain capacity model. We found that in assembly systems with uncertain capacities, the optimal solutions are about “deflation” rather than “inflation” of the planned production quality. That is, the planned amounts under uncertain capacities are generally smaller than those under unlimited capacities. Moreover, a wise decision-maker will plan production such that the targeted amounts of different components are equal. The key to such differences is that capacity uncertainty implies that output is the minimum of the planned amount and the realized capacity while yield randomness often implies that output is stochastically proportionate to the planned amount.

The paper is organized as follows. For ease of exposition, we start in Section 2 with a simple system where the firm produces and sells two complementary products as a set to the market. We then extend our model in Section 3 by considering a general assembly system where the firm needs to plan components production amounts and assembly amount sequentially with uncertain production and assembly capacities. Concluding remarks are given in Section 4. A symbol/notation table and all the detailed mathematical proofs are given in the appendixes.

A firm produces and sells a set of two perfectly complementary products to the market in a selling season. Due to long lead time of manufacturing, the firm needs to plan production in advance. Without loss of generality, a set contains one unit of each product. The one-time demand Z is random with a differentiable CDF Q( · ) on support (0, ∞). The production capacity for product i, Ki
                        , 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , is uncertain due to unexpected breakdowns, repairs, and reworks, etc. Assume that Ki
                         is independent of production plan and its CDF Fi
                        ( · ) is differentiable and has support on (0, ∞). Moreover, Ki
                        , 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , are mutually independent. (Assuming correlation of uncertain production capacities complicates the analyses without adding much insight into the solution structure of the problem.) As a result, the firm plans to produce ui
                         units of productibut will only receive 
                           
                              
                                 u
                                 i
                              
                              ∧
                              
                                 K
                                 i
                              
                              :
                              =
                              min
                              
                                 {
                                 
                                    u
                                    i
                                 
                                 ,
                                 
                                    K
                                    i
                                 
                                 }
                              
                           
                         units of finished products. Plus her initial inventory of product i, xi
                        , the available amount of product i is 
                           
                              
                                 A
                                 i
                              
                              :
                              =
                              
                                 u
                                 i
                              
                              ∧
                              
                                 K
                                 i
                              
                              +
                              
                                 x
                                 i
                              
                           
                        , and hence, the available amount of sets is A
                        1∧A
                        2. For any CDF G( · ), define 
                           
                              
                                 G
                                 ¯
                              
                              
                                 (
                                 ·
                                 )
                              
                              :
                              =
                              1
                              −
                              G
                              
                                 (
                                 ·
                                 )
                              
                           
                        . Note that for the rest of the paper, when we say “produce/assemble u units”, we actually mean “plan to produce/assemble u units”.

Following the literature (Ciarallo et al. 1994), assume that only executed production bears cost, i.e., product i’s production cost is ci
                        (ui
                        ∧Ki
                        ), where ci
                         is the corresponding unit cost. Let hi
                         be the unit disposal cost of unused product i. Assume that 
                           
                              
                                 c
                                 i
                              
                              >
                              −
                              
                                 h
                                 i
                              
                           
                        , that is, the salvage value (if hi
                         ≤ 0) of a product is less than its production cost. Let b be the unit penalty cost of unmet demand, and assume that 
                           
                              b
                              >
                              
                                 c
                                 1
                              
                              +
                              
                                 c
                                 2
                              
                           
                        , which is reasonable since the value of a set should be higher than its total production cost. The firm's problem is to choose ui
                        , 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , before capacities and demand are realized, so as to minimize her expected total cost. Note that a list of symbols and notations used throughout the paper is provided in Appendix A.

Let 
                           
                              u
                              :
                              =
                              (
                              
                                 u
                                 1
                              
                              ,
                              
                                 u
                                 2
                              
                              )
                           
                         be the production decision vector and 
                           
                              x
                              :
                              =
                              (
                              
                                 x
                                 1
                              
                              ,
                              
                                 x
                                 2
                              
                              )
                           
                         the initial inventory vector. The expected cost function is

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             Π
                                             (
                                             u
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             [
                                             
                                                (
                                                
                                                   h
                                                   1
                                                
                                                +
                                                
                                                   h
                                                   2
                                                
                                                )
                                             
                                             
                                                
                                                   (
                                                   
                                                      A
                                                      1
                                                   
                                                   ∧
                                                   
                                                      A
                                                      2
                                                   
                                                   −
                                                   Z
                                                   )
                                                
                                                +
                                             
                                             +
                                             b
                                             
                                                
                                                   (
                                                   Z
                                                   −
                                                   
                                                      A
                                                      1
                                                   
                                                   ∧
                                                   
                                                      A
                                                      2
                                                   
                                                   )
                                                
                                                +
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      h
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         A
                                                         i
                                                      
                                                      −
                                                      
                                                         A
                                                         1
                                                      
                                                      ∧
                                                      
                                                         A
                                                         2
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      c
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         i
                                                      
                                                      ∧
                                                      
                                                         K
                                                         i
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 x
                                 +
                              
                              =
                              max
                              
                                 {
                                 x
                                 ,
                                 0
                                 }
                              
                           
                        , and the expectation is taken over Fi
                        ( · ), 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , and Q( · ), the cumulative distribution functions of Ki
                         and Z, respectively. On the right hand side, the first term is disposal cost of mated but not sold sets of products, the second is the penalty cost of unmet demand, and the third is disposal cost of unmated products, while the last is production cost. The firm's problem can then be formalized as

                           
                              
                                 
                                    P
                                    :
                                    
                                    
                                       min
                                       u
                                    
                                    
                                    Π
                                    
                                       (
                                       u
                                       )
                                    
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       u
                                       i
                                    
                                    ≥
                                    0
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    .
                                 
                              
                           
                        
                     

Let 
                           
                              
                                 Δ
                                 i
                              
                              :
                              =
                              
                                 u
                                 i
                              
                              +
                              
                                 x
                                 i
                              
                              ≥
                              
                                 x
                                 i
                              
                           
                        ,
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , be the firm's target amount of product i. Then, the available amount of product i can be written as 
                           
                              
                                 A
                                 i
                              
                              =
                              
                                 Δ
                                 i
                              
                              ∧
                              
                                 (
                                 
                                    K
                                    i
                                 
                                 +
                                 
                                    x
                                    i
                                 
                                 )
                              
                           
                        . Choosing 
                           u
                         is equivalent to choosing 
                           
                              
                                 Δ
                              
                              :
                              =
                              (
                              
                                 Δ
                                 1
                              
                              ,
                              
                                 Δ
                                 2
                              
                              )
                           
                        . For ease of exposition, we will use either 
                           u
                         or 
                           Δ
                        , whichever is convenient, to denote the decision variables. Without loss of generosity, assume x
                        1 ≤ x
                        2 throughout – the case of x
                        1 ≥ x
                        2 will be symmetrical. We first introduce a lemma that will help simplify the problem to a great extent.


                        
                           Lemma 1
                           
                              The firm's best choices can only be: (a) producing no products at all or producing only product1 such that its target amount is at most as high as product 2’s initial stock level, or (b) producing both products such that their target amounts are equal. In other words, the optimal solution 
                              
                                 u
                              *, or equivalently, 
                              
                                 Δ
                              *, to 
                              
                                 P
                               
                              satisfies either (a)
                              
                                 
                                    
                                       Δ
                                       2
                                       *
                                    
                                    =
                                    
                                       x
                                       2
                                    
                                    ≥
                                    
                                       Δ
                                       1
                                       *
                                    
                                    ≥
                                    
                                       x
                                       1
                                    
                                 
                               
                              or (b)
                              
                                 
                                    
                                       Δ
                                       1
                                       *
                                    
                                    =
                                    
                                       Δ
                                       2
                                       *
                                    
                                    ≥
                                    
                                       x
                                       2
                                    
                                 
                              .

As shown in Fig. 1
                        , Lemma 1 indicates that, in the solution space, the optimal point can only be: (a) lying on the thick segment of the horizontal axis (i.e., from the original point (x
                        1, x
                        2) to point (x
                        2, x
                        2)) or (b) lying on the thick line 
                           
                              
                                 Δ
                                 1
                              
                              =
                              
                                 Δ
                                 2
                              
                              ≥
                              
                                 x
                                 2
                              
                           
                        . Suppose otherwise, the optimal point lies in zone Δ
                        1 < x
                        2 < Δ
                        2, or zone x
                        2 < Δ
                        1 < Δ
                        2, the firm can always be better off by lowering u
                        2 (equivalently, Δ
                        2) a little bit because the expected amount of mated components will be the same while some production cost can be saved, which results in contradiction. Likewise, suppose the optimal point lies in zone x
                        2 < Δ
                        2 < Δ
                        1, the firm can always be better off by lowering u
                        1 (equivalently, Δ
                        1), which also results in contradiction.

Case (a) of Lemma 1 corresponds to the situation where the firm already has abundant product 2 and/or product 1’s capacity is stochastically low, while in case (b), both products’ initial stock levels are not high enough and/or the firm's capacities are stochastically high enough, so the firm should produce both products and try to avoid mismatch by planning equal target amounts of them.

Based on Lemma 1, suppose the optimal solution satisfies (a) 
                           
                              
                                 Δ
                                 
                                    2
                                 
                                 *
                              
                              =
                              
                                 x
                                 2
                              
                              ≥
                              
                                 Δ
                                 
                                    1
                                 
                                 *
                              
                              ≥
                              
                                 x
                                 1
                              
                           
                        , or (b) 
                           
                              
                                 Δ
                                 1
                                 *
                              
                              =
                              
                                 Δ
                                 2
                                 *
                              
                              ≥
                              
                                 x
                                 2
                              
                           
                        . We try to locate the potential optimal solutions in these two cases by solving two sub-problems of 
                           P
                        . And then we build the links between the potential optimal solutions and finally identify the global optimum.

Suppose it is optimal to produce no products or only product 1 such that its target amount is at most as high as product 2’s initial stock level. To find this potential optimal solution, substitute 
                              
                                 
                                    u
                                    2
                                 
                                 =
                                 0
                              
                            into (1) and restrict 
                              
                                 Δ
                                 1
                              
                            to be at most as high as x
                           2, we have a single-dimensional objective function as

                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Π
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                E
                                                [
                                                
                                                   (
                                                   
                                                      h
                                                      1
                                                   
                                                   +
                                                   
                                                      h
                                                      2
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         A
                                                         1
                                                      
                                                      −
                                                      Z
                                                      )
                                                   
                                                   +
                                                
                                                +
                                                b
                                                
                                                   
                                                      (
                                                      Z
                                                      −
                                                      
                                                         A
                                                         1
                                                      
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   h
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      2
                                                   
                                                   −
                                                   
                                                      A
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   ∧
                                                   
                                                      K
                                                      1
                                                   
                                                   )
                                                
                                                
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where the available amount of sets is given as A
                           1. The firm's sub-problem in this case is

                              
                                 
                                    
                                       
                                          P
                                          1
                                       
                                       :
                                       
                                       
                                          min
                                          
                                             u
                                             1
                                          
                                       
                                       
                                       
                                          Π
                                          1
                                       
                                       
                                          (
                                          
                                             u
                                             1
                                          
                                          )
                                       
                                       
                                       
                                          s
                                          .
                                          t
                                       
                                       .
                                       
                                       0
                                       ≤
                                       
                                          u
                                          1
                                       
                                       ≤
                                       
                                          x
                                          2
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       ,
                                    
                                 
                              
                           whose optimal solution is characterized by the following proposition.


                           
                              Proposition 1
                              
                                 Π
                                 1(u
                                 1) is quasi-convex in u
                                 1 
                                 and the optimal solution
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       1
                                    
                                  
                                 to 
                                 
                                    P
                                 
                                 1 is

                                    
                                       (3)
                                       
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                                1
                                                1
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            0
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            ≥
                                                            V
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            <
                                                            V
                                                            ≤
                                                            
                                                               x
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               2
                                                            
                                                            <
                                                            V
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 where
                                 
                                    
                                       V
                                       =
                                       
                                          Q
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          
                                             (
                                             b
                                             +
                                             
                                                h
                                                2
                                             
                                             −
                                             
                                                c
                                                1
                                             
                                             )
                                          
                                          /
                                          
                                             (
                                             b
                                             +
                                             
                                                h
                                                1
                                             
                                             +
                                             
                                                h
                                                2
                                             
                                             )
                                          
                                          ]
                                       
                                    
                                 
                                 .
                              


                           Proposition 1 presents us with a potential optimal solution which, in effect, is determined by a fractile of the demand distribution Q( · ). In other words, when producing only product 1 is optimal, the firm plans its production based solely on the demand distribution, while ignoring product 1’s uncertain capacity, which is a little unexpected. Note that in a single-item, single-period system with uncertain capacity, the optimal solution is also not affected by the capacity distribution (Ciarallo et al. 1994). We will show that capacity uncertainty plays an important role in shaping the optimal solution when the firm needs to produce both products. Notice that c
                           2 has no effect on the value of V since no product 2 is produced in this case.

Suppose it is optimal to produce both products such that their target amounts are equal. To find this potential optimal solution, substitute 
                              
                                 
                                    u
                                    2
                                 
                                 =
                                 
                                    Δ
                                    1
                                 
                                 −
                                 
                                    x
                                    2
                                 
                              
                            into (1) and restrict 
                              
                                 Δ
                                 1
                              
                            to be no less than x
                           2, we have another single-dimensional objective function as

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Π
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                E
                                                [
                                                
                                                   (
                                                   
                                                      h
                                                      1
                                                   
                                                   +
                                                   
                                                      h
                                                      2
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Δ
                                                            1
                                                         
                                                         ∧
                                                         
                                                            (
                                                            
                                                               K
                                                               1
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                         
                                                         ∧
                                                         
                                                            (
                                                            
                                                               K
                                                               2
                                                            
                                                            +
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                         
                                                         −
                                                         Z
                                                      
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                b
                                                
                                                   
                                                      (
                                                      
                                                         Z
                                                         −
                                                         
                                                            Δ
                                                            1
                                                         
                                                         ∧
                                                         
                                                            (
                                                            
                                                               K
                                                               1
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                         
                                                         ∧
                                                         
                                                            (
                                                            
                                                               K
                                                               2
                                                            
                                                            +
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      
                                                         h
                                                         i
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               Δ
                                                               1
                                                            
                                                            ∧
                                                            
                                                               (
                                                               
                                                                  K
                                                                  i
                                                               
                                                               +
                                                               
                                                                  x
                                                                  i
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               Δ
                                                               1
                                                            
                                                            ∧
                                                            
                                                               (
                                                               
                                                                  K
                                                                  1
                                                               
                                                               +
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ∧
                                                            
                                                               (
                                                               
                                                                  K
                                                                  2
                                                               
                                                               +
                                                               
                                                                  x
                                                                  2
                                                               
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   c
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   ∧
                                                   
                                                      K
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      
                                                         (
                                                         
                                                            Δ
                                                            1
                                                         
                                                         −
                                                         
                                                            x
                                                            2
                                                         
                                                         )
                                                      
                                                      ∧
                                                      
                                                         K
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    Δ
                                    1
                                 
                                 ∧
                                 
                                    (
                                    
                                       K
                                       i
                                    
                                    +
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            is product i’s available amount and 
                              
                                 
                                    Δ
                                    1
                                 
                                 ∧
                                 
                                    (
                                    
                                       K
                                       1
                                    
                                    +
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ∧
                                 
                                    (
                                    
                                       K
                                       2
                                    
                                    +
                                    
                                       x
                                       2
                                    
                                    )
                                 
                              
                            is the amount of mated products. The firm's sub-problem in this case is

                              
                                 
                                    
                                       
                                          P
                                          2
                                       
                                       :
                                       
                                       
                                          min
                                          
                                             u
                                             1
                                          
                                       
                                       
                                       
                                          Π
                                          2
                                       
                                       
                                          (
                                          
                                             u
                                             1
                                          
                                          )
                                       
                                       
                                       s
                                       .
                                       t
                                       .
                                       
                                       
                                          u
                                          1
                                       
                                       ≥
                                       
                                          x
                                          2
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       ,
                                    
                                 
                              
                           whose optimal solution is provided in the following proposition.


                           
                              Proposition 2
                              
                                 Π
                                 2(u
                                 1) is quasi-convex in u
                                 1 
                                 and the optimal solution
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       2
                                    
                                  
                                 to 
                                 
                                    P
                                 
                                 2 
                                 is
                                 
                                    
                                       (5)
                                       
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                                1
                                                2
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            L
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                            >
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                                  ^
                                                               
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            L
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                            ≤
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 where
                                 
                                    
                                       (6)
                                       
                                          
                                             L
                                             
                                                (
                                                
                                                   u
                                                   1
                                                
                                                )
                                             
                                             =
                                             −
                                             
                                                (
                                                
                                                   h
                                                   1
                                                
                                                +
                                                
                                                   h
                                                   2
                                                
                                                +
                                                b
                                                )
                                             
                                             
                                                Q
                                                ¯
                                             
                                             
                                                (
                                                
                                                   Δ
                                                   1
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      h
                                                      1
                                                   
                                                   +
                                                   
                                                      c
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         F
                                                         ¯
                                                      
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         Δ
                                                         1
                                                      
                                                      −
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      h
                                                      2
                                                   
                                                   +
                                                   
                                                      c
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         F
                                                         ¯
                                                      
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         1
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 and
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                    
                                 
                                 , if applicable, is given by
                                 
                                    
                                       L
                                       (
                                       
                                          
                                             u
                                             ^
                                          
                                          1
                                       
                                       )
                                       =
                                       0
                                    
                                 
                                 , and is finite and unique.
                              

Unlike the potential optimal solution given in Proposition 1, this one given above in Proposition 2 is greatly shaped by the capacity distributions. This is because when producing both products is necessary, the firm needs to take the uncertain capacities into account so as to better coordinate the planned amounts in order to avoid mismatch between the complementary products. The key is that the product complementarity grants one product's uncertain capacity a negative externality on the other product's production activity. When producing only one product is necessary, there is no coordination of planned amounts and the externalities disappear.

Now that we have located the potential optimal solutions 
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 1
                              
                            and 
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 2
                              
                           , we can characterize the global optimal solution as follows.


                           
                              Proposition 3
                              
                                 The firm's optimal production plan 
                                 
                                    u
                                 * is
                                 
                                    
                                       (7)
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                *
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            0
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            ≥
                                                            V
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            V
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            <
                                                            V
                                                            ≤
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            V
                                                            <
                                                            0
                                                            <
                                                            L
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  u
                                                                  ^
                                                               
                                                               1
                                                            
                                                            ,
                                                            
                                                               
                                                                  u
                                                                  ^
                                                               
                                                               1
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            L
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                            ≤
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 or equivalently,
                                 
                                    
                                       (8)
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                
                                                *
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            ≥
                                                            V
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            V
                                                            ,
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               1
                                                            
                                                            <
                                                            V
                                                            ≤
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                            
                                                               x
                                                               2
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            V
                                                            <
                                                            0
                                                            <
                                                            L
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  Δ
                                                                  ^
                                                               
                                                               1
                                                            
                                                            ,
                                                            
                                                               
                                                                  Δ
                                                                  ^
                                                               
                                                               1
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            L
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            )
                                                            ≤
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 where
                                 
                                    
                                       
                                          
                                             Δ
                                             ^
                                          
                                          1
                                       
                                       =
                                       
                                          
                                             u
                                             ^
                                          
                                          1
                                       
                                       +
                                       
                                          x
                                          1
                                       
                                    
                                 
                                 .
                              

Note that from the definitions of V and L( · ), the criteria in (7) are mutually exclusive. In conjunction with Fig. 1, the first case in (8) corresponds to the original point, the second case corresponds to internal point of the thick segment of the horizontal axis, the third case corresponds to the point (x
                           2, x
                           2), and the fourth case corresponds to the internal point of the thick line 
                              
                                 
                                    Δ
                                    1
                                 
                                 =
                                 
                                    Δ
                                    2
                                 
                                 ≥
                                 
                                    x
                                    2
                                 
                              
                           . In other words, if there are already abundant sets (i.e., 
                              
                                 
                                    x
                                    1
                                 
                                 ≥
                                 V
                              
                           ), do not produce; if there are already abundant product 2 (i.e., 
                              
                                 
                                    x
                                    2
                                 
                                 ≥
                                 V
                              
                           ) but insufficient product 1 (i.e., 
                              
                                 
                                    x
                                    1
                                 
                                 <
                                 V
                              
                           ), produce only product 1 such that there may be V units of available set; if both products are not abundant (i.e., 
                              
                                 
                                    x
                                    2
                                 
                                 <
                                 V
                              
                           ), but planning more than x
                           2 units of set is not appealing (i.e., 
                              
                                 L
                                 (
                                 
                                    x
                                    2
                                 
                                 −
                                 
                                    x
                                    1
                                 
                                 )
                                 >
                                 0
                              
                           ), the firm should be just fine with planning x
                           2 units of set; otherwise if both the products are not abundant and planning more than x
                           2 units of set is appealing (i.e., 
                              
                                 L
                                 (
                                 
                                    x
                                    2
                                 
                                 −
                                 
                                    x
                                    1
                                 
                                 )
                                 ≤
                                 0
                              
                           ), the firm should plan more than x
                           2 units of set until the marginal cost is zero (i.e., 
                              
                                 L
                                 (
                                 
                                    
                                       u
                                       ^
                                    
                                    1
                                 
                                 )
                                 =
                                 0
                              
                           ).

If initially there are equal amounts of both products (i.e., 
                              
                                 
                                    x
                                    1
                                 
                                 =
                                 
                                    x
                                    2
                                 
                              
                           ), (7) will degenerate into

                              
                                 (9)
                                 
                                    
                                       
                                          
                                             u
                                          
                                          *
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      (
                                                      0
                                                      ,
                                                      0
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         x
                                                         1
                                                      
                                                      ≥
                                                      
                                                         V
                                                         ¯
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                            ^
                                                         
                                                         1
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                            ^
                                                         
                                                         1
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      
                                                         x
                                                         1
                                                      
                                                      <
                                                      
                                                         V
                                                         ¯
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    V
                                    ¯
                                 
                                 =
                                 
                                    Q
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       b
                                       −
                                       
                                          c
                                          1
                                       
                                       −
                                       
                                          c
                                          2
                                       
                                       )
                                    
                                    /
                                    
                                       (
                                       b
                                       +
                                       
                                          h
                                          1
                                       
                                       +
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    ]
                                 
                              
                           . That is, the firm will always plan equal amounts of both products. Moreover, compared with the case of unequal initial inventories, now she seems more unwilling to engage in production (i.e., given x
                           1, x
                           1 > V always implies 
                              
                                 
                                    x
                                    1
                                 
                                 >
                                 
                                    V
                                    ¯
                                 
                              
                           ).

Back to the general solution in Eq. (7), we can easily demonstrate the effects of parameters on the optimal solution, as summarized in Table 1.
                           
                        

Intuitively, the firm tends to plan more production as penalty cost increases, while he/she tends to plan less as holding costs or production costs increase. When producing only component 1 is necessary (corresponds to second column), surely the production cost of component 2 is irrelevant, and the firm should plan more of component 1 as holding cost of component 2 increases, which is also intuitive.

To better understand the effect of capacity uncertainties on the optimal solution, we examine changes in the firm's choice of which products to produce and the corresponding planned amounts as either capacity distribution is increased stochastically (this can be done through process improvement, preventive maintenance or simply investment in new production line). Note again that we have assumed that product 1’s initial stock level is lower than product 2’s.


                           
                              Definition 1
                              A random variable with distribution 
                                    
                                       
                                          G
                                          ^
                                       
                                       
                                          (
                                          ·
                                          )
                                       
                                    
                                  is said to be stochastically larger than another random variable with distribution G( · ) if ∀y, 
                                    
                                       G
                                       
                                          (
                                          y
                                          )
                                       
                                       ≥
                                       
                                          G
                                          ^
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                 .

Based on such definition and the optimal solution given in (7), we can easily reach the following corollaries as follows.


                           
                              Corollary 1
                              
                                 If initially the firm has at least V (a fractile of demand distribution) units of product 2, that is, x
                                 2 ≥ V, her optimal choice is not affected by the uncertain capacities.


                           Corollary 1 says that there exists a level V which is defined by the cost parameters and the demand distribution only, and if the initial amount of the more abundant product (product 2) is above this level, then the firm's optimal production plan is independent of both products’ capacities uncertainties. To understand this, we need to look at the effect of each product's capacity on its own production and the other product's production. For product 2’s uncertain capacity, it has no effect at all since product 2 is really abundant and no production of it is needed. For product 1’s uncertain capacity, obviously it has no effect on product 2’s zero production, but it sounds somewhat counterintuitive that it also has no effect on product 1’s positive production. In this case, the explanation is the same as in the single-item system (Ciarallo et al. 1994), “one simply has to hope that the capacity is sufficient to produce the optimal amount dictated by the demand and the costs in a single-period situation”. Based on Corollary 1, a production manager, knowing that there are initially at least V units of product 2, can plan production as if there is no capacity uncertainties and just hope that it will go as planned. In fact, when producing only one product (product 1) is necessary, the firm's optimal choice is not affected by the uncertain capacities.


                           
                              Corollary 2
                              
                                 If initially the firm has less than V units of product 2, a stochastic increase in product 1’s capacity leads to an increase in the likelihood of the firm deciding to produce both products, but a stochastic increase in product 2’s capacity does not change this likelihood. That is, if
                                 
                                    
                                       
                                          x
                                          2
                                       
                                       <
                                       V
                                       ,
                                       L
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          −
                                          
                                             x
                                             1
                                          
                                          )
                                       
                                       ≤
                                       0
                                    
                                  
                                 is more likely to be true if K
                                 1 
                                 is stochastically larger, but is independent of K
                                 2.

As can be seen from(6), 
                              
                                 L
                                 (
                                 
                                    x
                                    2
                                 
                                 −
                                 
                                    x
                                    1
                                 
                                 )
                              
                           is smaller if product 1’s capacity is stochastically larger (i.e., 
                              
                                 
                                    
                                       F
                                       ¯
                                    
                                    1
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                              
                            is generally bigger), and is independent of product 2’s capacity distribution 
                              
                                 
                                    
                                       F
                                       ¯
                                    
                                    2
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                              
                           . The intuition is that, when initially product 2 is not abundant (i.e., x
                           2 < V), the firm will consider producing only product 1rather than both products because of one and only one reason: the bottleneck lies in product 1’sshortage and capacity, producing more product 2 can be a waste in this case. Therefore, only increasing product 1’s capacity instead of product 2’s capacity can possibly encourage the firm to produce both products. In other words, when the initial inventories of both products are low (i.e., x
                           1 ≤ x
                           2 < V), it would be better for a production manager who wants to raise output to increase the capacity of the product of less initial stock rather than the capacity of the product of more initial stock.


                           
                              Corollary 3
                              
                                 When producing both products is necessary, a stochastic increase in either product's capacity leads to an equal increase in both products’ optimal target amounts. That is, if
                                 
                                    
                                       L
                                       (
                                       
                                          x
                                          2
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       )
                                       ≤
                                       0
                                    
                                 , 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                    
                                 , or equivalently
                                 
                                    
                                       
                                          Δ
                                          ^
                                       
                                       1
                                    
                                 , becomes higher if K
                                 1 
                                 or K
                                 2 
                                 is stochastically larger.


                           Corollary 3 can be easily shown mathematically through Lemma 1 and L( · )’s monotonicity. Counterintuitively, it implies that increasing only one product's capacity not only would encourage the production manager to plan more of the product, but also would encourage him/her to plan more of another product whose capacity remains unchanged. Moreover, the increments in both products’ optimal planned amounts are equal. Note that in contrast to Corollary 1, Corollary 3 demonstrates the impact of uncertain capacities on the firm's optimal choices when both products should be produced. As stated before, the idea is that the firm needs to take the uncertain capacities into account so as to better coordinate the planned amounts in order to avoid mismatch between the complementary products when producing both products.

We have studied systems of complementary products and assumed no assembly stage in last section. In this section, we consider a general assembly setting where the firm first plans components production before the uncertain production capacities are realized, then after production is executed and outputs are observed, she decides the amount of assembling the components into end-products before uncertain assembly capacity and random demand for the end-product are realized. That is, we have a two-stage problem. Production costs of components are accounted at the end of stage 1, while assembly costs, disposal costs and shortage penalty cost are accounted at the end of stage 2.

As in Section 2, production capacity Ki
                      for component i, 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     , is uncertain and has mutually independent CDF Fi
                     ( · ) on support (0, ∞). Let K
                     0 be the uncertain assembly capacity, it has a differentiable CDF F
                     0( · ) with support on (0, ∞). K
                     0 is independent of the decision variables. Let x
                     0 be the initial stock level of the end-product, c
                     0 and h
                     0 be its unit assembly cost and unit disposal cost respectively. The planned amount of assembling mated components is denoted as u
                     0, hence 
                        
                           
                              Δ
                              0
                           
                           =
                           
                              u
                              0
                           
                           +
                           
                              x
                              0
                           
                        
                      is the target amount of the end-product. Choosing u
                     0 is equivalent to choosing Δ
                     0, and we will use both of them, whichever is convenient, to denote the assembly decision.

Assume that 
                        
                           
                              c
                              i
                           
                           >
                           −
                           
                              h
                              i
                           
                        
                      so that the firm will not infinitely produce component i. Moreover, assume that 
                        
                           
                              h
                              0
                           
                           +
                           
                              c
                              0
                           
                           >
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              
                                 h
                                 i
                              
                              >
                              
                                 c
                                 0
                              
                           
                           −
                           b
                        
                     , that is, assembling an end-product requires substantial efforts (the first inequality), and the firm only assembles mated components into end-products in order to meet the demand (the second inequality). Without loss of generosity, assume that x
                     1 ≤ ⋅⋅⋅ ≤ xn
                     . Other assumptions and notations in Section 2 are relevant unless otherwise stated.

Working backward, given the component production plan 
                           
                              u
                              
                                 =
                                 (
                              
                              
                                 u
                                 1
                              
                              ,
                              ⋯
                              ,
                              
                                 u
                                 n
                              
                              )
                           
                         made in stage 1, obviously the firm must choose u
                        0 in [0, min 
                           i
                        
                        ai
                        ], where ai
                         is the realization of 
                           
                              
                                 A
                                 i
                              
                              =
                              
                                 u
                                 i
                              
                              ∧
                              
                                 K
                                 i
                              
                              +
                              
                                 x
                                 i
                              
                           
                         (i.e., the amount of available component i) and min 
                           i
                        
                        ai
                         is the realized amount of mated components. The firm's second-stage objective function is

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             π
                                             (
                                             
                                                u
                                                0
                                             
                                             |
                                             u
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             [
                                             
                                                h
                                                0
                                             
                                             
                                                
                                                   (
                                                   
                                                      u
                                                      0
                                                   
                                                   ∧
                                                   
                                                      K
                                                      0
                                                   
                                                   +
                                                   
                                                      x
                                                      0
                                                   
                                                   −
                                                   Z
                                                   )
                                                
                                                +
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             b
                                             
                                                
                                                   (
                                                   Z
                                                   −
                                                   
                                                      u
                                                      0
                                                   
                                                   ∧
                                                   
                                                      K
                                                      0
                                                   
                                                   −
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                +
                                             
                                             +
                                             
                                                c
                                                0
                                             
                                             
                                                (
                                                
                                                   u
                                                   0
                                                
                                                ∧
                                                
                                                   K
                                                   0
                                                
                                                )
                                             
                                             
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   h
                                                   i
                                                
                                                
                                                   (
                                                
                                                
                                                   a
                                                   i
                                                
                                                −
                                             
                                             
                                                u
                                                0
                                             
                                             ∧
                                             
                                                K
                                                0
                                             
                                             
                                                )
                                                ,
                                                
                                                0
                                                ≤
                                             
                                             
                                                u
                                                0
                                             
                                             ≤
                                             
                                                min
                                                i
                                             
                                             
                                                a
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the expectation is taken over K
                        0 and Z. The best decision in stage 2 is given as follows.


                        
                           Proposition 4
                           
                              π(u
                              0|
                                 u
                              ) is quasi-convex in u
                              0 
                              and the firm's optimal decision in stage 2 is characterized by
                              
                                 
                                    (11)
                                    
                                       
                                          
                                             u
                                             0
                                             *
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         i
                                                         f
                                                         
                                                         
                                                         
                                                         
                                                            L
                                                            0
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                         >
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                               ¯
                                                            
                                                            0
                                                            *
                                                         
                                                         ,
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         i
                                                         f
                                                         
                                                         
                                                         
                                                         
                                                            L
                                                            0
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                         ≤
                                                         0
                                                         ≤
                                                         
                                                            L
                                                            0
                                                         
                                                         
                                                            (
                                                            
                                                               min
                                                               i
                                                            
                                                            
                                                               a
                                                               i
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            min
                                                            i
                                                         
                                                         
                                                            a
                                                            i
                                                         
                                                         ,
                                                         
                                                         
                                                         i
                                                         f
                                                         
                                                         
                                                         
                                                         
                                                            L
                                                            0
                                                         
                                                         
                                                            (
                                                            
                                                               min
                                                               i
                                                            
                                                            
                                                               a
                                                               i
                                                            
                                                            )
                                                         
                                                         <
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       L
                                       0
                                    
                                    
                                       (
                                       
                                          u
                                          0
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          h
                                          0
                                       
                                       +
                                       b
                                       )
                                    
                                    Q
                                    
                                       (
                                       
                                          Δ
                                          0
                                       
                                       )
                                    
                                    −
                                    b
                                    +
                                    
                                       c
                                       0
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       h
                                       i
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                               
                              is given by
                              
                                 
                                    
                                       L
                                       0
                                    
                                    
                                       (
                                       
                                          
                                             u
                                             ¯
                                          
                                          0
                                          *
                                       
                                       )
                                    
                                    =
                                    0
                                 
                              
                              .
                           

We can show that 
                           
                              
                                 π
                                 ′
                              
                              
                                 (
                                 
                                    u
                                    0
                                 
                                 )
                              
                              =
                              
                                 
                                    F
                                    ¯
                                 
                                 0
                              
                              
                                 (
                                 
                                    u
                                    0
                                 
                                 )
                              
                              
                                 L
                                 0
                              
                              
                                 (
                                 
                                    u
                                    0
                                 
                                 )
                              
                           
                        . Since 
                           
                              
                                 
                                    F
                                    ¯
                                 
                                 0
                              
                              
                                 (
                                 ·
                                 )
                              
                              >
                              0
                           
                        , π′(u
                        0) has the same sign as L
                        0(u
                        0). Moreover, L
                        0(u
                        0) is increasing in u
                        0, hence π(u
                        0) is quasi-convex and (11) is a natural result. If L
                        0(0) > 0 (i.e., 
                           
                              
                                 x
                                 0
                              
                              >
                              
                                 Q
                                 
                                    −
                                    1
                                 
                              
                              
                                 [
                                 
                                    (
                                    b
                                    −
                                    
                                       c
                                       0
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       h
                                       i
                                    
                                    )
                                 
                                 /
                                 
                                    (
                                    
                                       h
                                       0
                                    
                                    +
                                    b
                                    )
                                 
                                 ]
                              
                           
                        ), there is no need to assemble since initially there are abundant end-products. If L
                        0(0) ≤ 0 ≤ L
                        0(min 
                           i
                        
                        ai
                        ), the firm needs more end-products and with enough mated components, she assembles up to that level. If L
                        0(min 
                           i
                        
                        ai
                        ) < 0, the firm needs more end-products but does not have enough mated components to assemble up to that level, she then just tries to assemble all mated components. Therefore, when L
                        0(0) ≤ 0, the optimal solution can simply be written as 
                           
                              
                                 u
                                 0
                                 *
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                              ∧
                              
                                 min
                                 i
                              
                              
                                 a
                                 i
                              
                           
                        . Note that given the assumptions on the costs, 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         is finite and unique.

Now back to stage 1, for a production plan 
                           u
                        , the firm's total cost function is

                           
                              (12)
                              
                                 
                                    Π
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    E
                                    
                                       [
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                c
                                                i
                                             
                                             
                                                (
                                                
                                                   u
                                                   i
                                                
                                                ∧
                                                
                                                   K
                                                   i
                                                
                                                )
                                             
                                          
                                          +
                                          π
                                          
                                             (
                                             
                                                
                                                   u
                                                   0
                                                   *
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

From (
11
), if L
                        0(0) > 0, obviously it is optimal to produce no components in stage 1 because the firm will not assemble for sure in stage 2. Therefore, we should focus on the case of L
                        0(0) ≤ 0. In this case, if 
                           
                              
                                 x
                                 1
                              
                              >
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                        , then 
                           
                              
                                 x
                                 i
                              
                              >
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        , that is, the firm initially has enough mated components to meet her target assembly level, so she will produce nothing in stage 1 and will assemble 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         units of end-products in stage 2. So for the rest of analysis, to keep things interesting, let us assume that L
                        0(0) ≤ 0 and 
                           
                              
                                 x
                                 1
                              
                              ≤
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                        , and we have the following lemma.


                        
                           Lemma 2
                           
                              If L
                              0(0) ≤ 0 and
                              
                                 
                                    
                                       x
                                       1
                                    
                                    ≤
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                 
                              , it is optimal for the firm to plan component production such that
                              
                                 
                                    0
                                    ≤
                                    
                                       u
                                       i
                                    
                                    ≤
                                    
                                       
                                          (
                                          
                                             
                                                u
                                                ¯
                                             
                                             0
                                             *
                                          
                                          −
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       +
                                    
                                 
                              , 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                               
                              in stage 1, and try to assemble all the mated components in stage 2.

Note that in last subsection we have shown that the optimal assembly solution is 
                           
                              
                                 u
                                 0
                                 *
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                              ∧
                              
                                 min
                                 i
                              
                              
                                 a
                                 i
                              
                           
                         when L
                        0(0) ≤ 0. So having 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         in mind, intuitively, it is meaningless for the firm to have more than 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         units of component 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         because the firm will need only at most 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         units of component i in stage 2. In turn, there should be 
                           
                              
                                 u
                                 0
                                 *
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 min
                                 i
                              
                              
                                 a
                                 i
                              
                           
                         (i.e., the firm tries to assemble all the mated components in stage 2) because min 
                           i
                        
                        ai
                         is always not bigger than 
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                         as long as 
                           
                              
                                 u
                                 i
                              
                              ≤
                              
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 +
                              
                           
                        , for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         and 
                           
                              
                                 x
                                 1
                              
                              ≤
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                        .

Based on Lemma 2, we can work with a modified total cost function where the firm plans to assemble all the mated components in stage 2, and the problem becomes

                           
                              (13)
                              
                                 
                                    P
                                    :
                                    
                                    
                                       min
                                       
                                          0
                                          ≤
                                          
                                             u
                                             i
                                          
                                          ≤
                                          
                                             
                                                (
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   0
                                                   *
                                                
                                                −
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             +
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          ⋯
                                          ,
                                          n
                                       
                                    
                                    Π
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    E
                                    
                                       [
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                c
                                                i
                                             
                                             
                                                (
                                                
                                                   u
                                                   i
                                                
                                                ∧
                                                
                                                   K
                                                   i
                                                
                                                )
                                             
                                          
                                          +
                                          π
                                          
                                             (
                                             
                                                
                                                   u
                                                   0
                                                   *
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

We next show that there exists a lemma analogous to Lemma 1.
                     


                        
                           Lemma 3
                           
                              The firm's best choices in stage 1 can only be: (a) producing no components at all or producing only components
                              
                                 
                                    1
                                    ,
                                    …
                                    ,
                                    j
                                 
                              , for some
                              
                                 
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    ⋯
                                    ,
                                    n
                                    −
                                    1
                                    }
                                 
                              , such that their target amounts are equal and no higher than component
                              
                                 
                                    j
                                    +
                                    1
                                 
                              ’s initial stock level, (b) producing all components such that the target amounts of them are equal. In other words, the optimal solution 
                              
                                 u
                              *, or equivalently, 
                                 Δ
                              *, to 
                              
                                 P
                               
                              either satisfies (a)
                              
                                 
                                    
                                       x
                                       j
                                    
                                    ≤
                                    
                                       Δ
                                       1
                                       *
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       Δ
                                       j
                                       *
                                    
                                    ≤
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                               
                              for some
                              
                                 
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    −
                                    1
                                    }
                                 
                              , and
                              
                                 
                                    
                                       Δ
                                       l
                                       *
                                    
                                    =
                                    
                                       x
                                       l
                                    
                                 
                               
                              for
                              
                                 
                                    l
                                    =
                                    j
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                 
                              , or (b)
                              
                                 
                                    
                                       Δ
                                       1
                                       *
                                    
                                    =
                                    ⋯
                                    =
                                    
                                       Δ
                                       n
                                       *
                                    
                                    ≥
                                    
                                       x
                                       n
                                    
                                 
                              .

Note that when it is optimal for the firm to produce components 
                           
                              1
                              ,
                              …
                              ,
                              j
                           
                         (i.e., case (a) in Lemma 3), there must be 
                           
                              
                                 x
                                 j
                              
                              <
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                         because otherwise there is no need to produce component j by Lemma 2. Likewise, when it is optimal to produce all components (i.e., case (b) in Lemma 3), there must be 
                           
                              
                                 x
                                 n
                              
                              <
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                         because otherwise there is no need to produce component n. As in the two-component system, we first try to locate the potential optimal solutions by assuming the optimal solution takes the form of case (a) or case (b) in Lemma 3, then we identify the global one later. We will also show that the constraints 
                           
                              
                                 u
                                 i
                              
                              ≤
                              
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 +
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                         are never binding unless 
                           
                              
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 +
                              
                              =
                              0
                           
                         (i.e., 
                           
                              
                                 x
                                 i
                              
                              ≥
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                           
                        ).

Suppose it is optimal for the firm to produce only components 
                              
                                 1
                                 ,
                                 …
                                 ,
                                 j
                              
                            for some 
                              
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                                 −
                                 1
                                 }
                              
                            such that their target amounts are equal and at most as high as component 
                              
                                 j
                                 +
                                 1
                              
                           ’s initial stock level. To find this potential optimal solution, substitute 
                              
                                 
                                    u
                                    k
                                 
                                 =
                                 
                                    Δ
                                    1
                                 
                                 −
                                 
                                    x
                                    k
                                 
                              
                           , 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 j
                              
                            and 
                              
                                 
                                    u
                                    l
                                 
                                 =
                                 0
                              
                           , 
                              
                                 l
                                 =
                                 j
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            into (12) and restrict Δ
                           1 in zone 
                              
                                 [
                                 
                                    x
                                    j
                                 
                                 ,
                                 
                                    x
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           , we have a single-dimensional objective function as

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Π
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         j
                                                      
                                                      
                                                         
                                                            c
                                                            i
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  (
                                                                  
                                                                     Δ
                                                                     1
                                                                  
                                                                  −
                                                                  
                                                                     x
                                                                     i
                                                                  
                                                                  )
                                                               
                                                               ∧
                                                               
                                                                  K
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            c
                                                            0
                                                         
                                                         
                                                            (
                                                            
                                                               min
                                                               i
                                                            
                                                            
                                                            
                                                               A
                                                               i
                                                            
                                                            ∧
                                                            
                                                               K
                                                               0
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   h
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      
                                                         min
                                                         i
                                                      
                                                      
                                                      
                                                         A
                                                         i
                                                      
                                                      ∧
                                                      
                                                         K
                                                         0
                                                      
                                                      +
                                                      
                                                         x
                                                         0
                                                      
                                                      −
                                                      Z
                                                      )
                                                   
                                                   +
                                                
                                                +
                                                b
                                                
                                                   
                                                      (
                                                      Z
                                                      −
                                                      
                                                         min
                                                         i
                                                      
                                                      
                                                      
                                                         A
                                                         i
                                                      
                                                      ∧
                                                      
                                                         K
                                                         0
                                                      
                                                      −
                                                      
                                                         x
                                                         0
                                                      
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   j
                                                
                                                
                                                   
                                                      h
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Δ
                                                            1
                                                         
                                                         ∧
                                                         
                                                            (
                                                            
                                                               K
                                                               i
                                                            
                                                            +
                                                            
                                                               x
                                                               i
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      j
                                                      +
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      h
                                                      i
                                                   
                                                   
                                                      x
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         h
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      min
                                                      i
                                                   
                                                   
                                                   
                                                      A
                                                      i
                                                   
                                                   ∧
                                                   
                                                      K
                                                      0
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           where the amount of mated components is 
                              
                                 
                                    min
                                    i
                                 
                                 
                                 
                                    A
                                    i
                                 
                                 =
                                 
                                    Δ
                                    1
                                 
                                 ∧
                                 
                                    (
                                    
                                       K
                                       1
                                    
                                    +
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ∧
                                 ⋯
                                 ∧
                                 
                                    (
                                    
                                       K
                                       j
                                    
                                    +
                                    
                                       x
                                       j
                                    
                                    )
                                 
                              
                            in this case, then the corresponding sub-problem is

                              
                                 
                                    
                                       
                                          P
                                          j
                                       
                                       :
                                       
                                          min
                                          
                                             u
                                             1
                                          
                                       
                                       
                                       
                                          Π
                                          j
                                       
                                       
                                          (
                                          
                                             u
                                             1
                                          
                                          )
                                       
                                       ,
                                       
                                       s
                                       .
                                       t
                                       .
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       ≤
                                       
                                          u
                                          1
                                       
                                       ≤
                                       
                                          x
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       ,
                                    
                                 
                              
                           whose optimal solution is provided in the following proposition.


                           
                              Proposition 5
                              
                                 Πj
                                 (u
                                 1) is quasi-convex in u
                                 1 
                                 and the optimal solution
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       j
                                    
                                  
                                 to 
                                 
                                    P
                                 
                                 
                                    j
                                  
                                 is
                                 
                                    
                                       (15)
                                       
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                                1
                                                j
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               L
                                                               j
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  j
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ≥
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                               1
                                                               j
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               L
                                                               j
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  j
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               j
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  
                                                                     j
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               L
                                                               j
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  
                                                                     j
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

We can show that 
                              
                                 
                                    Π
                                    j
                                    ′
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    j
                                 
                                 
                                    
                                       
                                          F
                                          ¯
                                       
                                       k
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       −
                                       
                                          x
                                          k
                                       
                                       )
                                    
                                    
                                       
                                          F
                                          ¯
                                       
                                       0
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                              
                            and Lj
                           (u
                           1) is an increasing function, hence Πj
                           (u
                           1) is quasi-convex and (15) is a natural result. Only the uncertain capacities of components 
                              
                                 1
                                 ,
                                 …
                                 ,
                                 j
                              
                            may have effect on the optimal solution 
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 j
                              
                            since other components will not be produced, and none of the components’ capacities has effect on the optimal solution when 
                              
                                 j
                                 =
                                 1
                              
                           . However, the uncertain assembly capacity, along with the random demand, always affects the optimal solution.

We now explain why the constraints 
                              
                                 
                                    u
                                    i
                                 
                                 ≤
                                 
                                    
                                       (
                                       
                                          
                                             u
                                             ¯
                                          
                                          0
                                          *
                                       
                                       −
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    +
                                 
                              
                           , 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                            are never binding unless 
                              
                                 
                                    
                                       (
                                       
                                          
                                             u
                                             ¯
                                          
                                          0
                                          *
                                       
                                       −
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    +
                                 
                                 =
                                 0
                              
                           . Note that we have argued that when producing components 1, ⋅⋅⋅, j is optimal, there must be 
                              
                                 
                                    x
                                    j
                                 
                                 <
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                              
                            by Lemma 2, or 
                              
                                 
                                    x
                                    j
                                 
                                 −
                                 
                                    x
                                    1
                                 
                                 <
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    1
                                 
                              
                           . Moreover, from the definition of 
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                            (i.e., 
                              
                                 
                                    L
                                    0
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    )
                                 
                                 =
                                 0
                              
                           ), there always exists 
                              
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ≥
                                 0
                              
                           , which implies that 
                              
                                 
                                    
                                       u
                                       ^
                                    
                                    1
                                    j
                                 
                                 ≤
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    1
                                 
                              
                           , hence the optimal planned amounts of the components naturally satisfy 
                              
                                 0
                                 ≤
                                 
                                    u
                                    i
                                    *
                                 
                                 ≤
                                 
                                    
                                       (
                                       
                                          
                                             u
                                             ¯
                                          
                                          0
                                          *
                                       
                                       −
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    +
                                 
                              
                           , 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           . The intuition is that when the firm plans to assemble all the mated components in stage 2 (as Π(
                              u
                           ) itself indicates), she will never plan more than 
                              
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 +
                              
                            units of component i in stage 1 because otherwise she may end up with assembling more end-products than she needs.

Suppose it is optimal to produce all components such that their target amounts are equal. To find this potential optimal solution, substitute 
                              
                                 
                                    u
                                    l
                                 
                                 =
                                 
                                    Δ
                                    1
                                 
                                 −
                                 
                                    x
                                    l
                                 
                              
                           , 
                              
                                 l
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                            into (12) and restrict Δ
                           1 in zone [xn
                           , ∞), we have a single-dimensional objective function as

                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Π
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      u
                                                      1
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            c
                                                            i
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  (
                                                                  
                                                                     Δ
                                                                     1
                                                                  
                                                                  −
                                                                  
                                                                     x
                                                                     i
                                                                  
                                                                  )
                                                               
                                                               ∧
                                                               
                                                                  K
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            c
                                                            0
                                                         
                                                         
                                                            (
                                                            
                                                               min
                                                               i
                                                            
                                                            
                                                            
                                                               A
                                                               i
                                                            
                                                            ∧
                                                            
                                                               K
                                                               0
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   h
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      
                                                         min
                                                         i
                                                      
                                                      
                                                      
                                                         A
                                                         i
                                                      
                                                      ∧
                                                      
                                                         K
                                                         0
                                                      
                                                      +
                                                      
                                                         x
                                                         0
                                                      
                                                      −
                                                      Z
                                                      )
                                                   
                                                   +
                                                
                                                +
                                                b
                                                
                                                   
                                                      (
                                                      Z
                                                      −
                                                      
                                                         min
                                                         i
                                                      
                                                      
                                                      
                                                         A
                                                         i
                                                      
                                                      ∧
                                                      
                                                         K
                                                         0
                                                      
                                                      −
                                                      
                                                         x
                                                         0
                                                      
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      
                                                         h
                                                         i
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               Δ
                                                               1
                                                            
                                                            ∧
                                                            
                                                               (
                                                               
                                                                  K
                                                                  i
                                                               
                                                               +
                                                               
                                                                  x
                                                                  i
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               min
                                                               i
                                                            
                                                            
                                                            
                                                               A
                                                               i
                                                            
                                                            ∧
                                                            
                                                               K
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           where the amount of mated components is 
                              
                                 
                                    min
                                    i
                                 
                                 
                                 
                                    A
                                    i
                                 
                                 =
                                 
                                    Δ
                                    1
                                 
                                 ∧
                                 
                                    (
                                    
                                       K
                                       1
                                    
                                    +
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ∧
                                 ⋯
                                 ∧
                                 
                                    (
                                    
                                       K
                                       n
                                    
                                    +
                                    
                                       x
                                       n
                                    
                                    )
                                 
                              
                            in this case, then the corresponding sub-problem is

                              
                                 
                                    
                                       
                                          P
                                          n
                                       
                                       :
                                       
                                          min
                                          
                                             u
                                             1
                                          
                                       
                                       
                                       
                                          Π
                                          n
                                       
                                       
                                          (
                                          
                                             u
                                             1
                                          
                                          )
                                       
                                       ,
                                       
                                       
                                       s
                                       .
                                       t
                                       .
                                       
                                       
                                          x
                                          n
                                       
                                       −
                                       
                                          x
                                          1
                                       
                                       ≤
                                       
                                          u
                                          1
                                       
                                       ,
                                    
                                 
                              
                           whose optimal solution is provided in the following proposition.


                           
                              Proposition 6
                              
                                 Πn
                                 (u
                                 1) is quasi-convex in u
                                 1 
                                 and the optimal solution
                                 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       n
                                    
                                  
                                 to 
                                 
                                    P
                                 
                                 
                                    n
                                  
                                 is
                                 
                                    
                                       (18)
                                       
                                          
                                             
                                                
                                                   u
                                                   ^
                                                
                                                1
                                                n
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                               1
                                                               n
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               L
                                                               n
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ≤
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               n
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               L
                                                               n
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            >
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

We can show that 
                              
                                 
                                    Π
                                    n
                                    ′
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       
                                          F
                                          ¯
                                       
                                       k
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       −
                                       
                                          x
                                          k
                                       
                                       )
                                    
                                    
                                       
                                          F
                                          ¯
                                       
                                       0
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    L
                                    n
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    L
                                    n
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                              
                            is an increasing function, hence Πn
                           (u
                           1) is quasi-convex and (18) is a natural result. As stated before, when producing all components is optimal, there must be 
                              
                                 
                                    x
                                    n
                                 
                                 <
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                              
                            by Lemma 2, or 
                              
                                 
                                    x
                                    n
                                 
                                 −
                                 
                                    x
                                    1
                                 
                                 <
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    1
                                 
                              
                           . Moreover, from the definition of 
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                            (i.e., 
                              
                                 
                                    L
                                    0
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    )
                                 
                                 =
                                 0
                              
                           ), there always exists 
                              
                                 
                                    L
                                    n
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ¯
                                       
                                       0
                                       *
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ≥
                                 0
                              
                           , which implies that 
                              
                                 
                                    
                                       u
                                       ^
                                    
                                    1
                                    n
                                 
                                 ≤
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    1
                                 
                              
                           , hence the optimal planned amounts of the components naturally satisfy 
                              
                                 0
                                 ≤
                                 
                                    u
                                    i
                                    *
                                 
                                 ≤
                                 
                                    
                                       (
                                       
                                          
                                             u
                                             ¯
                                          
                                          0
                                          *
                                       
                                       −
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    +
                                 
                              
                           , 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           .

Now that we have located the potential optimal solutions 
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 i
                              
                           , 
                              
                                 i
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                              
                           , we can characterize the global optimal solution in stage 1 as follows.


                           
                              Proposition 7
                              
                                 The firm's optimal production plan 
                                 u* in stage 1is
                                 
                                    
                                       (19)
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   u
                                                
                                                *
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               1
                                                            
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               u
                                                               1
                                                               1
                                                            
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               1
                                                            
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               1
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               2
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               1
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               2
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               u
                                                               1
                                                               2
                                                            
                                                            ,
                                                            
                                                               u
                                                               1
                                                               2
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               2
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  2
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               2
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  3
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ⋯
                                                            ,
                                                         
                                                      
                                                      
                                                         ⋯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               u
                                                               1
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               u
                                                               1
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               u
                                                               1
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  
                                                                     n
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               n
                                                            
                                                            −
                                                            
                                                               x
                                                               1
                                                            
                                                            ,
                                                            
                                                               x
                                                               n
                                                            
                                                            −
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               x
                                                               n
                                                            
                                                            −
                                                            
                                                               x
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ,
                                                            0
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               
                                                                  n
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            <
                                                            0
                                                            ≤
                                                            
                                                               L
                                                               n
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               u
                                                               1
                                                               n
                                                            
                                                            ,
                                                            
                                                               u
                                                               1
                                                               n
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               2
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               u
                                                               1
                                                               n
                                                            
                                                            +
                                                            
                                                               x
                                                               1
                                                            
                                                            −
                                                            
                                                               x
                                                               n
                                                            
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            f
                                                            
                                                            
                                                            
                                                               L
                                                               n
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  n
                                                               
                                                               −
                                                               
                                                                  x
                                                                  1
                                                               
                                                               )
                                                            
                                                            ≤
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Interestingly, (19) is general enough to incorporate two special cases of when L
                           0(0) > 0, or when L
                           0(0) ≤ 0 and 
                              
                                 
                                    x
                                    1
                                 
                                 >
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                              
                           . In either case, the optimal solution in stage 1 is to produce nothing. But both cases imply that L
                           1(0) ≥ 0. Therefore, (19) is the general optimal solution in stage 1.

For 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                              
                           , it is clear that 
                              
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       j
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 <
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                              
                            from Lj
                           ( · )’s monotonicity, and we can show that there exist 
                              
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 <
                                 
                                    L
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                              
                            based on (16), that is, the criteria in (19) are mutually exclusive. Moreover, by definition, we have 
                              
                                 
                                    Π
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    Π
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                              
                           . So for each criterion, using (15) and (18), one can identify the optimal solution in an algorithmic manner. The structure of this optimal solution is as predicted by Lemma 3.
                        


                           
                              Corollary 4
                              
                                 A stochastic increase in the assembly capacity leads to an increase in all components’ optimal target amounts. That is, 
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       j
                                    
                                 , or equivalently
                                 
                                    
                                       
                                          Δ
                                          ^
                                       
                                       1
                                       j
                                    
                                 , 
                                    
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 , become higher if K
                                 0 
                                 is stochastically larger.

From the definition of Lj
                           (u
                           1) and 
                              
                                 u
                                 1
                                 j
                              
                           , 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           , we know that if K
                           0 is stochastically larger (i.e., 
                              
                                 
                                    
                                       F
                                       ¯
                                    
                                    0
                                 
                                 
                                    (
                                    u
                                    )
                                 
                              
                            becomes bigger for any u), Lj
                           (u
                           1) will become smaller for any u
                           1, and 
                              
                                 u
                                 1
                                 j
                              
                            will become bigger. These mean that the firm tends to plan more components production when the assembly capacity is stochastically larger. This is simply because that the additional uncertain assembly capacity increases the risk of having more unused components, hence the firm becomes more cautious about a stochastically-smaller capacity.

In this paper, we studied the single-period optimal production planning problem in assembly systems with random demand and uncertain production and assembly capacities. The cost-minimizing firm plans components productions before the production capacities are realized, then after the outputs of components are observed, she decides the assembly amount before the demand and assembly capacity realizations.

We first studied a simplified system of selling two complementary products without an assembly stage. Without loss of generosity, assume that there are more products 2 than products 1 initially. The firm's best plan can only be: (a) producing no products or producing only product1 such that its target amount is not higher than product 2’s initial stock level, or (b) producing both products such that their target amounts are equal. In case (a), the optimal solution is dictated by the demand distribution and costs but not by the uncertain capacities. While in case (b), the firm's planned amounts of components are correlated and she needs to consider the risk of mismatch of products when making plan; as a result, the uncertain capacities play important roles in shaping the firm's optimal behavior. A stochastic increase in any product's capacity leads to an increase in the optimal target amounts. The choice between (a) and (b) is determined by the initial stock levels and product 1’s uncertain capacity. A stochastic increase in product 1’s capacity leads to an increase in the likelihood of the firm deciding to produce more both products. However, a stochastic increase in product 2’s capacity does not change this likelihood.

For a general assembly system with n components, if initially the firm has more end-product than a certain level dictated by the demand distribution and costs, she will neither produce any component nor assemble any end-product; if initially the firm does not have that many end-products but does have abundant mated components, she will produce nothing for the components and assemble up to that certain level; otherwise, in stage 1 she will plan less components than what are needed to assemble up to that level and will assemble as many as possible in stage 2. In the last case, the assembly system is equivalent to a system of selling complementary components, but with uncertain assembly capacity; the firm tends to plan more when the assembly capacity is unlimited than when it is uncertain, even if assembly is absolutely free.

We have assumed that only executed production bears cost. However, planning per se may cost money. For example, the cost of planning to produce ui
                      units of component i might be 
                        
                           
                              c
                              i
                           
                           
                              (
                              
                                 u
                                 i
                              
                              ∧
                              
                                 K
                                 i
                              
                              )
                           
                           +
                           
                              c
                              i
                              ′
                           
                           
                              u
                              i
                           
                        
                     , where 
                        
                           c
                           i
                           ′
                        
                      is the unit cost of planning (e.g., cost of preparing raw material and human resource). We expect that such change of cost structure may complicate our model to a certain extent, but the corresponding model may still be tractable since Πi
                     (u
                     1) will remain quasi-convex. The model will be even more complicated if the cost structure is further generalized to incorporate setup costs.

For future research, one may consider to extend the model into a multi-period setting. However, the problem seems extremely difficult because the production decision of each component will be affected by not only its uncertain capacity but also other components’ uncertain capacities, let alone the random demand and uncertain assembly capacity. The work of DeCroix (2013) on inventory control of an assembly system subject to supply disruptions (disruption in their paper can be thought of a special case of uncertain capacity which is either zero or infinite) demonstrates such complexities. Production and pricing in decentralized systems where the suppliers’ capacities are uncertain is also worth studying.

@&#ACKNOWLEDGMENTS@&#

We would like to thank the Editors and the anonymous reviewers for their significant help. This work is supported by National Natural Science Foundation of China (grant nos. 71272093, 71421001, 71531002). The first author was financially supported by The China Scholarship Council (CSC) during his visit at University of California, Riverside.


                     
                        
                           
                              
                              
                              
                                 
                                    
                                       
                                          Z
                                       , 
                                          
                                             Q
                                             (
                                             ·
                                             )
                                          
                                       
                                    
                                    Random demand in the coming season and its CDF
                                 
                                 
                                    
                                       
                                          
                                             K
                                             i
                                          
                                       , 
                                          
                                             
                                                F
                                                i
                                             
                                             
                                                (
                                                ·
                                                )
                                             
                                          
                                       
                                    
                                    Uncertain production capacity for component/product 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                        and its CDF
                                 
                                 
                                    
                                       
                                          
                                             K
                                             0
                                          
                                       , 
                                          
                                             
                                                F
                                                0
                                             
                                             
                                                (
                                                ·
                                                )
                                             
                                          
                                       
                                    
                                    Uncertain assembly capacity and its CDF
                                 
                                 
                                    
                                       
                                          
                                             x
                                             i
                                          
                                       , 
                                          
                                             x
                                             0
                                          
                                       
                                    
                                    Initial inventory levels of component/product 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                        and the end product, respectively
                                 
                                 
                                    
                                       
                                          
                                             u
                                             i
                                          
                                       , 
                                          
                                             Δ
                                             i
                                          
                                       , 
                                          
                                             A
                                             i
                                          
                                       
                                    
                                    Planned production amount, target amount and available amount of component/product 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       , where 
                                          
                                             
                                                Δ
                                                i
                                             
                                             =
                                             
                                                u
                                                i
                                             
                                             +
                                             
                                                x
                                                i
                                             
                                          
                                        and 
                                          
                                             
                                                A
                                                i
                                             
                                             =
                                             min
                                             
                                                {
                                                
                                                   u
                                                   i
                                                
                                                ,
                                                
                                                   K
                                                   i
                                                
                                                }
                                             
                                             +
                                             
                                                x
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             u
                                             0
                                          
                                       , 
                                          
                                             Δ
                                             0
                                          
                                       
                                    
                                    Planned assembly amount and target amount of end product, where 
                                          
                                             
                                                Δ
                                                0
                                             
                                             =
                                             
                                                u
                                                0
                                             
                                             +
                                             
                                                x
                                                0
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          x
                                       , 
                                          u
                                       , 
                                          
                                             Δ
                                          
                                       
                                    
                                    
                                       
                                          
                                             x
                                             =
                                             (
                                             
                                                x
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                x
                                                n
                                             
                                             )
                                          
                                       , 
                                          
                                             u
                                             =
                                             (
                                             
                                                u
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                u
                                                n
                                             
                                             )
                                          
                                       , 
                                          
                                             
                                                Δ
                                             
                                             =
                                             (
                                             
                                                Δ
                                                1
                                             
                                             ,
                                             …
                                             ,
                                             
                                                Δ
                                                n
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                                ^
                                             
                                             i
                                          
                                       
                                    
                                    Potential optimal solution when producing components/products 1 to 
                                          i
                                        is optimal
                                 
                                 
                                    
                                       
                                          
                                             c
                                             i
                                          
                                       , 
                                          
                                             h
                                             i
                                          
                                       
                                    
                                    Unit production cost and unit disposal cost of component/product 
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                             0
                                          
                                       , 
                                          
                                             h
                                             0
                                          
                                       
                                    
                                    Unit assembly cost and unit disposal cost of the end product
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    Unit penalty cost of unmet demand
                                 
                              
                           
                        
                     
                  


                     Proof of Lemma 1. Taking advantage of Fig. 1, in domain of Δ
                     1 > Δ
                     2, we have 
                        
                           
                              
                                 ∂
                                 Π
                                 (
                                 u
                                 )
                              
                              /
                              
                                 ∂
                                 
                                    u
                                    1
                                 
                              
                           
                           =
                           
                              (
                              
                                 h
                                 1
                              
                              +
                              
                                 c
                                 1
                              
                              )
                           
                           
                              
                                 F
                                 ¯
                              
                              1
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           >
                           0
                        
                     . That is, given Δ
                     2, the firm will be better off by lowering u
                     1 as long as Δ
                     1 > Δ
                     2, thus the optimal point must satisfy 
                        
                           
                              Δ
                              1
                              *
                           
                           ≤
                           
                              Δ
                              2
                              *
                           
                        
                     . Similarly, consider the domain of Δ
                     1 < Δ
                     2,which is further divided into two subdomains x
                     2 < Δ
                     1 < Δ
                     2 and Δ
                     1 < x
                     2 < Δ
                     2, we also have 
                        
                           
                              
                                 ∂
                                 Π
                                 (
                                 u
                                 )
                              
                              /
                              
                                 ∂
                                 
                                    u
                                    2
                                 
                              
                           
                           =
                           
                              (
                              
                                 h
                                 2
                              
                              +
                              
                                 c
                                 2
                              
                              )
                           
                           
                              
                                 F
                                 ¯
                              
                              2
                           
                           
                              (
                              
                                 u
                                 2
                              
                              )
                           
                           >
                           0
                        
                     . That is, given Δ
                     1, the firm will be better off by lowering u
                     2 as long as Δ
                     1 < Δ
                     2, which then leads to (a) 
                        
                           
                              Δ
                              2
                              *
                           
                           =
                           
                              x
                              2
                           
                           ≥
                           
                              Δ
                              1
                              *
                           
                           ≥
                           
                              x
                              1
                           
                        
                      or (b) 
                        
                           
                              Δ
                              1
                              *
                           
                           =
                           
                              Δ
                              2
                              *
                           
                           ≥
                           
                              x
                              2
                           
                        
                     . □


                     Proof of Proposition 1. Taking the derivative, we have 
                        
                           
                              Π
                              1
                              ′
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           =
                           
                              
                                 F
                                 ¯
                              
                              1
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           
                              [
                              
                                 (
                                 b
                                 +
                                 
                                    h
                                    1
                                 
                                 +
                                 
                                    h
                                    2
                                 
                                 )
                              
                              Q
                              
                                 (
                                 
                                    Δ
                                    1
                                 
                                 )
                              
                              −
                              b
                              −
                              
                                 h
                                 2
                              
                              +
                              
                                 c
                                 1
                              
                              ]
                           
                        
                     . Π
                     1(u
                     1) is quasi-convex because 
                        
                           
                              
                                 F
                                 ¯
                              
                              1
                           
                           
                              (
                              ·
                              )
                           
                           >
                           0
                        
                      and 
                        
                           
                              (
                              b
                              +
                              
                                 h
                                 1
                              
                              +
                              
                                 h
                                 2
                              
                              )
                           
                           Q
                           
                              (
                              
                                 Δ
                                 1
                              
                              )
                           
                           −
                           b
                           −
                           
                              h
                              2
                           
                           +
                           
                              c
                              1
                           
                        
                      is increasing in u
                     1. Therefore, if 
                        
                           
                              x
                              1
                           
                           >
                           V
                           =
                           
                              Q
                              
                                 −
                                 1
                              
                           
                           
                              [
                              
                                 (
                                 b
                                 +
                                 
                                    h
                                    2
                                 
                                 −
                                 
                                    c
                                    1
                                 
                                 )
                              
                              /
                              
                                 (
                                 b
                                 +
                                 
                                    h
                                    1
                                 
                                 +
                                 
                                    h
                                    2
                                 
                                 )
                              
                              ]
                           
                        
                     , we have 
                        
                           
                              Π
                              1
                              ′
                           
                           
                              (
                              0
                              )
                           
                           >
                           0
                        
                     , hence 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              1
                           
                           =
                           0
                        
                     ; if x
                     2 < V, we have 
                        
                           
                              Π
                              1
                              ′
                           
                           
                              (
                              
                                 x
                                 2
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           <
                           0
                        
                     , hence 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              1
                           
                           =
                           
                              x
                              2
                           
                           −
                           
                              x
                              1
                           
                        
                     ; otherwise, there exists an unique solution 
                        
                           V
                           −
                           
                              x
                              1
                           
                           ∈
                           
                              [
                              0
                              ,
                              
                                 x
                                 2
                              
                              −
                              
                                 x
                                 1
                              
                              ]
                           
                        
                      to the first order condition and 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              1
                           
                           =
                           V
                           −
                           
                              x
                              1
                           
                        
                     . □


                     Proof of Proposition 2. Taking the derivative, we have 
                        
                           
                              Π
                              2
                              ′
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           =
                           
                              
                                 F
                                 ¯
                              
                              1
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           
                              
                                 F
                                 ¯
                              
                              2
                           
                           
                              (
                              
                                 Δ
                                 1
                              
                              −
                              
                                 x
                                 2
                              
                              )
                           
                           L
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                        
                     . Since 
                        
                           
                              
                                 F
                                 ¯
                              
                              i
                           
                           
                              (
                              ·
                              )
                           
                           >
                           0
                        
                     , the signs of 
                        
                           Π
                           2
                           ′
                        
                      and Lare the same. Moreover, L(u
                     1) is increasing in u
                     1, hence Π
                     2(u
                     1) is quasi-convex. Since 
                        
                           L
                           (
                           ∞
                           )
                           =
                           ∞
                        
                     , if 
                        
                           L
                           (
                           
                              x
                              2
                           
                           −
                           
                              x
                              1
                           
                           )
                           ≤
                           0
                        
                     , there exists an unique solution 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                           
                           ≥
                           
                              x
                              2
                           
                           −
                           
                              x
                              1
                           
                        
                      to the first order condition, that is, 
                        
                           L
                           (
                           
                              
                                 u
                                 ^
                              
                              1
                           
                           )
                           =
                           0
                        
                      and naturally we have 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              2
                           
                           =
                           
                              
                                 u
                                 ^
                              
                              1
                           
                        
                     ; otherwise, we have 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              2
                           
                           =
                           
                              x
                              2
                           
                           −
                           
                              x
                              1
                           
                        
                     . □


                     Proof of Proposition 3. Given 
                        x
                     , if

                        
                           (A.1)
                           
                              
                                 L
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       h
                                       1
                                    
                                    +
                                    
                                       h
                                       2
                                    
                                    +
                                    b
                                    )
                                 
                                 Q
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 −
                                 b
                                 −
                                 
                                    h
                                    2
                                 
                                 +
                                 
                                    c
                                    1
                                 
                                 +
                                 
                                    
                                       
                                          h
                                          2
                                       
                                       +
                                       
                                          c
                                          2
                                       
                                    
                                    
                                       
                                          
                                             F
                                             ¯
                                          
                                          1
                                       
                                       
                                          (
                                          
                                             x
                                             2
                                          
                                          −
                                          
                                             x
                                             1
                                          
                                          )
                                       
                                    
                                 
                                 ≤
                                 0
                              
                           
                        
                     there must be x
                     2 ≤ V, otherwise there will a contradiction. Then we have

                        
                           (A.2)
                           
                              
                                 
                                    Π
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    Π
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                    
                                    )
                                 
                                 ≤
                                 
                                    Π
                                    2
                                 
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    Π
                                    1
                                 
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    Π
                                    1
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          ^
                                       
                                       1
                                       1
                                    
                                    )
                                 
                              
                           
                        
                     
                  

That is, it is better to produce according to 
                        
                           
                              Π
                              2
                           
                           
                              (
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 2
                              
                              )
                           
                        
                      rather than 
                        
                           
                              Π
                              1
                           
                           
                              (
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 1
                              
                              )
                           
                        
                     . Therefore, 
                        
                           
                              u
                              1
                              *
                           
                           =
                           
                              
                                 u
                                 ^
                              
                              1
                              2
                           
                           =
                           
                              
                                 u
                                 ^
                              
                              1
                           
                        
                      and 
                        
                           
                              u
                              2
                              *
                           
                           =
                           
                              u
                              1
                              *
                           
                           +
                           
                              x
                              1
                           
                           −
                           
                              x
                              2
                           
                        
                     . If 
                        
                           L
                           (
                           
                              x
                              2
                           
                           −
                           
                              x
                              1
                           
                           )
                           >
                           0
                        
                     , there can be x
                     2 ≤ V or x
                     2 > V. Analogously, consider 
                        
                           min
                           {
                           
                              Π
                              2
                           
                           
                              (
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 2
                              
                              )
                           
                           ,
                           
                              Π
                              1
                           
                           
                              (
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 1
                              
                              )
                           
                           }
                        
                      in both possible cases, using the fact that 
                        
                           
                              Π
                              2
                           
                           
                              (
                              
                                 x
                                 2
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           =
                           
                              Π
                              1
                           
                           
                              (
                              
                                 x
                                 2
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                        
                     , we can finally reach the optimal solution. □


                     Proof of Proposition 4. Taking the derivative yields

                        
                           (A.3)
                           
                              
                                 
                                    
                                       
                                          
                                             π
                                             ′
                                          
                                          
                                             (
                                             
                                                u
                                                0
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                F
                                                ¯
                                             
                                             0
                                          
                                          
                                             (
                                             
                                                u
                                                0
                                             
                                             )
                                          
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      h
                                                      0
                                                   
                                                   +
                                                   b
                                                   )
                                                
                                                Q
                                                
                                                   (
                                                   
                                                      Δ
                                                      0
                                                   
                                                   )
                                                
                                                −
                                                b
                                                +
                                                
                                                   c
                                                   0
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   h
                                                   i
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                F
                                                ¯
                                             
                                             0
                                          
                                          
                                             (
                                             
                                                u
                                                0
                                             
                                             )
                                          
                                          
                                             L
                                             0
                                          
                                          
                                             (
                                             
                                                u
                                                0
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     Since 
                        
                           
                              
                                 F
                                 ¯
                              
                              0
                           
                           
                              (
                              ·
                              )
                           
                           >
                           0
                        
                      and L
                     0(u
                     0) is an increasing function, π is quasi-convex. Hence, if L
                     0(0) > 0, 
                        
                           
                              u
                              0
                              *
                           
                           =
                           0
                        
                     ; if L
                     0(min 
                        i
                     
                     ai
                     ) < 0, 
                        
                           
                              u
                              0
                              *
                           
                           =
                           
                              min
                              i
                           
                           
                              a
                              i
                           
                        
                     ; otherwise, since 
                        
                           
                              L
                              0
                           
                           
                              (
                              ∞
                              )
                           
                           =
                           
                              h
                              0
                           
                           +
                           
                              c
                              0
                           
                           −
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              n
                           
                           
                              h
                              i
                           
                           >
                           0
                        
                     , there must exist 
                        
                           
                              L
                              0
                           
                           
                              (
                              
                                 
                                    u
                                    ¯
                                 
                                 0
                                 *
                              
                              )
                           
                           =
                           0
                        
                     , and we should have 
                        
                           
                              u
                              0
                              *
                           
                           =
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                        
                     . □


                     Proof of Lemma 2. We already know that if L
                     0(0) ≤ 0, the optimal assembly solution is 
                        
                           
                              u
                              0
                              *
                           
                           
                              (
                              u
                              )
                           
                           =
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                           ∧
                           
                              min
                              i
                           
                           
                              a
                              i
                           
                        
                     . Consider a decision 
                        u
                      in which 
                        
                           
                              u
                              i
                           
                           >
                           
                              
                                 (
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    i
                                 
                                 )
                              
                              +
                           
                        
                      for some i, and another decision 
                        u
                     ′ in which 
                        
                           
                              u
                              i
                              ′
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    i
                                 
                                 )
                              
                              +
                           
                        
                      and other components 
                        
                           u
                           j
                           ′
                        
                      being the same as uj, j ≠ i, of 
                        u
                     . Then we have 
                        
                           
                              min
                              i
                           
                           
                              a
                              i
                           
                           =
                           
                              (
                              
                                 u
                                 i
                              
                              ∧
                              
                                 K
                                 i
                              
                              +
                              
                                 x
                                 i
                              
                              )
                           
                           ∧
                           
                              min
                              
                                 j
                                 ≠
                                 i
                              
                           
                           
                              a
                              j
                           
                        
                      and 
                        
                           
                              min
                              i
                           
                           
                              a
                              i
                              ′
                           
                           =
                           
                              (
                              
                                 u
                                 i
                                 ′
                              
                              ∧
                              
                                 K
                                 i
                              
                              +
                              
                                 x
                                 i
                              
                              )
                           
                           ∧
                           
                              min
                              
                                 j
                                 ≠
                                 i
                              
                           
                           
                              a
                              j
                              ′
                           
                        
                     . Then we have 
                        
                           
                              u
                              0
                              *
                           
                           
                              (
                              u
                              )
                           
                           =
                           
                              u
                              0
                              *
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 ′
                              
                              )
                           
                        
                      given the same realizations of all the capacities. So the second stage costs corresponding to 
                        u
                      and 
                        u
                     ′ are the same while the first stage cost corresponding to 
                        u
                     ′ is smaller than the one corresponding to 
                        u
                     . Therefore, the firm should plan component production such that 
                        
                           0
                           ≤
                           
                              u
                              i
                           
                           ≤
                           
                              
                                 (
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    i
                                 
                                 )
                              
                              +
                           
                        
                     ,
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                      in stage 1. As a result, we have 
                        
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                           ≥
                           
                              min
                              i
                           
                           
                              a
                              i
                           
                        
                      for sure due to 
                        
                           
                              u
                              i
                           
                           ≤
                           
                              
                                 (
                                 
                                    
                                       u
                                       ¯
                                    
                                    0
                                    *
                                 
                                 −
                                 
                                    x
                                    i
                                 
                                 )
                              
                              +
                           
                        
                     ,
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     , and 
                        
                           
                              u
                              0
                              *
                           
                           
                              (
                              u
                              )
                           
                           =
                           
                              min
                              i
                           
                           
                              a
                              i
                           
                        
                      in stage 2 since 
                        
                           
                              x
                              1
                           
                           ≤
                           
                              
                                 u
                                 ¯
                              
                              0
                              *
                           
                        
                     . □


                     Proof of Lemma 3. For any given decision 
                        Δ
                     , one can always have 
                        
                           
                              Δ
                              
                                 n
                                 ′
                              
                           
                           ≥
                           
                              Δ
                              
                                 
                                    (
                                    n
                                    −
                                    1
                                    )
                                 
                                 ′
                              
                           
                           ≥
                           ⋯
                           ≥
                           
                              Δ
                              
                                 1
                                 ′
                              
                           
                        
                     , where 
                        
                           
                              1
                              ′
                           
                           ,
                           …
                           ,
                           
                              n
                              ′
                           
                        
                      represents an arbitrary arrangement of 
                        
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Since the mated amount of products is 
                        
                           
                              min
                              
                                 i
                                 ′
                              
                           
                           
                              A
                              
                                 i
                                 ′
                              
                           
                        
                     , while keeping 
                        
                           u
                           
                              1
                              ′
                           
                        
                      still, if the firm lowers 
                        
                           u
                           
                              j
                              ′
                           
                        
                     , j > 1 until 
                        
                           
                              Δ
                              
                                 j
                                 ′
                              
                           
                           =
                           
                              Δ
                              
                                 1
                                 ′
                              
                           
                           ≥
                           
                              x
                              
                                 j
                                 ′
                              
                           
                        
                      (
                        
                           u
                           
                              j
                              ′
                           
                        
                      is lowered but still positive) or 
                        
                           
                              Δ
                              
                                 j
                                 ′
                              
                           
                           =
                           
                              x
                              
                                 j
                                 ′
                              
                           
                           >
                           
                              Δ
                              
                                 1
                                 ′
                              
                           
                        
                      (
                        
                           u
                           
                              j
                              ′
                           
                        
                      is lowered to the limit, i.e., 
                        
                           
                              u
                              
                                 j
                                 ′
                              
                           
                           =
                           0
                        
                     ), she will be better off in terms of expectation value because 
                        
                           
                              min
                              
                                 i
                                 ′
                              
                           
                           
                              A
                              
                                 i
                                 ′
                              
                           
                        
                      will remain the same while 
                        
                           A
                           
                              j
                              ′
                           
                        
                      would decrease, which means that the expected second-stage cost remain the same while the first-stage cost becomes lower. Iteratively applying the same logic, we can achieve Lemma 3. □


                     Proof of Proposition 5. Taking the derivative of Πj
                     (u
                     1), we have

                        
                           (A.4)
                           
                              
                                 
                                    Π
                                    j
                                    ′
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    j
                                 
                                 
                                    
                                       
                                          F
                                          ¯
                                       
                                       k
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       −
                                       
                                          x
                                          k
                                       
                                       )
                                    
                                    
                                       
                                          F
                                          ¯
                                       
                                       0
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                              
                           
                        
                     Since 
                        
                           
                              
                                 F
                                 ¯
                              
                              i
                           
                           
                              (
                              ·
                              )
                           
                           >
                           0
                        
                     , 
                        
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                        
                     , the signs of 
                        
                           Π
                           j
                           ′
                        
                      and Lj
                      are the same. Moreover, Lj
                     (u
                     1) is increasing in u
                     1, hence Πj
                     (u
                     1) is quasi-convex. Therefore, if 
                        
                           
                              L
                              j
                           
                           
                              (
                              
                                 x
                                 j
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           ≥
                           0
                        
                     , we have 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              j
                           
                           =
                           
                              x
                              j
                           
                           −
                           
                              x
                              1
                           
                        
                     ; if 
                        
                           
                              L
                              j
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           <
                           0
                        
                     , we have 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              j
                           
                           =
                           
                              x
                              
                                 j
                                 +
                                 1
                              
                           
                           −
                           
                              x
                              1
                           
                        
                     ; otherwise, there exists a unique solution 
                        
                           u
                           1
                           j
                        
                      in 
                        
                           [
                           
                              x
                              j
                           
                           ,
                           
                              x
                              
                                 j
                                 +
                                 1
                              
                           
                           ]
                        
                      to the first order condition (i.e., 
                        
                           
                              L
                              j
                           
                           
                              (
                              
                                 u
                                 1
                                 j
                              
                              )
                           
                           =
                           0
                        
                     ), and the optimal solution is naturally 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              j
                           
                           =
                           
                              u
                              1
                              j
                           
                        
                     . □


                     Proof of Proposition 6. Taking the derivative of Πn
                     (u
                     1), we have

                        
                           (A.5)
                           
                              
                                 
                                    Π
                                    n
                                    ′
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       
                                          F
                                          ¯
                                       
                                       k
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       −
                                       
                                          x
                                          k
                                       
                                       )
                                    
                                    
                                       
                                          F
                                          ¯
                                       
                                       0
                                    
                                    
                                       (
                                       
                                          Δ
                                          1
                                       
                                       )
                                    
                                 
                                 
                                    L
                                    n
                                 
                                 
                                    (
                                    
                                       u
                                       1
                                    
                                    )
                                 
                              
                           
                        
                     Since 
                        
                           
                              L
                              n
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                        
                      is increasing in u
                     1 and 
                        
                           
                              
                                 F
                                 ¯
                              
                              i
                           
                           
                              (
                              ·
                              )
                           
                           >
                           0
                        
                     , 
                        
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                        
                     , Πn
                     (u
                     1) is quasi-convex. Therefore, if 
                        
                           
                              L
                              n
                           
                           
                              (
                              
                                 x
                                 n
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           >
                           0
                        
                     , we have 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              n
                           
                           =
                           
                              x
                              n
                           
                           −
                           
                              x
                              1
                           
                        
                     ; otherwise, there exists a unique and finite solution 
                        
                           u
                           1
                           n
                        
                      in [xn
                     , ∞) to the first order condition (i.e., 
                        
                           
                              L
                              n
                           
                           
                              (
                              
                                 u
                                 1
                                 n
                              
                              )
                           
                           =
                           0
                        
                     ) because 
                        
                           
                              lim
                              
                                 
                                    u
                                    1
                                 
                                 →
                                 ∞
                              
                           
                           
                              L
                              n
                           
                           
                              (
                              
                                 u
                                 1
                              
                              )
                           
                           =
                           ∞
                        
                     , and the optimal solution is naturally 
                        
                           
                              
                                 u
                                 ^
                              
                              1
                              n
                           
                           =
                           
                              u
                              1
                              n
                           
                        
                     . □


                     Proof of Proposition 7. From the definitions of Li
                     (u
                     1), 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     , we have the following fact that

                        
                           (A.6)
                           
                              
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       j
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ≤
                                 
                                    L
                                    j
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ≤
                                 
                                    L
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                              
                           
                        
                     So one and only one case of (i) 0 ≤ L
                     1(0), (ii) 
                        
                           
                              L
                              n
                           
                           
                              (
                              
                                 x
                                 n
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           ≤
                           0
                        
                     , (iii) 
                        
                           
                              L
                              j
                           
                           
                              (
                              
                                 x
                                 j
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           <
                           0
                           ≤
                           
                              L
                              j
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                        
                     , and (iv)
                        
                           
                              L
                              j
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           <
                           0
                           ≤
                           
                              L
                              
                                 j
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                        
                     , 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                           −
                           1
                        
                      is true. For any case, we can determine all the 
                        
                           
                              u
                              ^
                           
                           1
                           i
                        
                     , 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                      based on Propositions 5 and 6. Plug them into the corresponding functions 
                        
                           
                              Π
                              i
                           
                           
                              (
                              
                                 
                                    u
                                    ^
                                 
                                 1
                                 i
                              
                              )
                           
                        
                     , 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     , and check 
                        
                           
                              min
                              i
                           
                           
                              {
                              
                                 Π
                                 i
                              
                              
                                 (
                                 
                                    
                                       u
                                       ^
                                    
                                    1
                                    i
                                 
                                 )
                              
                              }
                           
                        
                      using the fact that 
                        
                           
                              Π
                              
                                 j
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                           =
                           
                              Π
                              j
                           
                           
                              (
                              
                                 x
                                 
                                    j
                                    +
                                    1
                                 
                              
                              −
                              
                                 x
                                 1
                              
                              )
                           
                        
                     . That 
                        
                           
                              u
                              ^
                           
                           1
                           i
                        
                      corresponding to 
                        
                           
                              min
                              i
                           
                           
                              {
                              
                                 Π
                                 i
                              
                              
                                 (
                                 
                                    
                                       u
                                       ^
                                    
                                    1
                                    i
                                 
                                 )
                              
                              }
                           
                        
                      is the optimal solution. □

@&#REFERENCES@&#

