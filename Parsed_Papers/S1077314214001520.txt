@&#MAIN-TITLE@&#On the family of shortest isothetic paths in a digital object—An algorithm with applications

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An algorithm to compute Family of Shortest Isothetic Paths (FSIP) is proposed.


                        
                        
                           
                           We make certain characterization of FSIP, which leads to the algorithm.


                        
                        
                           
                           Algorithm is discussed in detail with demonstration.


                        
                        
                           
                           We also show how FSIP can be used for shape analysis.


                        
                        
                           
                           Experimental results are given to demonstrate the effectiveness of FSIP.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shortest path

Isothetic path

Monotone path

Monotone polygon

Shape analysis

@&#ABSTRACT@&#


               
               
                  The family of shortest isothetic paths (FSIP) between two grid points in a digital object A is defined to be the collection of all possible shortest isothetic paths that connect them. We propose here a fast algorithm to compute the FSIP between two given grid points inside a digital object, which is devoid of any hole. The proposed algorithm works with the object boundary as input and does not resort to analysis of the interior pixels. Given the digital object A with n boundary pixels, it first constructs the inner isothetic cover that tightly inscribes A in 
                        
                           O
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          g
                                       
                                    
                                    log
                                    
                                       
                                          n
                                       
                                       
                                          g
                                       
                                    
                                 
                              
                           
                        
                      time, where g is a positive integer that denotes the unit of the underlying square grid. Then for any two points on the inner cover, it computes the FSIP in 
                        
                           O
                           (
                           n
                           /
                           g
                           )
                        
                      time, using certain combinatorial rules based on the characteristic properties of FSIP. We report experimental results that show the effectiveness of the algorithm and its further prospects in shape analysis, object decomposition, and in other related applications.
               
            

@&#INTRODUCTION@&#

Numerous variants of shortest path algorithms and their applications have been studied extensively over several decades under diverse algorithmic paradigms, such as graph theory, computational geometry, and operations research. Some of the major applications of shortest paths are networking, robotics, geographical information systems (GIS), VLSI design, resource allocation and collection, and traveling salesman problem (TSP) with neighborhoods [1,5,12,17,25,27,28]. Customization of these algorithms for such a wide range of applications and related constraint formulations need special attention, as evidenced in the related literature [6–9,16,22–24,26]. A comparative review of these algorithms is shown in Table 1
                     , and some of these related to our work are briefly discussed below.

In the domain of computational geometry and robot vision, a distance transform approach is proposed by Jarvis and Byrne [20] to find all paths from the goal location back to the start location. This results in shortest paths with respect to the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      distance metric, which assigns equal weights for movements in diagonal, horizontal, and in vertical directions. Since diagonal directions are allowed, the 
                        
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        
                      metric does not provide accurate solution to the problem. Zelinsky [30] uses path transform approach, which is an extension of distance transform planning. Two control points are selected in the work space of a robot, and path transforms for each of the control points are computed. The approach guarantees a solution if it exists. For computing the collection of all shortest paths inside a simple planar polygon from a given source vertex to all the other vertices, a linear-time algorithm was reported by Guibas et al. [18]. In the graph-theoretic domain, one of the fastest implementations of single-source shortest paths using Fibonacci heaps is due to Fredman and Tarjan [15], which has a running time of 
                        
                           O
                           (
                           (
                           |
                           V
                           |
                           log
                           |
                           V
                           |
                           )
                           +
                           |
                           E
                           |
                           )
                        
                     , where V and E are the respective sets of vertices and edges. For planar graphs, Frederickson proposed the use of separators to obtain 
                        
                           O
                           (
                           |
                           V
                           |
                           
                              
                                 log
                                 |
                                 V
                                 |
                              
                           
                           )
                        
                     -time algorithm for solving shortest path problems [14]. In a planar graph with nonnegative edge-lengths, an 
                        
                           O
                           (
                           |
                           V
                           |
                           )
                        
                     -time algorithm for shortest paths is also known [19].

Shortest paths are also found to be useful in image processing and computer vision. For example, different deformed templates, such as deforming contours, articulated objects, and smooth contours have been tracked in simple and complicated backgrounds using the idea of shortest path [11]. Nevertheless, the design of such algorithms still poses newer challenges in various emerging areas of image analysis and computer vision. This mandates further investigation of application-specific shortest-path problems in the framework of digital geometry.

In an earlier work [13], the problem of finding a shortest isothetic path (SIP) inside a digital object A (without any hole) laid on a grid 
                        
                           G
                        
                      (Section 2) was studied, such that the SIP lies entirely inside A and consists of moves along grid edges only. Although the problem looks somewhat analogous to certain problems of computational geometry, an efficient algorithmic solution for a digital object was awaited. For a given grid size, the above-mentioned algorithm runs in 
                        
                           O
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          g
                                       
                                    
                                    log
                                    
                                       
                                          n
                                       
                                       
                                          g
                                       
                                    
                                 
                              
                           
                        
                      time, n being the number of pixels on the border of the digital object, A.

A shortest isothetic path—whether monotone or not—between two points in a digital object is usually not unique. However, the family of shortest isothetic paths (FSIP) between two points is unique, since it is defined as the region containing the collection of all SIPs between them. As already mentioned above and also shown in Table 1, there exists a rich literature on shortest paths in different paradigms; however, determination of FSIP in a digital object, which is tunable with grid size, still remains open. The novelty of our work lies in the fact that it identifies the entire corridor between two given points of a digital object that envelops all shortest isothetic paths connecting the two points. For a digital object without any hole, the proposed algorithm needs 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 g
                              
                           
                           log
                           
                              
                                 n
                              
                              
                                 g
                              
                           
                           )
                        
                      preprocessing time, followed by 
                        
                           O
                           (
                           n
                           /
                           g
                           )
                        
                      time for computing the FSIP between two points, where n is the number of pixels on the object boundary. Note that the pixel geometry of a digital object scanned along axis-parallel lines can be viewed as a planar grid graph, where the vertices correspond to the pixels, and the edges represent their connectivity in 4-neighborhood. If 
                        
                           
                              
                                 n
                              
                              
                                 0
                              
                           
                        
                      denotes the total number of pixels in the object, then the number of pixels on its boundary will be 
                        
                           O
                           (
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           )
                        
                      unless the object is too elongated in one direction. We assume that the object is initially captured on a digital square grid of unity spacing (i.e., grid size 
                        
                           g
                           =
                           1
                        
                     ). For any grid size 
                        
                           g
                           ⩾
                           1
                        
                     , the proposed algorithm for computing FSIP is thus expected to run in 
                        
                           O
                           (
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           /
                           g
                           )
                        
                      time. In contrast, the conventional shortest-path algorithms for planar graphs, if applied directly on the graph corresponding to the object, may require 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 0
                              
                           
                           )
                        
                      time.

To start with, the definitions and terminologies related to FSIP are given in Section 2. Several interesting topological properties of FSIP are presented in Section 3. Based on these properties, the algorithm for computing the FSIP is designed, which has been described and demonstrated in Section 4. The nature of an FSIP depends on the complexity of its SIPs. As an introductory example, see Fig. 1
                     (left) where a digital object, A, is shown, and two FSIPs for two pairs of points in A are shown in Fig. 1(middle, right). All SIPs between the two points in Fig. 1(middle) are monotone, and those in Fig. 1(right) are non-monotone. Details of experimental results and their applications to shape analysis and object segmentation are elaborated in Section 5. Concluding remarks are presented in Section 6.

A digital object, A (henceforth referred to as an object), is a finite subset of 
                        
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        
                     , which consists of one or more 
                        
                           k
                           (
                           =
                           4
                           
                           or
                           
                           8
                           )
                        
                     
                     -connected components 
                     [21]. In this paper, we consider the object as a single 8-connected component. We need the following definitions in the context of our work.
                        Definition 1
                        Grid


                        The background grid is given by 
                              
                                 G
                                 =
                                 (
                                 H
                                 ,
                                 V
                                 )
                              
                           , where 
                              
                                 H
                              
                            and 
                              
                                 V
                              
                            represent the respective sets of (equi-spaced) horizontal grid lines and vertical grid lines. The grid size, g, is defined as the distance between two consecutive horizontal
                              
                                 /
                              
                           vertical grid lines. A grid point is the point between intersection of a horizontal and a vertical grid line.

An isothetic polygon has its vertices as grid points and its edges lying on grid lines. The inner isothetic cover of A is the maximum-area isothetic polygon P that tightly inscribes A (Fig. 1).

Since P is an isothetic polygon, it has 
                        
                           
                              
                                 90
                              
                              
                                 0
                              
                           
                        
                      and 
                        
                           
                              
                                 270
                              
                              
                                 0
                              
                           
                        
                      vertices, which are referred to as vertices of type 1 and type 3, respectively. All other grid points lying on the border of P are called edge points. The sequence of vertices of P is such that P always lies left of each edge during its traversal.
                        Definition 3
                        SIP


                        An (simple) isothetic path 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            from a grid point 
                              
                                 p
                                 ∈
                                 P
                              
                            to a grid point 
                              
                                 q
                                 ∈
                                 P
                              
                            is a sequence of 4-connected grid points such that all the constituent points of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            are distinct and lie on or inside P. For two given points in P, a/the shortest isothetic path (SIP) has the minimum length over all isothetic paths between them. A SIP is said to be monotone if it consists of moves only in one or two (orthogonal) directions.

The union of all possible SIPs between two given points 
                              
                                 p
                                 ∈
                                 P
                              
                            and 
                              
                                 q
                                 ∈
                                 P
                              
                            defines their family of SIPs (FSIP), denoted by 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           . The set 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is equivalent to a (isothetic) region bordered by two SIPs between p and q, which are said to be its extremum SIPs. If we traverse the border of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            from p to q such that each other SIP in 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            lies to the left during the traversal, then that path of traversal is one of the two extremum SIPs, which is termed as the infimum SIP and denoted by 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       inf
                                    
                                 
                              
                           . Similarly, on traversing the border of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            from q to p with each other SIP lying to the left during the traversal, we get the other extremum SIP, termed as the supremum SIP and denoted by 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       sup
                                    
                                 
                              
                           .

The set 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      is, therefore, bounded and well-defined by its two extremum SIPs, namely 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                     . Fig. 1 shows a couple of typical examples. The crux of our algorithm is to find 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                     , which, in turn, defines the region that contains all the SIPs comprising 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . The numbers of grid points for all SIPs in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      are same, as they all have the minimum length. As a degeneracy, if there is exactly one SIP between p and q, then 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      contains only that SIP, which is also 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                      coincident with each other. Otherwise, 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      will have distinct 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                     , which although can have partial overlaps. We need the following definitions to characterize such overlaps between 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                     , and hence to characterize 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      defined by them.
                        Definition 5
                        Convexity and Concavity


                        An edge of P defined by two consecutive vertices of type 1 is termed as a convex edge, as it gives rise to a convexity. Similarly, an edge defined by two consecutive type 3 vertices gives rise to a concavity, and hence termed as a concave edge.

A convex region C corresponding to a convex edge e is the maximum-area rectangle fully contained in P, having its one side as e, and the endpoints of the side opposite to e (i.e., its open side) lying on the sides of P preceding and following e.

For example, in Fig. 2
                     (left), the convex region is closed on three sides by the edges 
                        
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 -
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 -
                                 1
                              
                           
                           )
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 i
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                     , and 
                        
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                     , and open on the side defined by the horizontal line passing through 
                        
                           
                              
                                 v
                              
                              
                                 i
                                 -
                                 2
                              
                           
                        
                     . In Fig. 2(right), the convex region is closed similarly on three sides by the edges as in Fig. 2(left), and it is open on the side defined by the nearest concave edge.
                        Definition 7
                        Convex Isothetic Polygon


                        A convex isothetic polygon is an isothetic polygon whose intersection with any grid line is either empty or a single line segment [4].

The convexity index, 
                              
                                 α
                              
                           , of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is defined as the number of convex isothetic polygons that it consists of.

For example, for the FSIP shown in Fig. 1(middle), 
                        
                           α
                           =
                           1
                        
                     ; and for the one in Fig. 1(right), 
                        
                           α
                           =
                           4
                        
                     .
                        Definition 9
                        Bridge


                        A sub-path common to 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       inf
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       sup
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is called a bridge.

Every two consecutive isothetic polygons in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      are connected by a bridge. Each bridge in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      passes through one or more concave edges, with its two endpoints coinciding with two type 3 vertices of those concave edges. Each SIP in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      passes through all the bridges in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     .

Bridges are of two types (Fig. 3
                     ), which admit the following characterization. If a bridge is non-monotone, then it is a U-bridge. If a bridge is monotone, then it is a Z-bridge only if it has the same monotonicity of its preceding and/or following regions; otherwise, it is a U-bridge. A Z-bridge never breaks the monotonicity of a SIP, whereas a U-bridge always breaks its monotonicity.
                        Definition 10
                        Monotone and Non-Monotone FSIP


                        If 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            consists of monotone SIPs, then it is said be a monotone FSIP; otherwise, it is a non-monotone FSIP.

It is easy to observe that 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      cannot contain both monotone and non-monotone SIPs, since the length of a non-monotone SIP between p and q is always greater than that of a monotone SIP between p and q.

It is evident from Definition 4 that 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      may be conceived as an isothetic polygon, which is either simple or non-simple in the sense that it may have overlapping edges. The overlapping edges, in particular, give rise to bridges. Let 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      denote the rectangle having p and q as two of its diagonally opposite corners. Then the location of the aforesaid isothetic polygon corresponding to 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      has two possible topological cases, having a few combinatorial sub-cases, as explained below.
                        
                           1.
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                       
                                    
                                    ⊆
                                    
                                       
                                          R
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                       
                                    
                                 
                              .
                                 
                                    (a) 
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   q
                                                   )
                                                
                                             
                                          
                                        is monotone.
                                          
                                             i. If 
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            (
                                                            p
                                                            ,
                                                            q
                                                            )
                                                         
                                                      
                                                   
                                                 is simple, then it has no bridges (Fig. 4
                                                (left)).

ii. If 
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            (
                                                            p
                                                            ,
                                                            q
                                                            )
                                                         
                                                      
                                                   
                                                 is non-simple, then it has one or more Z-bridges but no U-bridges (Fig. 3(left)).

These are proved in Lemmas 1 and 2.

(b) If 
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   q
                                                   )
                                                
                                             
                                          
                                        is non-monotone, then it is always non-simple, has one or more U-bridge(s) (and may or may not contain any Z-bridge). This is proved in Lemma 2.

If 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                       
                                    
                                    
                                    ⊈
                                    
                                    
                                       
                                          R
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                       
                                    
                                 
                              , then it is non-monotone, non-simple, and has one or more U-bridges (may or may not contain any Z-bridge). This is evident from Fig. 3(right) and proved in Theorem 2.

When a SIP lies outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , it passes through at least one U-bridge that lies outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . The algorithm proposed in Section 4, while computing the extremum SIPs by traversing along the two consecutive sides of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , determines each such U-bridge lying outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      and the corresponding convex isothetic polygons of 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      connected by it. See, for example, the illustration in Fig. 3(right). Here the line of concavity is outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . Hence, for any 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , there is a sub-path to the right side of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . The union of all these sub-paths over all SIPs from p to q defines the portion of 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      lying outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . And all the sub-paths in this portion passes through the U-bridge lying outside 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . Detailed explanation is given in Section 4. We first have the following lemmas on a monotone SIP.
                        Lemma 1
                        
                           If a SIP 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           is monotone, then it lies in 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           , and hence its length is given by the semi-perimeter of 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           .
                        

As 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is monotone, its length is 
                              
                                 |
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                                 |
                                 =
                                 abs
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                                 +
                                 abs
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                              
                           , where 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                              
                            denote the respective coordinates of p and q, measured in grid units. If 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            goes outside 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           , then the sum of lengths of its horizontal (or vertical) sub-paths would be greater than 
                              
                                 abs
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                              
                            (or 
                              
                                 abs
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       p
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       y
                                    
                                    
                                       q
                                    
                                    
                                       (
                                       g
                                       )
                                    
                                 
                                 )
                              
                           ), wherein lies the contradiction. □


                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           is monotone if and only if any SIP between p and q is monotone.
                        

From Lemma 1, it is clear that if a SIP (between p and q) is monotone and another SIP is non-monotone, then the length of the latter would be greater than that of the former, which is a contradiction. Hence, either all SIPs in 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            are monotone or all of them are non-monotone. □

We have the following theorem on monotonicity of 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , considering its containment in 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     .
                        Theorem 1
                        FSIP monotonicity


                        
                           If 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           is monotone, then it lies in 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           . However, the condition 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                                 ⊆
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           does not guarantee the monotonicity of 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           .
                        

By Lemma 2, it is clear that 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is monotone if and only if all SIPs between p and q are monotone. By Lemma 1, all monotone SIPs always lie in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           , which implies 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            lies in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           .

But the converse is not true, since a non-monotone FSIP may lie in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           , as evident from the illustration in Fig. 4(right).□

We have now the following theorem that explicates the necessary and sufficient condition of a non-monotone FSIP.
                        Theorem 2
                        FSIP non-monotonicity


                        
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           is non-monotone only if it has a U-bridge.
                        

If 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is non-monotone, then each 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is non-monotone (Lemma 2) and hence consists of more than two directions. As explained above, the horizontal movements preceding and following a Z-bridge are in the same direction. So, the monotonicity breaks only due to U-bridge. □

Further, when there exists exactly one SIP between p and q, then 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                      entirely coincide, and 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      is just a single isothetic path. This is a very typical case, which occurs when p and q lie on the perimeter of P, and there is a Z-bridge between them, on which two or more lines of concavity are incident (Fig. 5
                     ).

To characterize the FSIP now, we use the sequence of its constituent isothetic sub-polygons and bridges. We have the following theorems.
                        Theorem 3
                        FSIP sub-polygons


                        
                           All the sub-polygons in 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           are simple convex isothetic polygons.
                        


                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            consists of sub-polygons, connected by bridges (Theorem 2). It is easy to observe that each of these sub-polygons is simple, since 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            is not simple only at bridges. To prove that a sub-polygon 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            is a convex isothetic polygon, observe that the part of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       inf
                                    
                                 
                              
                            and the part of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       sup
                                    
                                 
                              
                            defining the border of 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            are both monotone, since the sub-polygon 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            does not contain any bridge in general, and any U-bridge in particular. Hence, none of those parts of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       inf
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    
                                       sup
                                    
                                 
                              
                            has two consecutive vertices of type 3. This implies that 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            has no two consecutive vertices of type 3, wherefore 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            is a convex isothetic polygon. □


                           Each 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           has the same sequence of bridges, 
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           , and hence passes through the same sequence of (simple) convex isothetic polygons, 
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           .
                        

We prove by induction. From Theorem 3, 
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            can be represented by a unique sequence of convex isothetic polygons, namely 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           , intertwined by a unique sequence of bridges. Let 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                            be the first bridge in 
                              
                                 
                                    
                                       B
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           . Then by Definition 9, 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                            is either not preceded by any polygon or connects the first two polygons 
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              
                            in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the point where 
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                              
                            is incident on 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                              
                            be the horizontal line passing through 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Let, w.lo.g., q be lying somewhere below 
                              
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                              
                           , as shown in Fig. 6
                           . Then, in order to reach q, any SIP from p has to pass through 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                              
                            and hence contain 
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                              
                           .

For the induction hypothesis, assume that each 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            from p has passed through 
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                           . We prove in the induction step that 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            enters 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           .

Let 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                    
                                       ″
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the respective points at which 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            is incident on 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           . As shown in Fig. 6, if 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                            be the vertical line perpendicular to 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            and passing through 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           , then after reaching 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                            from 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                    
                                       ″
                                    
                                 
                                 ,
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            has to move along 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           , since any other direction would result in more than two types of moves inside 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                           , thereby contradicting the minimum path length of a SIP. It cannot also move upwards along 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                           , since the bridge 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            is not along that direction. So, it enters 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            through 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                           , whence the proof.□

We have now the following theorem.
                        Theorem 5
                        Convexity index


                        
                           The convexity index of 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            
                           is 
                           
                              
                                 α
                                 =
                                 β
                                 -
                                 λ
                                 +
                                 1
                              
                           
                           , where 
                           
                              
                                 β
                              
                            
                           is the number of bridges in 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                           
                           , and 
                           
                              
                                 λ
                                 =
                                 0
                              
                            
                           when neither p nor q lies on a bridge, 
                           
                              
                                 λ
                                 =
                                 1
                              
                            
                           when either p or q lies on a bridge, and 
                           
                              
                                 λ
                                 =
                                 2
                              
                            
                           when p and q both lie on bridges.
                        

From Theorem 4, each 
                              
                                 
                                    
                                       π
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                 
                              
                            passes through 
                              
                                 β
                              
                            bridges. Each bridge 
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                              
                            is either a U-bridge or a Z-bridge, and connects two convex isothetic polygons, namely 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           . If p or q marks the start or end of a bridge, then there is no convex isothetic polygons preceding and following that bridge. So, it reduces the number of convex isothetic polygons by 
                              
                                 λ
                              
                           . As the sequence of these polygons and the sequence of bridges are both unique, the proof follows. □

Algorithm Find-FSIP computes 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      by finding its extremum SIPs. As shown in Algorithm 1, its input is the (ordered) list L containing vertices of P, two lexicographically sorted lists consisting of vertices and edge points (i.e., all grid points on the border of P), which are denoted as 
                        
                           
                              
                                 L
                              
                              
                                 x
                              
                           
                        
                      (x as primary key and y as secondary key) and 
                        
                           
                              
                                 L
                              
                              
                                 y
                              
                           
                        
                      (y as primary key and x as secondary key), and 
                        
                           p
                           ,
                           q
                        
                      as the start and the endpoints. The procedure Find-U-Bridges is used to find the sequence of U-bridges between p and q, and the pair of endpoints defining each bridge is stored in the array B (Step 1). Note that B is initialized with p and appended with q in Find-U-Bridges (Steps 8 and 18). For each ordered point pair 
                        
                           (
                           B
                           [
                           i
                           ]
                           ,
                           B
                           [
                           i
                           +
                           1
                           ]
                           )
                        
                      in B—excepting the first and the last pairs, the respective points 
                        
                           B
                           [
                           i
                           ]
                        
                      and 
                        
                           B
                           [
                           i
                           +
                           1
                           ]
                        
                      represent the end of a bridge and the start of the next bridge in 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      (Step 4); they also represent the same two bridges in 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                      in reverse order (Step 5). The first pair has p and the start point of the first bridge, and the last pair has the endpoint of the last bridge and q. B is used to find the extremum SIPs in the do-while loop of Find-FSIP (Steps 3–10).

Step 6 of Find-FSIP uses the procedure Find-Region to compute the convex isothetic polygons bounded by the extremum SIPs (Theorem 3). It also finds the Z-bridges. While traversing the vertices of 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                      in succession, it identifies the overlapping line segments of 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 inf
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                              
                                 sup
                              
                           
                        
                     , which correspond to Z-bridges.

A U-bridge appearing after a convex isothetic polygon is appended by the procedure Append-Bridge, in the set 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      (Step 8). The first entry in B is p. So, the first U-bridge, 
                        
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                        
                     , will appear after the first region, 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        
                     . The last entry in B is q. Thus, at the last iteration of the do-while loop of Find-FSIP, there will be no U-bridge after the last convex isothetic polygon in the sequence, i.e., Steps 7, 8 and 9 will not be executed. Otherwise, the U-bridge after the convex isothetic polygon, is appended by the procedure Append-Bridge in Step 8. If the U-bridge consists of more than two type 3 vertices, then all the vertices belonging to the U-bridge are appended in 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      by Append-Bridge. The pointer gets incremented by two, and so it points to the end vertex of the last U-bridge (Step 9).
                        Algorithm 1
                        Find-FSIP 
                              
                                 
                              
                           
                        

In the procedure Find-U-Bridges, the point 
                        
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        
                      is determined as the corner point of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , which appears in the anticlockwise traversal of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      from p to q (Step 1). 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      intersects P at different points. These intersection points on 
                        
                           
                              
                                 
                                    
                                       pc
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 q
                              
                              
                                 ‾
                              
                           
                        
                      are determined in Step 3 or in Step 5, depending on the location of 
                        
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        
                      in 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . The procedures Remove-Points (Step 6) and Find-Polychain (Step 7) are designed based on certain combinatorial rules explained in [13]. The procedure Remove-Points is used to remove some of the intersection points between P and 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . The procedure Find-Polychain finds a polychain between two points, which gives a SIP. The vertices of P are indexed in increasing order, starting from p. If there are two consecutive vertices of type 13 (31) in the list of intersection points, then the vertex with greater (lower) index is discarded, since the line segment joining these two intersection points lies entirely outside P. For example, in Fig. 7
                     , the vertices 
                        
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                        
                     , and 
                        
                           
                              
                                 w
                              
                              
                                 4
                              
                           
                        
                      are the four intersection points, with type
                        
                           (
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                           =
                        
                      
                     31 and type
                        
                           (
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 4
                              
                           
                           )
                           =
                        
                      
                     13. According to the aforesaid rules, here 
                        
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 w
                              
                              
                                 4
                              
                           
                        
                      are discarded. After applying this rule, all intersection points are considered in pair. The indices of pairs of intersection points are then checked to find whether they are in increasing or in decreasing order and whether the index falls within the indices of extreme two points in M, namely 
                        
                           M
                           [
                           1
                           ]
                        
                      and 
                        
                           M
                           [
                           k
                           ]
                        
                     , where k is the total number of intersection points. If it is not so, then the last point of first pair and the first point of next pair are discarded. Now, M contains only the intersection points such that its traversal produces movements along the borders of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      and P alternately. That is, if 
                        
                           M
                           [
                           i
                           ]
                        
                      to 
                        
                           M
                           [
                           i
                           +
                           1
                           ]
                        
                      describes a segment on the border of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , then 
                        
                           M
                           [
                           i
                           +
                           1
                           ]
                        
                      to 
                        
                           M
                           [
                           i
                           +
                           2
                           ]
                        
                      indicates a sequence of vertices along the border of P. The latter sequence may be reduced by using combinatorial rules (Procedure Apply-Rule in [13]) to get a tight polychain from 
                        
                           M
                           [
                           i
                           +
                           1
                           ]
                        
                      to 
                        
                           M
                           [
                           i
                           +
                           2
                           ]
                        
                     , when the sequence creates a convexity. Let 
                        
                           M
                           =
                           〈
                           p
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           ,
                           …
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                           ,
                           q
                           〉
                        
                     . Then 
                        
                           (
                           p
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           )
                        
                      is traversed along 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                           ,
                           (
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           )
                        
                      along 
                        
                           P
                           ,
                           (
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           )
                        
                      along 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                           ,
                           (
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 4
                              
                           
                           )
                        
                      along P, and so on. During traversal along P, when the polychain 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      enters a convex region, then it is reduced and made to pass along the open side of the convex region (Fig. 2(left)). If there are one or more concavities inside the convex region, then though the reduced polychain passes along the open side (i.e., along the line of concavity which is nearest to the convex edge), it would store the two concave vertices of the nearest concavity (Fig. 2(right)).
                        Algorithm 2
                        Find-U-Bridges(
                              
                                 p
                                 ,
                                 q
                              
                           ) 
                              
                                 
                              
                           
                        

Once the polychain 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      is obtained, U-bridges are extracted from it (Find-U-Bridges: Steps 9–17). i and j are initialized to ‘1’, and p is appended in B (Step 8). The two endpoints corresponding to each U-bridge are stored in B in sequence by traversing 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     . Whenever there are two or more consecutive vertices of type 3 in 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      (Steps 10–17), then the two extreme type 3 vertices of the sequence are stored in B as the endpoints of the particular bridge. At the end of 
                        
                           B
                           ,
                           q
                        
                      is appended (Step 18), and finally B is returned in Step 19.

The procedure Find-Extremum is applied on each pair of points in B to find the convex isothetic polygon between every two consecutive bridges, which becomes a part of 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      (Theorem 3). The first four lines of Find-Extremum are similar to those in Find-U-Bridges. The extremum SIPs obtained at the two sides of a U-bridge are monotone (Theorem 3). The list of intersection points, M, is traversed and each extremum SIP moves alternately along the sides of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      and along the border of P (Steps 6–17). Initially, i and m (indices for M and 
                        
                           π
                        
                      respectively) are initialized to ‘1’, and p is appended in 
                        
                           π
                        
                      (Step 5). If p is inside P, then the first movement is along the side of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , and so, the first intersection point is appended in 
                        
                           π
                        
                      (Step 7). If p is on the border of P, then in some cases, the first movement will not be along a side of 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      but along the border of P up to the first intersection point. For simplicity, this case is not incorporated in the algorithm. If there is a corner point, then the corner point and the intersection point next to it are appended in 
                        
                           π
                        
                     , and reduction rules are applied (by Apply-Rule) if a convex region is created (Steps 8–14). The loop terminates on reaching the destination point (Steps 13–14).
                        Algorithm 3
                        Find-Extremum(
                              
                                 r
                                 ,
                                 s
                              
                           ) 
                              
                                 
                              
                           
                        

The second movement is along the border of P between the two intersection points determined by the procedure Traverse (Step 8). The SIP moves along the border of P, and if it enters any convex region, then corresponding reduction rules are applied. The next intersection point is appended in 
                        
                           π
                        
                      in Step 16. The variables i and m are incremented by 2 in Step 17, q is appended at the end of 
                        
                           π
                        
                      in Step 18, and 
                        
                           π
                        
                      is returned by the procedure in Step 19.


                     Fig. 8
                      shows an illustration of Algorithm 1. Two points p and q, and their corresponding rectangle, 
                        
                           
                              
                                 R
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , are shown in Fig. 8(top-left). First, 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      is determined using Find-Polychain (Fig. 8,top-middle). From 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                     , U-bridges are detected. Here, two U-bridges are there, 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      being the endpoints of the first U-bridge, and 
                        
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 6
                              
                           
                        
                      of the second (Fig. 8, top-right). Two extremum SIPs are obtained from p to 
                        
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        
                     , which are shown in red (infimum) and in blue (supremum) (Fig. 8, bottom-left).

The procedure Find-Region extracts the Z-bridge 
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                      from the corresponding region and then the U-bridge 
                        
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                      is appended. So, up to this point, we have 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                      (Fig. 8,bottom-left). Next, the two extremum SIPs between 
                        
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 3
                              
                           
                        
                      are determined (Fig. 8 bottom-middle). The corresponding region does not contain any Z-bridge, and we get 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                     . The next U-bridge consists of more than two vertices of type 3. All the segments between the two extreme points of the U-bridge are appended, and so 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                        
                      gets enhanced to 
                        
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       4
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       5
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       6
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                     . The concluding portions of the extremum SIPs between 
                        
                           
                              
                                 u
                              
                              
                                 6
                              
                           
                        
                      and q are obtained in a similar manner (Fig. 8 bottom-right). There is no more U-bridges, since q is the destination. Hence, finally, 
                        
                           
                              
                                 F
                              
                              
                                 (
                                 p
                                 ,
                                 q
                                 )
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       4
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       5
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       6
                                    
                                 
                              
                              
                                 ‾
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        
                     .

Let n be the number of pixels on the boundary of the digital object, A. Since the inner isothetic cover P tightly inscribes A, the number of grid points (vertices and edge points) on the boundary of P is 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         
                        [3,2], where g is the grid size. All these vertices are stored in L in 
                           
                              O
                              (
                              g
                              )
                              ·
                              O
                              (
                              n
                              /
                              g
                              )
                              =
                              O
                              (
                              n
                              )
                           
                         time, since the intersection of each grid edge with A is checked in 
                           
                              O
                              (
                              g
                              )
                           
                         time and the number of grid points visited is bounded by 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                        . Subsequently, the lists 
                           
                              
                                 
                                    L
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    L
                                 
                                 
                                    y
                                 
                              
                           
                         are constructed from L in 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              log
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              )
                           
                         time. Thus, the total preprocessing time before applying Find-FSIP algorithm is 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              log
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              )
                           
                        .

The algorithm Find-FSIP finds the U-bridges from the intersection points between P and 
                           
                              
                                 
                                    R
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        , which are less in number than the grid points comprising the border of P. To find the intersection points, 
                           
                              
                                 
                                    L
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    L
                                 
                                 
                                    y
                                 
                              
                           
                         are accessed (Find-U-Bridges: Steps 3–5). To find the positions of 
                           
                              p
                              ,
                              q
                           
                        , and 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         in these lists, binary search is applied, which takes 
                           
                              O
                              (
                              log
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              )
                           
                         time in total. Other intersection points lie consecutively from p to 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         in 
                           
                              
                                 
                                    L
                                 
                                 
                                    y
                                 
                              
                           
                        , and from 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                           
                         to q in 
                           
                              
                                 
                                    L
                                 
                                 
                                    x
                                 
                              
                           
                        , and hence obtained by appropriate linear search in 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         time. The procedure Remove-Points discards some of the intersection points from 
                           
                              
                                 
                                    M
                                 
                                 
                                    y
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    x
                                 
                              
                           
                         based on combinatorial rules, which takes 
                           
                              O
                              (
                              k
                              )
                           
                         time, where 
                           
                              k
                              (
                              <
                              n
                              /
                              g
                              )
                           
                         is the number of intersection points. Note that g times k does not exceed the semi-perimeter of 
                           
                              
                                 
                                    R
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        .

The procedure Find-Polychain computes the polychain 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                         by traversing along (the borders of) 
                           
                              
                                 
                                    R
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                         and P. Traversal along 
                           
                              
                                 
                                    R
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                         is done to add intersection points in 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        , which requires 
                           
                              O
                              (
                              k
                              )
                           
                         time. Traversal along P—from one intersection point to the next—yields all the vertices of P lying among the intersection points. These vertices are added linearly in 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                         in a maximum 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         time. During the traversal along P, reduction rules are applied by Apply-Rule on the corresponding parts of 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        . The total time complexity for this is linear in the number of vertices of 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        , which is at most 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                        . Hence, all U-bridges are computed and added in the FSIP in 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         time in the worst case.

The time taken by Find-Extremum is upper-bounded by the maximum possible length of an extremum SIP, which is 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                        . The procedure Find-Region extracts the convex isothetic polygons and the Z-bridges by traversing 
                           
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                                 
                                    inf
                                 
                              
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                                 
                                    sup
                                 
                              
                           
                        . As explained in Section 4, the Z-bridges are obtained from the overlapping line segments in 
                           
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                                 
                                    inf
                                 
                              
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                                 
                                    sup
                                 
                              
                           
                        , using a linear pass on each, which needs 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         time in worst case. The Append-Bridge procedure adds the isothetic convex polygons and the bridges in 
                           
                              
                                 
                                    F
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        , which also takes 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                         time in worst case. Thus, the worst-case time complexity to compute the FSIP is 
                           
                              O
                              (
                              n
                              /
                              g
                              )
                           
                        . Hence, on considering the preprocessing time, the total worst-case time complexity becomes 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              log
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              )
                           
                        .

@&#EXPERIMENTAL RESULTS@&#

The proposed algorithm is implemented in C in Ubuntu 10.4, Kernel version 2.6.32-21-generic, Dual Intel Xeon Processor 2.8GHz, 800MHz FSB. It is tested on several datasets containing various digital images of different shapes and forms. As an example, the resultant FSIP between two given points in octopus image is shown in Fig. 9
                     . Notice that this FSIP consists of three U-bridges and four simple convex isothetic polygons, and so, 
                        
                           β
                           =
                           3
                        
                      and 
                        
                           α
                           =
                           4
                        
                     .

A set of FSIPs—especially the non-monotone ones—can be useful for extracting shape-related information about an object. However, finding the FSIPs for all pairs (or a large subset) of points chosen from the border of P, and then finding the non-monotone ones among them, is computationally prohibitive even for objects of reasonable size. Hence, to strike a balance, we locate only the convex edges (Definition 5) from the border of P, place appropriate control points on these convex edges, and then compute the FSIPs among them.

A convex edge is preceded and followed by monotone segments (or some other convex edges). We define the slope of a monotone segment s as the slope of the straight line passing through the first endpoint of the first edge in s and the last endpoint of the last edge in s. Let 
                           
                              |
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                              |
                           
                         denote the length of a convex edge, 
                           
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                           
                        . Let the respective lengths of the monotone segments 
                           
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        , preceding and following 
                           
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                           
                        , be 
                           
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    l
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        , and their respective slopes be 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        . Then the control points are selected based on the following cases (illustrated in Fig. 10
                        ).
                           
                              
                                 Case 1.
                              
                              If 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                  have nearly equal lengths or nearly equal slopes, i.e., 
                                    
                                       abs
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ⩽
                                       ρ
                                       ·
                                       max
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                  or 
                                    
                                       abs
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ⩽
                                       ρ
                                       ·
                                       max
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                 , then one control point is placed on 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                 . When there are two or more convex edges in succession, it is taken on the median convex edge. We have taken 
                                    
                                       ρ
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             3
                                          
                                       
                                    
                                  in our experiments.

If 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                  are both sufficiently small compared to 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                 , i.e., 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       ⩽
                                       ρ
                                       ·
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                  and 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ⩽
                                       ρ
                                       ·
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                 , then the two vertices defining 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                  are considered as two distinct control points.

If the monotone segment 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                  connecting two consecutive convex edges, 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 , is sufficiently smaller in length than the monotone segments 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                             +
                                             2
                                          
                                       
                                    
                                 —preceding and following 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                  respectively, i.e., 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ⩽
                                       ρ
                                       ·
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ⩽
                                       ρ
                                       ·
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             +
                                             2
                                          
                                       
                                    
                                 , then one control point is placed only on 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                 .

A striking feature of the above-mentioned technique is that the placement and the density of control points depend mostly on the object shape. The maximum (i.e., worst-case) density can occur, for example, for a sufficiently long comb-shaped object when each of its ‘spikes’ has a small number of grid points; and in that case, the number of control points is linear in the number of grid points on the border of P. Excepting such cases, this number is expected to be significantly small. This is also evident from our experimentation on real-world datasets. Table 2
                         shows some of our experimental results obtained for a small set of typical real-world objects.

FSIP can also provide a measure of path complexity between two given points, which can be used for shape analysis. For example, the maximum number of intersection of FSIPs (over a selected set of control points) signifies its centrality measure, which corresponds to a critical region. Fig. 11
                         illustrates some critical regions generated by our algorithm on the image guitarist. In Fig. 11(top-right), there are six control points with 
                           
                              
                                 
                                    
                                       
                                          
                                             6
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              =
                              15
                           
                         FSIPs. The lower part of the left hand (holding the guitar) of the guitarist is reported as the critical region (shown in red), since a maximum number of eight FSIPs overlap there. Four of these eight FSIPs are from the point at the bottom of the guitar, and remaining four from the point at the top of the guitar—both sets leading to points in head, hand, and two legs. When one point is disregarded (say, the bottom point in the guitar), there arise two critical regions with five control points, as shown in Fig. 11(bottom-left). In the critical region shown in red, there are four overlapping FSIPs: two from guitar top to hand and right leg, and two from head to hand and right leg. In the other critical region shown in indigo blue, there are also four such overlapping FSIPs: two from guitar top to hand and right leg, and two from hand and head to left leg. So, it is the “guitar” here that changes the critical region. When there are no control points inside the “guitar”, then the position of the critical region remains in the “body”, as shown with four control points in Fig. 11(bottom-right). The result in this case has six critical regions, which are shown in red, indigo blue, olive green, pink, purple, and sea green.

The critical region, C, in Fig. 11(top-right) forms the “bridge” between families (or parts of families) lying left of C and those lying right of C. This is a typicality of guitarist image and may not always arise. However, if it arises, then it would give a meaningful partition of the digital shape. Another example on the image dance is shown in Fig. 12
                        . In this image, the critical region is at the gripping hands. A critical region, however, may not always straightway provide a meaningful partition. For example, in Fig. 13
                        , the critical region (red) varies for different poses of the tennis player, and so it cannot partition the tennis bat from the tennis player. However, it is interesting to notice that in each of these poses, the critical region lies near the waist at the side of the hand holding the bat.

The convexity index of an FSIP also gives a complexity measure, since an FSIP is defined as a sequence of isothetic regions and bridges. The result is different from skeletonization, though both of them can be used for shape analysis. The skeleton of a digital object is a set of line segments lying always in the middle w.r.t. the object boundary [29], whereas an FSIP encompasses a wider region containing the shortest isothetic paths.

The data of FSIPs generated for three images, i.e., guitarist, dance, and tennis set, are tabulated in Tables 3–5
                        
                        
                        . The source and the destination points are given in the first column of each table. The second column contains the ideal (Manhattan) distance 
                           
                              |
                              pq
                              
                                 
                                    |
                                 
                                 
                                    1
                                 
                              
                           
                         between p and q, whereas the third column contains the length of a SIP between them, which is denoted by 
                           
                              |
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                              |
                           
                        . The path complexity of a SIP (and its FSIP, thereof) is estimated as 
                           
                              κ
                              =
                              (
                              |
                              
                                 
                                    π
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                              |
                              -
                              |
                              pq
                              
                                 
                                    |
                                 
                                 
                                    1
                                 
                              
                              )
                              /
                              |
                              pq
                              
                                 
                                    |
                                 
                                 
                                    1
                                 
                              
                              ×
                              100
                           
                        . The rationale is, as a SIP deviates more and more from the sides of 
                           
                              
                                 
                                    R
                                 
                                 
                                    (
                                    p
                                    ,
                                    q
                                    )
                                 
                              
                           
                        , its complexity goes on increasing. This complexity can be used to capture the shape of the object part lying between the concerned points. In combination with FSIP complexity, the number of U-bridges can also be used to estimate the shape complexity. For, a long SIP may not always signify a complex shape. As an example, in guitarist image, the point lying at top of the guitar and that in the right leg are furthest (depicted in Table 3), but the corresponding FSIP is monotone. On the contrary, the path length between the top of the guitar and the head of the guitarist is although less, the FSIP is more complex with two U-bridges. Again, the FSIP between the bottom of the guitar and the head has maximum number (three) of U-bridges, but a path in this FSIP is less complex if we consider merely the complexity estimate of the FSIP.

In dance image, the FSIP with maximum path complexity is from the man’s left leg to the girl’s right leg (Table 4), but it consists of three U-bridges. The FSIP from man’s left leg to girl’s left leg has maximum number (four) of U-bridges. The FSIPs from man’s head to man’s hand and left leg, girl’s head to girl’s right leg, and girl’s hand to girl’s right leg are all monotone. Monotone FSIP implies freedom of movement, whereas the presence of a Z-bridge or a U-bridge restricts this freedom. Presence of U-bridges makes a SIP non-monotone, whereas Z-bridges do not break the monotonicity. So, bridges carry a strong signature for the analysis of shape of an object.

The FSIP characteristics for two images of tennis set (Fig. 13) are provided in Table 5. Different poses give rise to different path complexities for the same pair of points, since the nature and the orientation of the concavities change with these poses. Between bat and left leg in the tennis set, some poses have monotone FSIPs and some have non-monotone. But, between right leg and left leg, the FSIPs are non-monotone for all the four poses. For Pose 1 tabulated in Table 5, there are more than one U-bridges, whereas for each other pose, there is one or none.

To demonstrate another real-world application of FSIP, we introduce here a novel idea for shape understanding through meaningful decomposition of a digital object. It is based on the key observation that two different components of an object are quite unlikely to be connected by any monotone FSIP. This, in turn, leads to the result that a set of non-monotone FSIPs for pairs of control points selected from the border of P, if judiciously analyzed, can result in natural decomposition of real-world objects. The object segmentation works as follows.

We initiate here the concept of object segmentation using FSIPs, which can be enhanced further in future. The FSIPs between consecutive control points are determined for segmentation of the object. Some of these FSIPs are monotone, and some are non-monotone. Based on the monotonicity of FSIPs, control points are partitioned into different sets. Let there be m control points, 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                           
                        , in order. Then the FSIP between 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         is monotone if and only if 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         belong to the same set (closure). Hence, all the control points belonging to the same closure set are considered to be in a particular segment of the object, whereas control points belonging to a different set comprise a different segment. The U-bridges of two consecutive non-monotone FSIPs due to two consecutive pairs of sets are used to perform the segmentation.

The results of segmentation for few typical objects are shown in Fig. 14
                        . The petals of a flower belong to all different segments, as reported by our algorithm. The letters N and T have also resulted to their main constituting segments. In Fig. 15
                        , the ‘handle’ of fork, of soup-spoon, and of spoon are reported as a different segment.

The rotational invariance of segmentation is shown in Fig. 16
                        . Six rotations of hammer are considered at fifteen degree intervals. The segmentation is almost same for all six positions, which depicts the rotational invariance of our segmentation. Invariance to grid resolution is presented in Fig. 17
                         for various grid sizes (
                           
                              g
                              =
                              2
                              ,
                              3
                              ,
                              4
                              ,
                              6
                              ,
                              8
                              ,
                              10
                           
                        ) for the object wrench. The resulting segmentations are again same for various grid sizes, as all six results contain three naturally distinctive segments.

@&#CONCLUSION@&#

The proposed algorithm finds the region containing all possible shortest isothetic paths between two given points on the border of a digital object. Given an inner isothetic cover P, it runs in 
                        
                           O
                           (
                           n
                           /
                           g
                           )
                        
                      time which is linear in the number of grid points on the border of P with 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 g
                              
                           
                           log
                           
                              
                                 n
                              
                              
                                 g
                              
                           
                           )
                        
                      preprocessing time. The algorithm can be applied on digital objects without holes. However, for objects with holes, it requires appropriate modifications. Preliminary experimental results on shape analysis and segmentation using multiple FSIPs, as demonstrated in this paper, show a strong indication of its practical perspectives for real-world applications related to image understanding.

@&#ACKNOWLEDGMENTS@&#

The first and the second authors gratefully acknowledge the support provided by INSPIRE Program under Department of Science and Technology, Government of India, and Major Project Scheme under University Grant Commission, Government of India.

@&#REFERENCES@&#

