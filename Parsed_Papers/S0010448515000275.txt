@&#MAIN-TITLE@&#Canal surfaces with rational contour curves and blends bypassing the obstacles

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The rationality of generalized contours on rational canal surfaces is studied.


                        
                        
                           
                           The contour method is used for computing PN blends between two canal surfaces.


                        
                        
                           
                           The constructed blends can easily satisfy certain constrains, e.g. avoiding obstacles.


                        
                        
                           
                           Only one SOS decomposition for all canal surfaces with the same silhouette is needed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Canal surfaces

Rational parameterizations

Contour curves

Blends

Polynomial SOS

Bypassing obstacles

@&#ABSTRACT@&#


               
               
                  In this paper, we will present an algebraic condition, see (20), which guarantees that a canal surface, given by its rational medial axis transform (MAT), possesses rational generalized contours (i.e., contour curves with respect to a given viewpoint). The remaining computational problem of this approach is how to find the right viewpoint. The canal surfaces fulfilling this distinguished property are suitable for being taken as modeling primitives when some rational approximations of canal surfaces are required. Mainly, we will focus on the low-degree cases such as quadratic and cubic MATs that are especially useful for applications. To document a practical usefulness of the presented approach, we designed and implemented two simple algorithms for computing rational offset blends between two canal surfaces based on the contour method which do not need any further advanced formalism (as e.g. interpolations with MPH curves). A main advantage of the designed blending technique is its simplicity and also an adaptivity to choose a suitable blend satisfying certain constrains (avoiding obstacles, bypassing other objects, etc.). Compared to other similar methods, our approach requires only one SOS decomposition for the whole family of rational canal surfaces sharing the same silhouette, which significantly simplifies the computational complexity.
               
            

@&#INTRODUCTION@&#

Silhouette curves are planar curves enclosing the projection of a spatial object into plane. They not only help to create a first visual perception of the shape of the studied object but they have also many practical applications—for instance, in reconstruction of the 3D object from a 2D image, in rendering, in computing the visible area, when deleting invisible curves. There exist two types of silhouettes—parallel (corresponding to the viewpoints at the infinity) and perspective (corresponding to the real viewpoints at a finite distance). The preimages of the silhouette curves on the studied 3D object are called contour curves. We recall that in some papers the notion silhouette curves is used simultaneously also for the contour curves — however, we will strictly distinguish it in what follows. More details about silhouettes/contours and their computation and related topics can be found e.g. in  [1–4].

Silhouette and contour curves are very complex even for simple surfaces and in most cases it is difficult to represent them accurately (and finding their NURBS representation, if it exists, is even more complicated). In this paper, we will focus only on one of the most important classes of technical surfaces, namely on the rational canal surfaces, whose silhouettes were already studied e.g. in  [5–7]. We will investigate the contour curves (solely with respect to the parallel projection) from the point of view of their rationality. In addition, we will show that they are very useful e.g. for the construction of adaptive blending surfaces between two canal surfaces satisfying some given constraints (for instance avoiding obstacles). This approach is based on the construction of a single rational silhouette curve which is common for a whole family of different rational canal surfaces and then choosing a suitable surface with prescribed properties with help of a certain distance function.

Let us recall that the canal surfaces, see e.g.  [8], are defined as envelopes of one parameter families of spheres in 3-space. Nowadays they are very popular in Computer-Aided Design as they can be used for constructing simple blends between two given surfaces, see  [9] and references therein for a detailed overview of blending techniques. Among others, all surfaces of revolution belong to canal surfaces. For a constant radius of moving spheres we speak about pipe surfaces. A special (and probably the most investigated) subfamily of the canal surfaces are Dupin cyclides which can be defined as the envelopes of all spheres touching three given spheres, see e.g.  [10–13].

It was proved in  [14] that any canal surface with a rational spine curve (a set of all centers of moving generating spheres) and a rational radius function has a rational parameterization. This result followed an equivalent result from  [15] for pipe surfaces. A technique for computing rational parameterizations of canal surfaces was presented in  [16]. Minimal rational parameterizations of canal surfaces were thoroughly studied in  [17]. Let us emphasize that although the canal surfaces with rational spine curves and rational radii always possess exact rational parameterizations, approximate parameterization techniques are also investigated in connection with them, see e.g.  [18]. This is caused by the computational difficulty of decomposing a rational function into a sum of two squares (SOS) over reals, which is a necessary part of the parameterization algorithm from  [16] (and we will see that the SOS decomposition will occur also in the approach presented in this paper when exact rational parameterizations are required).

Recently a ‘contour method’ for parameterizing (some classes of) canal surfaces has been introduced in  [18,19]. This approach is based on the main idea that if the parameterizations of the spine curve and one curve on the canal surface (different from the characteristic circles) are known and they are corresponding in parameter we can easily find a rational parameterization of the canal surface by rotating the points of the given curve along the tangents of the spine curve. In  [19], a condition guaranteeing the rationality of the special curves on canal surfaces called contour curves, which were then used for a computation of parameterizations of canal surfaces, was investigated. The presented approach extended the results about rational spatial Minkowski Pythagorean hodograph curves and the associated planar (Euclidean) Pythagorean hodograph curves from  [20] and related them with the contour curves of canal surfaces given by their medial axis transforms.

In this paper we will follow the approach from the aforementioned papers and extend the notion of ‘contour curves’ (originally related to the coordinate planes and coordinate axis directions only) to general planes and general directions, too. This allows us to apply the contour method to a broader class of canal surfaces and hence a main drawback of the original method (dependence on the choice of a suitable coordinate system) is eliminated. We will formulate a condition on the medial axis transform of the canal surface which guarantees the rationality of the contour curves with respect to a given general direction (viewpoint at infinity), and thus also the rationality (and the rational offsets property) of the obtained canal surface parameterizations. In addition, we will mention the existence of real contour curves which, of course, do not have to exist for a chosen direction and a chosen part of the given canal surface, in general.

The remainder of this paper is organized as follows. Section  2 summarizes some fundamental facts concerning the canal surfaces, contour curves and SOS decomposition problem. As a motivation, in Section  3 we recall several results about contour curves on implicitly given canal surfaces. In Section  4, general contour curves are introduced and the condition which must be satisfied by the MAT and that guarantees the rationality of the contour curves is derived and discussed. The main part of the paper is devoted to the low-degree cases such as quadratic and cubic MATs that are especially useful for practical applications. In Section  5, the polynomial quadratic and cubic medial axis transforms are thoroughly studied from the point of view of the rationality of the associated contour curves. We will show how to find a suitable viewpoint which guarantees the rationality of the contour curves on this type of canal surfaces (i.e., with quadratic or cubic MATs). Special investigations will be devoted to pipe surfaces with low-degree MATs. In Section  6 we will focus on the operation of blending with rational contours. A simple direct method (which does not require in most cases another advanced modeling technique as e.g. modeling with MPH curves) for computing rational offset blends between two canal surfaces based on the contour method will be formulated. A main advantage of the designed blending technique is its simplicity and especially its usefulness for constructing blends satisfying certain constrains, e.g. when avoiding obstacles or bypassing other objects is required. Compared to other methods our approach needs only one SOS decomposition for the whole family of rational canal surfaces sharing the same silhouette, see  Fig. 1
                     . The designed algorithms are presented in several examples. In Section  7, we conclude the paper.

We start with short recalling some fundamental properties of canal surfaces which will be used in the following sections. We also mention the problem of sum of squares decomposition of non-negative polynomials over reals playing an important role in our method.

A canal surface 
                        
                           S
                         is the envelope of a 1-parameter family of spheres 
                           F
                         whose centers trace a curve 
                           
                              m
                           
                         in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         and possess radii 
                           r
                        , i.e.,  
                           
                              (1)
                              
                                 F
                                 
                                    (
                                    t
                                    )
                                 
                                 :
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             x
                                          
                                          −
                                          
                                             m
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 r
                                 
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 t
                                 ∈
                                 I
                                 ,
                              
                           
                         where 
                           
                              x
                           
                           =
                           
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        . The curve 
                           
                              m
                           
                         is called the spine curve and 
                           r
                         the radius function of 
                           S
                        . For constant 
                           r
                         we obtain a pipe surface. The defining equations for the canal surface 
                           S
                         are 
                           
                              (2)
                              
                                 F
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 F
                              
                              
                                 ′
                              
                           
                         is the derivative of 
                           F
                         with respect to 
                           t
                        . When we eliminate the parameter 
                           t
                         from (2) one can get the corresponding implicit equation 
                           f
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                         of 
                           S
                        . The linear equation 
                           
                              
                                 F
                              
                              
                                 ′
                              
                           
                           =
                           0
                         describes the plane with the normal vector 
                           
                              
                                 
                                    m
                                 
                              
                              
                                 ′
                              
                           
                        , i.e., perpendicular to the spine curve 
                           
                              m
                           
                        . Thus the canal surface 
                           S
                         contains a one parameter set of the so called characteristic circles 
                        
                           F
                           ∩
                           
                              
                                 F
                              
                              
                                 ′
                              
                           
                         and canal surfaces belong to the so called ringed surfaces. It can be proved that the envelope (i.e., the canal surface) is real iff the condition 
                           
                              (3)
                              
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                       2
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≥
                                 0
                              
                           
                         is fulfilled for all 
                           t
                           ∈
                           I
                        .

By appending the corresponding sphere radii 
                           r
                         to the points of the spine curve (or the skeleton, or the medial axis) we obtain the medial axis transform MAT, i.e., the curve 
                           
                              
                                 
                                    m
                                 
                              
                              ¯
                           
                        . For the sake of clarity, we identify the canal surface 
                           S
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         with its medial axis transform 
                           
                              
                                 
                                    m
                                 
                              
                              ¯
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       m
                                    
                                    ,
                                    r
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                                 ,
                                 1
                              
                           
                        , see  [14,21], where 
                           
                              
                                 R
                              
                              
                                 3
                                 ,
                                 1
                              
                           
                         is the 4-dimensional Minkowski space serving as the natural ambient space for MATs of canal surfaces, cf. (1). We recall that the squared norm of a vector 
                           
                              u
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                                 ,
                                 1
                              
                           
                         with respect to the indefinite Minkowski inner product 
                        
                           
                              〈
                              
                                 u
                              
                              ,
                              
                                 v
                              
                              〉
                           
                           =
                           
                              
                                 
                                    u
                                 
                              
                              
                                 ⊤
                              
                           
                           
                              J
                           
                           
                              v
                           
                        , given by 
                           
                              J
                           
                           =
                           diag
                           
                              (
                              1
                              ,
                              1
                              ,
                              1
                              ,
                              −
                              1
                              )
                           
                        , can be positive, negative or zero. Hence, we distinguish three types of vectors: a vector 
                           
                              u
                           
                         is called space-like if 
                           
                              〈
                              
                                 u
                              
                              ,
                              
                                 u
                              
                              〉
                           
                           >
                           0
                        , time-like if 
                           
                              〈
                              
                                 u
                              
                              ,
                              
                                 u
                              
                              〉
                           
                           <
                           0
                        , and light-like (or isotropic) if 
                           
                              〈
                              
                                 u
                              
                              ,
                              
                                 u
                              
                              〉
                           
                           =
                           0
                        . Considering their tangent vectors we analogously speak about space-, light-, or time-like curves. So condition (3) expresses that the medial axis transform 
                           
                              
                                 
                                    m
                                 
                              
                              ¯
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                                 ,
                                 1
                              
                           
                         is not a time-like curve.

For computing a parameterization of the canal surface 
                           S
                         we apply the method used e.g. in  [18,19] based on rotating the points of a curve 
                           
                              c
                           
                         on 
                           S
                         (different from the characteristic circles) around the tangents of the spine curve 
                           
                              m
                           
                        , i.e., we arrive at 
                           
                              (4)
                              
                                 
                                    s
                                 
                                 
                                    (
                                    t
                                    ,
                                    u
                                    )
                                 
                                 =
                                 
                                    m
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          ϱ
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       ⋆
                                       
                                          (
                                          0
                                          ,
                                          
                                             c
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             m
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       ⋆
                                       
                                          (
                                          ϱ
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          ϱ
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                       ⋆
                                       
                                          (
                                          ϱ
                                          
                                             (
                                             u
                                             )
                                          
                                          ,
                                          −
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           ϱ
                           
                              (
                              u
                              )
                           
                         is a rational function and 
                           ⋆
                         is the operation of quaternion multiplication 
                           
                              (5)
                              
                                 
                                    (
                                    a
                                    ,
                                    
                                       a
                                    
                                    )
                                 
                                 ⋆
                                 
                                    (
                                    b
                                    ,
                                    
                                       b
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    a
                                    b
                                    −
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ⋅
                                    
                                       b
                                    
                                    ,
                                    a
                                    
                                       b
                                    
                                    +
                                    b
                                    
                                       a
                                    
                                    +
                                    
                                       a
                                    
                                    ×
                                    
                                       b
                                    
                                    )
                                 
                                 ,
                              
                           
                         see  [22,23] for more details about quaternions. Any rational choice of 
                           ϱ
                         gives a rational parameterization of a canal surface—for the sake of simplicity we choose 
                           ϱ
                           =
                           u
                         for the low rational degree of 
                           
                              s
                           
                         in 
                           u
                        , and 
                           ϱ
                           =
                           2
                           u
                           /
                           
                              (
                              1
                              −
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         for a relatively uniform distribution of the 
                           t
                        -parameter lines.

Let us emphasize that when using the spine curve 
                           
                              m
                           
                         and another curve 
                           
                              c
                           
                         on 
                           S
                         for the computation of the rational parameterization of 
                           S
                         we have to have guaranteed that their parameterizations correspond in parameter, i.e., it must hold
                           
                              (6)
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    (
                                    
                                       c
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    
                                       m
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 for all  
                                 t
                                 ∈
                                 I
                                 .
                              
                           
                         In other words, it has to be ensured that the point 
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                         lies at the characteristic circle of 
                           S
                         corresponding to the sphere centered at 
                           
                              m
                           
                           
                              (
                              t
                              )
                           
                         and with the radius 
                           r
                           
                              (
                              t
                              )
                           
                        , for all 
                           t
                           ∈
                           I
                        .

In  [18,19], we introduced the so-called 
                           z
                        -contour curve 
                           
                              
                                 C
                              
                              
                                 z
                              
                           
                         of a given canal surface 
                           S
                         as a curve consisting of all the points at which the normals of 
                           S
                         are orthogonal to the 
                           z
                        -axis (equivalently to the vector 
                           
                              k
                           
                           =
                           
                              
                                 
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    1
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        ) and used this curve for computing the parameterization of 
                           S
                        . It was shown that the parameterizations of the two branches of the 
                           z
                        -contour curve possess the form 
                           
                              (7)
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          k
                                       
                                    
                                    
                                       ±
                                    
                                 
                                 =
                                 
                                    m
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            ▿
                                                         
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ▿
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ±
                                    
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               ▿
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ▿
                                             
                                          
                                       
                                       
                                          ′
                                          ⊥
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              m
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ▿
                                    
                                 
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ▿
                                    
                                 
                              
                              
                                 ′
                                 ⊥
                              
                           
                           =
                           
                              
                                 
                                    (
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        .

Sum of squares (SOS) problem is closely connected with solving polynomial equations, for more details see e.g.  [24,25]. A polynomial 
                           τ
                           
                              (
                              t
                              )
                           
                         over reals is said to be positive semidefinite (PSD), or positive definite (PD) if 
                           τ
                           
                              (
                              t
                              )
                           
                           ≥
                           0
                        , or 
                           τ
                           
                              (
                              t
                              )
                           
                           >
                           0
                         for all 
                           t
                           ∈
                           R
                        . We say that 
                           τ
                         is a sum of squares if the degree of 
                           τ
                         is even and it can be written as a sum of squares of other polynomials. It is obvious that SOS decomposition of 
                           τ
                         implies its nonnegativity. However, the converse is not true in general—the construction of PSD polynomials which are not sums of squares was first described by Hilbert in 1888.

For the sake of brevity, we recall only elementary notions dealing with the univariate polynomials where the situation becomes much easier than in the general case. It can be shown that every PSD univariate polynomial is a sum of just two squares. In this section we show how the decomposition of a polynomial 
                           τ
                           ∈
                           R
                           
                              [
                              t
                              ]
                           
                         can be computed, i.e., we want to find two polynomials 
                           f
                           ,
                           g
                           ∈
                           R
                           
                              [
                              t
                              ]
                           
                         such that
                           
                              (8)
                              
                                 τ
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         Let us recall that a real polynomial in one variable is PSD iff its leading coefficient is positive and its roots are either complex in conjugate pairs or real with even multiplicity. Of course, the SOS decomposition (8) is by no mean unique; for an arbitrary 
                           φ
                         the polynomials 
                           
                              (9)
                              
                                 
                                    
                                       f
                                    
                                    
                                       φ
                                    
                                 
                                 =
                                 cos
                                 φ
                                 
                                 g
                                 −
                                 sin
                                 φ
                                 
                                 f
                                 
                                 and
                                 
                                 
                                    
                                       g
                                    
                                    
                                       φ
                                    
                                 
                                 =
                                 cos
                                 φ
                                 
                                 f
                                 +
                                 sin
                                 φ
                                 
                                 g
                              
                           
                         solve the problem as well, i.e., formula (9) generates an equivalence class of decompositions. For a polynomial 
                           τ
                         of degree 
                           2
                           n
                        , there exist 
                           
                              
                                 2
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         non-equivalent classes of decompositions, see  [16]. Hence in order to obtain all possible decompositions we have to compute 
                           
                              
                                 2
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         particular non-equivalent decompositions and use formula (9) to generate all of them.

Of course, it is not easy to get the initial decomposition 
                           
                              (
                              f
                              ,
                              g
                              )
                           
                        , because we are not able to compute the exact roots, in general. And another limitation appears when we want to work only with polynomials with rational coefficients, when the SOS decomposition may include more than two squares. Nonetheless, in this paper we are going to decompose quadratic and quartic polynomials, only, and thus the computation of a SOS decomposition can be achieved symbolically. In particular we can obtain a decomposition (8) with the help of the roots of 
                           τ
                         which can be computed using the discriminant for quadratic 
                           τ
                         and so called Ferrari’s formulas for quartic 
                           τ
                        .
                           Example 2.1
                           If 
                                 τ
                               is a quadratic PSD polynomial, we can write its factorization as follows 
                                 
                                    (10)
                                    
                                       τ
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       λ
                                       
                                          (
                                          t
                                          −
                                          α
                                          −
                                          β
                                          i
                                          )
                                       
                                       
                                          (
                                          t
                                          −
                                          α
                                          +
                                          β
                                          i
                                          )
                                       
                                       ,
                                    
                                 
                               where 
                                 α
                                 ,
                                 β
                                 ∈
                                 R
                               and 
                                 λ
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                              . Then there exists only one equivalence class of the decomposition generated e.g. by
                                 
                                    (11)
                                    
                                       f
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                       
                                       
                                          (
                                          t
                                          −
                                          α
                                          )
                                       
                                       ,
                                       
                                       g
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             λ
                                          
                                       
                                       β
                                       .
                                    
                                 
                              
                           


                        
                           Example 2.2
                           For a quartic PSD polynomial 
                                 
                                    (12)
                                    
                                       τ
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       λ
                                       
                                          (
                                          t
                                          −
                                          α
                                          −
                                          β
                                          i
                                          )
                                       
                                       
                                          (
                                          t
                                          −
                                          α
                                          +
                                          β
                                          i
                                          )
                                       
                                       
                                          (
                                          t
                                          −
                                          γ
                                          −
                                          δ
                                          i
                                          )
                                       
                                       
                                          (
                                          t
                                          −
                                          γ
                                          +
                                          δ
                                          i
                                          )
                                       
                                       ,
                                    
                                 
                               where 
                                 α
                                 ,
                                 β
                                 ,
                                 γ
                                 ,
                                 δ
                                 ∈
                                 R
                               and 
                                 λ
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                               we use Fibonacci’s identities 
                                 
                                    (13)
                                    
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                a
                                                c
                                                ±
                                                b
                                                d
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                (
                                                a
                                                d
                                                ∓
                                                b
                                                c
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               and obtain two non-equivalent decompositions in the form 
                                 
                                    (14)
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             (
                                             δ
                                             
                                                (
                                                t
                                                −
                                                α
                                                )
                                             
                                             ±
                                             β
                                             
                                                (
                                                t
                                                −
                                                γ
                                                )
                                             
                                             )
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                          
                                          
                                             (
                                             
                                                (
                                                t
                                                −
                                                α
                                                )
                                             
                                             
                                                (
                                                t
                                                −
                                                γ
                                                )
                                             
                                             ∓
                                             β
                                             δ
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

We recall that in  [18,26] a method for computing approximate parameterizations of implicitly given canal surfaces based on approximating their classical contour curves by polynomial cubics was introduced. The algorithm starts with computing approximate parameterizations of the both branches of the 
                        z
                     -contour curve of the given canal surface 
                        S
                     . From these parameterizations an approximation of the spine curve of 
                        S
                      is reconstructed and then an approximate parameterization of 
                        S
                      is computed.

A drawback of this method lies in the fact that it produces parameterizations with the high rational bidegree. This is caused by the quality of the reconstructed spine curve which is rational of degree seven. Hence the improvement of the method producing the polynomial cubic spine curve, which leads to the canal surface having the rational degree 
                        
                           (
                           7
                           ,
                           4
                           )
                        
                      in the first parameter and 
                        
                           (
                           2
                           ,
                           2
                           )
                        
                      in the second parameter, is presented in  [26]. The main idea of the method is based on computing the parameterizations 
                        
                           
                              
                                 c
                              
                           
                           
                              x
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           
                           
                              ⊤
                           
                        
                        ,
                        
                           
                              
                                 c
                              
                           
                           
                              y
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       y
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           
                           
                              ⊤
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                           
                           
                              z
                           
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       z
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           
                           
                              ⊤
                           
                        
                      (corresponding in parameter) of the contour curves 
                        
                           
                              C
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              y
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              z
                           
                        
                     , respectively. Then the parametric description of the spine curve is easily derived in the form
                        
                           (15)
                           
                              
                                 m
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             z
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                              .
                           
                        
                      Of course, both methods are not independent of the coordinate system.

Unfortunately, when a canal surface is in a special position the methods from  [18,26] may lead to some difficulties (see Example 3.1). These problems can be easily avoided considering the contour curves w.r.t. a general viewpoint. When a canal surface is given by its implicit equation 
                        f
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        0
                      then the contour curve w.r.t. the parallel projection given by the vector 
                        
                           v
                        
                      is determined as the complete intersection of two algebraic surfaces defined by the polynomials
                        
                           (16)
                           
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              
                              and
                              
                              ∇
                              f
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              ⋅
                              
                                 v
                              
                              ,
                           
                        
                      where 
                        ∇
                        f
                      stands for the gradient of 
                        f
                     .

Analogously to  [18], now we consider three contour curves w.r.t. three arbitrary linearly independent directions and using them we reconstruct the spine curve. More precisely, we compute the parameterizations 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    1
                                 
                              
                           
                        
                     , 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    3
                                 
                              
                           
                        
                      (corresponding in parameter) of three different contour curves on 
                        S
                      w.r.t. the vectors 
                        
                           
                              
                                 v
                              
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              
                                 v
                              
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                           
                           
                              3
                           
                        
                     , respectively. Then the spine curve possesses the parameterization
                        
                           
                              
                                 m
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              ⋅
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                3
                                             
                                          
                                          ⋅
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  


                     
                        Example 3.1
                        Let us consider the canal surface 
                              S
                            implicitly given by the polynomial 
                              
                                 
                                    f
                                    =
                                    2304
                                    
                                       
                                          x
                                       
                                       
                                          6
                                       
                                    
                                    +
                                    6912
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    768
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    4608
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    z
                                    −
                                    1296
                                    
                                       
                                          x
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    6912
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    1536
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    4608
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    z
                                    +
                                    2592
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1280
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          4
                                       
                                    
                                    +
                                    3072
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    1632
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1440
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    z
                                    +
                                    216
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2304
                                    
                                       
                                          y
                                       
                                       
                                          6
                                       
                                    
                                    +
                                    768
                                    
                                       
                                          y
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    9216
                                    
                                       
                                          y
                                       
                                       
                                          4
                                       
                                    
                                    z
                                    −
                                    1296
                                    
                                       
                                          y
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    1280
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    8704
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    4512
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    288
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    z
                                    −
                                    216
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    256
                                    
                                       
                                          z
                                       
                                       
                                          6
                                       
                                    
                                    −
                                    1536
                                    
                                       
                                          z
                                       
                                       
                                          5
                                       
                                    
                                    +
                                    2672
                                    
                                       
                                          z
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    1056
                                    
                                       
                                          z
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    24
                                    
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    72
                                    z
                                    −
                                    9
                                    .
                                 
                              
                            We want to compute an approximate parameterization of 
                              S
                            (of a low degree) in some prescribed bounding box 
                              B
                           . The method based on the classical contour curves cannot be applied as the 
                              z
                           -contour curve 
                              
                                 
                                    C
                                 
                                 
                                    z
                                 
                              
                            lying in 
                              B
                            is closed and thus cannot be used for parameterizing the whole part of 
                              S
                           , see Fig. 2
                            (top). An easy way to overcome this problem is considering other three viewpoints, see Fig. 2 (bottom).

Hence, the aforementioned considerations and Example 3.1 lead us to the motivation to study the silhouettes and the contour curves w.r.t. a general viewpoint in more detail and also for the canal surfaces given by their medial axis transforms.

In this section we will introduce the general contour curves with respect to an arbitrary direction 
                        
                           v
                        
                     . Then we will investigate the conditions guaranteeing their rationality and show how they can be efficiently used for computing rational parameterizations of (some special) canal surfaces. 
                        Definition 4.1
                        A general contour curve 
                           
                              
                                 
                                    C
                                 
                                 
                                    
                                       v
                                    
                                 
                              
                            w.r.t. the vector 
                              
                                 v
                              
                            of the canal surface 
                              S
                            is a curve on 
                              S
                            different from its characteristic circles and consisting of all the points at which the normals of 
                              S
                            are orthogonal to 
                              
                                 v
                              
                           .

A general contour curve 
                        
                           
                              C
                           
                           
                              
                                 v
                              
                           
                        
                      w.r.t. the vector 
                        
                           v
                        
                      corresponds to the silhouette of the given canal surface when projecting it to the plane with the normal vector 
                        
                           v
                        
                     , see Fig. 3
                     . Without loss of generality, we may assume in what follows that 
                        
                           v
                        
                      is a unit vector. When a canal surface is given by its implicit equation 
                        f
                        
                           (
                           
                              x
                           
                           )
                        
                        =
                        0
                      then the general contour curve w.r.t. the vector 
                        
                           v
                        
                      is determined as the complete intersection of two algebraic surfaces defined by (16).

For computing parameterizations 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 v
                              
                           
                           
                              ±
                           
                        
                      of the both branches of the general contour curve 
                        
                           
                              C
                           
                           
                              
                                 v
                              
                           
                        
                      on the canal surface given by its MAT, we orthogonally project the spine curve 
                        
                           m
                        
                      to a plane 
                        
                           
                              ν
                           
                           
                              
                                 v
                              
                           
                        
                      going through the origin and having the normal vector 
                        
                           v
                        
                     . Then we compute the parameterization of the projection of the contour curve and lift it back.

The orthogonal projection 
                        
                           
                              π
                           
                           
                              
                                 v
                              
                           
                        
                        :
                        
                           
                              R
                           
                           
                              3
                           
                        
                        →
                        
                           
                              ν
                           
                           
                              
                                 v
                              
                           
                        
                      is realized as follows: 
                        
                           (17)
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       v
                                    
                                 
                              
                              
                                 (
                                 
                                    m
                                 
                                 )
                              
                              =
                              
                                 m
                              
                              −
                              
                                 (
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    v
                                 
                                 )
                              
                              
                                 v
                              
                              .
                           
                        
                      According to (7) the general contour curve w.r.t. the vector 
                        
                           v
                        
                      can possess the following parameterization 
                        
                           (18)
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                                 
                                    ±
                                 
                              
                              =
                              
                                 m
                              
                              −
                              r
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    
                                       
                                          π
                                       
                                       
                                          
                                             v
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                m
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ±
                                    
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             
                                                v
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   m
                                                
                                                )
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ×
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               m
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                       
                                    
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   
                                                      v
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         m
                                                      
                                                      )
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                      After some simplifications we obtain 
                        
                           (19)
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                                 
                                    ±
                                 
                              
                              =
                              
                                 m
                              
                              −
                              r
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                             ⊤
                                          
                                       
                                       ⋅
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ±
                              r
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ×
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         ′
                                                         ⊤
                                                      
                                                   
                                                   ⋅
                                                   
                                                      v
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  


                     
                        Proposition 4.2
                        
                           The general contour curve   (19)   of the canal surface defined by the medial axis transform 
                           
                              
                                 
                                    
                                       m
                                    
                                 
                                 ¯
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          m
                                       
                                       ,
                                       r
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                            
                           is rational iff there exists a rational function 
                           
                              σ
                            
                           such, that
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

Moreover, since the unit normal vectors of the given canal surface along 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 v
                              
                           
                           
                              ±
                           
                        
                      are of the form 
                        
                           (21)
                           
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                                 
                                    ±
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          ±
                                       
                                    
                                    −
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             
                                                v
                                             
                                          
                                          
                                             ±
                                          
                                       
                                       −
                                       
                                          m
                                       
                                       ‖
                                    
                                 
                              
                              =
                              −
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                             ⊤
                                          
                                       
                                       ⋅
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ±
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ×
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         ′
                                                         ⊤
                                                      
                                                   
                                                   ⋅
                                                   
                                                      v
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      the parameterization of the canal surface yields the associated Pythagorean normals (i.e., it is a PN parameterization guaranteeing rational offsets,  [27]); see the following proposition 
                        Proposition 4.3
                        
                           The parameterizations 
                           
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    ±
                                 
                              
                            
                           of the canal surface defined by 
                           
                              
                                 
                                    
                                       m
                                    
                                 
                                 ¯
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          m
                                       
                                       ,
                                       r
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                            
                           computed by rotating the points of the contour curve 
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    
                                       v
                                    
                                 
                                 
                                    ±
                                 
                              
                            
                           around the tangents of 
                           
                              
                                 m
                              
                            
                           is PN iff there exists a rational function 
                           
                              σ
                            
                           such, that condition   (20)   is satisfied.
                        

Using explicit formula (21) for the unit normal vectors of the given canal surface along 
                        
                           
                              
                                 c
                              
                           
                           
                              
                                 v
                              
                           
                           
                              ±
                           
                        
                      we can immediately write down a parameterization of the given canal surface derived from quaternion formula (4) in the form
                        
                           (22)
                           
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    ±
                                 
                              
                              =
                              
                                 m
                              
                              +
                              r
                              
                                 
                                    
                                       
                                          ϱ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          ±
                                       
                                    
                                    +
                                    2
                                    ϱ
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                v
                                             
                                          
                                          
                                             ±
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ϱ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ×
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                v
                                             
                                          
                                          
                                             ±
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ϱ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  


                     
                        Remark 4.4
                        The curves in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                    ,
                                    1
                                 
                              
                            satisfying condition (20) are actually the Pythagorean hodograph (PH) curves, see  [28], in 4-dimensional space w.r.t. the inner product defined by the matrix 
                              
                                 (23)
                                 
                                    
                                       A
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                −
                                                
                                                   v
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                             
                                             
                                                
                                                   o
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         o
                                                      
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              
                                 o
                              
                              =
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           . Thus we can write 
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          ′
                                          ⊤
                                       
                                    
                                    ⋅
                                    
                                       A
                                    
                                    ⋅
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Remark 4.5
                        For 
                              z
                           -contour curves, i.e., for the contour curves w.r.t. the vector 
                              
                                 k
                              
                              =
                              
                                 
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           , condition (20) degenerates to the following simple one, which was presented in  [19].
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                2
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        


                     
                        Example 4.6
                        We recall the approach from  [19] where 
                              z
                           -contour curves were studied and used for parameterizing (special types of) canal surfaces. If we apply the method from this paper to the canal surface given by the following quintic MAT 
                              
                                 (26)
                                 
                                    
                                       m
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   1
                                                
                                                
                                                   225
                                                
                                             
                                             
                                                (
                                                −
                                                24
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                65
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                15
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                150
                                                t
                                                )
                                             
                                             ,
                                             
                                                
                                                   1
                                                
                                                
                                                   225
                                                
                                             
                                             
                                                (
                                                −
                                                57
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      5
                                                   
                                                
                                                −
                                                80
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                105
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                75
                                                t
                                                )
                                             
                                             ,
                                             
                                                
                                                   1
                                                
                                                
                                                   90
                                                
                                             
                                             
                                                (
                                                6
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                10
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                15
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                60
                                                t
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                              
                            and 
                              
                                 (27)
                                 
                                    r
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          30
                                       
                                    
                                    
                                       (
                                       −
                                       6
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                       +
                                       10
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       15
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                            we arrive at the conclusion that the classical contour curves (i.e., the contour curves w.r.t. the axis directions) are not rational since 
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≠
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            for any 
                              i
                              ,
                              j
                              ∈
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 }
                              
                              ,
                              
                              i
                              ≠
                              j
                           . However, using the unit vector 
                              
                                 v
                              
                              =
                              
                                 
                                    
                                       (
                                       −
                                       2
                                       /
                                       3
                                       ,
                                       −
                                       1
                                       /
                                       3
                                       ,
                                       2
                                       /
                                       3
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                            we get 
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             2
                                             
                                                
                                                   t
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                            and hence the associated general contour curve w.r.t. the vector 
                              
                                 v
                              
                            is rational and can be immediately used for computing a rational parameterization of the given canal surface.

Although the main role in this paper plays canal surfaces with polynomial MATs the following example shows that the theory holds for the canal surfaces with rational MATs, in general. 
                        Example 4.7
                        Let us consider the canal surface given by the rational quadratic MAT
                              
                                 (30)
                                 
                                    
                                       m
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   2
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   2
                                                   t
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ,
                                    
                                    r
                                    =
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                            Then for the vector 
                              
                                 v
                              
                              =
                              
                                 
                                    
                                       (
                                       −
                                       1
                                       /
                                       3
                                       ,
                                       2
                                       /
                                       3
                                       ,
                                       2
                                       /
                                       3
                                       )
                                    
                                 
                                 
                                    ⊤
                                 
                              
                            we obtain 
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      m
                                                   
                                                
                                                
                                                   ′
                                                   ⊤
                                                
                                             
                                             ⋅
                                             
                                                v
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          r
                                       
                                       
                                          ′
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   4
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                   t
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            3
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Hence, the contour curve w.r.t. 
                              
                                 v
                              
                            is rational, i.e.,  
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          ±
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   −
                                                   4
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   7
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ∓
                                                   17
                                                   t
                                                
                                                
                                                   17
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   2
                                                   
                                                      (
                                                      3
                                                      
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ∓
                                                      17
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   17
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   2
                                                   
                                                      (
                                                      2
                                                      
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      5
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ±
                                                      17
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   17
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ,
                                 
                              
                            and an exact rational parameterization of the corresponding canal surface can be obtained symbolically just by substituting to (4).

In this section, we will investigate the existence of rational general contour curves over reals for canal surfaces defined by the polynomial MATs. Let the spine curve 
                        
                           m
                        
                        ∈
                        
                           
                              R
                           
                           
                              3
                           
                        
                        
                           [
                           t
                           ]
                        
                      and the radius function 
                        r
                        ∈
                        R
                        
                           [
                           t
                           ]
                        
                      be given. Then the problem is to find a unit vector 
                        
                           v
                        
                        ∈
                        
                           
                              S
                           
                           
                              2
                           
                        
                      and a polynomial 
                        σ
                        ∈
                        R
                        
                           [
                           t
                           ]
                        
                      such that Eq. (20) is fulfilled. After denoting 
                        τ
                        =
                        
                           
                              
                                 ‖
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                        −
                        
                           
                              r
                           
                           
                              ′
                              2
                           
                        
                      we have 
                        
                           (33)
                           
                              τ
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             ′
                                             ⊤
                                          
                                       
                                       ⋅
                                       
                                          v
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      As the first consequence we see a necessary condition on 
                        
                           
                              
                                 (
                                 
                                    m
                                 
                                 ,
                                 r
                                 )
                              
                           
                           
                              ⊤
                           
                        
                     —namely the polynomial 
                        τ
                      must be PSD. So our goal is to find an SOS decomposition of 
                        τ
                        =
                        
                           
                              f
                           
                           
                              φ
                           
                           
                              2
                           
                        
                        +
                        
                           
                              g
                           
                           
                              φ
                           
                           
                              2
                           
                        
                      (cf. (9)) and a unit vector 
                        
                           v
                        
                      such that 
                        
                           (34)
                           
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    ′
                                    ⊤
                                 
                              
                              ⋅
                              
                                 v
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    φ
                                 
                              
                              ,
                           
                        
                      which implies 
                        σ
                        =
                        
                           
                              f
                           
                           
                              φ
                           
                        
                      and therefore the associated contour curve is rational. We will write 
                        
                           p
                        
                        =
                        
                           
                              
                                 [
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 ]
                              
                           
                           
                              ⊤
                           
                        
                      for the coordinate vector of a polynomial 
                        p
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              n
                           
                        
                        
                           
                              p
                           
                           
                              i
                           
                        
                        
                           
                              t
                           
                           
                              i
                           
                        
                     . With this notation, (34) can be rewritten as 
                        
                           (35)
                           
                              
                                 M
                              
                              ⋅
                              
                                 v
                              
                              =
                              cos
                              φ
                              
                              
                                 f
                              
                              +
                              sin
                              φ
                              
                              
                                 g
                              
                              ,
                           
                        
                      where 
                        
                           M
                        
                      is the matrix with the columns being the coordinate vectors of 
                        
                           
                              
                                 m
                              
                           
                           
                              ′
                           
                        
                      and 
                        
                           f
                        
                      and 
                        
                           g
                        
                      are the coordinate vectors of the polynomials from some particular SOS decomposition of 
                        τ
                     . This is a matrix with 
                        deg
                        
                           
                              
                                 m
                              
                           
                           
                              ′
                           
                        
                        +
                        1
                        =
                        deg
                        
                           m
                        
                      rows and 3 columns. Thus together with the parameter 
                        φ
                      and the condition 
                        
                           
                              
                                 v
                              
                           
                           
                              ⊤
                           
                        
                        ⋅
                        
                           v
                        
                        =
                        1
                      we obtain 
                        deg
                        
                           m
                        
                        +
                        1
                      equations with 4 unknowns. From this, we can see that no solution can be generally expected for 
                        deg
                        
                           m
                        
                        >
                        3
                     . In what follows the analysis of the low degree cases will be provided.

The canal surfaces with linear MATs are rotational surfaces, namely cylinders and cones. They contain rational contour curves w.r.t. all unit vectors (except the vector parallel to the axis of the cylinder or the cone) and the branches of these contour curves are straight lines.

The canal surfaces with quadratic and cubic MATs are more interesting, cf. Sections  5.1 and 5.2.

Firstly, we recall that the canal surfaces defined by quadratic MATs (i.e., their rational parameterizations of minimal degree, Bézier representations and implicit equations) were thoroughly studied in  [29]. In this section we will focus only on properties dealing with the rationality of their general contour curves.

Since all quadratic polynomial curves are parabolas and the rationality of the contour curve does not obviously depend on isometries, scaling and reparameterizations, we may assume w.l.o.g. that a real quadratic MAT is in the following canonical form
                           
                              (36)
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    ¯
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          a
                                          t
                                          ,
                                          0
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          c
                                          t
                                          +
                                          d
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                              
                           
                         where 
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           d
                           ∈
                           R
                         and 
                           a
                           ≠
                           0
                         (otherwise the spine curve is not a parabola). All the solutions of (35) are then given by 
                           
                              (37)
                              
                                 
                                    v
                                 
                                 
                                    (
                                    φ
                                    ,
                                    ψ
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          φ
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          φ
                                          ,
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cos
                                                φ
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                sin
                                                φ
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          ψ
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              f
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        , 
                           
                              g
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                         are the associated coordinate vectors of the decomposition of 
                           τ
                         and 
                           φ
                           ∈
                           
                              [
                              0
                              ,
                              2
                              π
                              )
                           
                        , 
                           ψ
                           ∈
                           R
                        . In order to find rational contour curves we need to identify all unit vectors in (37). Geometrically it is equivalent to find the intersection of the elliptic cylinder (37) with the unit sphere 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 ⊤
                              
                           
                           ⋅
                           
                              v
                           
                           =
                           1
                        . We will show that the intersection consists of two great circles, i.e., the ellipse 
                           
                              (38)
                              
                                 
                                    e
                                 
                                 
                                    (
                                    φ
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                             
                                          
                                          cos
                                          φ
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                2
                                             
                                          
                                          sin
                                          φ
                                          ,
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cos
                                                φ
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                sin
                                                φ
                                             
                                             
                                                a
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           
                         has to have the unit semi-major axis. Implicitizing ellipse (38) and substituting the following decomposition of 
                           τ
                        
                        
                           
                              (39)
                              
                                 f
                                 =
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    t
                                    −
                                    
                                       
                                          b
                                          c
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 g
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         yields 
                           
                              (40)
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 a
                                 b
                                 c
                                 x
                                 y
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                           
                         and the associated canonical form of (40) is 
                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             00
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             00
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                         are the eigenvalues of the matrix of the quadratic terms 
                           
                              (42)
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             −
                                             a
                                             b
                                             c
                                          
                                       
                                       
                                          
                                             −
                                             a
                                             b
                                             c
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 00
                              
                           
                           =
                           −
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              −
                              1
                              )
                           
                           −
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         is the absolute term in Eq. (40). Hence, we arrive at the following canonical form of the ellipse (40)
                        
                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 1
                              
                           
                         and we can immediately formulate: 
                           Theorem 5.1
                           
                              For any canal surface 
                              
                                 S
                               
                              with a quadratic MAT satisfying 
                              
                                 τ
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                       2
                                    
                                 
                                 ≥
                                 0
                              
                              , there exist two  1-parameter families of vectors 
                              
                                 
                                    v
                                 
                              
                              , corresponding to two great circles on the unit sphere, which yield rational contour curves 
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          v
                                       
                                    
                                 
                               
                              on 
                              
                                 S
                              
                              .
                           

For 
                           b
                           =
                           c
                           =
                           0
                         the canal surface becomes a pipe. In this case two great circles are coincident and all the solutions lie in the plane parallel to the plane of parabola. 
                           Proposition 5.2
                           
                              For any pipe surface 
                              
                                 S
                               
                              with a quadratic spine curve 
                              
                                 
                                    m
                                 
                               
                              and radius 
                              
                                 r
                              
                              , there exists exactly one rational contour curve, namely
                              
                                 
                                    (44)
                                    
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             
                                                v
                                             
                                          
                                          
                                             ±
                                          
                                       
                                       =
                                       
                                          m
                                       
                                       ±
                                       r
                                       
                                       
                                          n
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    n
                                 
                               
                              is a unit vector perpendicular to the plane of the parabolic MAT.
                           


                        
                           Remark 5.3
                           Considering the 1-parameter family of vectors 
                                 
                                    v
                                 
                               (cf. Theorem 5.1), which yield rational corresponding contour curves 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       ±
                                    
                                 
                              , one can require some additional extra criterion when choosing a particular 
                                 
                                    v
                                 
                              . As a natural condition can be taken for instance the minimal arc length of the obtained contour curve since the contour curves with the minimal arc lengths do not wind too much around the canal surfaces. This guarantees a better distribution of the parameter lines on the canal surface. In Fig. 4
                              , the plus branch of some arbitrary rational contour curve (top) and the plus branch of a rational contour curve with the minimal arc length (bottom) on a given canal surface are shown.

We have already answered the question which unit vectors yield rational contour curves on a canal surface given by a quadratic MAT. In addition, another interesting question is which unit vectors give at least real contour curves (regardless of their rationality), i.e., for which 
                           
                              v
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         the following condition is satisfied
                           
                              (45)
                              
                                 ρ
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                                ⊤
                                             
                                          
                                          ⋅
                                          
                                             v
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                       2
                                    
                                 
                                 ≥
                                 0
                                 .
                              
                           
                         Using canonical form (36) of a quadratic MAT and denoting 
                           
                              v
                           
                           =
                           
                              
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        , we arrive at 
                           
                              (46)
                              
                                 ρ
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (47)
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    ;
                                 
                              
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    −
                                    2
                                    
                                       (
                                       a
                                       x
                                       y
                                       +
                                       b
                                       c
                                       )
                                    
                                    ;
                                 
                              
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                         The necessary and the sufficient conditions of non-negativity of the quadratic polynomial 
                           ρ
                         are the positivity of the coefficient of the quadratic term of 
                           ρ
                        , i.e., 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                           >
                           0
                         and the non-positivity of the discriminant of 
                           ρ
                        , i.e.,  
                           
                              (48)
                              
                                 D
                                 =
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 2
                                 a
                                 b
                                 c
                                 x
                                 y
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 −
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 0
                                 .
                              
                           
                         Hence the boundary curves enclosing the region on the unit sphere corresponding to the vectors giving the real contour curves are defined as 
                           
                              (49)
                              
                                 D
                                 =
                                 0
                                 
                                 and
                                 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         which are exactly the curves on 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         corresponding to the vectors giving the rational contour curves, see (40). Then by parameterizing the ellipse 
                           D
                           =
                           0
                         and substituting this parameterization to 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                         (only its 
                           x
                        -coordinate is sufficient) we obtain the inequality of the form 
                           
                              (50)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                    
                                 
                                 >
                                 0
                                 ,
                              
                           
                         where 
                           p
                           
                              (
                              s
                              )
                           
                           ,
                           q
                           
                              (
                              s
                              )
                           
                         are some polynomials in 
                           s
                        . This condition is always satisfied since the positivity of 
                           1
                           −
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                         follows from condition (3) and it can be shown that for 
                           1
                           −
                           
                              
                                 b
                              
                              
                                 2
                              
                           
                         being positive 
                           p
                         (and thus also 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                        ) is never zero. Hence the condition 
                           
                              
                                 ρ
                              
                              
                                 2
                              
                           
                           >
                           0
                         is satisfied for all vectors satisfying the condition 
                           D
                           ≤
                           0
                        . 
                           Theorem 5.4
                           
                              For any canal surface 
                              
                                 S
                               
                              with a quadratic MAT satisfying 
                              
                                 τ
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                       2
                                    
                                 
                                 ≥
                                 0
                              
                              , the great circles on the unit sphere 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               
                              corresponding to the vectors giving the rational contour curves delimit the region on 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               
                              corresponding to the vectors giving the real contour curves.
                           


                        
                           Example 5.5
                           Let us consider the canal surface 
                                 S
                               defined by the quadratic MAT, where 
                                 
                                    (51)
                                    
                                       
                                          m
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                t
                                                ,
                                                0
                                                )
                                             
                                          
                                          
                                             ⊤
                                          
                                       
                                       
                                       and
                                       
                                       r
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       1
                                       .
                                    
                                 
                               The canal surface fulfills non-degenerative condition (3), i.e., 
                                 τ
                               is PSD, and hence it contains two 1-parameter families of real rational contour curves corresponding to two great circles on the unit sphere, see Fig. 5
                               (left). These great circles are simultaneously the boundary curves delimiting the region on 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               corresponding to the vectors giving the real contour curves—i.e., the parts of the sphere lying inside the cylinder. For the pipe surface defined by 
                                 
                                    m
                                 
                               from (51) and 
                                 r
                                 =
                                 
                                    const.
                                 
                              , there exists 1-parameter system of unit vectors corresponding to one great circle on the unit sphere all giving one rational contour curve, see Fig. 5 (right) and of course all vectors from 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               give real contour curves.

For a spatial cubic spine curve (we omit the planar case), the matrix 
                           
                              M
                           
                         is 3×3 and regular. Hence, the solution of (35) has the form 
                           
                              (52)
                              
                                 
                                    v
                                 
                                 =
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          g
                                       
                                    
                                    
                                       φ
                                    
                                 
                                 .
                              
                           
                         Moreover, as 
                           
                              v
                           
                         is a unit vector we obtain 
                           
                              (53)
                              
                                 
                                    
                                       
                                          g
                                       
                                    
                                    
                                       φ
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          −
                                          ⊤
                                       
                                    
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       
                                          g
                                       
                                    
                                    
                                       φ
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                         The matrix 
                           
                              G
                           
                           =
                           
                              
                                 
                                    M
                                 
                              
                              
                                 −
                                 ⊤
                              
                           
                           ⋅
                           
                              
                                 
                                    M
                                 
                              
                              
                                 −
                                 1
                              
                           
                         is regular and symmetric. Thus 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ⊤
                              
                           
                           ⋅
                           
                              G
                           
                           ⋅
                           
                              x
                           
                           =
                           1
                         describes a regular quadric in 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 3
                              
                           
                         with the center at the origin. So, we can transform (34) to the problem of intersection of the quadric 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ⊤
                              
                           
                           ⋅
                           
                              G
                           
                           ⋅
                           
                              x
                           
                           =
                           1
                         with a curve parameterized as 
                           
                              x
                           
                           
                              (
                              φ
                              )
                           
                           =
                           cos
                           φ
                           
                           
                              f
                           
                           +
                           sin
                           φ
                           
                           
                              g
                           
                        , which is a conic section. For the sake of simplicity we denote 
                           c
                           ≔
                           cos
                           φ
                         and 
                           s
                           ≔
                           sin
                           φ
                        . Thus, we solve the system
                           
                              (54)
                              
                                 
                                    
                                       
                                          (
                                          c
                                          
                                          
                                             f
                                          
                                          +
                                          s
                                          
                                          
                                             g
                                          
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    G
                                 
                                 ⋅
                                 
                                    (
                                    c
                                    
                                    
                                       f
                                    
                                    +
                                    s
                                    
                                    
                                       g
                                    
                                    )
                                 
                                 =
                                 1
                                 ,
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         which leads to the homogeneous quadratic equation 
                           
                              (55)
                              
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ⋅
                                    
                                       G
                                    
                                    ⋅
                                    
                                       f
                                    
                                    −
                                    1
                                    )
                                 
                                 +
                                 2
                                 c
                                 s
                                 
                                    (
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ⋅
                                    
                                       G
                                    
                                    ⋅
                                    
                                       g
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             g
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    ⋅
                                    
                                       G
                                    
                                    ⋅
                                    
                                       g
                                    
                                    −
                                    1
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                         Denoting 
                           
                              (56)
                              
                                 A
                                 ≔
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    G
                                 
                                 ⋅
                                 
                                    f
                                 
                                 ,
                                 
                                 B
                                 ≔
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    G
                                 
                                 ⋅
                                 
                                    g
                                 
                                 ,
                                 
                                 C
                                 ≔
                                 
                                    
                                       
                                          g
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ⋅
                                 
                                    G
                                 
                                 ⋅
                                 
                                    g
                                 
                              
                           
                         we arrive at the following solution 
                           
                              (57)
                              
                                 c
                                 =
                                 ±
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 s
                                 =
                                 ±
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (58)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       −
                                       B
                                       ±
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                (
                                                A
                                                −
                                                1
                                                )
                                             
                                             
                                                (
                                                C
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    
                                       A
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         and 
                           
                              (59)
                              
                                 
                                    v
                                 
                                 =
                                 ±
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       
                                          f
                                       
                                       +
                                       
                                          g
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Thus we can formulate 
                           Theorem 5.6
                           
                              For a canal surface with the cubic MAT satisfying 
                              
                                 τ
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       ′
                                       2
                                    
                                 
                                 ≥
                                 0
                              
                              , there exists a vector 
                              
                                 
                                    v
                                 
                               
                              such that 
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                 
                               
                              is rational over reals iff at least for one (of two non-equivalent) decomposition of 
                              
                                 τ
                              
                              
                                 
                                    (60)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          (
                                          A
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          C
                                          −
                                          1
                                          )
                                       
                                       ≥
                                       0
                                       ,
                                    
                                 
                              
                              where 
                              
                                 A
                                 ,
                                 B
                                 ,
                                 C
                               
                              are defined in   (56)
                              .
                           

Computing the vectors ensuring rational contour curves for canal surfaces with cubic MAT leads to two quadratic equations (which correspond to two non-equivalent decompositions of 
                           τ
                        , see (14)) and, as shown above, each of them possesses four (generally complex) solutions. So we can formulate the following proposition. 
                           Proposition 5.7
                           
                              For a canal surface with the cubic MAT there exist at most  8  different real vectors ensuring the rationality of the corresponding contour curve.
                           


                        
                           Example 5.8
                           Let us consider the canal surface 
                                 S
                               given by the cubic MAT, where 
                                 
                                    (61)
                                    
                                       
                                          m
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                3
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                4
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                4
                                                t
                                                ,
                                                3
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                4
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                4
                                                t
                                                ,
                                                3
                                                t
                                                −
                                                5
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             ⊤
                                          
                                       
                                       ,
                                    
                                 
                               and 
                                 
                                    (62)
                                    
                                       r
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       3
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       5
                                       t
                                       .
                                    
                                 
                               Since condition (60) is satisfied for both non-equivalent classes of decomposition there exist 8 vectors yielding the rational contour curves on 
                                 S
                              , see Fig. 6
                               (left). For the pipe surface given by 
                                 
                                    m
                                 
                               from (61) and 
                                 r
                                 =
                               const., there exist 4 vectors ensuring the rationality of the corresponding contour curves, see Fig. 6 (right).

Now, let us focus on pipe surfaces. As in the quadratic case we can write a canonical representative of all cubically parameterized real polynomial spine curves (up to similarities and a reparameterization) in the form
                           
                              (63)
                              
                                 
                                    m
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          a
                                          t
                                          ,
                                          
                                             
                                                b
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          c
                                          t
                                          ,
                                          d
                                          t
                                          )
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                              
                           
                         where 
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           d
                           ∈
                           R
                         and 
                           b
                           ,
                           d
                           ≠
                           0
                         (otherwise the spine curve is not a spatial cubic as required at the beginning of this section). Then the discriminants of (55) are of the form 
                           
                              (64)
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            β
                                                            −
                                                            δ
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      α
                                                      −
                                                      γ
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      β
                                                      +
                                                      δ
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    ;
                                 
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            β
                                                            +
                                                            δ
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      α
                                                      −
                                                      γ
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      β
                                                      −
                                                      δ
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           α
                           ±
                           β
                           i
                           ,
                           γ
                           ±
                           δ
                           i
                           
                           
                              (
                              α
                              ,
                              γ
                              ∈
                              R
                              ,
                              β
                              ,
                              δ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                              )
                           
                         are the roots of 
                           τ
                         (for 
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           =
                           0
                        ), i.e.,  
                           
                              (65)
                              
                                 τ
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    (
                                    2
                                    a
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 b
                                 c
                                 t
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    t
                                    −
                                    α
                                    −
                                    β
                                    i
                                    )
                                 
                                 
                                    (
                                    t
                                    −
                                    α
                                    +
                                    β
                                    i
                                    )
                                 
                                 
                                    (
                                    t
                                    −
                                    γ
                                    −
                                    δ
                                    i
                                    )
                                 
                                 
                                    (
                                    t
                                    −
                                    γ
                                    +
                                    δ
                                    i
                                    )
                                 
                                 .
                              
                           
                         Hence the non-negativity of the discriminants 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         depends only on the polynomials 
                           
                              (66)
                              
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          β
                                          +
                                          δ
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          β
                                          −
                                          δ
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         respectively. Solving (65) as a system of equations for coefficients of 
                           τ
                         yields 
                           
                              
                                 
                                    a
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       −
                                       2
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    c
                                    =
                                    
                                       
                                          α
                                          
                                             (
                                             β
                                             −
                                             δ
                                             )
                                          
                                          
                                             (
                                             β
                                             +
                                             δ
                                             )
                                          
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                 
                              
                              
                                 (67)
                                 
                                    d
                                    =
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   (
                                                   4
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            β
                                                            +
                                                            δ
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            β
                                                            −
                                                            δ
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          2
                                          b
                                       
                                    
                                 
                              
                           
                         and since 
                           
                              m
                           
                         possesses real coefficients 
                           
                              (68)
                              
                                 
                                    [
                                    
                                       
                                          
                                             (
                                             β
                                             +
                                             δ
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             (
                                             β
                                             −
                                             δ
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                         has to be a non-positive polynomial. Hence 
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                         is a non-negative and 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                         a non-positive polynomial, in general. We arrive at the following conclusion: 
                           Proposition 5.9
                           
                              For any pipe surface with the cubic spine curve, there exists a real vector (at most  4  different vectors) ensuring the rationality of the corresponding contour curve.
                           

This section is devoted to presenting two simple algorithms for the computation of a blending canal surface with the polynomial MAT of degrees 2 and 3 between two prescribed canal surfaces. Such a blending surface shall smoothly join two given canal surfaces. Hence, if we consider the MAT representation of the given canal surfaces and the blending surface in 
                        
                           
                              R
                           
                           
                              3
                              ,
                              1
                           
                        
                      this problem can be transformed into the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                        /
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Hermite interpolation of data in 4-dimensional space. The designed algorithms will be consequently modified for constructing family of blends with the same silhouettes, i.e., without necessity of further SOS decompositions.

To have guaranteed the PSD property of the polynomial 
                        τ
                      associated to a quadratic or cubic MAT of the constructed blending canal surface, which is a necessary condition for using SOS decompositions, we will assume in what follows that the given Hermite data 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                           ;
                           
                              
                                 
                                    t
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 2
                              
                           
                           }
                        
                      span a hyperplane 
                        ζ
                        =
                        
                           〈
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ;
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 2
                              
                           
                           〉
                        
                      such that the angle between this hyperplane 
                        ζ
                      and the coordinate hyperplane 
                        r
                        =
                        0
                      is less than or equal to 
                        π
                        /
                        4
                     . Then the angle between all lines in 
                        ζ
                     , including the tangents of the constructed MAT, and the hyperplane 
                        r
                        =
                        0
                      is also less than or equal to 
                        π
                        /
                        4
                     , which implies condition (3). These input data are called admissible data. To decide if the input Hermite data 
                        
                           {
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                           ;
                           
                              
                                 
                                    t
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 2
                              
                           
                           }
                        
                      are admissible it is enough to consider the normal vector 
                        
                           
                              
                                 n
                              
                           
                           
                              ζ
                           
                        
                      of the hyperplane 
                        ζ
                      which must be non-space-like, i.e., it must hold
                        
                           (69)
                           
                              
                                 〈
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ζ
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ζ
                                    
                                 
                                 〉
                              
                              ≤
                              0
                              ,
                              
                              where  
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    ζ
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ×
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     
                  


                     
                        Remark 6.1
                        Quadratic MATs (i.e., parabolas) are planar and cubic MATs are lying in 3D space. Hence the requirement that the given Hermite data are admissible (in our sense) guarantees that the constructed interpolating parabolas/cubics (contained in 
                              ζ
                           ) satisfy the PSD property. Of course, working only with the admissible data is a condition which is satisfactory but not necessary. However, our tests showed that in the majority of practical situations given data are of this type.

In Section  5.1 we showed that for a quadratic MAT (satisfying the PSD property of the polynomial 
                           τ
                        ) there always exist two 1-parameter families of vectors yielding the rational contour curves. Hence we design a method for constructing a blending canal surface having quadratic MAT between two other canal surfaces. Since parabolas can interpolate only planar data we have to use quadratic biarcs
                           1
                        
                        
                           1
                           In this paper, the notion biarc is not reserved only for circular biarcs but we consider it as a shape composed of two arcs of any curve, in our case of two parabolic arcs, with an identical tangent vector at the connecting point.
                         which can interpolate spatial 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         data. In particular, for the points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                         and the tangent vectors 
                           
                              
                                 
                                    t
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    t
                                 
                              
                              
                                 2
                              
                           
                         at these points (
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       t
                                    
                                 
                                 
                                    2
                                 
                              
                              }
                           
                         are admissible data), we construct two Bézier quadratic curves (parabolas)
                           
                              (70)
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                       
                                       ¯
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             μ
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    t
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       μ
                                       ]
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       ¯
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                             −
                                             μ
                                          
                                          
                                             1
                                             −
                                             μ
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    t
                                    ∈
                                    
                                       [
                                       μ
                                       ,
                                       1
                                       ]
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    a
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           0
                           ,
                           1
                           ,
                           2
                         are the control points and 
                           
                              (71)
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                    
                                    
                                       n
                                       −
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                         are the Bernstein basis polynomials. To interpolate the input data the conditions 
                           
                              
                                 
                                    a
                                 
                              
                              ¯
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                    
                                    ¯
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    t
                                 
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                              
                              ¯
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                    
                                    ¯
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              1
                              )
                           
                           =
                           
                              
                                 
                                    t
                                 
                              
                              
                                 2
                              
                           
                         must be satisfied. Hence we arrive at 
                           
                              (72)
                              
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       1
                                       −
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         In addition, to guarantee the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity at the connecting point (
                           
                              
                                 
                                    a
                                 
                              
                              ¯
                           
                           
                              (
                              μ
                              )
                           
                           =
                           
                              
                                 
                                    b
                                 
                              
                              ¯
                           
                           
                              (
                              μ
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                    
                                    ¯
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              μ
                              )
                           
                           =
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                    
                                    ¯
                                 
                              
                              
                                 ′
                              
                           
                           
                              (
                              μ
                              )
                           
                        ) we have 
                           
                              (73)
                              
                                 
                                    
                                       
                                          a
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    μ
                                    )
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 μ
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                       
                                          (
                                          1
                                          −
                                          μ
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             t
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Hence, we can formulate Algorithm 1.


                        
                           
                              
                           
                        
                     


                        
                           Example 6.2
                           Let us consider two canal surfaces given by the following MATs: 
                                 
                                    (74)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   ¯
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   (
                                                   t
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   3
                                                   ,
                                                   −
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   1
                                                   /
                                                   4
                                                   
                                                      (
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          
                                             [
                                             1
                                             /
                                             3
                                             ,
                                             1
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   ¯
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   3
                                                   t
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   −
                                                   3
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             1
                                             /
                                             2
                                             ]
                                          
                                          .
                                       
                                    
                                 
                               We interpolate the admissible Hermite 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               data 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                               in 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                       ,
                                       1
                                    
                                 
                               by a quadratic biarc 
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                               and for each 
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       i
                                    
                                 
                               we compute the vector 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       i
                                    
                                 
                               ensuring the rationality of the corresponding contour curve 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       i
                                    
                                 
                              . Rotating the points of 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       i
                                    
                                 
                               around the tangents of 
                                 
                                    
                                       
                                          h
                                       
                                    
                                    
                                       i
                                    
                                 
                               yields a piecewise PN parameterization of the blending surface (composed of two parts) between the given canal surfaces, see Fig. 7
                              .

In Section  5.2, it was shown that for a real canal surface defined by the cubic MAT the rational contour curve exists if condition (60) is fulfilled. Hence in such cases we can use canal surfaces with cubic MAT for the blending process, see Algorithm 2.


                        
                           
                              
                           
                        
                     


                        
                           Remark 6.3
                           If condition (60) is not fulfilled (step 3 of Algorithm 2), then the constructed canal surface does not have a rational general contour curve and the contour method cannot be used. Of course, Algorithm 1 or the technique from  [19] can be still applied in this case. Nevertheless, our experiments show that for the majority of admissible data condition (60) is satisfied.


                        
                           Example 6.4
                           We construct a blending canal surface with a cubic MAT between two non-rational canal surfaces defined as 
                                 
                                    (75)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   ¯
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   (
                                                   sin
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   1
                                                   ,
                                                   cos
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   −
                                                   3
                                                   ,
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         t
                                                         −
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          
                                             [
                                             1
                                             /
                                             2
                                             ,
                                             1
                                             ]
                                          
                                          ;
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   ¯
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   (
                                                   tan
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                   −
                                                   4
                                                   t
                                                   ,
                                                   sin
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   1
                                                   ,
                                                   
                                                      
                                                         3
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          ,
                                          
                                          t
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             1
                                             /
                                             3
                                             ]
                                          
                                          .
                                       
                                    
                                 
                               Thus we compute Ferguson’s cubic 
                                 
                                    
                                       
                                          h
                                       
                                    
                                    ¯
                                 
                               matching the admissible Hermite 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               data 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              , 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                          
                                          ¯
                                       
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              . Since condition (60) is fulfilled we can compute the rational contour curve 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       ±
                                    
                                 
                               w.r.t. a suitable vector 
                                 
                                    v
                                 
                              . Finally, by rotating the points of e.g.  
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       +
                                    
                                 
                               around the tangents of 
                                 
                                    h
                                 
                               we arrive at the PN parameterization of the blending surface, see Fig. 8
                              .

In this subsection we will deal with the problem of constructing a blending surface between two given canal surfaces which satisfies a certain constraint, in particular it is required that the constructed blend shall bypass some obstacle(s). We will see an advantage of the contour method which allows us to generate at once a whole family of rational canal surfaces having the same projection of the contour curve (the silhouette) w.r.t. some vector 
                           
                              v
                           
                        , see Fig. 1.

Firstly, we construct a classical blending surface, see Sections  6.1 and 6.2. For instance, we use Algorithm 1 and obtain a blending canal surface that is described by a quadratic medial axis transform 
                           
                              
                                 
                                    m
                                 
                              
                              ¯
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       m
                                    
                                    ,
                                    r
                                    )
                                 
                              
                              
                                 ⊤
                              
                           
                        —thus the rationality of its contour curve 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 
                                    v
                                 
                              
                           
                         w.r.t. the vector 
                           
                              v
                           
                         is generally guaranteed. Then we construct a new spine curve and a new contour curve in the form 
                           
                              (76)
                              
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    m
                                 
                                 +
                                 
                                    v
                                 
                                 f
                                 ,
                                 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                 
                                 +
                                 
                                    v
                                 
                                 f
                                 ,
                              
                           
                         obtained from the original spine curve 
                           
                              m
                           
                         and the original contour curve 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 
                                    v
                                 
                              
                           
                         using some suitable rational distance function 
                        
                           f
                         continuous on 
                           
                              (
                              0
                              ,
                              1
                              )
                           
                         and satisfying the conditions 
                           
                              (77)
                              
                                 f
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 f
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                         The distance function 
                           f
                         enables to modify the blending canal surface in the 
                           
                              v
                           
                        -direction and thus to satisfy the constraints. We emphasize that the original and also the new canal surfaces possess the same projection w.r.t. the direction 
                           
                              v
                           
                        , both have the contour curve being rational w.r.t. the direction 
                           
                              v
                           
                        , and both are blending the given canal surfaces.

The natural question reads how to choose the aforementioned distance function 
                           f
                        . A suitable non-zero function of the lowest degree satisfying (77) and one extra-condition 
                           f
                           
                              (
                              μ
                              )
                           
                           =
                           ξ
                         can be e.g. the following function of degree 4 
                           
                              (78)
                              
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       ξ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                μ
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          t
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         In what follows we will use a different function composed of the two parts which is of degree 3 only. Moreover, it is ensured that 
                           
                              [
                              μ
                              ,
                              ξ
                              ]
                           
                         is an extreme of 
                           f
                        , see Fig. 9
                        , 
                           
                              (79)
                              
                                 f
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                3
                                                μ
                                                −
                                                2
                                                t
                                                )
                                             
                                             ,
                                          
                                          
                                             t
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                μ
                                                ]
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            μ
                                                            )
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                2
                                                t
                                                −
                                                3
                                                μ
                                                +
                                                1
                                                )
                                             
                                             ,
                                          
                                          
                                             t
                                             ∈
                                             
                                                [
                                                μ
                                                ,
                                                1
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Remark 6.5
                           For the modification of the adaptive blends presented in Fig. 1 we have used the distance functions 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                               whose graphs are shown in Fig. 10
                              .


                        
                           Example 6.6
                           A rational blending canal surface between two given canal surfaces was computed by the designed contour method, see Fig. 11
                               (left). Hence, its spine curve 
                                 
                                    m
                                 
                              , the radius function 
                                 r
                               and the rational contour curve 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                 
                               are known. Now, the task is to modify this blending surface such that it bypasses a sphere which is given by its center 
                                 
                                    x
                                 
                               and the radius  
                                 R
                              .

We construct a new blending surface (bypassing the given sphere) with the same silhouette, see Fig. 11 (middle, right). This can be simply done by computing a new spine curve 
                                 
                                    
                                       
                                          m
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               and the corresponding contour curve 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       
                                          v
                                       
                                    
                                    
                                       ∗
                                    
                                 
                               according to (76), where the function 
                                 f
                               is chosen as in (79). A right choice of the values 
                                 μ
                               and 
                                 ξ
                               shall guarantee that the new blending surface does not intersect the given sphere—in particular it must hold for all 
                                 t
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 
                                    (80)
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   m
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             x
                                          
                                          ‖
                                       
                                       >
                                       r
                                       
                                          (
                                          t
                                          )
                                       
                                       +
                                       R
                                       .
                                    
                                 
                              
                           


                        
                           Remark 6.7
                           Let us note that it is not guaranteed in general that the constructed blending canal surface (between two given canal surfaces) avoids the prescribed obstacle (e.g. when the obstacle is too large or too close to the given canal surfaces). The reason is that the freedom in modifying the shape of the canal surfaces is quite restricted since these are the envelopes of one parameter families of spheres. Moreover, we can modify them (for our blending purposes) only in some directions (guaranteeing rational contour curves). For these situations e.g. the ringed surfaces are more convenient, cf.  [30]. However, when it is possible it is better to use canal surfaces (for the blending purposes) since these blends are of more natural shapes.


                        
                           Example 6.8
                           In this example we consider the problem of constructing two different blending surfaces between two pairs of given canal surfaces such that the constructed blends bypass each other, i.e., they do not intersect. Using the contour method we can easily (and independently) construct the blending surfaces 
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                               and then we modify them suitably (to ensure that they do not intersect), see Fig. 12
                              . The non-intersection of the constructed canal surfaces can be verified e.g. by the methods from  [31].


                        
                           Remark 6.9
                           Let us discuss one detail of the above presented approach. When using the quadratic-biarc-method for the computation of the blend avoiding a given obstacle we have to, in fact, compute rational parameterizations of two canal surfaces (since the blend is composed of the two parts). Hence for each part we have to find a vector giving the rational contour curve. Nevertheless, when modifying the double-blend to bypass the given obstacle it must be satisfied that the both parts possess the rational contour curve with respect to the same direction. However, this can be always done since for each canal surface with the quadratic MAT there exist two one-parameter families of vectors corresponding to the two great circles on the unit sphere giving the rational contour curves. And the great circles always intersect in the real points.

@&#CONCLUSION@&#

In this paper, we studied a condition guaranteeing the rationality of general contour curves on canal surfaces. These curves can be used for the computation of PN parameterizations of (some distinguished) canal surfaces. Special cases (quadratic and cubic MATs) were investigated and used for the formulation of the two simple algorithms for a construction of PN blends between two canal surfaces. A main advantage of the designed blending technique is its simplicity and also a possibility to choose a suitable blend satisfying certain constrains as e.g. avoiding obstacles, bypassing other objects. When compared to other similar methods our approach requires only one SOS decomposition for the whole family of rational canal surfaces sharing the same silhouette. Application of general contour curves for computing approximate parameterizations of implicitly given canal surfaces was also mentioned.

@&#ACKNOWLEDGMENTS@&#

The work in this paper was supported by the European Regional Development Fund, project “NTIS—New Technologies for the Information Society”, European Centre of Excellence, CZ.1.05/1.1.00/02.0090. The third author was supported by the project NEXLIZ, CZ.1.07/2.3.00/30.0038, which is co-financed by the European Social Fund and the state budget of the Czech Republic. We thank all referees for their valuable comments which helped us to improve the paper.

@&#REFERENCES@&#

