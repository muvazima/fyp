@&#MAIN-TITLE@&#A comprehensive study of three dimensional tolerance analysis methods

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introduce four major 3D tolerance analysis models briefly.


                        
                        
                           
                           Make a comprehensive comparison and discussion between them.


                        
                        
                           
                           Expound the connotation of 3D tolerance analysis.


                        
                        
                           
                           Present a perspective overview of the future research about 3D tolerance analysis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

3D tolerance analysis

T-Map

Matrix

Unified Jacobian–Torsor

Direct linearization method

Comparison

@&#ABSTRACT@&#


               
               
                  Three dimensional (3D) tolerance analysis is an innovative method which represents and transfers tolerance in 3D space. The advantage of 3D method is taking both dimensional and geometric tolerances into consideration, compared with traditional 1/2D tolerance methods considering dimensional tolerances only. This paper reviews four major methods of 3D tolerance analysis and compares them based on the literature published over the last three decades or so. The methods studied are Tolerance-Map (T-Map), matrix model, unified Jacobian–Torsor model and direct linearization method (DLM). Each of them has its advantages and disadvantages. The T-Map method can model all of tolerances and their interaction while the mathematic theory and operation may be challenging for users. The matrix model based on the homogeneous matrix which is classical and concise has been the foundation of some successful computer aided tolerancing software (CATs), but the solution of constraint relations composed of inequalities is complicated. The unified Jacobian–Torsor model combines the advantages of the torsor model which is suitable for tolerance representation and the Jacobian matrix which is suitable for tolerance propagation. It is computationally efficient, but the constraint relations between components of torsor need to be considered to improve its accuracy and validity. The DLM is based on the first order Taylor’s series expansion of vector-loop-based assembly models which use vectors to represent either component dimensions or assembly dimensions. Geometric tolerances are operated as dimensional tolerances in DLM, which is not fully consistent with tolerancing standards. The results of four models with respect to an example are also listed to make a comparison. Finally, a perspective overview of the future research about 3D tolerance analysis is presented.
               
            

@&#INTRODUCTION@&#

The objective of tolerance analysis is to check the feasibility and quality of assemblies or parts for a given GD&T scheme. The results of tolerance analysis include worst case variations and statistical distribution of functional requirement, acceptance rates, contributors and their percent contributions, and the sensitivity coefficients with respect to each contributor. Tolerance analysis is an essential part for mechanical design and manufacturing because it affects not only the performance of products but also the cost.

Tolerance analysis, including tolerance representation and tolerance propagation (tolerance transfer), can be classified into many categories based on the analysis objective and analysis approach, as shown in Fig. 1
                     . According to dimensionality, there are one dimensional (1D), two dimensional (2D) and three dimensional (3D) tolerance analyses. Three approaches are applied for 1/2/3D tolerance analysis, i.e., worst case (deterministic case), statistical case and Monte Carlo simulation. Rigid and flexible tolerance analysis are two different models in the light of analysis objective. The former is surface-based and needs shape closure only, such as engines’ tolerance analysis; the latter is point-based and needs shape and force closure simultaneously, such as auto-bodies’ tolerance analysis where the finite element method (FEM) is used to take the deformation into consideration  [1–4]. The division into part level and assembly level is another classification. The stack-up effect of assembly can be described by virtue of assembly function explicitly or implicitly, depending on the assembly method and sequence, as well as the property of components  [5]. Tolerance analysis runs through the whole process of the product, including design, process planning, manufacturing, inspection, but the objective may be different in each phase. For example, the tolerance scheme, i.e., conventional (parametric) and geometric tolerance will be selected and specified, and then tolerance analysis for functional requirement will be carried out in design phase. Meanwhile, besides manual analysis, computer aided tolerancing software (CATs), such as VisVSA®, 3DCS®  and CETOL®  are applied to tolerance analysis successfully  [6–9]. To be sure, the classification of tolerance analysis will be more and more complicated with the development of mechanical design and manufacturing.

Over the last thirty years, a large amount of fundamental research efforts has been given to explore the mathematical basis for tolerance analysis. For tolerance representation, the models or concepts include variational geometry  [10–12], variational class [13,14], virtual boundary  [15,16], feasibility space  [17,18], vectorial approach  [19], virtual joints  [20], degree of freedom (DOF) [21–23], Tolerance-Map (T-Map)  [24,25], topologically and technologically related surfaces (TTRS)  [26], infinitesimal matrix  [27], matrix  [28–30], small displacement torsor (SDT)  [31,32], and proportioned assembly clearance volume (PACV)  [33,34]. Similarly, for tolerance propagation, the approaches or methods consist of the linearization method  [35], system moments  [36,37], quadrature  [38–40], reliability index  [41,42], the Taguchi method  [43,44], Monte Carlo simulations  [45,46], network of zones and datums [47], kinematic formulation  [48], the direct linearization method (DLM)  [49,50], Jacobian matrix  [51,52], state space  [53,54], and the variational method  [55]. It is worth noting that the partition of two categories mentioned above is approximate and based mainly on their strong suits, because there is no boundary between the tolerance representation and propagation for these models, such as the TTRS  [56].

As new generations of tolerancing standards, i.e., ASME Y14.5-2009  [57] and ISO 1101  [58] were released and popularized, geometric tolerances are generally accepted as industry practices. The traditional 1/2D tolerance analysis models are insufficient to meet the ever-tightening and increasingly complex requirements of tolerance analysis in various fields  [59]. More specifically, variations of a feature caused by geometric tolerances are three dimensional, which cannot be considered by 1/2D methods. Researchers and engineers need a new method that can analyze how those geometric tolerances are represented and propagated in three dimensional space urgently. It is the 3D tolerance analysis method. Let us take a combustion engine as an example, as shown in Fig. 2
                     . The translational and rotational variations of piston accumulated by geometric and dimensional tolerances of crank-link parts have a significant impact on the compression ratio. In addition, tolerances of parts affect not only the dimensional quality of assembly, but also other qualities such as frictional work  [60,61] and sealing. Finding out the mapping relationship of tolerance between parts and functional requirements and performance indexes is important to engine design. 3D tolerance analysis methods will offer a significant clue for understanding the role of every tolerance of parts in the variation stream (gray boxes in Fig. 2).

The 3D tolerance analysis is an innovative method which represents and transfers tolerance in 3D space. Geometric tolerances and dimensional tolerances, as well as the interaction between them in the tolerance zone can be taken into consideration by 3D tolerance analysis methods. Moreover, abundant results, i.e., the translational and rotational variations of target feature are obtained in these methods. Many models have been developed for 3D tolerance representation and propagation since 1990s. Portman  [27] introduces a spatial dimensional chain where the individual error is represented as an infinitesimal matrix to model the tolerance propagation. Fleming  [47] illustrates the geometric relationships by a network of zones and datums connected by arcs to which constraints are assigned. The effects of these constraints are calculated through the network between nodes. Rivest et al.  [48]propose a kinematic formulation which exploits the kinematic character of a toleranced feature relative to its datum. These three methods are preliminary explorations of 3D methods. Laperrière and Lafond  [20,51] use virtual joints for tolerance representation and the Jacobian matrix for tolerance propagation. Davidson et al.  [24] present a T-Map representing all possible variations of size, position, form, and orientation for a target feature. Desrochers and Rivière  [29] represent the variations of a feature with a displacement matrix and transfer them with a homogeneous matrix. An SDT model introduced by Clément et al.  [31] uses six small displacement vectors to represent the position and orientation of an ideal surface in relation to another ideal surface in a kinematic way. Desrochers et al.  [62] put forward a unified Jacobian–Torsor model which combines the advantages of the torsor model and the Jacobian matrix. Chase et al.  [50] introduce a DLM based on the first order Taylor’s series expansion of vector-loop-based assembly models which use vectors to represent either component dimensions or assembly dimensions. Some models mentioned above have been applied extensively by virtue of CATs.

The purpose of this work is to discuss four typical methods of 3D tolerance analysis, i.e., the T-Map model, the matrix model, the unified Jacobian–Torsor model and DLM, all of which are research hotspots recently. The TTRS theory is also introduced because it is the basis of the matrix and torsor models. Although several review papers have introduced these methods briefly  [63–70], it is the first time to put them together to make a comparison in 3D context. It should be noted that the concept of 3D here emphasizes tolerance representation and propagation in three dimensional space, other models, such as the state space model which focuses on tolerance transfer with a state space method, the variational method which pays close attention to variation propagation of fixtures with total deterministic locating (3–2–1 scheme), are not discussed because they are point-based tolerance schemes where variations caused by geometric tolerances are not three dimensional.

The rest of the paper is organized as follows: Section  2 gives an overall introduction of these 3D tolerance analysis models. Section  3 makes a comprehensive discussion and comparison between them. Finally, conclusions with a perspective overview of the future research about 3D tolerance analysis are given in Section  4.

The T-Map®  (Patent No. 6963824) model developed by Davidson et al.  [24] is a hypothetical Euclidean volume of points, the shape, size, and internal subsets of which represent all possible variations in size, position, form, and orientation of a target feature. A T-Map is a convex set resulting from a one-to-one mapping from all the variational possibilities of a feature within its tolerance zone, constructed from a basis-simplex and described with areal coordinates.

The areal coordinates use areal parameters to describe the position of a point in a reference triangle. Given three fixed points 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                        , called basis points that are chosen in Euclidean space, the position of any point 
                           σ
                         is uniquely determined by the linear equation: 
                           
                              (1)
                              
                                 σ
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                         are areal coordinates about 
                           σ
                        , and have the relation 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                           =
                           1
                        . Either one or two of these coordinates will be negative when 
                           σ
                         is chosen outside 
                           ▵
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                        .

In order to illustrate the modeling process of T-Map, here we consider a cross-section of a round bar with a size tolerance 
                           t
                         on its length, as shown in Fig. 3
                        . Fig. 3(a) shows the tolerance zone ABCD where all points of the end face must lie in, and the Cartesian coordinate system. Assuming a perfect round plane with diameter 
                           d
                         and no thickness, the possible displacement of this plane is the tolerance zone, i.e., the volume limited by the planes 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        , and the cylindrical diameter of the bar. The plane would translate along the 
                           z
                         axis and rotate around the 
                           x
                         axis freely on two dimensional occasions where the plane is always parallel to the 
                           x
                         axis. The plane 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in Fig. 3(a) represents the greatest clockwise tilt of the perfect plane in tolerance zone. After that, the two dimensional set of planes in Fig. 3(a) defined by three basis planes 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         are mapped to the areal coordinates, as shown in Fig. 3(b). Any end plane of the round bar that satisfies the size tolerance and is parallel to the 
                           x
                         axis will be represented by 
                           σ
                         expressed as Eq. (1). Especially, the points on the line-segment 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         in Fig. 1(b) represent the parallel planes that are perpendicular to the 
                           z
                         axis in Fig. 1(a) and lie between 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        . The points on the line-segment 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in Fig. 1(b) correspond to these planes in Fig. 1(a) that are parallel to the 
                           x
                         axis, pass through point 
                           B
                        , and lie in the tolerance zone between 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                        . Similarly, the points on the line-segment 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in Fig. 1(b) correspond to these planes in Fig. 1(a) that are parallel to the 
                           x
                         axis, pass through point 
                           C
                        , and lie in the tolerance zone between 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                        .

The three dimensional tolerance zone at the end of the round bar is obtained by a full sweeping operation around 
                           z
                         axis with the rectangle ABCD in Fig. 3(a). Therefore, the three dimensional T-Map is modeled by revolving the triangle in Fig. 3(b) a full turn around the line 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        , it is a right-circular dicone shown in Fig. 3(c). It should be mentioned that the areal coordinates can also be used to identify points in three dimensional space where four basis points are non-coplanar. The points 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 4
                              
                           
                         in Fig. 3(c) are selected to establish a tetrahedron of reference for three dimensional area coordinates in the T-Map. Setting 
                           ∑
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           =
                           1
                        , any end plane of the round bar that satisfies the size tolerance will be represented by the linear equation: 
                           
                              (2)
                              
                                 σ
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       4
                                    
                                 
                                 .
                              
                           
                         The transformation from T-Map in Fig. 3(c) to Cartesian coordinates in Fig. 3(a) is worth mentioning. Presuming a plane in the Cartesian coordinates, as shown in Fig. 4
                        , its position can be described by the equation 
                           p
                           x
                           +
                           q
                           y
                           +
                           r
                           z
                           +
                           s
                           =
                           0
                        . 
                           p
                           ,
                           q
                           ,
                           r
                         are the direction cosines in which 
                           r
                         is approximately equal to 1 because the rotation displacement of the plane shown in Fig. 3(a) around the 
                           z
                         axis is smaller than other two rotation displacements in the tolerance zone, and 
                           s
                         is the absolute distance from the plane to the origin of coordinates. Therefore, the planes in the tolerance zone are distinguished by the coordinates 
                           p
                           ,
                           q
                         and 
                           s
                         only. 
                           
                              
                                 q
                              
                              
                                 ′
                              
                           
                         in Fig. 3(b) is obtained by assigning dimension or length on 
                           q
                         in Fig. 3(a) because 
                           q
                         is dimensionless. The lateral dimension 
                           t
                         of 
                           
                              
                                 q
                              
                              
                                 ′
                              
                           
                         axis in Fig. 3(b) is 
                           t
                           =
                           d
                           
                              (
                              t
                              /
                              d
                              )
                           
                           =
                           d
                           ⋅
                           tan
                           
                              (
                              α
                              )
                           
                           =
                           d
                           q
                           =
                           
                              
                                 q
                              
                              
                                 ′
                              
                           
                        . 
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                         is obtained in the same way as 
                           
                              
                                 q
                              
                              
                                 ′
                              
                           
                        . Consequently, the transformation of any plane in the tolerance zone of Fig. 3(a) from areal coordinates to Cartesian coordinates is: 
                           
                              (3)
                              
                                 
                                    [
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             q
                                          
                                       
                                       
                                          
                                             r
                                          
                                       
                                       
                                          
                                             s
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             t
                                             /
                                             d
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             t
                                             /
                                             d
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             t
                                             /
                                             2
                                          
                                          
                                             t
                                             /
                                             2
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

It should be stressed that a T-Map for a single part is always convex. This property allows the usage of fundamental principles of convex sets, such as Minkowski sums and differences.

We continue to use the round bar shown in Fig. 3 as an objective to illustrate the modeling process of form and orientation tolerance for T-Map, but now a flatness tolerance 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         and a parallelism tolerance 
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                         which is relative to a datum plane (another end of bar) are specified besides the size tolerance 
                           t
                        . According to the tolerancing standards, the flatness tolerance zone is defined by two parallel planes with the distance 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                        . Its position and orientation are not constrained within the size tolerance zone. The internal triangular sub-set drawn with a dashed line in Fig. 5
                        (a) represents the flatness tolerance while the hatched triangle corresponds to positions that the flatness tolerance zone can occupy. The Minkowski sum of the sub-set of the dashed triangle and the hatched triangle is the tolerance 
                           t
                        . Similarly, the parallelism tolerance zone is defined by two parallel planes which are parallel to planes 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         with the distance 
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        , represented by the dashed triangle in Fig. 5(b). Because the parallelism tolerance zone can only translate up or down within the tolerance zone 
                           t
                        , the Minkowski sum of sub-set of dashed triangle and its translational zone shown in Fig. 5(b) is a truncated map along the 
                           
                              
                                 q
                              
                              
                                 ′
                              
                           
                         axis.

In order to illustrate the tolerance propagation of T-Map, a simple assembly composed of two parts is shown in Fig. 6
                         as an example. Part 1 is a round bar. Part 2 consists of two round bars separated by an offset 
                           b
                        . They are assembled end to end coaxially. The functional surface is the upper face of the bar with diameter 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         in part 2. The dimensions and tolerances of assembly can be seen in Fig. 6. The coordinate frames are similar to Fig. 3.

The variations of orientation in the tolerance zone of part 1 are amplified and cause positional variations of the functional surface because of the offset 
                           b
                        . The accumulation T-Map depends on the offset 
                           b
                         and the diameters 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         since functional requirements for the target face in the assembly control the assignment of tolerances to the individual parts. Here we only consider the condition where 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           >
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        . The T-Maps of part 2 and functional requirements in which the aspect ratios are unity are selected to be constructed on the basis tetrahedron 
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                           
                              
                                 σ
                              
                              
                                 4
                              
                           
                         in Fig. 3(c). When 
                           b
                           =
                           0
                        , the half-section of the accumulation (solid line) and functional requirement (dashed line) T-Maps are shown in Fig. 7
                        (a) in which the accumulation T-Map is inscribed in the functional T-Map in order to avoid specifying excessively tight tolerances on individual parts. 
                           
                              
                                 t
                              
                              
                                 a
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 f
                              
                           
                         which are equal to 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                         represent accumulation tolerance and functional requirement tolerance along the length direction. 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         which is equal to 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           ⋅
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           +
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                         represents orientation tolerance of functional surface, which is tighter than functional requirement.

However, it is somewhat complicated if 
                           b
                           ≠
                           0
                        . Assuming a rotational angle 
                           −
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                         in the tolerance zone of part 1, 
                           s
                         of T-Map of part 1 becomes 
                           s
                           +
                           b
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                         which results in point 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in Fig. 3(c) moves downward by the amount 
                           b
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         and the opposite point 
                           
                              
                                 σ
                              
                              
                                 7
                              
                           
                         moves upward by the same amount. That is an oblique elliptic dicone truncated by the orientation tolerance 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                        , shown by the dashed line in Fig. 7(b). When 
                           b
                           ≤
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           /
                           2
                        , the point 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in T-Map of part 1 is still within the functional T-Map, and the accumulation tolerance in the axial direction is 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        . When 
                           b
                           >
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           /
                           2
                        , the point 
                           
                              
                                 σ
                              
                              
                                 3
                              
                           
                         in T-Map of part 1 touches the line 
                           
                              
                                 σ
                              
                              
                                 1
                                 f
                              
                           
                           
                              
                                 σ
                              
                              
                                 3
                                 f
                              
                           
                        , and the accumulation tolerance along the axial direction is 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           ⋅
                           
                              (
                              
                                 (
                                 2
                                 b
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              1
                              )
                           
                           +
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                        .

Besides round bars, T-Maps have been developed for other features, such as polygonal bars  [25], axes  [71–73], angled faces  [74], point–line clusters  [75], and planar and radial clearance with a statistical way  [76–78]. T-Map can also be used for tolerance allocation or synthesis, the detailed discussion is not within the scope of this paper.

The matrix model introduced by Desrochers and Rivière  [29] uses a displacement matrix 
                           
                              D
                           
                         to describe the small displacements of a feature within the tolerance zone and the clearance between two features. Using the theory of the set of displacements by Hervé  [79], Clément et al.  [26,31,32] have proven that there are only seven elementary surface types, as shown in Table 1
                        . The combinations of surfaces are called TTRS when two surfaces belong to the same part or Pseudo-TTRS when two surfaces belong to two different parts  [80]. The reference elements are classified by the concept of minimum geometric datum element (MGDE)  [81]. Thirteen relative positioning constrains of basic components of the MGDE, i.e., point, line and plane are defined, as shown in Table 1. The concept of functional requirements is also declared in the wake of the TTRS  [82].

The 4×4 homogeneous matrix 
                           
                              D
                           
                         including a 3×3 rotational matrix and a 3×1 translational matrix is chosen here to represent the relative displacement of a feature within tolerance zone: 
                           
                              (4)
                              
                                 
                                    [
                                    
                                       
                                          
                                             C
                                             γ
                                             C
                                             β
                                          
                                          
                                             −
                                             S
                                             γ
                                             C
                                             α
                                             +
                                             C
                                             γ
                                             S
                                             β
                                             S
                                             α
                                          
                                          
                                             S
                                             γ
                                             S
                                             α
                                             +
                                             C
                                             γ
                                             S
                                             β
                                             C
                                             α
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             S
                                             γ
                                             C
                                             β
                                          
                                          
                                             C
                                             γ
                                             C
                                             α
                                             +
                                             S
                                             γ
                                             S
                                             β
                                             S
                                             α
                                          
                                          
                                             −
                                             C
                                             γ
                                             S
                                             α
                                             +
                                             S
                                             γ
                                             S
                                             β
                                             C
                                             α
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             −
                                             S
                                             β
                                          
                                          
                                             C
                                             β
                                             S
                                             α
                                          
                                          
                                             C
                                             β
                                             C
                                             α
                                          
                                          
                                             w
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           α
                           ,
                           β
                           ,
                           γ
                         are rotational displacements around the 
                           x
                           ,
                           y
                           ,
                           z
                         axes respectively; 
                           u
                           ,
                           v
                           ,
                           w
                         are translational displacements along the 
                           x
                           ,
                           y
                           ,
                           z
                         axes respectively; 
                           C
                         is the abbreviation of 
                           cos
                           
                              (
                              )
                           
                         and 
                           S
                         is 
                           sin
                           
                              (
                              )
                           
                        .

Tolerance is only meaningful in directions other than those that leave a surface invariant with respect to itself  [83], so every parameter in the matrix can be seen as a micro DOF that leaves the feature non-invariant. Let us take a planar surface shown in Fig. 8
                         as an example, the ideal plane without form tolerance and thickness can translate along the 
                           x
                         axis and rotate around the 
                           y
                         and 
                           z
                         axes in the tolerance zone. In other words, a plane has three non-invariant degrees, i.e., 
                           β
                           ,
                           γ
                         and 
                           u
                         within its tolerance zone. Another three displacements (
                           α
                           ,
                           v
                         and 
                           w
                        ) are invariant and set to zero. Therefore, Eq. (4) can be simplified for the planar non-invariant matrix 
                           
                              D
                           
                         (see Eq. (5)). Non-invariant displacement matrix of the other five surfaces can be seen in Table 1. 
                           
                              (5)
                              
                                 
                                    [
                                    
                                       
                                          
                                             C
                                             γ
                                             C
                                             β
                                          
                                          
                                             −
                                             S
                                             γ
                                          
                                          
                                             C
                                             γ
                                             S
                                             β
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             S
                                             γ
                                             C
                                             β
                                          
                                          
                                             C
                                             γ
                                          
                                          
                                             S
                                             γ
                                             S
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             −
                                             S
                                             β
                                          
                                          
                                             0
                                          
                                          
                                             C
                                             β
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

The matrix representation is completed by a set of inequalities defining the bounds of every component in the matrix. These inequalities depend on the type of surface and tolerance. If more than one tolerance is specified on the same feature, their effects are calculated through the principle of effects overlapping. Taking the four vertexes (
                           A
                           ,
                           B
                           ,
                           C
                           ,
                           D
                        ) into consideration, the bounds of the planar surface with 
                           t
                         shown in Fig. 8 can be expressed by: 
                           
                              (6)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   S
                                                   L
                                                
                                             
                                             ≤
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      (
                                                      A
                                                      ,
                                                      B
                                                      ,
                                                      C
                                                      ,
                                                      D
                                                      )
                                                   
                                                
                                             
                                             ≤
                                             
                                                
                                                   t
                                                
                                                
                                                   S
                                                   U
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             t
                                             /
                                             a
                                             ≤
                                             β
                                             ≤
                                             t
                                             /
                                             a
                                          
                                       
                                       
                                          
                                             −
                                             t
                                             /
                                             b
                                             ≤
                                             γ
                                             ≤
                                             t
                                             /
                                             b
                                          
                                       
                                    
                                    }
                                 
                                 
                                 with  
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 D
                                 ×
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   C
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 C
                              
                              
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 ,
                                 D
                              
                           
                         are coordinates for points 
                           A
                           ,
                           B
                           ,
                           C
                        , and 
                           D
                        .

Two types of datum reference frame (DRF) need to be identified for tolerance transfer in the matrix model when the assembly graph is created, i.e., global DRF (
                           R
                        ) which is the evaluation reference of the functional feature and local DRF (
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        ) of each part feature. The homogeneous matrix 
                           
                              P
                           
                         which depends only on the nominal geometry represents the transformation of the 
                           R
                         to the 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        . Given two points in 
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                        , the theoretical point 
                           M
                         and the same point 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         after a displacement in the tolerance zone, 
                           
                              [
                              
                                 
                                    
                                       MM
                                    
                                 
                                 
                                    ′
                                 
                              
                              ]
                           
                         represents the total displacement of the 
                           M
                         because of matrix 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        , which can be expressed by: 
                           
                              (7)
                              
                                 
                                    
                                       
                                          [
                                          M
                                          
                                             
                                                M
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       R
                                       →
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          [
                                          M
                                          
                                             
                                                M
                                             
                                             
                                                ′
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       R
                                       →
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ×
                                 
                                    (
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             [
                                             M
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       R
                                       →
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ×
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    I
                                    )
                                 
                                 
                                    
                                       ×
                                       
                                          [
                                          M
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The equation above gives the range of displacements of the 
                           i
                        th feature in the global DRF that is allowed by the tolerance zone. More points are necessary to specify the constraints that keep the feature inside the bounds of the tolerance zone. Taking the planar surface shown in Fig. 8 as an example, the additional constraints of points 
                           A
                           ,
                           B
                           ,
                           C
                         and 
                           D
                         are: 
                           
                              (8)
                              
                                 
                                    
                                       t
                                    
                                    
                                       S
                                       L
                                    
                                 
                                 ≤
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    I
                                    )
                                 
                                 
                                    
                                       ×
                                       
                                          [
                                          
                                             
                                                M
                                             
                                             
                                                A
                                                ,
                                                B
                                                ,
                                                C
                                                ,
                                                D
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ⋅
                                 
                                    
                                       x
                                    
                                    
                                       ⃗
                                    
                                 
                                 ≤
                                 
                                    
                                       t
                                    
                                    
                                       S
                                       U
                                    
                                 
                              
                           
                         where 
                           
                              
                                 x
                              
                              
                                 ⃗
                              
                           
                         represents the directional vector of tolerance zone.

It should be mentioned that other geometric tolerances, such as orientation tolerance, also can be modeled by Eq. (8) through the arithmetic operation of some vertex points according to the tolerancing standards. Moreover, a cylindrical clearance zone can be viewed as an equivalent concentricity tolerance in the matrix model.

For convenience, the assembly in Fig. 6 is also used to demonstrate the tolerance analysis of the matrix model, as shown in Fig. 9
                         where three local DRFs (
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        ) and one global DRF (
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                        ) are specified. The assembly graph is shown in Fig. 10
                        . The functional requirement is the displacement of point 
                           a
                         along the 
                           z
                         axis in the global DRF, which is equal to 
                           
                              
                                 z
                              
                              
                                 a
                                 /
                                 D
                                 1
                              
                           
                           +
                           
                              
                                 z
                              
                              
                                 a
                                 /
                                 D
                                 2
                              
                           
                        . Two matrices 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    2
                                 
                              
                           
                         which are similar to Eq. (5) are established for tolerance representation of the upper surface relative to the under surface of two round bars. With Eq. (7), we can obtain the two displacements of point 
                           a
                        :
                           
                              
                                 (9)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          a
                                          /
                                          D
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    b
                                    ⋅
                                    cos
                                    
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    ⋅
                                    sin
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       (
                                       cos
                                       
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       ⋅
                                       cos
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       1
                                       )
                                    
                                 
                              
                              
                                 (10)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          a
                                          /
                                          D
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                         The constraints of the components of 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 
                                    1
                                 
                              
                           
                         under the tolerance 
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                         with respect to four vertexes of part 1 are: 
                           
                              
                                 (11)
                                 
                                    −
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ≤
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋅
                                                   cos
                                                   
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ⋅
                                                   sin
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋅
                                                   cos
                                                   
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   ⋅
                                                   sin
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                /
                                                2
                                             
                                          
                                       
                                       }
                                    
                                    ≤
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 (12)
                                 
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          11
                                       
                                    
                                    ≤
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋅
                                                cos
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       }
                                    
                                    ≤
                                    
                                       
                                          t
                                       
                                       
                                          11
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The constraints of the components of 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 2
                              
                           
                         under the tolerance 
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                         with respect to four vertexes of part 2 are: 
                           
                              (13)
                              
                                 −
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⋅
                                                cos
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ⋅
                                             sin
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⋅
                                                cos
                                                
                                                   (
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                sin
                                                
                                                   (
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ⋅
                                             sin
                                             
                                                (
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                    
                                    }
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         where 
                           −
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           /
                           2
                           ≤
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           /
                           2
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           2
                           ≤
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           2
                           ,
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 β
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ≤
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ≤
                           
                              
                                 β
                              
                              
                                 2
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        .

Standard optimization algorithms, such as simplex, can be applied to solve this problem.

The statistical method of the matrix model for tolerance analysis can be found in  [30]. It is worth mentioning that some CATs based on the matrix model have been developed and applied successfully, such as CATIA.3D FDT®   [6] and FROOM  [68,69].

The unified Jacobian–Torsor model introduced by Desrochers et al.  [62] combines the advantages of the torsor model which is suitable for tolerance representation and the Jacobian matrix which is suitable for tolerance propagation. Tolerance analysis of this model is in a kinematic way because of the concept of torsor which is also on the basis of TTRS.

The torsor, also known as small displacement torsor (SDT), is a small displacement screw used to represent the position and orientation of an ideal surface or its feature (axis, centerline, plane) in relation to another ideal surface with a kinematic way  [34]. As shown in Fig. 11
                        , at a given point 
                           O
                         on nominal surface 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                        , the SDT of variational surface 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         from 
                           
                              
                                 S
                              
                              
                                 0
                              
                           
                         can be expressed as: 
                           
                              (14)
                              
                                 T
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   1
                                                   /
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ε
                                                
                                                
                                                   1
                                                   /
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             α
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             w
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              
                                 ρ
                              
                              
                                 1
                                 /
                                 0
                              
                           
                         is the rotational vector around the axis including three specific vectors, i.e., 
                           α
                           ,
                           β
                         and 
                           γ
                         indicate the vectors around the axes 
                           x
                           ,
                           y
                         and 
                           z
                         in the local reference system respectively; likewise, 
                           
                              
                                 ε
                              
                              
                                 1
                                 /
                                 0
                              
                           
                         is the translational vector and 
                           u
                           ,
                           v
                           ,
                           w
                         are three specific vectors along the axes 
                           x
                           ,
                           y
                         and 
                           z
                         respectively.

The relative translation between two surfaces at any point 
                           M
                         in Euclidean space can be obtained by a linearization rule in terms of 
                           
                              
                                 ε
                              
                              
                                 1
                                 /
                                 0
                              
                           
                         and a cross product of 
                           
                              
                                 ρ
                              
                              
                                 1
                                 /
                                 0
                              
                           
                         and vector 
                           
                              
                                 O
                                 M
                              
                              
                                 ⃗
                              
                           
                        . 
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       ⃗
                                    
                                 
                                 =
                                 
                                    
                                       ε
                                    
                                    
                                       1
                                       /
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                       /
                                       0
                                    
                                 
                                 ×
                                 
                                    
                                       O
                                       M
                                    
                                    
                                       ⃗
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             w
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             γ
                                             y
                                             +
                                             β
                                             z
                                          
                                       
                                       
                                          
                                             γ
                                             x
                                             −
                                             α
                                             z
                                          
                                       
                                       
                                          
                                             −
                                             β
                                             x
                                             +
                                             α
                                             y
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

The SDT is well suited to not only 3D tolerance representation but also 3D metrology  [84,85]. It should be noted that the SDT for tolerance representation is the first order approximation of the matrix model introduced in the previous subsection  [86]. The rotation angles in Eq. (4) can be simplified by 
                           sin
                           
                              (
                              θ
                              )
                           
                           ≈
                           θ
                         and 
                           cos
                           
                              (
                              θ
                              )
                           
                           ≈
                           1
                         because the angles are very small in the tolerance zone. Then the 3×3 rotational matrix can be written as: 
                           
                              (16)
                              
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             −
                                             γ
                                          
                                          
                                             β
                                          
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                          
                                             −
                                             α
                                          
                                       
                                       
                                          
                                             −
                                             β
                                          
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

And the small displacement of any point 
                           M
                         can be obtained by: 
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       ⃗
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             w
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                          
                                             −
                                             γ
                                          
                                          
                                             β
                                          
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             1
                                          
                                          
                                             −
                                             α
                                          
                                       
                                       
                                          
                                             −
                                             β
                                          
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 ×
                                 
                                    [
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          
                                             y
                                          
                                       
                                       
                                          
                                             z
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             v
                                          
                                       
                                       
                                          
                                             w
                                          
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             γ
                                             y
                                             +
                                             β
                                             z
                                          
                                       
                                       
                                          
                                             γ
                                             x
                                             −
                                             α
                                             z
                                          
                                       
                                       
                                          
                                             −
                                             β
                                             x
                                             +
                                             α
                                             y
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

Generally, the constraints of components of SDT depend on the type of tolerance and feature. The SDT used for tolerance representation of planar and cylindrical surfaces, as well as their joints (clearance) has been studied deeply. Seven types of surface and their screws are listed in  [86]. The concept of non-invariant of the matrix model is also effective in the SDT model. 
                           α
                           ,
                           v
                         and 
                           w
                         in Eq. (14) that have no effect on tolerance analysis of the plane shown in Fig. 8 can be set to zero to reduce the scale of computational work.

Tolerance representation with SDT is concise and intuitionistic, but it is difficult for tolerance transfer  [64,65]. Therefore, Jacobian matrix is introduced into tolerance analysis.

The Jacobian method is a linear arithmetic formulation applied in series robot system, mapping the displacement or velocity of joints to end joint. Laperrière and Lafond  [20,51] bring it into tolerance analysis by introducing the concept of functional pairs expressed by a set of virtual joints.

There are two types of functional pairs in the assembly, i.e., internal pair and contact or kinematic pair. The former is composed of two functional elements (FEs) on the same part; the latter is made up of two FEs on different parts if there is a physical or potential contact between them.

The Jacobian matrix for 
                           i
                        th FE can be expressed as: 
                           
                              (18)
                              
                                 
                                    
                                       
                                          [
                                          J
                                          ]
                                       
                                    
                                    
                                       
                                          FE
                                       
                                       i
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   3
                                                   ×
                                                   3
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            P
                                                            t
                                                            i
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   3
                                                   ×
                                                   3
                                                
                                             
                                          
                                          
                                             ⋮
                                          
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   3
                                                   ×
                                                   3
                                                
                                             
                                             ⋅
                                             
                                                (
                                                
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   
                                                      3
                                                      ×
                                                      3
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               P
                                                               t
                                                               i
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   
                                                      3
                                                      ×
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ⋯
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋯
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      0
                                                      ]
                                                   
                                                
                                                
                                                   3
                                                   ×
                                                   3
                                                
                                             
                                          
                                          
                                             ⋮
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   
                                                      3
                                                      ×
                                                      3
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               P
                                                               t
                                                               i
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   
                                                      3
                                                      ×
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              [
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       0
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ]
                           
                         represents the local orientation of 
                           i
                        th frame with respect to 0th frame that is the global reference system; 
                           
                              [
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       PTi
                                    
                                 
                              
                              ]
                           
                         is a projection matrix designating the unit vectors along local axes respectively for tolerance zone tilted according to the direction of tolerance analysis; 
                           
                              [
                              
                                 
                                    
                                       W
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                 
                              
                              ]
                           
                         is a skew-symmetric matrix allowing the representation of the vector among the 
                           i
                        th and 
                           n
                        th frame (end point), defined in Eq. (19); 
                           
                              [
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       0
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                              
                              ]
                           
                           ⋅
                           
                              [
                              
                                 
                                    
                                       W
                                    
                                 
                                 
                                    
                                       i
                                    
                                 
                                 
                                    
                                       n
                                    
                                 
                              
                              ]
                           
                         reflects the leverage effect when the small rotations of FE are being multiplied by terms of the Jacobian matrix. 
                           
                              (19)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       3
                                       ×
                                       3
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             0
                                          
                                          
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             −
                                             d
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             d
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             −
                                             d
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           d
                           
                              
                                 z
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           =
                           d
                           
                              
                                 z
                              
                              
                                 n
                              
                           
                           −
                           d
                           
                              
                                 z
                              
                              
                                 i
                              
                           
                           ,
                           d
                           
                              
                                 y
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           =
                           d
                           
                              
                                 y
                              
                              
                                 n
                              
                           
                           −
                           d
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                        , 
                           d
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 n
                              
                           
                           =
                           d
                           
                              
                                 x
                              
                              
                                 n
                              
                           
                           −
                           d
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        .

The SDT model is suitable for tolerance representation while the Jacobian matrix is suitable for tolerance propagation. The unified Jacobian–Torsor model combines the advantages of both methods, the expression of which can be written as follows: 
                           
                              (20)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            α
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            γ
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            γ
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          FR
                                       
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             [
                                             J
                                             ]
                                          
                                       
                                       
                                          
                                             FE
                                          
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          
                                             [
                                             J
                                             ]
                                          
                                       
                                       
                                          
                                             FE
                                          
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        β
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     ¯
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        γ
                                                                     
                                                                     ¯
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where FR represents the functional requirement; (
                           
                              
                                 α
                              
                              ¯
                           
                           ,
                           
                              
                                 α
                              
                              ¯
                           
                        ) is the tolerance interval where 
                           α
                         must lie in, other vectors follow the same way. The interval arithmetic is incorporated into Eq. (20) to allow tolerance analysis to be performed on a “tolerance zone basis” rather than on a “point basis”.

The assembly graph of Fig. 9 with the unified Jacobian–Torsor model is shown in Fig. 12
                        , including two internal FEs and one contact FE. The target feature is the upper face of the bar with diameter 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         in part 2. All coordinate frames are in the middle of the tolerance zone or contact zone. The contact pair between part 1 and part 2 is considered as zero because there is no clearance between two contacting planes. With Eq. (20), the final expression of the unified Jacobian–Torsor formulation about the assembly in Fig. 9 is: 
                           
                              (21)
                              
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            w
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            α
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            α
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            γ
                                                         
                                                         ¯
                                                      
                                                      ,
                                                      
                                                         
                                                            γ
                                                         
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          FR
                                       
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               −
                                                               b
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               −
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               b
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  /
                                                                  2
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  /
                                                                  2
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  /
                                                                  2
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  /
                                                                  2
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  −
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        11
                                                                     
                                                                  
                                                                  /
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  0
                                                                  ,
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      FE
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         As can be seen, the orientation tolerance mainly limits the rotational displacements of the upper surface of part 1. We only focus on the value along the 
                           z
                         axis of FR in this paper. The result shows 
                           w
                         must lie in the interval of 
                           
                              [
                              −
                              
                                 (
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 /
                                 2
                                 +
                                 b
                                 
                                    
                                       t
                                    
                                    
                                       11
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 /
                                 2
                                 +
                                 b
                                 
                                    
                                       t
                                    
                                    
                                       11
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              ]
                           
                        . It should be pointed out that the 
                           b
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         of the result is the so called leverage effect caused by the small rotational displacement 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         and the offset 
                           b
                        .

The statistical method of the unified Jacobian–Torsor model where Monte Carlo simulation is applied has been developed [87–89]. Moreover, the unified Jacobian–Torsor model can also be used for redesign of assembly tolerance where the contribution of each FE can be calculated  [90], and geometrical variations management in a multi-disciplinary environment  [91].

The DLM (Direct Linearization Method) proposed by Chase et al.  [49,50] is based on the first order Taylor’s series expansion of the assembly kinematic constraint equations with respect to both the assembly variables and the manufactured variables in assembly. The assembly equations expressed by the vector-loop-based assembly models which use vectors to represent either component dimensions or assembly dimensions take three main sources of variation into account in a mechanical assembly. They are dimensional variations and geometric feature variations which are the results of the natural variations in manufacturing processes, and kinematic variations are small adjustments between mating parts that occurred at assembly due to the dimensional and geometric variations in manufacturing phrase.

It is the kinematic variations which result in implicit assembly functions. As shown in Fig. 13
                        , the kinematic variable 
                           F
                         depends on the variables 
                           θ
                           ,
                           R
                           ,
                           t
                         and 
                           H
                        , and the position of contact points 
                           a
                         and 
                           b
                         which are called kinematic joints (dashed rectangles). Kinematic joints describe motion constraints at the contact points between mating parts. There are six common joints in 2D assemblies and twelve common joints in 3D assemblies.

The vectors in a matrix form are arranged in chains or loops representing the accumulation of variations mentioned above in vector-loop-based assembly models. Firstly, ignoring the geometric tolerances, the assembly constraints with the vector-loop-based assembly models can be expressed as a concatenation of homogeneous transformation matrices: 
                           
                              (22)
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 ⋯
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 ⋯
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 ⋅
                                 
                                    
                                       R
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 H
                              
                           
                         where 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         is the rotational transformation matrix between the vectors at node 
                           i
                        ; 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         is the translational matrix of vector 
                           i
                           ;
                           
                              
                                 
                                    R
                                 
                              
                              
                                 
                                    f
                                 
                              
                           
                         is the final closure rotational transformation matrix with the global DRF; 
                           
                              H
                           
                         is the resultant matrix which is equal to the identity matrix for a closed loop, or the final gap or clearance and its orientation for an open vector loop.

Eq. (22) describes a series of rotations and translations to transform the local coordinates from vector-to-vector until it has traversed the entire vector loop and returned to the starting point. It is important to note that the rotational value of 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         is always relative to the prior vector. It is a positive angle when the rotational direction is same as the prior vector. It is a negative angle, otherwise.

Although smaller than dimensional variations, the accumulation and propagation of geometric feature variations are similar to dimensional variations. In the vector-loop-based assembly models, geometric tolerances are considered by placing at the contact point between mating surfaces with zero length vectors having specified variations or tolerances. In other words, the geometric tolerance associated with each joint may result in an independent translational variation or rotational variation or both. It should be pointed out that the effect of feature variations in 3D depends upon the joint types and which joint axis you are looking down. Fig. 14
                         shows the effects of flatness tolerance 
                           t
                         at the kinematic joint 
                           b
                         of Fig. 13. Fig. 14(a) represents a translational variation in the 
                           x
                           –
                           y
                         plane while Fig. 14(b) represents a rotational variation in the 
                           x
                           –
                           z
                         plane. There are three variations in all at this joint where another rotational variation around the 
                           z
                         axis is not shown, which implies the DOF of kinematic motions and the DOF of feature variations are mutually exclusive.

All the possible combinations of geometric feature tolerances with kinematic joint types in 2D space and 3D space can be seen in  [92].

Assuming a geometric feature tolerance is added to joint 
                           i
                        , assembly constraint equation (22) can be rewritten as: 
                           
                              (23)
                              
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ⋅
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 ⋯
                                 
                                    [
                                    
                                       
                                          R
                                       
                                       
                                          i
                                          g
                                       
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          g
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       ⋅
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 ⋯
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ⋅
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 ⋅
                                 
                                    
                                       R
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 H
                              
                           
                         where 
                           
                              [
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       ig
                                    
                                 
                              
                              ⋅
                              
                                 
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ig
                                    
                                 
                              
                              ]
                           
                         is the transformation matrix caused by geometric tolerance of 
                           i
                        th feature.

It is complex to solve Eqs. (22) and (23) because they are nonlinear equations. But the approximate solution with the DLM method is accurate enough for tolerance analysis. The first order Taylor’s series expansion of assembly constraint equations for a closed loop can be written as: 
                           
                              (24)
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       H
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 A
                                 ⋅
                                 
                                    Δ
                                 
                                 X
                                 +
                                 B
                                 ⋅
                                 
                                    Δ
                                 
                                 U
                                 +
                                 F
                                 ⋅
                                 
                                    Δ
                                 
                                 α
                                 =
                                 
                                    [
                                    0
                                    ]
                                 
                                 .
                              
                           
                        
                     

And for an open loop is: 
                           
                              (25)
                              
                                 
                                    
                                       
                                          Δ
                                       
                                       H
                                    
                                    
                                       O
                                    
                                 
                                 =
                                 C
                                 ⋅
                                 
                                    Δ
                                 
                                 X
                                 +
                                 D
                                 ⋅
                                 
                                    Δ
                                 
                                 U
                                 +
                                 G
                                 ⋅
                                 
                                    Δ
                                 
                                 α
                              
                           
                         where 
                           
                              Δ
                           
                           
                              
                                 
                                    H
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         is the vector of clearance variations in a closed loop and 
                           
                              Δ
                           
                           
                              
                                 
                                    H
                                 
                              
                              
                                 
                                    O
                                 
                              
                           
                         is the vector of assembly variations in an open loop; 
                           
                              Δ
                           
                           
                              X
                           
                         is the vector of variations of dimensional variables; 
                           
                              Δ
                           
                           
                              U
                           
                         is the vector of variations of assembly variables; 
                           
                              Δ
                           
                           
                              α
                           
                         is the vector of variations of geometric feature variables; 
                           
                              A
                           
                         and 
                           
                              C
                           
                         are the first order partial derivatives of the dimensional variables in the closed loop and open loop respectively; 
                           
                              B
                           
                         and 
                           
                              D
                           
                         are the first order partial derivatives of the assembly variables in the closed loop and open loop respectively; 
                           
                              F
                           
                         and 
                           
                              G
                           
                         are the first order partial derivatives of the geometric feature variables in the closed loop and open loop respectively.

Among Eqs. (24) and (25), 
                           
                              Δ
                           
                           
                              U
                           
                         is obtained by solving these two equations. For the closed loop, 
                           
                              Δ
                           
                           
                              U
                           
                         is given in Eq. (26) if 
                           
                              B
                           
                         is a full-ranked matrix and in Eq. (27) if 
                           
                              B
                           
                         is a singular matrix. 
                           
                              
                                 (26)
                                 
                                    
                                       Δ
                                    
                                    U
                                    =
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ⋅
                                    A
                                    ⋅
                                    
                                       Δ
                                    
                                    X
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ⋅
                                    F
                                    ⋅
                                    
                                       Δ
                                    
                                    α
                                 
                              
                              
                                 (27)
                                 
                                    
                                       Δ
                                    
                                    U
                                    =
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   T
                                                
                                             
                                             ⋅
                                             B
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ⋅
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    ⋅
                                    A
                                    ⋅
                                    
                                       Δ
                                    
                                    X
                                    −
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   T
                                                
                                             
                                             ⋅
                                             B
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ⋅
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    ⋅
                                    F
                                    ⋅
                                    
                                       Δ
                                    
                                    α
                                    .
                                 
                              
                           
                        
                     

From Eqs. (25) to (27), we can obtain the 
                           
                              Δ
                           
                           
                              U
                           
                         in the open loop as: 
                           
                              
                                 (28)
                                 
                                    
                                       Δ
                                    
                                    U
                                    =
                                    
                                       (
                                       C
                                       −
                                       D
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       ⋅
                                       A
                                       )
                                    
                                    ⋅
                                    
                                       Δ
                                    
                                    X
                                    +
                                    
                                       (
                                       G
                                       −
                                       D
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       ⋅
                                       F
                                       )
                                    
                                    ⋅
                                    
                                       Δ
                                    
                                    α
                                 
                              
                              
                                 (29)
                                 
                                    
                                       Δ
                                    
                                    U
                                    =
                                    
                                       (
                                       C
                                       −
                                       D
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ⋅
                                                B
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             T
                                          
                                       
                                       ⋅
                                       A
                                       )
                                    
                                    ⋅
                                    
                                       Δ
                                    
                                    X
                                    +
                                    
                                       (
                                       G
                                       −
                                       D
                                       ⋅
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ⋅
                                                B
                                                )
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             T
                                          
                                       
                                       ⋅
                                       F
                                       )
                                    
                                    ⋅
                                    
                                       Δ
                                    
                                    α
                                    .
                                 
                              
                           
                        
                     

Tolerance accumulation of DLM can be estimated with a worst case way and a statistical way, as shown in Eqs. (30) and (31). 
                           
                              
                                 (30)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          W
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             d
                                          
                                       
                                       |
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          d
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             α
                                          
                                       
                                       |
                                    
                                    ⋅
                                    
                                       
                                          T
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          α
                                       
                                    
                                 
                              
                              
                                 (31)
                                 
                                    
                                       
                                          T
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      |
                                                   
                                                   ⋅
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                         
                                                            α
                                                         
                                                      
                                                      |
                                                   
                                                   ⋅
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         α
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    ij
                                 
                              
                              
                                 
                                    d
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    ij
                                 
                              
                              
                                 
                                    α
                                 
                              
                           
                         are sensitivity matrices of dimensional variables and geometric variables respectively, which are the coefficients of the 
                           
                              Δ
                           
                           
                              X
                           
                         and 
                           
                              Δ
                           
                           
                              α
                           
                         in Eqs. (26)–(29); 
                           m
                         and 
                           n
                         are the number of dimensional and geometric variables respectively.

Let us continue to take the assembly shown in Fig. 9 as the example to demonstrate the computational process of DLM. That is an open loop where the assembly constraint equations are explicit because no adjustable elements exist. The geometric tolerance 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                         involves a rotational variable 
                           α
                         around the 
                           x
                         axis in part 1 which is equal to 
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                        . According to Eq. (23), the resultant vector along the 
                           z
                         axis at point 
                           a
                         is 
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                           ⋅
                           cos
                           
                              (
                              α
                              )
                           
                           +
                           b
                           ⋅
                           sin
                           
                              (
                              α
                              )
                           
                        . From Eq. (25), the stack-up variation along the 
                           z
                         axis is 
                           ±
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ⋅
                              cos
                              
                                 (
                                 α
                                 )
                              
                              )
                           
                           /
                           2
                           +
                           
                              (
                              b
                              ⋅
                              cos
                              
                                 (
                                 α
                                 )
                              
                              −
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                              sin
                              
                                 (
                                 α
                                 )
                              
                              )
                           
                           ⋅
                           α
                        .

The second order tolerance analysis (SOTA) method where the second order Taylor’s series expansion of the assembly kinematic constraint equations is taken into account by Monte Carlo simulation has been developed to enhance the accuracy of DLM  [93].

Because the derivatives of the assembly function with respect to both the assembly and manufactured variables are more readily from the vector model, the DLM is more computationally efficient over other models for tolerance analysis. Owing to the long-term research by association for the development of computer-aided tolerancing software (ADCATS), DLM has been applied on CATs successfully, such as CETOL 6 Sigma®.

So far, we have listed four 3D tolerance analysis methods particularly based on the literature published over the last three decades or so. And a simple example has been used to demonstrate the analysis process of these models. Each of them has its advantages and disadvantages. This section discusses and compares them in detail.

The T-Map based on area coordinates cannot only model all 3D variations of a feature, such as size, orientation and form, but also model completely and precisely the interactions of them. It is completely compatible with the ASME/ISO standards for geometric tolerance and suitable for tolerance synthesis. The size and shape of the accumulation map are controlled by the dimensions and shapes of target surfaces in assembly, which gives expression to the connotation of 3D tolerance analysis. However, the Minkowski operation for tolerance propagation is not straightforward and not suitable for computation by hand, and the calculation of clearance for two planar surfaces or the pin-hole assembly has been developed in 1D situation only. In other words, T-Map has not yet been fully developed. A mass of efforts is still needed to study the algorithms of sensitivities of contributors and their percent contributions, as well as the statistical arithmetic. Moreover, the T-Map for axes is four dimensional, which is difficult for illustration in 3D situation. A better method for the visualization of higher dimensional maps is needed.

The matrix model uses a displacement matrix to describe the small displacements of a feature within the tolerance zone and the clearance between two features. This model, completed by a set of inequalities defining the bounds of the tolerance zones, reproduces the measurable or non-invariant displacements associated with various types of tolerance. It is very efficient for computation and can be integrated into CAD systems easily. The statistical method for the matrix model has also been developed which brings the constraint relations between the translational displacements and rotational displacements into computation by Monte Carlo simulation. But the analysis objective and constraint objective are points, which lead to different results with respect to different points. The optimization may be difficult when lots of inequalities are obtained. In addition, it is unable to take the form tolerance into account.

The unified Jacobian–Torsor model combines the advantages of the torsor model which is suitable for tolerance representation and the Jacobian matrix which is suitable for tolerance propagation. To overcome the limitations and difficulties of point-based approaches, the interval arithmetic is brought into the model to allow tolerance analysis to be performed on a “tolerance zone basis” rather than on a “point basis”. Tolerance analysis of this model is in a kinematic way because of the concept of torsor. It is more suitable for the representation and propagation of clearance in 3D situation. The statistical method and tolerance allocation for this model have also been studied. Nevertheless, the constraint relations between the components of torsor need to be considered to improve the accuracy of results and conform to the tolerancing standards better. As with the matrix model, the unified Jacobian–Torsor model cannot deal with the form tolerance too.

The DLM is based on the first order Taylor’s series expansion of the assembly kinematic constraint equations with respect to both the assembly variables and the manufactured variables in an assembly. Three main sources of variations, i.e., dimensional variations and geometric feature variations, as well as kinematic variations, are distinguished and represented by the vector-loop-based assembly models. Although all types of tolerance can be modeled, and the results of statistical case and worst case can be calculated efficiently with the sensitivity matrix, this method heavily depends on the user’s expertise and experience to obtain correct results. More specifically, how to define the joint types and the effects of geometric variations are dependent of user’s choices. Meanwhile, the relationship between the geometric tolerance and the dimensional tolerance needs continuous optimization to coincide with the tolerancing standards better.

The difference and comparison between four models with six items are listed in Table 2
                     . The symbol ‘–’ represents unknown or unable to calculate based on the published literature. ‘
                        •
                     ’ and ‘
                        □
                     ’ represent point-based and surface-based respectively. 
                        w
                      and 
                        α
                      represent the variation of target surface along the 
                        z
                      axis and around the 
                        x
                      axis in the assembly depicted in Fig. 6 respectively.

The results of four models corresponding to the assembly shown in Fig. 6 are listed in Table 3
                      where only the condition of 
                        b
                        >
                        
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                        
                        /
                        2
                      is considered. It should be noted that the result of the matrix model is obtained by ignoring the constraint inequalities because the symbolic parameters impede the optimization. Residual gaps between 3D and 2D which is 
                        
                           
                              t
                           
                           
                              1
                           
                        
                        +
                        
                           
                              t
                           
                           
                              2
                           
                        
                      are approximated and simplified. As can be seen, the residuals reflect the property of 3D tolerance which takes the structure of assembly and the geometric tolerance into consideration. This is a significant difference of tolerance analysis between 3D and traditional 1/2D methods. The result of T-Map depends on not only the shapes of target surface but also the diameters of bars in the assembly. Because the rotational variation aroused by the orientation tolerance 
                        
                           
                              t
                           
                           
                              11
                           
                        
                      is very small, the results of the matrix model and DLM can be approximated and simplified as 
                        ±
                        
                           (
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           /
                           2
                           +
                           b
                           
                              
                                 t
                              
                              
                                 11
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           )
                        
                     , which is the result of the unified Jacobian–Torsor model.

The rotational displacement 
                        α
                      can be obtained by the T-Map model and the unified Jacobian–Torsor model because these two models are surface-based approaches. More specifically, the accumulation maps illustrated in Fig. 7 express both translational and rotational variations of functional surface. Similarly, Eq. (21) of the unified Jacobian–Torsor model includes all of translational and rotational variations of functional surface. However, the result of the matrix model is the variation of point 
                        a
                      on functional surface. The pose of a point in space is described by position rather than orientation. If another point of functional surface is selected as the target objective, the result may be different. So does the DLM. Compared with point-based approaches, the advantages of surface-based models include: (1) the results reflect not only position but also orientation of the analytic objective clearly in 3D space; (2) the variations caused by selection of different points are avoided.

@&#CONCLUSION@&#

The discussion and comparison have been given in the previous section where our subjective judgment comes into play. More details about these models, as well as the differences between them are left to the readers. Generally, each of these tolerance analysis models has its own strengths and weaknesses, and it is up to the users to make the wise choice according to the analysis objective and condition.

We would like to conclude this paper by presenting a perspective overview of the future research about 3D tolerance analysis which is considered to be challenging but promising.
                        
                           (1)
                           Working conditions of the assembly, such as deformation because of force and temperature, and variation of joint due to lubricating medium, need to be taken into account to improve the reliability. The combustion engine is a typical example, which endures high temperature and high pressure and forced liquid lubrication when it works. There is no doubt that the geometric feature and joint (clearance) are different to the static condition. Pierre et al.  [94] integrate the thermomechanical strains into the SDT model and Zhang et al.  [95] take the working condition into the unified Jacobian–Torsor model, which can be seen as the preliminary work. The interaction between the temperature and force and lubrication aggravates the difficulties of the analysis process.

The constraints between translational and rotational vectors of 3D tolerance analysis models should be optimized further in order to conform to the tolerancing standards better and enhance the accuracy, because they depend on each other in the tolerance zone. According to the envelope principle, 
                                 β
                               and 
                                 γ
                               must shrink to zero when 
                                 u
                               arrives at its limited position for a planar feature in the tolerance zone, as shown in Fig. 8. Therefore, it should be wrong to take both the limited values of translation and rotation into computation simultaneously. The unified Jacobian–Torsor model and DLM cannot deal with these constraints. Other 3D models which are not discussed in detail in this paper also need to consider the constraints.

The mathematic models of tolerance analysis, especially the tolerance propagation for form tolerance and runout tolerance which includes circular runout and total runout, still need a large deal of research. The position and orientation of form tolerance are random in a tolerance zone (see Fig. 5(a)), which means the form tolerance is not deterministic in tolerance propagation. Meanwhile, the role of form tolerance heavily depends on the user’s expertise and experience, which is illustrated in DLM. Approximately, a runout tolerance can be seen as the combination of form tolerance and positional tolerance, which is more complex than form tolerance.

The existing 3D models focus on connections in series mainly. The solution of tolerance representation and propagation for parallel connections in the assembly will greatly reduce the gap between 3D models and reality. 
                                 F
                               shown in Fig. 13 depends on the variables 
                                 θ
                                 ,
                                 R
                                 ,
                                 t
                               and 
                                 H
                              , and the transfer route which passes point 
                                 a
                               or point 
                                 b
                               or both. Most often, a series route passing one of two points is selected for tolerance propagation. However, there are two routes that participate in tolerance propagation actually. It is complicated for parallel connections because there are interactions between them.

The sensitivity and percent contribution of tolerance are very useful for tolerance optimization, especially in a statistical case. Some of 3D tolerance analysis methods, such as T-Map and the matrix model, still lack suitable algorithm to calculate them. Moreover, for a feature specified by more than one tolerance, the algorithm for separating and calculating each of them has not been presented by far.

@&#ACKNOWLEDGMENTS@&#

The work described in this paper is supported in part by grants from the National Natural Science Foundation of China (Grant Nos. 51121063, 51175340) and the National Science & Technology Pillar Program during the 12th Five-year Plan Period (Grant No. 2012BAF06B03). The authors are grateful for these financial supports.

@&#REFERENCES@&#

