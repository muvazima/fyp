@&#MAIN-TITLE@&#Camera and light calibration from reflections on a sphere

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Estimation of multiple light directions from a single image of a specular sphere with unknown radius.


                        
                        
                           
                           Closed form recovery of position and orientation of multiple cameras observing the sphere.


                        
                        
                           
                           Estimation of camera intrinsics using an iterative approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Light estimation

Camera calibration

Specular reflection

@&#ABSTRACT@&#


               
               
                  This paper introduces a novel method for recovering light directions and camera parameters using a single sphere. Traditional methods for estimating light directions using spheres either assume both the radius and center of the sphere being known precisely, or they depend on multiple calibrated views to recover these parameters. In this paper, it will be shown that light directions can be uniquely determined from specular highlights observed in a single view of a sphere without knowing or recovering the exact radius and center of the sphere. Besides, given multiple views of the sphere, it will be shown that the focal length and the relative positions and orientations of the cameras can be determined using the recovered sphere and light directions. Closed form solutions for estimation of light directions and camera poses are presented, and an optimization procedure for estimation of the focal length is introduced. Experimental results on synthetic and real data demonstrates both the accuracy and robustness of the proposed method.
               
            

@&#INTRODUCTION@&#

The recovery of light directions is crucial in many computer vision and graphics applications. For instance, light directions can be used to infer the shape of an object using shape-from-shading [1], shape-from-shadows [2], shape-from-specularities [3] or photometric stereo [4]. Augmented reality and image based rendering techniques use the precise locations of light sources to render virtual objects into a scene realistically [5]. In medical applications, light estimates are used for quantification of skin cancer and burn scars [6]. Other applications use light sources in controlled setups for gaze estimation [7] and recognition [8]. In humanities, scholars analyze light in realistic paintings to address a number of technical problems in the history of art [9].

In this paper, we describe how multiple light directions and camera parameters can be recovered from specular highlights observed on a sphere. The simultaneous calibration of both light and camera parameters from just a single calibration object results in a simple setup and an efficient solution. Neither the camera intrinsics nor the radius and location of the sphere are assumed to be known. In contrast, existing methods for estimating light directions using spheres either assume both the radii and centers of the spheres being known precisely, or depend on multiple calibrated views to recover these parameters. It will be shown in this paper that, for a given focal length, light directions can be uniquely determined from specular highlights observed in a single view of a sphere without knowing or recovering the exact radius and center of the sphere. The focal length can then be determined by an optimization procedure that employs a consistency measure on light directions estimated from images captured from at least two distinct viewpoints. It will be shown that the relative orientations and positions of the cameras can be recovered using two or more light directions estimated in each view.

Preliminary results of this research have been published in [10]. This paper further extends [10] in the following aspects:
                        
                           •
                           Internal camera parameters are not assumed to be known but estimated using an iterative optimization procedure.

Additional theoretical details for the estimation of light direction, camera pose and sphere center are presented.

The shape of specular reflection produced by a non-infinitesimal light source is studied. The error introduced by using the center of a fitted ellipse for estimation of light directions is analyzed.

New experiments on real and synthetic data are presented. In particular, an augmented reality application with a detailed error analysis, an experiment for estimating different focal lengths, and an experiment for estimating the symmetric transfer error are presented.

Throughout the paper, we make certain assumptions. Firstly, we assume that the outline of the sphere and the specular highlights can be extracted, and that these features are elliptical. The latter makes the former trivial as there exists a plethora of work dealing with robust extraction of ellipses [11–13]. Secondly, we assume that specular highlights can be matched between different views. In practice, we perform matching using temporal information. Thirdly, since it is difficult or impossible to estimate camera intrinsics from just a single image of a single sphere, we assume that the camera intrinsics remain constant for at least two consecutive frames in the image sequence.

The rest of this paper is organized as follows. Section 2 discusses previous work on light direction estimation and camera calibration. Section 3 addresses the problem of sphere reconstruction from a single image. It will be shown that with unknown radius, a one-parameter family of solutions will be obtained with all the sphere centers lying on the line joining the camera center and the true sphere center. Section 4 briefly reviews the standard technique for recovering light directions from observed highlights on a sphere with known radius and location. It then proves that any sphere from the family of solutions recovered from a single image can be used to estimate the light directions. In Section 5.1, an iterative optimization method is proposed for recovering the camera calibration matrix; and in Section 5.2, a method for recovering the relative positions and orientations of the cameras is presented. In Section 6 the shape of specular reflections on a sphere is studied. Finally, experimental results on both synthetic and real images are presented in Section 7, followed by conclusions in Section 8.

@&#LITERATURE REVIEW@&#

There exists a relative large number of works dealing with the estimation of light directions from images. In 1982, Pentland [14] proposed a maximum-likelihood method for the estimation of a single distant light source and evaluated his method against light direction estimations made by human subjects. In the context of shape from shading, an iterative algorithm that alternatively estimates the surface shape and the direction of a single source was proposed by Brooks and Horn [15]. Similarly, Ikeuchi and Sato [16] and Zheng and Chellappa [17] estimated a single distant point light source. Vogiatzis et al. [18] introduced a robust technique to accurately estimate a single light direction from a visual hull of a quasi Lambertian object.

However, multiple light sources are often present in natural environments, and the problem of estimating multiple light directions is generally more challenging. In [19], constraints derived from surface normals and image intensities at occluding boundaries were exploited to estimate multiple light directions. A unique solution for more than four light sources could not be computed from a single image under the Lambertian model. In [20], multiple light sources from a sphere of known physical size were estimated by identifying critical points (CP). CP have a maximal change of intensity and occur on a smooth surface whenever the light direction is perpendicular to the normal of the surface. Unfortunately, CP are difficult to detect due to their sensitivity to noise. Wang and Samaras [21] proposed to segment an object into light patches, where each patch is illuminated by a different set of sources. For an object with known geometry and albedo, light directions can then be determined.

The above methods analyze the shading on a Lambertian model with constant surface albedo and treat specular highlights as outliers. However, the specular reflection component of light is known to work in a very predictable manner, and it can be exploited for light estimation. Similarly, cast shadows provide rich informations of light sources [22]. In [23], cues from shading, shadow, and specular highlights were combined for the estimation of a directional light in a textured scene. Unlike existing work, a textured surface is considered. Lagger and Fua [24] recovered multiple light directions from textured objects by optimizing a standard lighting model. The algorithm of Lagger and Fua can operate in the presence of an arbitrary texture and an unknown number of light directions, but unfortunately, 3D geometry is assumed to be known. The aforementioned methods mostly require prior knowledge of the projections of a reference object with known geometry to give the relationship between surface orientations and image intensities.

Debevec utilized a mirror sphere in [25] to estimate the global illumination in real world scenes. Using such a mirror sphere might, however, change the scene illumination due to its strong reflection properties. Besides, it is challenging to extract the boundary of a highly reflective object. Instead of using a mirror sphere, Zhou and Kambhamettu [26] used a sphere which exhibited both specular and diffuse components. They proposed an iterative method to recover the location and radius of a sphere from a pair of calibrated images, and used the recovered sphere to estimate the light directions from the specular highlights on the sphere. Similar to their work, this paper considers the problem of recovering multiple distant light sources from a single sphere with unknown radius and location. Unlike [26], we do not require multiple fully calibrated views for recovering the radius and location of the sphere via an iterative method. It will be shown in this paper that light directions can be recovered directly from a scaled sphere estimated from a single view. Given multiple views of the sphere, a solution is introduced to estimate the camera parameters using the recovered sphere and light directions. Hence, both the light directions and camera parameters (intrinsic and extrinsic) can be recovered using a single sphere. It will be shown that at least two light sources are necessary to determine all the parameters of the cameras.

Camera calibration has been extensively explored in the literature [27]. The usual approach is to regard view dependent appearances such as specular highlights as outliers. However, it has long been known that specular highlights provide rich shape and pose information [28]. The literature on estimation of camera poses from specular highlights is relatively sparse. In [29] it was shown that specular flow can be used as a cue for 3D pose estimation. Specular highlights captured with a mirror sphere were matched against similar cues generated from a CAD model of an object in various poses. Recently, Agrawal and Ramalingam [30] worked with a single image of a calibration grid reflected on two or more specular spheres to determine the camera pose. The estimation was performed without knowledge of the radii and locations of the spheres; however, the camera was assumed to be internally calibrated. In [31], the specular reflection of a polygonal light source on a sphere was used to estimate the camera pose. Lagger et al. [32] demonstrated how specular highlights can be exploited for accurate registration of shiny objects. They observed that specular highlights are very sensitive to pose changes and can provide additional constraints that can be incorporated into standard pose estimation algorithms.

Instead of using specular highlights as an additional constraint for camera pose, in this work we will exploit spherical specular highlights as the exclusive source of information for both camera intrinsic and extrinsic parameters estimation.

Consider a pinhole camera viewing a sphere. Let the radius and center of the sphere be S
                     r and 
                        
                           
                              
                                 S
                              
                              
                                 c
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                      respectively, and let the camera coordinate system coincide with the world coordinate system. The sphere can be represented as a quadric surface by using a 4×4 symmetric matrix
                        
                           (1)
                           
                              S
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               c
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where I
                     3
                     =
                     diag{1,1,1} is a 3×3 identity matrix. Any 3D point X lying on S will satisfy the equation 
                        
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ∼
                                    
                                 
                              
                              
                                 T
                              
                           
                           S
                           
                              
                                 X
                              
                              
                                 ∼
                              
                           
                           =
                           0
                        
                     , where 
                        
                           
                              
                                 X
                              
                              
                                 ∼
                              
                           
                        
                      denotes the homogeneous coordinates of the point. Suppose the 3×3 calibration matrix K of the pinhole camera is known, the projection matrix for the camera can be written as
                        
                           (2)
                           
                              P
                              =
                              K
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     The image of S under P will be a conic section. This conic can be represented by a 3×3 symmetric matrix, given by [27]
                     
                        
                           (3)
                           
                              C
                              =
                              
                                 
                                    [
                                    
                                       
                                          PS
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                                 
                                    ∗
                                 
                              
                              ,
                           
                        
                     where S
                     ∗ denotes the sphere in the dual space and is given by
                        
                           (4)
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    -
                                    1
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      T
                                                   
                                                
                                                /
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                
                                                /
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      T
                                                   
                                                
                                                /
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                /
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Now, the conic image can be expressed in terms of K, S
                     c and S
                     r, by combining (4) and (2) with (3), as
                        
                           (5)
                           
                              C
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                KK
                                             
                                             
                                                T
                                             
                                          
                                          -
                                          
                                             
                                                KS
                                             
                                             
                                                c
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      KS
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ]
                                             
                                             
                                                T
                                             
                                          
                                          /
                                          
                                             
                                                S
                                             
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              .
                           
                        
                     Any 2D point x lying on C will satisfy the equation 
                        
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ∼
                                    
                                 
                              
                              
                                 T
                              
                           
                           C
                           
                              
                                 x
                              
                              
                                 ∼
                              
                           
                           =
                           0
                        
                     , where 
                        
                           
                              
                                 x
                              
                              
                                 ̃
                              
                           
                        
                      represents, again, the homogeneous coordinates of the point. The back projection of the conic image C defines a cone, which will be tangent to the sphere S and can be represented as a quadric surface using a 4×4 symmetric matrix [27]
                     
                        
                           (6)
                           
                              Q
                              =
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              CP
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      T
                                                   
                                                
                                                CK
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Note that the intersection of the cone Q with the sphere S is a circle with the plane of the circle being orthogonal to the line joining the camera center and the sphere center. Hence, Q is a right circular cone with its vertex at the camera center (the world origin) and axis passing through the sphere center S
                     c (see Fig. 1
                     ). If the radius S
                     r of the sphere is known, S
                     c can be uniquely determined along the cone axis. In the next paragraph, a closed form solution for S
                     c will first be derived under a special case (C is a circle). The method for estimating S
                     c under the general case (C is a conic) will then be discussed.

Consider the case where the sphere center lies along the positive Z-axis, and the camera calibration matrix is given by an identity matrix I
                        3. Under this configuration, the sphere center will have coordinates 
                           
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        . Note that d is also the distance between the camera center and the sphere center. The image of the sphere can be obtained using (5), and is given by
                           
                              (7)
                              
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             I
                                             -
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   c
                                                
                                                
                                                   T
                                                
                                             
                                             /
                                             
                                                
                                                   S
                                                
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Note that 
                           
                              
                                 
                                    C
                                 
                                 
                                    ¯
                                 
                              
                           
                         represents a circle with radius 
                           
                              r
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                S
                                             
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . The center of 
                           
                              
                                 
                                    C
                                 
                                 
                                    ¯
                                 
                              
                           
                         is at the origin, which is also the image of the sphere center. Given the radius r of 
                           
                              
                                 
                                    C
                                 
                                 
                                    ¯
                                 
                              
                           
                        , the distance d between the camera center and the sphere center can be recovered (see Fig. 2
                        ) as
                           
                              (8)
                              
                                 d
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       r
                                    
                                 
                                 ,
                              
                           
                        and the location of the sphere center follows.

Consider the case where the sphere center and the camera calibration matrix are given by S
                        c and K respectively. Generally, the image of the sphere will no longer be a circle centered at the origin, but a conic section C centered at an arbitrary point x
                        a. Note that x
                        a is in general not the image of S
                        c. In order to recover S
                        c from C, the effect of K is first removed by normalizing the image using K
                        −1. The conic C will be transformed to a conic 
                           
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    T
                                 
                              
                              CK
                           
                         in the normalized image. This conic can be diagonalized into
                           
                              (9)
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 
                                    
                                       MDM
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 M
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where M is an orthogonal matrix (i.e., M
                        T
                        =
                        M
                        −1) whose columns are the eigenvectors of 
                           
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                         and D is a diagonal matrix consisting of the corresponding eigenvalues. Let a
                        >0 and b
                        <0, then the matrix M
                        T defines a rotation that will transform 
                           
                              
                                 
                                    C
                                 
                                 
                                    ˆ
                                 
                              
                           
                         to the circle D with radius 
                           
                              r
                              =
                              
                                 
                                    -
                                    
                                       
                                          b
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           
                         centered at the origin. This transformation corresponds to rotating the camera about its center until its principle axis passes through the sphere center. This reduces the general case to the previously described special case, and the distance d between the camera center and the sphere center can be recovered in terms of r and S
                        r. Finally, the sphere center can be recovered as
                           
                              (10)
                              
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 M
                                 
                                    
                                       [
                                       0
                                       
                                       0
                                       
                                       d
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                                 ,
                              
                           
                        where m
                        3 is the third column of M.

Suppose the center S
                     c of a sphere with known radius S
                     r has been estimated using the method described in the previous section. It is straightforward to recover a light direction from an observed highlight on the sphere by using the properties of specular reflection (Fig. 3
                     ).

To recover the light direction, first construct a ray r from the camera center O through a pixel x corresponding to a highlight (see Fig. 4
                     )
                        
                           (11)
                           
                              r
                              =
                              O
                              +
                              t
                              V
                              ,
                           
                        
                     where 
                        
                           V
                           =
                           
                              
                                 K
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 x
                              
                              
                                 ̃
                              
                           
                        
                      is the viewing direction for the specular highlight observed at x and K is the camera calibration matrix. Next, the point X on the sphere giving rise to the highlight is obtained by determining the first intersection of the ray r with the sphere S. The unit surface normal at X can then be obtained as
                        
                           (12)
                           
                              N
                              =
                              
                                 
                                    X
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          c
                                       
                                    
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          r
                                       
                                    
                                 
                              
                              ,
                           
                        
                     and, finally, the light direction L can be recovered as
                        
                           (13)
                           
                              L
                              =
                              2
                              (
                              V
                              ·
                              N
                              )
                              N
                              -
                              V
                              .
                           
                        
                     
                  

Now suppose the radius S
                     r of the sphere is unknown. It has been shown in Section 3 that there exists a one-parameter family of solutions for the sphere center S
                     c which all lie on the straight line joining the camera center and the true sphere center. It will now be shown that the light direction recovered from an observed highlight using any of these scaled spheres will be identical. In other words, light directions can be recovered from the highlights observed in the image of a sphere without knowing its size and location.
                        Proposition 1
                        
                           Consider a ray casted from the camera center and the family of spheres with varying radius recovered from the conic image of a sphere. If this ray intersects any of these spheres, it will intersect all the spheres and the first point of intersection with each sphere will all have the same unit surface normal.
                        

Since the cone constructed from the camera center and the conic image of the sphere will be tangent to all the recovered spheres, any ray lying within this cone will intersect all these spheres, whereas any ray lying outside this cone will intersect none of them. Consider a sphere S from the family with radius S
                           r and center S
                           c. Suppose the ray intersect S at the point X with surface normal N. Consider a second sphere S′ from the family, and let its radius and center be 
                              
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                              
                           . A line being parallel to N can be constructed from 
                              
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                              
                           , and let the intersection point between this line and S′ be X′.

Consider the two triangles ▵OS
                           c
                           X and 
                              
                                 ▵
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Obviously, 
                              
                                 |
                                 
                                    
                                       XS
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 :
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                 
                                 :
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                              
                           . It follows from (8) that 
                              
                                 |
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 :
                                 |
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                 
                                 :
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Finally by construction, 
                              
                                 ∠
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                 
                                 X
                                 =
                                 ∠
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Hence ▵OS
                           c
                           X and 
                              
                                 ▵
                                 
                                    
                                       OS
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                              
                            are similar and 
                              
                                 ∠
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                 
                                 OX
                                 =
                                 ∠
                                 
                                    
                                       S
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       OX
                                    
                                    
                                       ′
                                    
                                 
                              
                           . It follows that the ray will intersect S′ at X′ at which the surface normal N′ is parallel to the surface normal N at X. Since the two spheres being considered are chosen arbitrarily, the same argument applies to all spheres in the family.□

From (13), the light direction L only depends on the vector V and the surface normal N. The following corollary therefore follows immediately from Proposition 1.
                        Corollary 1
                        
                           The light direction estimated from an observed specular highlight in an image of a sphere will be independent of the radius used in recovering the location of the sphere center.
                        

The estimation of sphere center and light direction in the previous sections requires known camera intrinsic parameters. In this section, an iterative method is proposed for recovering the camera calibration matrix K. For simplicity, the following practical assumptions are made. It is supposed that the camera has zero skew ζ
                        =0, that the pixels are square (k
                        u
                        =
                        k
                        v
                        =1) and that the principal point is at the image center (u
                        x
                        =
                        w/2,
                        u
                        y
                        =
                        h/2), where w and h are the width and height of the image respectively. As a result, we only need to solve for the unknown focal length f to determine the calibration matrix
                           
                              (14)
                              
                                 K
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         fk
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   ζ
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         fk
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                
                                                
                                                   w
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   f
                                                
                                                
                                                   h
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        To determine f from images, we suppose that the sphere is captured from at least two distinct viewpoints and that the images were taken with constant focal length under constant illumination.

Consider the case, where a camera with a particular focal length f captures a sphere. The proposed methods in Sections 3 and 4 can be applied to recover the sphere center S
                        c and light direction L. Let us now change the focal length to f′. It follows from (11) that a distinct ray will be recovered, which will intersect the sphere centered at 
                           
                              
                                 
                                    S
                                 
                                 
                                    c
                                 
                                 
                                    ′
                                 
                              
                           
                        . As a result of Eqs. (12) and (13) a distinct light direction L′ will be recovered. Since we assume light directions are fixed globally, we can employ a consistency measurement on light directions estimated from images captured from distinct viewpoints. Unfortunately, estimated light directions from different views are defined in different coordinate systems and we propose to solve this problem by measuring angles between pairs of distinct estimated light directions.

Consider, for example, two distinct unit light directions {L
                        1,1,
                        L
                        1,2} estimated in a first view and two distinct unit light directions {L
                        2,1,
                        L
                        2,2} estimated in a second view. The angle difference between the pairs can be defined as
                           
                              (16)
                              
                                 δ
                                 =
                                 |
                                 ∠
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 )
                                 -
                                 ∠
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       L
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 )
                                 |
                                 =
                                 |
                                 
                                    
                                       cos
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       cos
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       2
                                       ,
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                                 )
                                 |
                                 .
                              
                           
                        Based on this consistency measurement, the focal length f can be solved by considering all angles between light directions for all views. We propose to determine f by solving the following optimization problem
                           
                              (17)
                              
                                 
                                    
                                       minimize
                                    
                                    
                                       f
                                       >
                                       0
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          j
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          i
                                          <
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          j
                                          <
                                          
                                             
                                                j
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                j
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where L
                        
                           i,j
                         represents the jth estimated light direction in the ith view. We found that (17) can be minimized efficiently using basic optimization techniques, namely Grid Search and Powell’s Conjugate Gradient Descent method. To determine a unique focal length, we performed exhaustive Grid Search with the bounds [100,10000] and a sampling density of 500. Subsequently, we performed Powell’s Conjugate Gradient Descent method to find the local minimum nearest to the minimum obtain from the Grid Search.

Suppose two images of a sphere are captured from two distinct viewpoints. The sphere center can be recovered in each of the two camera-centered coordinate systems respectively (see Section 3). By assuming an arbitrary but fixed radius for the sphere in both views, it is possible to relate the two cameras in a common coordinate system as illustrated in Fig. 5
                        . Without loss of generality, let the sphere center in the camera-centered coordinate system of the first view be S
                        c and that of the second view be 
                           
                              
                                 
                                    S
                                 
                                 
                                    c
                                 
                                 
                                    ′
                                 
                              
                           
                         respectively. By considering a common world coordinate system centered at the sphere center, the projection matrices for the two views can be written as
                           
                              
                                 P
                                 =
                                 K
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 K
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Note that the above projection matrices are not unique. Due to the symmetry exhibited in the geometry of the sphere, an arbitrary rotation about the sphere center (i.e., the world origin) can be applied to the camera without changing the image of the sphere. This corresponds to rotating the camera around the sphere while keeping the cone constructed from the image tangent to the sphere. A rotation around the axis of the cone will also keep the image of the sphere unchanged. Hence, by choosing the first camera as a reference view, a more general form of the projection matrices for the two views is given by
                           
                              
                                 P
                                 =
                                 K
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 K
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         c
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where R is a 3×3 rotation matrix.

By assuming the light directions being fixed globally in both views, the highlights observed in the two images can be exploited to uniquely determine the relative rotation between the two cameras. Note that the location of the highlight on the sphere surface will depend on both the light direction and the viewpoint. Hence the locations of the highlights due to the same light direction will be different under two distinct viewpoints, and their projections on the two images do not provide a pair of point correspondence. Nonetheless, using the method described in Section 4, the light directions can be recovered in each of the two camera-centered coordinate systems.

Let the unit light direction in the camera-centered coordinate system of the first view be L and that of the second view be L′ respectively. Since these two directions are parallel in the common world coordinate system, the rotation matrix R relating the two cameras will bring L to L′, i.e.,
                           
                              (20)
                              
                                 RL
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                        The above equation places two independent constraints on R. Hence, observing two highlights produced by two distinct light directions in two images will provide four constraints, which are enough to determine the three parameters of R.

In practice, estimated light directions are not exact, due to the presence of noise. It may not be possible to find a rotation that perfectly maps a set of light directions {L
                        1,…,
                        L
                        m} to another set of light directions 
                           
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             m
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        . A least squares solution can be obtained instead by minimizing the sum of squared residual errors
                           
                              (21)
                              
                                 ∊
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             -
                                             
                                                
                                                   RL
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        Note that (21) attains a minimum if the sum of the dot products
                           
                              (22)
                              
                                 c
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       RL
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        attains a maximum. Readers not familiar with quaternion representation of rotations are suggested to read Appendix A. Using unit quaternion representation to represent a rotation, (22) can be rewritten as
                           
                              (23)
                              
                                 c
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                           
                         is the unit quaternion representation of the rotation matrix R, and 
                           
                              
                                 
                                    L
                                 
                                 
                                    ̇
                                 
                              
                           
                         is the quaternion representation of the light direction vector L. Since 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              )
                              ·
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    ̇
                                 
                              
                              ·
                              (
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                        , (23) can be further rewritten as
                           
                              (24)
                              
                                 u
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ·
                                 (
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 .
                              
                           
                        Using matrix representations for quaternion multiplications, (24) can be expressed as
                           
                              (25)
                              
                                 c
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 ·
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 W
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              L
                           
                         and 
                           
                              
                                 
                                    L
                                 
                                 
                                    ∼
                                 
                              
                           
                         are the orthogonal 4×4 quaternion matrices as in (A.3), and W is a 4×4 symmetric matrix given by
                           
                              (26)
                              
                                 W
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ∼
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 .
                              
                           
                        From basic eigenvalue theory, the unit quaternion which maximizes (25) is given by the eigenvector 
                           
                              
                                 
                                    e
                                 
                                 
                                    ̇
                                 
                              
                           
                         of W corresponding to the largest positive eigenvalue. A rotation matrix can then be extracted as the lower-right-hand submatrix of 
                           
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              E
                           
                        , where 
                           
                              E
                           
                         is the quaternion matrix representation of 
                           
                              
                                 
                                    e
                                 
                                 
                                    ̇
                                 
                              
                           
                        .

Finding the transformation between points measured in two different coordinate systems (also known as absolute orientation) is also studied in the field of photogrammetry, and our results are a special case of the derivations in [33].

The theoretical formulation derived in this paper takes a single point as input for the estimation of light directions and camera parameters. However, in practice a non-infinitesimal light source will produce a specular reflection covering an area on the sphere, from which a single point has to be extracted. To determine which point to select form this area, we examine the shape of a specular reflection produced by a light source of spherical shape. We first synthetically estimate the ground truth area belonging to the specular reflection that is produced from a light source of spherical shape. The boundary of this area can be obtained by considering the great circle of the spherical light source that is perpendicular to the light direction. This circle was sampled and each sample point was forward projected on the reflective sphere and finally projected to the image using the 4th degree forward projective equation given in [34]. The resulting image points were taken as the ground truth shape. In addition, we also obtained a ground truth image point for the projected center of the spherical light source that satisfies (13). Both, the ground truth point and the ground truth shape are plotted for three different light directions in Fig. 6
                     . Here, γ
                     
                        i
                      denotes the incident angle which we define as the angle between the light direction and the line that connects the camera center with the sphere center.

It can be seen in Fig. 6 that the shape of the reflection appears to be an ellipse for the first two cases. To confirm this we fitted a conic to the ground truth shape and found that the sample points are approximately but not perfectly elliptical. It can be seen that the ground truth shape is not elliptical for the large incident angle γ
                     3. Nevertheless we fit an ellipse to it and the ellipse center provides an approximation to the ground truth point. We estimated the errors ∊
                     1, ∊
                     2 and ∊
                     3 which we define as the euclidean distance (in pixel) from the ground truth point to the fitted ellipse center. Although the shape appears to become increasingly non-elliptical for larger incident angles γ, we found that for γ
                     1
                     =45°, γ
                     2
                     =90°, and γ
                     3
                     =135° the error was just ∊
                     1
                     =0.31, ∊
                     2
                     =1.10, and ∊
                     3
                     =3.06 (in pixel) respectively. We conclude that the ellipse center is a good approximation to the ground truth point.

@&#EXPERIMENTAL RESULTS@&#

The closed form solutions for recovering the sphere centers, light directions and camera rotations and the iterative method for recovering the focal length have been implemented. Experiments on both synthetic and real data were carried out and the results are presented in the following sections.

To evaluate the robustness of the proposed method, noise was added to the sphere’s silhouette as well as to the locations of two specular highlights. To add noise to the silhouette, points were first sampled and then perturbed with noise in a radial direction. A noisy conic was obtained as a conic robustly fitted to these noisy points using a direct least squares method [35]. Noise was added directly to the coordinates of the specular highlights. Experiments with noise levels ranging from 0.0 to 3.0 pixels were carried out. To obtain statistically meaningful results, 250 independent trials for each noise level were conducted and errors were estimated and averaged.


                        Fig. 7
                         plots the mean errors in estimated (a) rotation, (b) translation angle, (c) translation length and (d) light direction against the noise level. The error in rotation in Fig. 7a was obtained by decomposing the rotation matrix 
                           
                              R
                              =
                              
                                 
                                    R
                                 
                                 
                                    noisy
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    groundtruth
                                 
                              
                           
                         into an angle and axis. The angle was taken as the error. It can be seen that the error increased linearly with the noise level in all cases and that the error in translation in Fig. 7b and c is very low. This follows from the fact that translation depend only on the sphere’s outline, which has been fitted robustly to the noisy points. In contrast, noise added to the specular points have a larger impact on the error. This can be seen in Fig. 7d where light directions are estimated less accurately when noise is exclusively added to the specular points. It can be seen in Fig. 7a that the error in rotation will be reduced when more light sources are added into the scene.

The robustness of focal length estimation proposed in Section 5.1 has also been analyzed. Fig. 8
                        a plots the error in the focal length estimation using 2, 4, and 8 images. It can be seen that the error is inverse proportional to the number of views and that noise added to specular points have a larger impact on the error. Fig. 8b and c shows the shape of the cost function in (17) for noisy specularities and noisy conic. Even for larger noise levels, a minimum can still be located near the ground truth.

In addition to the experiments above, where noise was added individually to the conic or the specularities, we performed an additional experiment with noise added simultaneously to both conic and specularities. In general, we observed that errors in the estimated camera parameters and light directions were slightly larger than the sum of the individual errors shown in Figs. 7 and 8.

In this section, we present three experimental results on real images. We are not aware of other methods that estimate light and camera parameters simultaneously. Therefore, we evaluate the quality of the estimated light and camera parameters using a planar calibration pattern, 3D reconstruction and augmented reality.

The camera observed five objects and a billiard sphere with a radius of 27cm, as seen in Fig. 9
                           a. The objects were illuminated by two light sources that were placed at an approximate distance of 2.0m away from the sphere center. The initial camera center was positioned approximately 0.5m away from the sphere center. Since ground truth for camera and light parameters were not available in this experiment, we verified the correctness of the estimated parameters as follows.
                              
                                 •
                                 First, the physical measurements of the five objects were compared against reconstructions obtained using the estimated camera parameters. The reconstructions were obtained from triangulations of corresponding points. It can be seen in Table 1
                                     that the error between measured and estimated entities was generally very low. In Table 2
                                     the mean reprojection error for the vertices of the reconstructed objects is given for all views. This table also lists the back projection error of specular highlights.

The images were also augmented with a wireframe model of the reconstructions and a synthetic rendering of the billiard sphere in Fig. 10
                                    b. The sphere was rendered under the estimated light directions. The correct location of the specular highlights on the sphere, with respect to the original sphere shown in Fig. 10a, and the correct augmentation of the wireframe models confirm the low errors reported in Table 2.

Second, the focal length is compared to an estimate made using a planar calibration pattern [36]. The cost function of the optimization (17) is plotted in Fig. 9b and a minimum was obtained at 
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ˆ
                                             
                                          
                                          =
                                          4698
                                       
                                    , while the planar calibration pattern gave 
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ¯
                                             
                                          
                                          =
                                          4416
                                       
                                    .

Third, a virtual bunny was augmented into the scene in Fig. 10c. The virtual bunny was rendered using the estimated light directions and a shadow was casted into the scene. The good registration of the bunny confirms the good quality of the estimated camera parameters and light directions.

A second experiment on real data was performed. This time, we took two images from different viewpoints of a billiard sphere illuminated by two light sources. The estimated focal lengths was again compared against estimates made using the planar calibration pattern. The experiment was repeated for different focal lengths. The cost functions of the optimization problem (17) for three different focal lengths were plotted in Fig. 11
                            and the minima were obtained at 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       17
                                       mm
                                    
                                 
                                 =
                                 3742
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       24
                                       mm
                                    
                                 
                                 =
                                 5100
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       40
                                       mm
                                    
                                 
                                 =
                                 7820
                              
                           , while Zhang’s planar calibration pattern method yielded 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       17
                                       mm
                                    
                                 
                                 =
                                 3761
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       24
                                       mm
                                    
                                 
                                 =
                                 5037
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       40
                                       mm
                                    
                                 
                                 =
                                 8336
                              
                           , respectively.

Finally, a third experiment on real data was performed. This time, five light bulbs were placed approximately 2m away from a billiard sphere, which had a radius of 27mm. The camera was approximately located 1.5m from the sphere center. Seven images of the billiard sphere and a planar checkerboard pattern were taken from different viewpoints.

The point correspondences of the pattern were used to estimate the symmetric transfer error (STE), which we calculate as follows. For each point 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              
                            the distance 
                              
                                 d
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 F
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            between the epipolar line 
                              
                                 F
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            and its corresponding point 
                              
                                 u
                                 
                                    
                                       ′
                                    
                                    
                                       i
                                    
                                 
                              
                            was computed; here F represents the Fundamental matrix. This was done in both directions and the mean distance was used as the error
                              
                                 (27)
                                 
                                    e
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                    
                                       
                                          d
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          F
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          d
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          2
                                          p
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (28)
                                 
                                    d
                                    (
                                    p
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                ax
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                by
                                             
                                             
                                                0
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          c
                                          |
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           is the absolute Euclidean distance (in pixels) between a point 
                              
                                 p
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                            and a homogeneous line 
                              
                                 
                                    
                                       l
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           .


                           Table 3
                            lists the STE (in pixel) in the second column for the 6 image pairs. It can be seen that the average STE error was approximately 3 pixel. Considering the fact that the image resolution was 4752 pixel×3168 pixel and the focal length was 4391 pixel, this is a low error.

Camera extrinsic parameters were also obtained from the dense point correspondences on the planar pattern. The relative rotations and translations between the estimated cameras were compared against those estimates from the planar calibration pattern and are listed in columns 3–7 of Table 3. The average angular error in the estimated rotations was 0.66° for the rotation and the average errors in the translations were 0.51cm, 0.34cm and 0.12cm for the x, y and z component of the translations vectors. The procedure for obtaining the error in rotation was the same as in the synthetic case, but this time using the rotation obtained from the calibration pattern as the ground truth. Given the large distances between the camera centers and the sphere center, these obtained results are accurate.

@&#CONCLUSIONS@&#

In this paper we have described how light directions and both camera intrinsic and extrinsic parameters can be recovered from specular highlights observed on a sphere. The main contributions of this paper are.
                        
                           1.
                           a closed form solution for recovering light directions from the specular highlights observed in a single image of a sphere with unknown size and location,

an iterative solution to recover the focal length from multiple views of the sphere, and

a closed form solution for recovering the relative camera poses using the estimated sphere, focal length and light directions.

The estimation quality of both light directions and camera parameters depends on the quality of the extracted silhouettes and specular highlights. As we have shown in synthetic experiments, if the sphere silhouettes and the specular highlights cannot be accurately extracted, the camera poses and light directions would be inaccurate. Sophisticated methods for sphere silhouette and specular highlight extractions, e.g., based on temporal tracking information, should therefore be employed to ensure accurate estimations.

We represent quaternions with a four vector
                        
                           (A.1)
                           
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                                
                                                   y
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     or alternatively by a sum of a real number w and three imaginary numbers x, y and z as
                        
                           (A.2)
                           
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              =
                              w
                              +
                              ix
                              +
                              jy
                              +
                              kz
                              ,
                           
                        
                     where i
                     2
                     =
                     j
                     2
                     =
                     k
                     2
                     =
                     ijk
                     =−1. Note that the purely imaginary quaternion 
                        
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                           =
                           0
                           +
                           ix
                           +
                           jy
                           +
                           kz
                        
                      represents the vector 
                        
                           q
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                y
                                             
                                             
                                                z
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 T
                              
                           
                        
                     . The conjugate of a quaternion negates its imaginary part 
                        
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           w
                           -
                           ix
                           -
                           jy
                           -
                           kz
                        
                     .

Products of quaternions can be expressed as a multiplication between an orthogonal 4×4 quaternion matrix and a quaternion
                        
                           
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              =
                              Q
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                -
                                                x
                                             
                                             
                                                -
                                                y
                                             
                                             
                                                -
                                                z
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                w
                                             
                                             
                                                -
                                                z
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                z
                                             
                                             
                                                w
                                             
                                             
                                                -
                                                x
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                -
                                                y
                                             
                                             
                                                x
                                             
                                             
                                                w
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              ,
                           
                        
                     or
                        
                           (A.3)
                           
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    Q
                                 
                                 
                                    ∼
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                -
                                                x
                                             
                                             
                                                -
                                                y
                                             
                                             
                                                -
                                                z
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                w
                                             
                                             
                                                z
                                             
                                             
                                                -
                                                y
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                -
                                                z
                                             
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                y
                                             
                                             
                                                -
                                                x
                                             
                                             
                                                w
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ̇
                                 
                              
                              .
                           
                        
                     A rotation
                        
                           (A.4)
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              =
                              Rx
                           
                        
                     can be represented using unit quaternions (i.e., 
                        
                           ‖
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                           ‖
                           =
                           1
                        
                     ) as
                        
                           (A.5)
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ̇
                                 
                              
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                              
                                 ̇
                              
                           
                        
                      is the quaternion representation of the vector x. The rotation representation using unit quaternions in (A.5) follows from 
                        
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                           
                              
                                 x
                              
                              
                                 ̇
                              
                           
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           Q
                           
                              
                                 x
                              
                              
                                 ̇
                              
                           
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ∼
                                    
                                 
                              
                              
                                 T
                              
                           
                           Q
                           
                              
                                 x
                              
                              
                                 ̇
                              
                           
                        
                     , where
                        
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              Q
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                ·
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                                (
                                                xy
                                                -
                                                wz
                                                )
                                             
                                             
                                                2
                                                (
                                                xz
                                                +
                                                wy
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                2
                                                (
                                                yx
                                                +
                                                wz
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                                (
                                                yz
                                                -
                                                wx
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                2
                                                (
                                                zx
                                                -
                                                wy
                                                )
                                             
                                             
                                                2
                                                (
                                                zy
                                                +
                                                wx
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                -
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     If 
                        
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                        
                      is a unit quaternion, 
                        
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                           ·
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                           =
                           1
                        
                      and the lower-right-hand submatrix of 
                        
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ∼
                                    
                                 
                              
                              
                                 T
                              
                           
                           Q
                        
                      is an orthonormal matrix representing the rotation. Therefore, if 
                        
                           
                              
                                 q
                              
                              
                                 ̇
                              
                           
                        
                      is a unit quaternions, (A.5) can be used to represent a rotation.

@&#REFERENCES@&#

