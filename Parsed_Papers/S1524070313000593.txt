@&#MAIN-TITLE@&#A new sketch-based 3D model retrieval approach by using global and local features

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel sketch-based 3D model retrieval approach using global and local features.


                        
                        
                           
                           Employ hybrid feature lines to generate representative views for 3D models.


                        
                        
                           
                           An improved bag-of-features method to extract local features and their relations.


                        
                        
                           
                           An efficient two-stage matching strategy to evaluate the relevance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Sketch-based 3D model retrieval

Global features

Local features

Semantic relations

@&#ABSTRACT@&#


               
               
                  With the rapid growth of available 3D models, fast retrieval of suitable 3D models has become a crucial task for industrial applications. This paper proposes a novel sketch-based 3D model retrieval approach which utilizes both global feature-based and local feature-based techniques. Unlike current approaches which use either global or local features, as well as do not take into account semantic relations between local features, we extract these two kinds of feature information from the representative 2D views of 3D models that can facilitate semantic description and retrieval for 3D models. Global features represent the gross exterior boundary shape information, and local features describe the interior details by compact visual words. Specifically, an improved bag-of-features method is provided to extract local features and their latent semantic relations. In addition, an efficient two-stage matching strategy is used to measure the distance between the query sketch and 3D models for selection and refinement. Experiment results demonstrate that our approach which combines these two kinds of complementary features significantly outperforms several state-of-the-art approaches.
               
            

@&#INTRODUCTION@&#

With the rapid increase in the number of available 3D models, the ability to fast retrieve suitable 3D models has become more and more crucial in many industrial applications. A common way is keyword-based retrieval such as Google 3D Warehouse where users input keywords and models are returned by matching the input text and the pre-specified model tags. Because the tags are general text descriptions provided by users and sometimes cannot describe models clearly, keyword-based retrieval often returns unexpected results. Another important alternative is content-based retrieval [1]. Model retrieval by example requires users to provide an example model as the initial input, but it is not applicable when the example model is not at hand. Instead, sketch-based retrieval is much more intuitive and convenient, where users can just draw a 2D sketch as the input. In fact, a sketch is the more natural way for 3D model retrieval. As a sketch is rough and only contains partial information about a 3D model, effective sketch-based retrieval is challenging and difficult.

Several studies have sought to improve sketch-based 3D model retrieval effectiveness [2–4]. They matched the 2D query sketch with multiple views of 3D models, and encoded sketches and views with feature descriptors. According to the feature descriptors used, existing methods can be classified into two categories, i.e., global feature-based methods and local feature-based methods. The global features-based methods extract global shape information from 2D views of 3D models, and describe the views as global descriptors such as Spherical Harmonic descriptor [2] and Light Field descriptor [3] to support global shape matching. The local features-based methods consider the views as bag of independent visual words, which can facilitate partial shape matching by using bag-of-features descriptors [4]. So far, most methods utilize only global shape descriptors to represent 2D views. Very recently, local features have been widely used in many computer vision applications [5]. The utilizations of local features usually achieve better performance than the traditional methods using only global descriptors. Moreover, to the best of our knowledge, current local feature-based methods still have some drawbacks, for example, they do not take into account semantic relations between local features, leading that the retrieval results cannot meet the user’s needs. The purpose of this research is to improve retrieval effectiveness and efficiency by combining global and local features.

In the paper, we propose a novel sketch-based 3D model retrieval approach by combining both the global feature-based and local feature-based techniques to capture complementary features and improve retrieval effectiveness. Our approach takes a simple 2D sketch of the desired model as the input and compares this sketch to a set of representative 2D projection views of each model in a 3D model database. The approach utilizes global features to rapidly locate candidate models. Improved local features are exploited to further refine these candidate models. The effectiveness of our approach is demonstrated by comparative and evaluative experiments. The main contributions of this paper are summarized as follows:
                        
                           1.
                           We propose a novel sketch-based 3D model retrieval approach by utilizing both the global and local visual features and taking into account the semantic relations between local features.

We employ the hybrid feature line generation and best view selection techniques to generate a good set of representative views for 3D models.

We adopt the integrated descriptors to represent global features of views from multiple aspects. We further present an improved bag-of-features method to extract local features of views and represent them as distributions of compact visual words.

An efficient two-stage matching strategy is proposed to evaluate the relevance between the input sketch and 3D models.

We evaluate our approach over the public standard dataset. The experimental results show that our approach can achieve significantly better retrieval performance compared with the state-of-the-art methods.

The rest of this paper is organized as follows. In Section 2, we introduce related work about sketch-based 3D model retrieval. Section 3 gives an overview about our approach. Feature extraction and retrieval algorithms are presented in Sections 4 and 5, respectively. Section 6 reports the experimental results. Section 7 concludes the paper and discusses future work.

@&#RELATED WORK@&#

With the increasing use of 3D models in computer graphics and geometric-aided design, 3D model retrieval has become an active research field. There have been a huge amount of work on content-based 3D model retrieval [1]). For example, Mohamed and Hamza [6] employed a skeletal reeb graph for 3D object representation and matching using a normalized mixture distance function for example-based model retrieval. Also, Liu et al. [7] introduced a new 3D model retrieval method based on color and geometry signatures. Most existing studies focus on query-by-model algorithms, which use existing models as queries and measure the similarity between models. Since we pay more attentions to design suitable feature descriptors for measuring the similarity between the query sketch and 3D models, we mainly review some related work on sketch-based 3D model retrieval methods.

Many efforts have been made to design sketch-based 3D model retrieval algorithms. Funkhouser et al. [2] presented a search engine where users drawed outlines from three principal view directions and the system matched them to thirteen orthographic projection views of 3D models. They utilized global rotation invariant Spherical Harmonic descriptors to represent each view of a 3D model, but boundary features alone could not discriminate interior details well. Chen et al. [3] provided a visual similarity-based approach by using LightField descriptors, which compared input sketches to ten silhouettes of each 3D model that were generated from ten viewing angles on a dodecahedron. Each silhouette was a 2D projection view, denoted by Fourier descriptors and Zernike moments. However, this approach was designed for sketching closed contours. For domain-specific 3D CAD model retrieval, Hou and Ramani [8–10] integrated multiple descriptors like 2.5D Spherical Harmonic, Fourier descriptors and Zernike moments to represent 2D drawings. In addition, Li and Johan [11] adopted view context-based features and 2D relative shape context matching for sketch-based model retrieval. However, these approaches usually require users to draw multiple sketches with closed contours, which are often inconvenient for users to perform retrieval. In particular, they do not consider local details, and is unable to differentiate those models having similar outlines but with different interior details. Furthermore, Shao et al. [12] rendered 2D contours of each model from seven views and developed a sampling-based shape matching scheme. Yoon et al. [13] measured orientations of sketch lines by using diffusion tensors as the descriptors, and proposed an orientation histogram that globally encoded each view of a model. These two approaches focus on dealing with the variations of sketches, which are considered very meaningful. In summary, global-based approaches exploit mainly boundary information, and cannot effectively discriminate interior details.

Recently, bag-of-features techniques have attracted increasing attentions in 3D model retrieval. Bag-of-features (BOFs) retrieval, which is already well known in text and image retrieval fields [14,5], represents a document or an image as an unordered collection of words or visual words, and has demonstrated impressive performance. By adopting local feature descriptors independent of locations, bag-of-features approaches can immediately enable partial matching. For example, Bronstein et al. [15] encoded 3D shapes as geometric words and expressions for invariant shape retrieval. Lavoué [16] showed that the retrieval effectiveness can be improved based on bag-of-words paradigm. But they mainly focused on employing bag-of-features methods in various ways for supporting 3D model query inputs. Unlike these studies, our work employs bag-of-features for improving sketch-based 3D model retrieval. A typical similar work is presented by Eitz et al. [17,4]. They exploited a feature lines-based approach, representing local regions of projected views of 3D models as visual word histograms. However, current local features-based approaches have some limitations because of the lack of global contextual semantic information, which motivate us to develop a new sketch-based retrieval approach that can augment bag of features with global semantic relations to improve retrieval accuracy.

Our sketch-based 3D model retrieval framework is shown in Fig. 1
                     . It consists of a feature base with an index structure generated offline, and a sketch-based online search engine. 3D models are first projected from different viewpoints to generate a good set of 2D views. Then global and local features of these 2D views are extracted respectively. Global features describe the global contours of 2D views, which can be used to prune those 3D models whose views are quite different from the input sketch in global contour shape. Local features with an improved bag-of-features method are used to refine the candidate 3D models, which also take into account the latent semantic relations between local features. In this way, each 3D model is described as global and local feature descriptors. These feature descriptors are indexed and stored in the feature indexing base. An online search engine computes the feature descriptors for the query sketch, and 3D models similar to the input sketch are retrieved by matching query descriptors to the view descriptors in the feature indexing base. The relevance between the input sketch and 3D models is evaluated by an efficient two-stage distance measurement based on the global and local feature descriptors. The distance of the closest view of a 3D model to the input sketch is used as the final distance between the input sketch and the 3D model. By computing the minimal distance between the feature vectors of the query and each view of the model, we can rank models accordingly. The details for this approach will be explained in the following sections.

To measure the difference between a 2D query sketch and the views of 3D models effectively and efficiently, we need to generate 2D views for 3D models, and extract features for both input sketches and these 2D views. In our algorithm, global features are chosen because of their robustness for the global-based model filtering, while local features are chosen because of their better accuracy in refining related models with interior details.

In order to generate 2D views for 3D models that are likely to be sketched by users, we use two techniques to generate good views. One technique is to render hybrid feature line views for each model, and the other is to select a set of representative views for a 3D model.

Currently, rendering the silhouettes of a model is widely used in several applications, but it lost some inner information; rendering the depth maps of a 3D model is certainly very descriptive of the model, but it is not feasible for users to draw correct depth maps. To overcome the drawbacks of previous approaches, we adopt a hybrid line rendering method to generate 2D views for the 3D model. The hybrid method generates the following types of curves, including:
                           
                              1.
                              Exterior silhouettes which depict the 2D outlines from a certain viewpoint of a 3D model.

Occluding contours which depict all points on the model whose normals are orthogonal to the view direction.

Suggestive contours [18] which depict lines drawn on the visible parts of the model surface and complement contours in conveying shape.

Boundaries (e.g., Canny edge lines [19]) which depict edges that only belong to a single polygonal face of a 3D model.


                        Fig. 2
                         highlights the results generated with different rendering methods. We can observe that a hybrid rendering method can closely resemble the way most people sketch 3D models.

We consider view directions to get representative views. Existing researches mainly follow the fixed uniform projection direction methods [3]. The uniform projection directions generate 2D views from all fixed viewpoints, but these views may include some unexpected undistinguishable views or excessive views. In fact, only some views are needed to depict a 3D model. For example, a monitor often tends to be drawn from the front viewpoint, and a desk is often sketched from a side viewpoint. In addition, a car is not likely to be drawn from a bottom viewpoint. Unlike the uniform viewpoints for all 3D models, we would use different numbers of representative views for each 3D model to achieve better retrieval. Less views could speed up the search, and meanwhile better views can guarantee the retrieval results. Therefore, we incorporate a best view selection method in [20] to select a good set of representative views. This method takes into account several view attributes such as area attributes, silhouette attributes and semantic attributes. Based on these multiple attribute factors, each candidate view is scored and those representative views are selected as the good views for 3D models. Fig. 3
                         shows nine representative 2D feature line views for a car model.

After obtaining 2D views from 3D models, global features will be extracted from these views. Firstly, we preprocess 2D views with several steps such as binarization, edge detection, closing operations, gap connection and region filling. In order to avoid noise disturbance, we also apply median filtering to remove isolated points. To depict global shape information of 2D views of 3D models, we adopt Fourier descriptors, Zernike moments, circularity and eccentricity [11] to represent global features from different aspects. Fourier descriptors and Zernike moments have been successfully applied to image representation applications [21,22].

Fourier descriptors [21] are obtained through Fourier transform on a shape signature function derived from boundary coordinates 
                           
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              -
                              1
                              }
                           
                        . A typical shape signature function is the centroid distance function which is given by the distance of the boundary points from the centroid of the shape:
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 -
                                 1
                              
                           
                        where
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

Fast Fourier Transform (FFT) is then applied on 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                         to obtain the coefficients:
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                -
                                                j
                                                2
                                                π
                                                ni
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 n
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 -
                                 1
                              
                           
                        
                     

The magnitudes of coefficients 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                         are normalized by dividing the magnitude of the first coefficient 
                           
                              |
                              
                                 
                                    a
                                 
                                 
                                    0
                                 
                              
                              |
                           
                        . For efficient shape description, only a small number of the acquired descriptors are selected for shape representation. Experiments show that lower Fourier descriptors are suitable for global shape representation. So we employ 10 Fourier descriptors to represent gross shape boundary information about 2D views of 3D models and query sketches.

The Zernike moments [21] are derived from complex Zernike polynomials over the unit circle 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              1
                              )
                           
                        :
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   nm
                                                
                                             
                                             (
                                             ρ
                                             ,
                                             θ
                                             )
                                             =
                                             
                                                
                                                   R
                                                
                                                
                                                   nm
                                                
                                             
                                             (
                                             ρ
                                             )
                                             exp
                                             (
                                             jm
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   nm
                                                
                                             
                                             (
                                             ρ
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      s
                                                      =
                                                      0
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                            -
                                                            |
                                                            m
                                                            |
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   (
                                                   n
                                                   -
                                                   s
                                                   )
                                                   !
                                                
                                                
                                                   s
                                                   !
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  +
                                                                  |
                                                                  m
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            -
                                                            s
                                                         
                                                      
                                                   
                                                   !
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  -
                                                                  |
                                                                  m
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            -
                                                            s
                                                         
                                                      
                                                   
                                                   !
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   n
                                                   -
                                                   2
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where n is the order and m is the repetition, satisfying 
                           
                              n
                              -
                              |
                              m
                              |
                              =
                              even
                           
                         and 
                           
                              |
                              m
                              |
                              ⩽
                              n
                           
                        . The Zernike moments of order n with repetition m are expressed as:
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       nm
                                    
                                 
                                 =
                                 
                                    
                                       n
                                       +
                                       1
                                    
                                    
                                       π
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                       
                                    
                                 
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       V
                                    
                                    
                                       nm
                                    
                                 
                                 (
                                 ρ
                                 ,
                                 θ
                                 )
                              
                           
                        
                     

The magnitudes of moments are normalized through dividing them by the mass of the shape. Since the Zernike basis functions take the unit circle as the domains and the moments are normalized, this makes the resulting moments invariant to translation, scale and rotation. Considering the precision of shape representation, the first 15 moments are used in practice.

In addition, circularity defines the compactness of the shape: 
                           
                              cir
                              =
                              4
                              *
                              π
                              *
                              Area
                              /
                              
                                 
                                    Perimeter
                                 
                                 
                                    2
                                 
                              
                           
                        , and the range of circularity is between 0 and 1. Given n points 
                           
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              }
                           
                         in a shape, eccentricity depicts the shape deviation from a circle (the range of eccentricity is between 0 and 1):
                           
                              
                                 ecc
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       4
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In summary, the above shape descriptors can represent coarse global shape features from multiple aspects, which are more effective for describing global shape information. The global feature-based representation includes the spatial distribution relationships of whole contour pixels in 2D views.

Since global descriptors mainly capture global shape features without shape interior details, we capture local features for 2D views and query sketches to further discriminate interior content. We present an improved bag-of-features (also known as bag-of-words) [14,23] method as the descriptors for local features.

Each view is represented as a bag of features containing visual word occurrences. We use a compact representation by quantizing features according to visual vocabulary. The details about the local feature extraction procedure are described as follows:
                           
                              1.
                              
                                 Extract local regions: We randomly sample about 400 local regions over each view and utilize Speeded Up Robust Features (SURF) [24] to describe local regions of the view. SURF descriptors are designed to support translation, scale and rotation invariance.


                                 Learn visual vocabulary: We obtain visual vocabulary using an efficient k-means clustering algorithm based on those local features. In addition, we use a stop list to filter the most frequent visual words that occur in almost all views because these most frequent visual words are not discriminative. So the top 5% frequent visual words are eliminated as stop words. Different from common images, these 2D views are binary images. Too much visual words may lead to bad matching results due to data sparseness. The details about the parameter selection of the vocabulary size will be discussed in Section 6.


                                 Quantize features using visual vocabulary: We quantize local features from each view based on the visual vocabulary, representing them as the index of their closest visual words.


                                 Represent 2D views of 3D models as distributions of compact visual words: Based on visual words frequency probability statistics, each view is further represented as histograms of compact visual words.

In order to provide a compact feature representation, we explore a TF–IDF (Term Frequency–Inverse Document Frequency) [25] scheme to compute the importance of a visual word. The idea is that a word is important if it appears often in a document but at the same time less distinctive if it is a common word in the collection.

Suppose there is a visual vocabulary with K visual words, each view is represented by a K-vector 
                           
                              d
                              =
                              {
                              (
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    wt
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    wt
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    w
                                 
                                 
                                    K
                                 
                              
                              ,
                              
                                 
                                    wt
                                 
                                 
                                    K
                                 
                              
                              )
                              }
                           
                         and the weight 
                           
                              
                                 
                                    wt
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    n
                                 
                                 
                                    iv
                                 
                              
                              /
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              )
                              log
                              (
                              N
                              /
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              +
                              0.01
                              )
                           
                        , where 
                           
                              
                                 
                                    n
                                 
                                 
                                    iv
                                 
                              
                           
                         is the number of a visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         occurring in the view 
                           
                              v
                              ,
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                           
                         is the total number of visual words in the view 
                           
                              v
                              ,
                              N
                           
                         is the number of views of the whole collection, and 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                           
                         is the number of views that contain the visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                           
                         in the collection.

Current methods treat each visual word separately without considering semantic relations between visual words. In view of the high dimensions and the lack of utilization of semantic relations between visual words, we employ PLSA (Probabilistic Latent Semantic Analysis) [26–28] to deal with these problems. PLSA aims to map the high-dimensional word distribution vector into a lower dimensional topic semantic space and capture semantic relations between words, which has recently been successfully applied to text information retrieval. To the best of our knowledge, we are the first to use PLSA for sketch-based 3D model retrieval. We introduce a latent topic layer between the document and the words, and visual topics refer to compact visual words. Here, the document refers to the 2D view of the 3D model.

Specifically, suppose there are M latent topics in view collections, and each topic is depicted by the visual word multinomial distribution. Each view is considered as the mixture of multiple topics. Each visual word in a view is generated by a specific hidden topic, and the conditional probability of generating a word by a specific topic is independent from the document. We use this mixture model to represent all views, where M multinomial models are seen as M semantic dimensional vectors.

Formally, we define 
                           
                              D
                              =
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    N
                                 
                              
                              )
                           
                         to denote N views of 3D models with K visual words, and 
                           
                              Z
                              =
                              (
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    z
                                 
                                 
                                    M
                                 
                              
                              )
                           
                         to denote M latent topics. The probability of a visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                           
                         in a view 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         is defined as:
                           
                              
                                 p
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              p
                              (
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         is the conditional probability of a word 
                           
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                           
                         given a topic 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                        , and 
                           
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              |
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the conditional probability of topic 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                         given a view 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                        .

The log-likelihood of the collection D is expressed as:
                           
                              
                                 log
                                 p
                                 (
                                 D
                                 |
                                 Λ
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 n
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 log
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                l
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                l
                                             
                                          
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        where 
                           
                              n
                              (
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the frequency of a visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                           
                         occurring in a view 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                        , and 
                           
                              Λ
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               (
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                               |
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                 
                              
                           
                         denotes all topic model parameter collection.

We learn the mixture probability model by using a Expectation Maximization (EM) [29] algorithm, and compute maximum likelihood estimate as follows:
                           
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          Λ
                                       
                                    
                                 
                                 log
                                 (
                                 p
                                 (
                                 D
                                 |
                                 Λ
                                 )
                                 )
                              
                           
                        
                     

E-step:
                           
                              
                                 p
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       l
                                    
                                 
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       p
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      l
                                                   
                                                
                                                )
                                                p
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      l
                                                   
                                                
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       p
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                                p
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      t
                                                   
                                                
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

M-step:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             p
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             
                                                
                                                   z
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   n
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   p
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   n
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   p
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             p
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   l
                                                
                                             
                                             |
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   n
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   p
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   n
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Once the mixture probability model is estimated, 
                           
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    z
                                 
                                 
                                    M
                                 
                              
                           
                         will define the m semantic dimension vectors, and 
                           
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              |
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the representation of 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         in low-dimensional semantic space. In this way, each view is finally represented by M-vector: 
                           
                              {
                              (
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    wz
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    wz
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    z
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    wz
                                 
                                 
                                    M
                                 
                              
                              )
                              }
                           
                         where 
                           
                              
                                 
                                    wz
                                 
                                 
                                    l
                                 
                              
                           
                         denotes the weight of the topic 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                         and 
                           
                              
                                 
                                    wz
                                 
                                 
                                    l
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              |
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . The co-occurrence vectors of all views of 3D models are used to train a PLSA model. After the PLSA model is learned, it can be applied to sketch-based local feature matching. Latent semantic relations between visual words are captured by co-occurrence characteristics. Based on this, we can obtain a higher-level representation for 2D views of 3D models, where a visual topic consists of multiple visual words.

In order to guarantee fast search, visual words and topics for 2D views of 3D models are stored in an inverted index, and the feature signature file for each view is also stored in a direct index.

Note that these local features are invariant to translation because visual words are independent of concrete positions. In addition, since the 2D view size is normalized and visual word frequency is quantized, these features are also invariant to scale changes.

Overall, the above improved bag-of-features method takes into account latent semantic relations between local features based on the PLSA technique. These local features augment global features with many interior details. Thus, the global features-based method and the local features-based method are complementary to each other.

In the online search procedure, users draw sketches and submit them to the retrieval pipeline. We first preprocess the query sketch and extract the global and local feature descriptors from the sketch. Then we compute the distances between the sketch and the views of 3D models, rank them and output the retrieved models.

To evaluate the relevance between a 2D sketch and 3D models, we also extract the feature vectors for each sketch. We adopt the integrated shape descriptors to represent the global outline features and histograms of compact visual words to represent the local features. Note that the compact visual words refer to visual topics as mentioned in the previous Section 4.3.

Global features for a sketch are described as 
                           
                              {
                              sf
                              ,
                              sz
                              ,
                              sc
                              ,
                              se
                              }
                           
                        . sf denotes the Fourier descriptors of the sketch: 
                           
                              sf
                              =
                              {
                              
                                 
                                    sf
                                 
                                 
                                    i
                                 
                              
                              }
                              ,
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              10
                           
                        . sz denotes the Zernike moments of the sketch: 
                           
                              sz
                              =
                              
                                 
                                    
                                       
                                          
                                             sz
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              15
                           
                        . sc and se denotes the circularity and eccentricity features of the sketch, respectively.

We use the L1 distance metric to evaluate the distances of global descriptors from multiple aspects. The global feature distance 
                           
                              
                                 
                                    gd
                                 
                                 
                                    j
                                 
                              
                           
                         between a sketch and the jth 3D model are computed as below:
                           
                              
                                 
                                    
                                       gd
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                f
                                             
                                          
                                          *
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   10
                                                
                                             
                                          
                                          |
                                          
                                             
                                                sf
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                mf
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                i
                                             
                                          
                                          |
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                z
                                             
                                          
                                          *
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   15
                                                
                                             
                                          
                                          |
                                          
                                             
                                                sz
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                mz
                                             
                                             
                                                j
                                                ,
                                                k
                                                ,
                                                i
                                             
                                          
                                          |
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                c
                                             
                                          
                                          *
                                          |
                                          sc
                                          -
                                          
                                             
                                                mc
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          |
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                e
                                             
                                          
                                          *
                                          |
                                          se
                                          -
                                          
                                             
                                                me
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        where j denotes the jth model, k represents the k view of one model, 
                           
                              
                                 
                                    mf
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    i
                                 
                              
                           
                         means the ith fourier descriptor of the kth view of the model j, and 
                           
                              
                                 
                                    mz
                                 
                                 
                                    j
                                    ,
                                    k
                                    ,
                                    i
                                 
                              
                           
                         means the ith Zernike moment of the kth view of the model j. 
                           
                              
                                 
                                    w
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    z
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    c
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    e
                                 
                              
                           
                         denotes the weights of different global descriptors. Here, according to the importance difference, we assign 0.4 to 
                           
                              
                                 
                                    w
                                 
                                 
                                    f
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    z
                                 
                              
                           
                        , and assign 0.1 to 
                           
                              
                                 
                                    w
                                 
                                 
                                    c
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    e
                                 
                              
                           
                         to achieve better performance in practice.

Local features for a sketch is described by visual topics and their weights:
                           
                              
                                 sh
                                 =
                                 {
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       sh
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 }
                                 ,
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                        where 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                         indicates the lth visual topics, and 
                           
                              
                                 
                                    sh
                                 
                                 
                                    l
                                 
                              
                           
                         represents the weight of 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                        .

The local features-based similarity between the sketch S and a 2D view D is defined as:
                           
                              
                                 Sim
                                 (
                                 S
                                 ,
                                 D
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                l
                                             
                                          
                                          ∈
                                          S
                                       
                                    
                                 
                                 
                                    
                                       sh
                                    
                                    
                                       l
                                    
                                 
                                 ·
                                 w
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 D
                                 )
                                 ·
                                 log
                                 
                                    
                                       
                                          
                                             
                                                df
                                                (
                                                C
                                                )
                                                +
                                                1
                                             
                                             
                                                df
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ,
                                                C
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              w
                              (
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              ,
                              D
                              )
                           
                         denotes the weight of 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                         in the view, 
                           
                              df
                              (
                              C
                              )
                           
                         denotes the number of views in the collection, and 
                           
                              df
                              (
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                              ,
                              C
                              )
                           
                         denotes the number of views that contains 
                           
                              
                                 
                                    z
                                 
                                 
                                    l
                                 
                              
                           
                        . The similarity is further normalized 
                           
                              (
                              0
                              <
                              Sim
                              (
                              S
                              ,
                              D
                              )
                              <
                              1
                              )
                           
                        :
                           
                              
                                 Sim
                                 (
                                 S
                                 ,
                                 D
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   l
                                                
                                             
                                             ∈
                                             S
                                          
                                       
                                       
                                          
                                             sh
                                          
                                          
                                             l
                                          
                                       
                                       ·
                                       w
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             l
                                          
                                       
                                       ,
                                       D
                                       )
                                       ·
                                       log
                                       
                                          
                                             
                                                
                                                   
                                                      df
                                                      (
                                                      C
                                                      )
                                                      +
                                                      1
                                                   
                                                   
                                                      df
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      C
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   l
                                                
                                             
                                             ∈
                                             S
                                          
                                       
                                       log
                                       
                                          
                                             
                                                
                                                   
                                                      df
                                                      (
                                                      C
                                                      )
                                                      +
                                                      1
                                                   
                                                   
                                                      df
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      ,
                                                      C
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Therefore, the local feature distance between the sketch and a model is computed as follows:
                           
                              
                                 
                                    
                                       ld
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          k
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 Sim
                                 (
                                 S
                                 ,
                                 
                                    
                                       mv
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 )
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    mv
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                           
                         denotes the kth view of the jth model. The value of 
                           
                              
                                 
                                    ld
                                 
                                 
                                    j
                                 
                              
                           
                         ranges from 0 to 1. Here, the smaller the value of the distance is, the more relevant the views is to the sketch. When a 2D view are identical to the query sketch, the distance between them is close to 0. The minimum distance between the sketch and 2D views of a 3D model is considered as the final distance between the sketch and the 3D model.

Before online search, we construct a feature indexing database for 3D models using an offline indexing algorithm. The details about the offline indexing algorithm are described as follows:
                           
                              1.
                              
                                 Coordinate normalization: In order to achieve translation and scale invariance, we translate the centers of all models to the origins of the coordinate system and then scale them such that their bounding spheres have the same radius.


                                 Pose normalization: To enhance the retrieval accuracy, we perform the optimal axis-based 3D model alignment by utilizing principal component analysis and symmetry techniques [30].


                                 Compute feature descriptors: First, we generate and select a set of representative views for 3D models, then compute global and local features for each view, and finally construct feature indexing database for 3D models.

We focus on retrieval using 2D sketches as queries. Given a query sketch, we propose a sketch-based 3D model online search algorithm as depicted in Algorithm 1.
                           Algorithm 1
                           Sketch-based online search algorithm. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: Query sketch S, Visual vocabulary V, 3D model base M, Feature base F.
                                          
                                          
                                             
                                                Output: The retrieved 3D models related to the query sketch.
                                          
                                          
                                             
                                                1: Preprocess the input sketch: 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                2: Extract global features from 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                , and obtain global descriptors GF.
                                          
                                          
                                             
                                                3: Select candidate 3D models from the model database based on global feature distance.
                                          
                                          
                                             
                                                4: Extract local features from 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                , and compute local descriptors.
                                          
                                          
                                             
                                                5: Quantize the local feature descriptors according to visual vocabulary V, and compute the distribution of visual topics LF.
                                          
                                          
                                             
                                                6: Refine the related 3D models based on the integrated feature distance between 
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                 and the candidate 3D models.
                                          
                                          
                                             
                                                7: Rank the retrieved 3D models and return the results.
                                          
                                       
                                    
                                 
                              
                           

During the online search stage, we first crop the input sketch and normalize its size to uniform pixels. Then, as mentioned in Section 4, we extract the global and local features of the preprocessed sketch, and represent them as global descriptors and distributions of compact visual words. After that, we compute distance matrix and rank results. We adopt an efficient two-stage feature matching strategy by combining global and local feature difference between the sketch and the models’ feature views to evaluate the relevance between the sketch and 3D models. First, those models whose global distances to the query sketch exceed the specified threshold are quickly excluded. Since the distances are normalized to between 0 and 1, this threshold is set as 0.8. Then, the accurate model refinement is conducted on the filtered relatively small data set. Moreover, in the refinement stage, we take an integrated distance which combines the global feature distance and the local feature distance by using linear interpolation: 
                           
                              
                                 
                                    d
                                 
                                 
                                    ′
                                 
                              
                              =
                              (
                              1
                              -
                              λ
                              )
                              *
                              gd
                              +
                              λ
                              *
                              ld
                           
                        , where 
                           
                              λ
                           
                         is the smoothing parameter. In our experiments, we assign 0.6 to 
                           
                              λ
                           
                         for achieving relatively optimal performance. The candidate models are re-ranked based on the integrated distance computation. And the top retrieved results are finally returned to users.

The global-based model selection works as a filtering stage, which not only improves the efficiency of the proposed local-based refinement method, but also improves the retrieval effectiveness by reducing the number of false positives. The complementary combination of global and local matching methods reduces the number of necessary comparisons between the query sketch and 3D models, and can further improve overall performance.

@&#EXPERIMENTAL RESULTS@&#

A prototype system for sketch-based 3D model retrieval is implemented with C++ to demonstrate the effectiveness of the proposed approach. The system consists of off-line feature extraction and online search modules. In the off-line indexing module, a 3D model takes about 6s to extract features on the average. Though this may cost a few hours for off-line processing, it provides good performance for on-line searching. In the on-line searching module, a retrieval task takes less than 1s for one query sketch. We perform the retrieval in a graphical user interface that can support user to draw sketches or upload sketches. All the experiments are carried out on a standard PC (Windows/XP 32bits, E7500 CPU@2.93GHz, 2GB RAM), and the timings reported here are generated using a single thread.

In order to evaluate the retrieval performance of our approach, we perform experiments on a typical open 3D model benchmark, i.e., the Princeton Shape Benchmark Database (PSB) [31]. This benchmark consists of 1814 models, and is divided into a train dataset and a test dataset. We use the standard sketch set gathered by Eitz et al. [4] as query inputs, which comprises of 1814 human-drawn sketches. Because PSB has different numbers of models for different classes, we utilize sketches whose number of relevant models exceeds 20 to avoid the class bias for retrieval evaluation. The example classes involves several classes like chair, table, cup, sofa, car, airplane, bird, flower, etc. The retrieval effectiveness is measured in terms of precision–recall plots, which have been commonly used in information retrieval [32]. Precision is the fraction of retrieved models that are relevant, while recall is the fraction of relevant models that are retrieved. We use the paired t-test with significance at 
                           
                              p
                              <
                              0.05
                           
                        . In addition, we adopt a fivefold cross validation to optimize system parameters. The queries are divided into five equal parts. We train the model by using four out of five parts and then apply the model to estimate the average precision of the remaining part. We repeat this process on each of these five parts and report the average results over all parts.

We study the sensitivity of our approach against the number of vocabulary size. This is because the vocabulary size not only determines the computation cost but also affects the retrieval performance. To measure the influence of the vocabulary size, we run experiments with different visual vocabulary sizes, such as 50, 100, 200, 500, and 1000. The results are shown in Fig. 4
                           . An important observation is that using 200 or more words generally leads to better performance, but using a larger vocabulary makes computation cost higher. Also, 2D views and sketches are binary, and too much visual words like 1000 words or more words do not obviously provide better retrieval performance than 500 words. Therefore, we set the vocabulary size as 500 in our approach. Next, based on the visual vocabulary computation, we learn a topic PLSA model. The PLSA model is trained with the views of 907 models. The number of iterations is 200 during training and inference. As the number of visual topics is also one of important parameters, we perform experiments with 20, 50, 80, 100 visual topics respectively. Fig. 5
                            shows the retrieval performance with different numbers of visual topics. We observe that, as the number of visual topics enlarges, the performance goes up significantly at the beginning and becomes stable when 
                              
                                 M
                                 >
                                 80
                              
                           . According to the experimental result, we set the number of visual topics as 80 in our approach.

Difference view generation and selection methods also have influence on the retrieval performance. On the one hand, the 2D views of a 3D model should be representative enough to capture discriminative descriptors for the 3D model. On the other hand, the appropriate number of views can also be helpful for reducing the computation cost. We apply different view number generation methods to measure the results, as shown in Fig. 6
                           . As described in Section 2, Chen et al. [3] adopt 100 views by setting the cameras on the 20 vertices of a regular dodecahedron; Funkhouser et al. [2] obtain 13 orthogonal view directions for each model; Yoon et al. [13] use 14 views, namely, 6 orthographic projections and 8 isometric projections; Daras and Axenopoulos [33] extract 32 views for each model from uniformly distributed viewpoints. Compared with these previous methods, our best view generation method achieves better retrieval performance. Less representative views can reduce the runtime, and at the same time the retrieval accuracy of the best view method is also guaranteed as well as 100 views.


                        Fig. 7
                         shows the precision–recall plots of our proposed retrieval algorithm as well as other approaches (bag of features [4], Light Field [3], Spherical Harmonics [2]) in our experiments. The bag-of-features approach is a typical state-of-art local feature-based approach, and other approaches like Light Field and Spherical Harmonics are typical global feature-based approaches. Among the figure, GFM refers to our global feature-based method mentioned in Section 4.2, and LFM refers to our local feature-based method mentioned in Section 4.3. Some observations can be made from Fig. 7. Our combined approach clearly achieves better performance than other state-of-art approaches, among which LFM and Bag-of-features take the second and third place, respectively. Local features-based approaches obtain better results than global features-based approaches. In addition to precision–recall plots, we also employ other commonly metrics, i.e., Nearest Neighbor (NN), First Tier (FT), Second Tier (ST), E-Measures (E), Discounted Cumulated Gain (DCG) and Average Precision (AP) [31], to have a comprehensive evaluation on these approaches, as depicted in Table 1
                        . It is obvious that LFM is superior to GFM in most cases. For example, the results of query sketches like chairs, cars, and planes can be better retrieved using LFM. However, when inputting query sketches like swords, GFM may obtain better performance than LFM. Possible explanation is that the sketches like swords contain little interior details and local features of swords are undistinguishable. Therefore, LFM and GFM are complementary to some extent, and our approach by using LFM and GFM can provide a more discriminative capability. On the whole, our approach which combines global and local visual features can improve the retrieval performance.

@&#DISCUSSION@&#


                        Fig. 8
                         illustrates some examples of sketch-based retrieval results using our approach. The left part of the figure shows the query sketches, and the right part shows the ordered relevant 3D models. Among them, the top four rows show some good examples, while the other four rows show some failure examples. Take the first chair sketch as an example. The views of the related chair models usually have some latent spatial and semantic relations, including latent topics like a chair-back, a chair-seat and four chair-legs, and these visual topics are correlated and constrained each other. Similarly, the views of the related car models include latent visual topics like wheels. Additionally, helicopters and airplanes can be effectively discriminated by taking advantage of latent semantic relations between local features. In most cases, our system can handle input sketches with or without closed curves effectively. Particularly, we can gain good results when the input sketches contain many interior details. Nevertheless, we also find that our system may return some failures when few details are provided by the input sketches. As shown in the 5–8 rows of Fig. 8, the performance of some sketches are not as good as others. For instance, the retrieval results of the car sketch in the fifth row contain some failures like motorbike models; the retrieval results of the human sketch in the sixth row contain some negatives like tree models. This is because these sketches are relatively coarse. To further explain our combined approach (GFM+LFM) compared with GFM and LFM, Fig. 9
                         shows example retrieval results for a simple car sketch. The top 8 retrieval results based on single GFM contain two failures such as motorbike and bicycle models. The top 8 retrieval results based on single LFM are basically right except for employing a monster_truck model. The combination of both GFM and LFM yields better results than using GFM or LFM separately.

In terms of retrieval time, we have an approximate efficiency performance comparison on different approaches. The average response time per query is 0.32s, 0.11s, 0.12s, 0.03s, 0.05s, and 0.16s respectively for Spherical Harmonics, Light Field, GFM, bag of features, LFM, and our approach. Bag-of-features is the most efficient, while our LFM approach have inferior performance. This is because bag-of-features approaches are accelerated by using inverted indices. Only views that have at least one visual word in common with the query sketch are considered in the local feature matching process.

To sum up, the experiments demonstrate that our approach outperforms both state-of-the-art local feature-based approaches and global feature-based approaches. Specifically, local features combined with global semantic relationships can capture more discriminative information about objects. However, our approach still has limitations and there is much room to be improved. Although our approach achieves better retrieval accuracy, our feature extraction takes more time than other approaches because of exploiting both global and local features. In addition, we also test our proposed approach for various users. As we ask the users to draw target objects without specifying the details of the expected models, the drawn sketches differ drastically from user to user. For instance, some sketches are so coarse that the retrieval could not effectively discriminate an airplane from a bird. The emerging semantic web and incremental interactive feedback technologies can be incorporated to further improve retrieval effectiveness.

We present a new sketch-based 3D model retrieval approach, which takes advantage of global and local features in 2D hybrid views of 3D models as well as the query sketch. Multiple typical views are first obtained considering hybrid feature line generation and best view selection. Global features are extracted and represented as integrated descriptors. Local features are extracted by adopting an improved bag-of-features method and represented as distributions of compact visual words. Furthermore, an efficient two-stage matching strategy is proposed to evaluate the relevance between the input sketch and 3D models. Global-based filtering step is used to select candidate models based on the global feature distance. Then, local-based refinement step is further exploited to refine retrieval results and re-rank them for the candidates. In our approach, we augment bag of features with global spatial relationships and semantic relations that can improve the retrieval efficiency and accuracy. Experiment results show that our approach by incorporating these two kinds of complementary features significantly outperforms other state-of-the-art approaches.

Although the proposed approach achieves better performance than previous approaches, diversified sketches suggest that sketch-based 3D model retrieval for realistic inputs is still a very hard problem. In our further work, we will employ feedback learning mechanism and user context model to enhance our approach because difference users may have different sketching styles. Besides, we intend to investigate combining effective semantic-based retrieval with sketch-based retrieval to provide much easier retrieval modes and more desirable retrieval results.

@&#ACKNOWLEDGMENTS@&#

We thank the editor and anonymous reviewers for their constructive comments that help us to greatly improve this paper. This work is supported by Specialized Research Fund for the Doctoral Program of Higher Education of China (No. 20110101110065), National Science and Technology Support Program of China (Nos. 2011BAG05B04 and 2012BAD35B01), Zhejiang Natural Science Foundation of China (No. Z1090461), and Zhejiang Key Science and Technology Innovation Team Plan of China (No. 2009R50015).

@&#REFERENCES@&#

