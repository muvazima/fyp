@&#MAIN-TITLE@&#Adaptive meshing for finite element analysis of heterogeneous materials

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An adaptive meshing scheme for versatile heterogeneous materials.


                        
                        
                           
                           A mesh adaptation algorithm based on centroidal Voronoi tessellation.


                        
                        
                           
                           A specific density function aiming to equalize the material variation over mesh elements.


                        
                        
                           
                           An adaptive sampling technique for calculating material variations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Heterogeneous object modeling

Finite element analysis

Adaptive mesh generation

Computational efficiency

@&#ABSTRACT@&#


               
               
                  Adaptive meshing of 2D planar regions, curved surfaces as well as 3D volumes has been extensively studied in Finite Element Analysis (FEA) in the past few decades. Despite the maturity of these adaptive meshing approaches, most of the existing schemes assume the domain or sub-domain of interest is homogeneous. In the context of FEA of heterogeneous objects, traditional adaptive mesh generation strategies become inadequate as they fail to take into account the material heterogeneities. This paper is motivated to tackle such problems and propose an adaptive mesh generation scheme for FEA of versatile heterogeneous materials. The proposed approach takes full advantages of the material heterogeneity information, and the mesh density is formulated with a specific function of the material variations. Dual triangulation of centroidal Voronoi tessellation is then constructed and necessary mesh subdivision is applied with respect to a predefined material threshold. Experiments show that the proposed approach distributes the material composition variation over mesh elements as equally as possible and thus minimizes the number of elements in terms of the given material threshold. FEA results show that the proposed method can significantly decrease the mesh complexities as well as computational resources in FEA of heterogeneous objects and compared with existing approaches, significant mesh reduction can be achieved without sacrifice in FEA qualities.
               
            

@&#INTRODUCTION@&#

With recent technologies, design and fabrication of objects with spatially different material definitions becomes commonplace. Such objects are commonly termed as heterogeneous material objects. Heterogeneous material objects [1–4] possess superior properties in applications where multiple, often contradictive, functional requirements are simultaneously expected. By introducing material heterogeneities into the design domain, different properties and advantages of various materials can be fully exploited; traditional limitations due to material incompatibility/affinity problems can be naturally alleviated with gradual material variations. In the past few decades, a variety of applications have been reported in mechanical, electrical, thermal, optical, biomedical and other fields  [5–14].

The wide applications of heterogeneous objects have aroused active research in numerical analysis of heterogeneous objects. Many Finite Element Analysis (FEA)-based approaches have been proposed for function analysis or design validities  [15–21]. These methods extended traditional FEA approaches by taking the material heterogeneity into account and allowing different materials to be defined for each node or element. Most of them either use classic mesh generation schemes which result in poor accuracies (as the mesh only guarantees the geometric accuracies but fails to characterize the material heterogeneities) or alternatively, employ meshes with ultra-high densities to assure solution accuracies, which, on the other hand, significantly degrades the computational efficiencies  [22].

Adaptive finite element mesh generation is a promising solution to such problems. In the past, numerous investigations have been conducted on adaptive mesh refinement for 2D planar regions, curved surfaces as well as 3D volumes  [23,24]. Finer-resolution grids are used in regions where the surfaces exhibit large curvatures, and in planar or quasi-planar regions, sparse mesh grids are employed. However, almost all of these methods assume the components under meshing have homogeneous material compositions in the domain or sub-domain of interest. In the context of FEA of heterogeneous material objects, however, these strategies are no longer effective and directly applicable.

Motivated to take advantages of traditional adaptive meshing techniques while at the same time to incorporate the material heterogeneity into FEA studies, this paper aims to investigate effective approaches to generate adaptive meshes for heterogeneous objects. The proposed approach takes full advantages of the material heterogeneity information, and the mesh density is formulated with a specific function of the material variations. Dual triangulation of centroidal Voronoi tessellation is then constructed and necessary mesh subdivision is then applied in accordance with a predefined material threshold. Experiments show that the proposed approach distributes the material composition variation over mesh elements as uniformly as possible and thus minimize the number of elements while satisfying the material threshold requirement. Numerical results show that the proposed approach can properly balance the accuracy and computational overhead of finite element analyses and significant mesh reduction can be achieved without apparent sacrifice in FEA qualities.

@&#RELATED WORK@&#

Automatic mesh generation for FEA of homogeneous materials has been extensively studied in the past, and among others, the Delaunay triangulation methods  [25,26], advancing front methods (AFMs)  [27,28], Quadtree/Octree methods  [29,30] are most commonly used approaches. A basic principle for automatic mesh generation schemes is the ability to construct adaptive meshes with regard to a node spacing function (or a sizing function). In general, adaptive mesh generation consists of two steps: collect information (e.g. the object geometry, a posterior error estimator of the solution and some economic constraints) to build a node spacing function and then construct a desirable mesh conforming to the node spacing function  [30–33]. In  [24], Lo provided a comprehensive review on existing adaptive meshing schemes based on node spacing functions, for instance, the Delaunay triangulation method, advancing front approach, mesh generation using contours, coring technique, Quadtree/Octree technique and mesh refinement by subdivisions.

The aforementioned methods however mainly considered the geometric compatibility and the topological compatibility of the finite element meshes. The geometric compatibility guarantees the final mesh to be closely conformable to the object shapes or geometries; and the topological compatibility ensures all the elements are properly connected with correct adjacency relationships  [34].

In addition to these two compatibility requirements, Sullivan et al.  [34] proposed that the physical compatibility should also be seriously considered, as he put it, “An accurate numerical solution requires that the domain be discretized sufficiently to describe the physics of the problem”. As such, they tackled the adaptive meshing problem for heterogeneous objects, but unfortunately, they only focused on multi-material objects which are very primitive in material heterogeneity. Schimpf et al.  [35] also studied the adaptive meshing problem for human organs (e.g. heart, liver, lungs), each of which is also regarded as components with “distinct” materials.

The FEA studies on Functionally Graded Materials (FGMs) have been widely investigated in recent years. Most investigations, however, did not take the local material heterogeneities into account for the meshes were usually generated with commercial software packages  [36–39], which are inherently designed for homogeneous solid modeling purposes.

To our knowledge, the work done by Shin  [40], perhaps, seems to be the first study on the adaptive meshing problem for FGM objects. In his work, he converted continuous material gradation into step-wise variation. Iso-material contours of the solid model were first created; triangular mesh was then generated inside each iso-material (i.e. homogeneous) region formed by iso-material contours. The advantage of this model is that it is computationally efficient, and the size of mesh elements is also adaptively determined. However, only unidirectional material gradient was taken into account in Shin’s approach. No generic solutions were proposed to solve adaptive mesh generation for objects with bidirectional or even more complex material distributions  [1,41,42].

Chiu et al.  [43] proposed an adaptive mesh generation method for complex heterogeneous objects based on the quadtree technique. A material threshold was utilized to evaluate if a mesh element is homogeneous or quasi-homogeneous. The subdivision of the domain was recursively processed until all the elements satisfied the material threshold requirement. This method is capable of processing objects with complex material gradient functions, for instance the Heterogeneous Feature Tree (HFT) structure  [42], but a large amount of computational resources are needed for geometric intersection calculations. Moreover, material compositions are evaluated at a few sampling points only (for instance, the corner points of a quadtree rectangle), and in case the material composition differences among all sampling points fall below a given tolerance, no further subdivisions will be performed any longer. Theoretically however, it is possible that abrupt material changes still exist within quadrants of interest, even though the material variations along the bounding edges are homogeneous or quasi-homogeneous. In such scenarios, Chiu et al.’s approach is incapable of generating robust and adaptive finite element meshes.

To the best of our knowledge, so far there seems to be no thorough investigations on adaptive mesh generation for heterogeneous materials. Existing studies either resort to commercial software packages, which by nature, are not suited for mesh generation of heterogeneous materials, or use unnecessarily dense meshes which introduce significant efficiency problems. This paper is motivated to bridge such a gap towards providing a generic solution to this problem. We show, in what follows, that the proposed approach can effectively generate adaptive meshes for general heterogeneous models, inclusive of simple analytic function-based as well as other complex data representations such as HFT structures.

In this section, a general scheme for adaptive meshing of heterogeneous materials is first presented. Algorithmic details on how to apply the adaptive meshing method to analytic function-based and HFT-based heterogeneous models are then elucidated with examples.

For mesh generation of heterogeneous materials, there are four important factors to be considered:

(i) Geometric approximation

In a numerical simulation by means of finite elements, the computational process is based on an approximation (or mesh) of the domain where the problem is formulated. A mesh that well conforms to the geometric boundaries is therefore a prerequisite for accurate simulations.

(ii) Mesh quality

Mesh quality (e.g. aspect ratio) is another essential factor. Low-quality elements such as skinny triangles with large aspect ratios will degrade the accuracy of FEA solutions or lead to poor stiffness matrix conditioning  [44].

(iii) Number of mesh elements

The number of mesh elements has significant impacts on the computational efficiency of FEA. In order to boost the computational efficiency while maintaining the accuracy of FEA solutions, it is crucial to avoid introducing an excessive number of mesh elements.

(iv) Material threshold

When heterogeneous materials are subjected to FEA, the material composition variation, which directly relates to the material property (e.g. Young’s modulus) change in each finite element, greatly impacts the accuracy of FEA solutions  [45]. A material threshold is proposed to evaluate the validity of meshes of heterogeneous materials. A generated mesh 
                           
                              
                                 T
                              
                              
                                 ̃
                              
                           
                         is deemed validated, when the maximum material composition variation 
                           
                              
                                 δ
                              
                              
                                 
                                    max
                                 
                              
                           
                         over elements of 
                           
                              
                                 T
                              
                              
                                 ̃
                              
                           
                         is lower than the material threshold 
                           
                              
                                 δ
                              
                              
                                 0
                              
                           
                        , i.e.
                           
                              (1)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 <
                                 
                                    
                                       δ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 where  
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       T
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 
                                 δ
                                 
                                    (
                                    T
                                    )
                                 
                                 .
                              
                           
                         Here 
                           δ
                           
                              (
                              T
                              )
                           
                         denotes the material composition variation within an arbitrary element 
                           T
                         in 
                           
                              
                                 T
                              
                              
                                 ̃
                              
                           
                        .

To satisfy these four requirements, we propose an adaptive meshing scheme for accurate and efficient FEA of heterogeneous materials, in which the mesh adaptivity is determined by both material and geometric complexities of heterogeneous materials. In light of that, the proposed adaptive meshing algorithm embraces three-step meshing stages: Initial Mesh Generation (IMG), Material-Oriented Refinement (MOR) and Geometry-Oriented Refinement (GOR).

The IMG only involves a classical mesh generation problem, in which an initial triangulation that well approximates the geometric domain is constructed by a geometric modeler. In this stage, no material heterogeneity information is taken into account.

Following the IMG step, the MOR is repeatedly executed until the generated mesh is validated in terms of Eq. (1). In this mesh refinement step, a centroidal Voronoi tessellation (CVT)-based approach is proposed to govern mesh adaptation. A density function associated with material distributions being established, the CVT-based method controls the mesh density in such a way that denser mesh nodes are accumulated into the area where the material changing rate is large, and coarser nodes are allocated in relative “flatter” regions, and here the flatness refers to the rate of material changes. In addition, the CVT-based method distributes the material composition variation over elements of the CVT-based mesh as uniformly as possible. In such a way, the number of elements is minimized with respect to a predefined material threshold. The benefits of adopting the CVT-based approach are two-fold: it enables easy and flexible controls on the mesh distributions and also guarantees high mesh quality which is inherently supported due to CVT’s superior properties, as will be explained in more details in the following sections.

Notably, only material heterogeneity information is considered in the MOR. This becomes problematic whenever coarse elements are generated near curved boundaries of the domain where finer elements are expected to account for the geometric facilities. To solve this problem, the third step of the adaptive meshing algorithm is applied. In the GOR, the Delaunay refinement algorithm is used. Steiner points  [25] are inserted into the circumcenters of skinny triangles recursively until some specified criterion, such as minimum angle, is satisfied.

As the Delaunay refinement algorithm applied in the GOR step has been well studied  [25,26], our work in this paper focuses on the development of the MOR step, the core of which is a CVT-based method. To make this paper self-contained, we first give a brief introduction to the concept of CVT and its applications in the field of mesh generation.

Given an open bounded domain 
                              Ω
                              ∈
                              
                                 
                                    ℜ
                                 
                                 
                                    d
                                 
                              
                            and a set of distinct points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            in 
                              Ω
                           , the corresponding Voronoi region 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            for each point 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                            is defined as: 
                              
                                 (2)
                                 
                                    
                                       
                                          V
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                       
                                       ∈
                                       Ω
                                       |
                                       |
                                       
                                          x
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       <
                                       |
                                       
                                          x
                                       
                                       −
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       |
                                         for  
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                         and  
                                       j
                                       ≠
                                       i
                                       }
                                    
                                 
                              
                            where 
                              
                                 |
                                 ⋅
                                 |
                              
                             denotes the Euclidean distance in 
                              
                                 
                                    ℜ
                                 
                                 
                                    d
                                 
                              
                           . Note that the Voronoi region 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            is the point set in 
                              Ω
                            that are closer to 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                            than to any other point in 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           . We refer to 
                              
                                 
                                    
                                       {
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            as the Voronoi tessellation (VT) of 
                              Ω
                            and 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            as the associated generating points  [46]. The dual tessellation of VT is called Voronoi Delaunay triangulation (VDT).

Given a nonnegative density function 
                              ρ
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                            on 
                              Ω
                           , for any region 
                              V
                              ⊂
                              Ω
                           , the centroid 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    ∗
                                 
                              
                            of 
                              V
                            is defined as: 
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                V
                                             
                                          
                                          
                                             x
                                          
                                          ρ
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          d
                                          
                                             x
                                          
                                       
                                       
                                          
                                             
                                                ∫
                                             
                                             
                                                V
                                             
                                          
                                          ρ
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          d
                                          
                                             x
                                          
                                       
                                    
                                    .
                                 
                              
                            We call a Voronoi tessellation 
                              
                                 
                                    
                                       {
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            of 
                              Ω
                            a centroidal Voronoi tessellation (CVT) if and only if the generating points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            corresponding to the Voronoi regions 
                              
                                 
                                    
                                       {
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            are also the centroids of those regions, i.e., 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                            for 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              [46]. The associated Delaunay triangulation is called centroidal Voronoi Delaunay triangulation (CVDT)  [46].

A usually used algorithm for constructing CVT/CVDT is the Lloyd method  [46]. Given a domain 
                              Ω
                           , a density function 
                              ρ
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                            defined on 
                              Ω
                           , and a positive integer 
                              n
                           , the Lloyd method is performed as below:


                           
                              
                                 (i)
                                 Select an initial set of 
                                       n
                                     points 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                     on 
                                       Ω
                                    ;

Construct the Voronoi regions 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                     of 
                                       Ω
                                     associated with 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    ;

Determine the mass centroids of the Voronoi regions 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    ; these centroids form the new set of points 
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    .

If the new points meet the convergence criteria, return 
                                       
                                          
                                             
                                                {
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                     and terminate; otherwise, go to step (ii).


                           Fig. 1
                            shows two CVT/CVDT-based meshes with respect to different density functions. For a constant density function, the generating points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            are uniformly distributed, which leads to high-quality mesh as shown in Fig. 1(a). For a nonconstant density function, the generating points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                            are still locally uniformly distributed as depicted in Fig. 1(b); and it is conjectured that, asymptotically, the relation between the density function and the local mesh size of a CVT satisfies the below equation: 
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ≈
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ρ
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   ρ
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                d
                                                +
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                            denotes the diameter of 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            corresponding 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                            and 
                              d
                            is the dimension of 
                              Ω
                              [46]. Eq. (4) is quite useful to adaptive finite element methods based on CVT/CVDT meshes. Based on this equation and a posterior error estimator, one can explicitly construct the density function of CVT/CVDT and generate adaptive finite element meshes accordingly  [54]. Successful applications of CVT/CVDT-based adaptive algorithms have been conducted in numerical analysis of partial differential equations (PDEs)  [48,54]. In  [55], adaptive finite element methods based on the superconvergence properties  [56,57] of CVT/CVDT are further developed. It is worth mentioning that the computations of CVT/CVDT density functions are very similar to the calculations of sizing functions in the context of adaptive meshing. Systematic studies on automatic generation of geometric as well as non-geometric (e.g. boundary conditions of FEA, a posteriori error estimator of solution) sizing functions can be found in  [58–60]. In particular, the relationship between density functions of CVT/CVDT and sizing fields is provided in  [61].

As mentioned above, the key idea of CVT/CVDT-based adaptive algorithms is to propose a density function tuned to specific application needs  [48,54]. To extend the CVT/CVDT-based techniques to adaptive meshing of heterogeneous materials, it is natural to connect the density function to the material variations in heterogeneous models. In this section, we present how the density function of CVT/CVDT is determined with respect to the material distribution function of heterogeneous objects.

Given a heterogeneous model with a material composition function 
                              f
                           , the related gradient function (or material composition changing rate) 
                              g
                            is defined as 
                              
                                 (5)
                                 
                                    g
                                    =
                                    |
                                    ∇
                                    f
                                    |
                                    .
                                 
                              
                            Here we assume that 
                              f
                            is continuous and smooth everywhere in the domain of interest, and 
                              ∇
                              f
                            exists (but unlike 
                              f
                           , 
                              ∇
                              f
                            is not necessarily continuous and smooth).

In accordance with the gradient function, the desirable gradation of a CVT for the heterogeneous model should follow the way that more generating points (or mesh nodes) are created in the area where material composition changes quickly, while fewer generating points are used in the area where material composition changes slowly. More significantly, to minimize the number of generating points with regard to a material threshold, the material composition variation over Voronoi regions of a CVT should be distributed as equally as possible.

Let us assume a CVT on a heterogeneous model satisfies the above equal material variation property, thus we have 
                              
                                 (6)
                                 
                                    
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            denotes the mean value of 
                              g
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                            on the Voronoi region 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                            denotes the diameter of 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                           . Note that when the number of Voronoi generating points gets large (or the diameter of Voronoi regions becomes small), one can use the value of 
                              g
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                            at the generating point 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                            to approximate the mean value of 
                              g
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                            on the Voronoi region 
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                            and therefore 
                              
                                 (7)
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ≈
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    .
                                 
                              
                            From Eqs. (4) and (7), it can be easily deduced that the relation between the density function and the gradient function of material composition follows the below equation: 
                              
                                 (8)
                                 
                                    ρ
                                    ≈
                                    c
                                    
                                       
                                          g
                                       
                                       
                                          d
                                          +
                                          2
                                       
                                    
                                 
                              
                            where 
                              c
                            is an arbitrary positive constant. For the sake of simplicity, we let 
                              c
                              =
                              1
                            and rewrite the density function as 
                              
                                 (9)
                                 
                                    ρ
                                    ≈
                                    
                                       
                                          g
                                       
                                       
                                          d
                                          +
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

It turns out to be that the density function is a power function of the material composition changing rate where 
                              d
                            is the dimension of the domain of interest.

Having established the density function associated with the material distributions, we now illustrate the CVT-based refinement algorithm for heterogeneous models. Fig. 2
                            shows the flowchart of the CVT-based refinement algorithm, in which the initial triangulation is obtained from the IMG step. Several important steps to this refinement algorithm are listed as below.


                           
                              
                                 (i)
                                 Calculate the density function associated with the material distribution of a heterogeneous model according to Eqs. (5) and (9).

Construct a CVT-based mesh corresponding to the density function obtained in step (i) with the initial triangulation or other triangulations used as input.

Evaluate the validity of the CVT-based mesh in accordance with Eq. (1).

If 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                       <
                                       
                                          
                                             δ
                                          
                                          
                                             0
                                          
                                       
                                    , terminate the refinement algorithm and output the CVT-based mesh; otherwise, refine the CVT-based mesh based on the evaluation result in step (iii) and return to step (ii).

Following the general scheme, we next take two heterogeneous models, namely the analytic functional model (see Section  3.2) and the HFT-based model (see Section  3.3) as examples to elucidate the rationale and general applicability of the adaptive meshing method.

Explicit, analytic functions are often used to represent heterogeneous material distributions. Given a point 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         in a Cartesian coordinate system, its material composition is represented with an explicit analytic function 
                           V
                           =
                           f
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        . In the literature, linear, exponential   [21], parabolic   [17] and power function   [15] based material distributions have been widely used in modeling heterogeneous objects. One common property of all these functions is that their derivatives can be easily calculated. This provides the basis for adaptive meshing of analytic functional models.

As an example, Fig. 3
                         shows an analytic heterogeneous model with power function-based material distribution. It consists of two primary material constituents: ceramic (blue) and metal (red), as shown in Fig. 3(b). The material composition function of metal component is formulated as 
                           
                              (10)
                              
                                 f
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                b
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                b
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 0
                                 ≤
                                 
                                    
                                       y
                                    
                                    
                                       P
                                    
                                 
                                 ≤
                                 b
                              
                           
                         where 
                           P
                         is an arbitrary point in the domain, and 
                           b
                         is the vertical length of the domain, as seen in Fig. 3(a).

As mentioned earlier, the adaptive meshing process of heterogeneous materials begins with an initial triangulation covering the domain of interest. In this paper, a commercial CAD package, SolidWorks, is utilized to generate the initial triangulation. Fig. 4
                           (a) shows an initial decomposition of the domain depicted in Fig. 3. Note that denser points are situated on the curved boundary in order to improve the accuracy of the geometric approximation of the domain boundary.

With the analytic material composition function given as Eq. (10), we can simply calculate its gradient function by 
                              
                                 (11)
                                 
                                    g
                                    
                                       (
                                       P
                                       )
                                    
                                    =
                                    
                                       |
                                       ∇
                                       f
                                       |
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             (
                                             b
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   P
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    0
                                    ≤
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                    
                                    ≤
                                    b
                                    .
                                 
                              
                            Substituting Eq. (11) into Eq. (9) the density function can be then rewritten as 
                              
                                 (12)
                                 
                                    ρ
                                    
                                       (
                                       P
                                       )
                                    
                                    ≈
                                    g
                                    
                                       
                                          
                                             (
                                             P
                                             )
                                          
                                       
                                       
                                          d
                                          +
                                          2
                                       
                                    
                                    =
                                    g
                                    
                                       
                                          
                                             (
                                             P
                                             )
                                          
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          16
                                          
                                             
                                                
                                                   (
                                                   b
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                8
                                             
                                          
                                       
                                    
                                    
                                    0
                                    ≤
                                    
                                       
                                          y
                                       
                                       
                                          P
                                       
                                    
                                    ≤
                                    b
                                 
                              
                            where 
                              d
                              =
                              2
                           , as the heterogeneous model is defined in a 2D space.

Armed with the density function as Eq. (12), the CVT-based mesh can then be constructed by using the CfCVDT-based approach  [52] mentioned earlier. In this approach, a modified Lloyd’s method is developed to construct the CfCVDTs. In addition to the classic steps of the Lloyd’s algorithm mentioned previously, a projecting process as well as a lifting process is further executed during the Lloyd iteration. Here the projecting process denotes the projection of an interior generator onto the boundary, and conversely, the lifting process denotes the return of a boundary generator to the interior domain. With the aid of these two processes, the CfCVDT-based approach can freely control the mesh density in accordance with the density function.

Since the construction algorithm of CfCVDTs has been comprehensively studied in  [52], the details will not be restated. Fig. 4(b) shows the CVT-based mesh on the basis of the initial triangulation depicted in Fig. 4(a).

After obtaining the CVT-based mesh, it is pivotal to evaluate its validity in accordance with Eq. (1). If 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              >
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                           , we refine the CVT-based mesh by adding a set of points 
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                z
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                            onto the centroids of triangle elements whose material composition variations are larger than the material threshold, i.e. 
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             z
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    where  
                                    δ
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    >
                                    
                                       
                                          δ
                                       
                                       
                                          0
                                       
                                    
                                    .
                                 
                              
                            A new CVT-based mesh is then constructed based on the refined mesh, followed by evaluating the validity of the mesh. This process is iterated until 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              <
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                           . Fig. 4(c) shows the CVT-based mesh that satisfies the material threshold 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              0.1
                           .

Central to the above iterative process, the calculation of 
                              δ
                              
                                 (
                                 T
                                 )
                              
                            requires a lot of attention. In this paper, the definition of 
                              δ
                              
                                 (
                                 T
                                 )
                              
                            is consistent with that in  [43], i.e., 
                              
                                 (14)
                                 
                                    δ
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    i
                                    j
                                    ,
                                    i
                                    ≠
                                    j
                                    ,
                                    i
                                    ,
                                    
                                    j
                                    ∈
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    m
                                 
                              
                            where 
                              m
                            is the number of sample points in 
                              T
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    j
                                 
                              
                            is the material composition difference between two sample points, 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                           , i.e., 
                              
                                 (15)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       ‖
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                 
                              
                            where 
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                            denotes the material composition of 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           . To calculate the material composition variation accurately and efficiently, two factors are taken into account:


                           
                              
                                 (i)
                                 How many sample points to choose;

Where to locate these points.

Similar to the definition of 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            in Eq. (1), we further define 
                              
                                 (16)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          T
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       (
                                       T
                                       )
                                    
                                    ,
                                    
                                    and
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          a
                                          v
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                          u
                                          m
                                          
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   ̃
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          T
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       (
                                       T
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    a
                                    v
                                    g
                                 
                              
                            denote the minimum and average material composition variation over the elements of the mesh 
                              
                                 
                                    T
                                 
                                 
                                    ̃
                                 
                              
                           , respectively.

In Fig. 4(c), some skinny elements are induced near the curved boundary for the value of the density function here is relatively low (see Eq. (12)) but dense vertices are distributed on the curved boundary to precisely approximate the geometric features (refer to Section  3.2.1). To further improve the mesh quality, we refine the mesh by using the Ruppert’s refinement algorithm  [25]. New points are inserted to the circumcenters of the skinny triangles recursively until all triangles contain angles larger than a predefined minimum angle.

Having satisfied this criterion, Fig. 4(d) shows the final mesh with respect to the material threshold 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              0.1
                           . More adaptive meshes in terms of different material thresholds can also be found in Fig. 5
                           . In these adaptive meshes, denser elements are generated in the bottom area to approximate the rapid material composition changes as well as in the top area to approximate the curved boundary. Therefore the proposed adaptive meshing scheme guarantees mesh adaptivity with respect to both material heterogeneities and geometric facilities. It can also be noted that all the triangles in these meshes are well shaped and close to equilateral triangles.

To evaluate the quality of a mesh, we apply a common quality measure  [62], where the quality of a triangle 
                              T
                            is defined as 
                              
                                 (17)
                                 
                                    q
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    2
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             b
                                             +
                                             c
                                             −
                                             a
                                             )
                                          
                                          
                                             (
                                             c
                                             +
                                             a
                                             −
                                             b
                                             )
                                          
                                          
                                             (
                                             a
                                             +
                                             b
                                             −
                                             c
                                             )
                                          
                                       
                                       
                                          a
                                          b
                                          c
                                       
                                    
                                    .
                                 
                              
                            Here 
                              
                                 
                                    R
                                 
                                 
                                    T
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                            are the radii of the largest inscribed circle and the smallest circumscribed circle of 
                              T
                           , and 
                              a
                              ,
                              b
                              ,
                              c
                            are the side lengths of 
                              T
                           . Notice that equilateral triangles produce a maximum 
                              q
                            value of 1.0.

For a given triangulated mesh 
                              
                                 
                                    T
                                 
                                 
                                    ̃
                                 
                              
                           , we further define 
                              
                                 (18)
                                 
                                    
                                       
                                          q
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          T
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    q
                                    
                                       (
                                       T
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          q
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          T
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    q
                                    
                                       (
                                       T
                                       )
                                    
                                    ,
                                    
                                    and
                                    
                                    
                                       
                                          q
                                       
                                       
                                          a
                                          v
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          N
                                          u
                                          m
                                          
                                             (
                                             
                                                
                                                   T
                                                
                                                
                                                   ̃
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          T
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                    q
                                    
                                       (
                                       T
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    q
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            denotes the quality of the worst triangle, 
                              
                                 
                                    q
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            denotes the quality of the best triangle, and 
                              
                                 
                                    q
                                 
                                 
                                    a
                                    v
                                    g
                                 
                              
                            denotes the average quality of the mesh 
                              
                                 
                                    T
                                 
                                 
                                    ̃
                                 
                              
                           .


                           Table 1
                            lists some mesh statistics related to different meshing schemes for the heterogeneous model depicted in Fig. 3, which include the number of nodes 
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                           , the number of elements 
                              
                                 
                                    N
                                 
                                 
                                    e
                                 
                              
                           , the mesh quality 
                              q
                           , and the material composition variation over elements 
                              δ
                           . We remark that the uniform meshes here as well as in the rest of this paper are generated in SolidWorks. At all refinement levels in terms of the material threshold, the values of 
                              
                                 
                                    q
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    q
                                 
                                 
                                    a
                                    v
                                    g
                                 
                              
                            given in Table 1 illustrate that the quality of the adaptive meshes are always very good. One can also observe that the adaptive meshes are much more efficient than the uniform meshes, which are supported by the values of 
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                            and 
                              
                                 
                                    N
                                 
                                 
                                    e
                                 
                              
                           . For instance, to satisfy the material threshold 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              0.03
                           , 11,534 elements are generated in the uniform mesh, whereas only 3,815 elements are created in the adaptive mesh.

As mentioned earlier, an important property of the adaptive mesh is the equal distribution of the material composition variation over mesh elements. In order to verify this, Fig. 6
                            illustrates the distributions of material composition variation over elements of different meshes for the heterogeneous model depicted in Fig. 3. Notice that the material composition variation over elements of the adaptive mesh falls into the interval [0.0, 0.05], which is smaller than that of the uniform mesh, [0.0, 0.09]. More importantly, the material composition variation of a majority of elements in the adaptive mesh obviously concentrates to the interval [0.03, 0.04], which cannot be found in the uniform mesh. In addition, from Table 1, one can also note that the average material composition of the adaptive mesh (e.g. 0.0357) is much closer to the material threshold (e.g. 0.05) than that of the uniform mesh (e.g. 0.0172). In light of the above observations, the adaptive meshing scheme indeed distributes the material composition variation more equally than does the uniform meshing scheme.

In the above function-based heterogeneous model, it is assumed that the function is continuous and the derivative of the function exists. In practical applications, such a constraint is often too restrictive, and the representable material heterogeneity is therefore limited and simple. Complex (e.g. bidirectional or even tri-variate) heterogeneous material distributions have proven to perform better in certain applications, especially when the objects of interest have complex, irregular shapes or are subject to unbalanced loads  [20,63]. In these scenarios, it is challenging to represent complex material gradations with a single, analytic function throughout the entire geometric domain.

In our previous work  [41,42], we proposed to use dedicated tree data structures to represent heterogeneities that can hardly be represented with explicitly analytic functions. A HFT structure was proposed to organize the material variation dependencies[42,64] with one or more hierarchies. By definition, heterogeneous features (saved in a tree node) in the lower hierarchy represent the references from/to which the volume fractions vary, and the parent feature represents the heterogeneous objects. As an example, Fig. 7
                         shows a 2D heterogeneous object based on the HFT structure.

In this example, the 2D region 
                           
                              
                                 F
                              
                              
                                 2
                                 D
                              
                           
                        ’s material gradation is dependent on the boundary (
                           
                              
                                 F
                              
                              
                                 b
                              
                           
                        ) and interface (
                           
                              
                                 F
                              
                              
                                 i
                                 n
                                 t
                              
                           
                        ) curves; therefore, these curve features are saved as the child features of the region 
                           
                              
                                 F
                              
                              
                                 2
                                 D
                              
                           
                         (see Fig. 7(b)). For the boundary feature (
                           
                              
                                 F
                              
                              
                                 b
                              
                           
                        ), its material compositions are case specific, depending on the different location of the point of interest, as shown in Fig. 7(c). If the point is located between Circle A (
                           
                              
                                 C
                              
                              
                                 A
                              
                           
                        ) and Circle C (
                           
                              
                                 C
                              
                              
                                 C
                              
                           
                        ), the material composition of 
                           
                              
                                 C
                              
                              
                                 C
                              
                           
                         represents the material composition of the boundary feature; if the point is situated between 
                           
                              
                                 C
                              
                              
                                 A
                              
                           
                         and Circle B (
                           
                              
                                 C
                              
                              
                                 B
                              
                           
                        ), then 
                           
                              
                                 C
                              
                              
                                 B
                              
                           
                         represent the material composition of the boundary feature instead of 
                           
                              
                                 C
                              
                              
                                 C
                              
                           
                        . Therefore, 
                           
                              
                                 C
                              
                              
                                 B
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 C
                              
                           
                         are saved as the child features of 
                           
                              
                                 F
                              
                              
                                 b
                              
                           
                         (see Fig. 7(b)).

As is evident above, no analytic function is used to represent the heterogeneous material distribution, and the gradient function for the entire modeling domain is unknown or even does not exist. Therefore the approach presented in Section  3.2 cannot be directly migrated to the HFT-based model. Inspired by the hierarchical nature of the HFT structure, we propose a divide and conquer-based approach to tackle the adaptive meshing problem for the HFT-based model. The main steps of the proposed approach are listed as below:


                        
                           
                              (i)
                              Subdivide the domain of a HFT-based model into subregions that each subregion has one unique material distribution;

Calculate the density function in each subregion;

Combine all the density functions of subregions into a density function over the whole domain;

Generate an adaptive mesh of the HFT-based model with respect to the density function obtained in step (iii).

According to the HFT-based model depicted in Fig. 7, for an arbitrary point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            inside the domain, the constituent composition of one primary material at this point is defined as: 
                              
                                 (19)
                                 
                                    f
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    W
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             b
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             n
                                             t
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          M
                                       
                                       
                                          i
                                          n
                                          t
                                       
                                    
                                    +
                                    
                                       [
                                       1
                                       −
                                       W
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                b
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                i
                                                n
                                                t
                                                i
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       
                                          M
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                            where 
                              W
                            is a user defined weighting function, 
                              
                                 
                                    d
                                 
                                 
                                    i
                                    n
                                    t
                                    i
                                 
                              
                              /
                              
                                 
                                    d
                                 
                                 
                                    b
                                    i
                                 
                              
                            are the distances from 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            to the interface/boundary features, and 
                              
                                 
                                    M
                                 
                                 
                                    i
                                    n
                                    t
                                 
                              
                              /
                              
                                 
                                    M
                                 
                                 
                                    b
                                 
                              
                            are the material compositions (in terms of one primary material) of the interface/boundary features.

As the material composition of the boundary feature (
                              
                                 
                                    M
                                 
                                 
                                    b
                                 
                              
                           ) depends on its two child features (
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    C
                                 
                              
                           ), we split the domain into two subregions (
                              
                                 
                                    Ω
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    Ω
                                 
                                 
                                    2
                                 
                              
                           ), each of which has one unique material distribution, as shown in Fig. 7(c). Without loss of generality, the weighting function 
                              W
                            is defined separately on each subregion as 
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      n
                                                      t
                                                      i
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  i
                                                                  n
                                                                  t
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                             for  
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   1
                                                
                                             
                                             ;
                                          
                                       
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      n
                                                      t
                                                      i
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  i
                                                                  n
                                                                  t
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             
                                             for  
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

In the subregion 
                              
                                 
                                    Ω
                                 
                                 
                                    1
                                 
                              
                           , the material composition of an arbitrary point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            can be written as 
                              
                                 (21)
                                 
                                    f
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             A
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             B
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         b
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         A
                                                         B
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          M
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    M
                                 
                                 
                                    A
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    B
                                 
                              
                            denotes the material composition of 
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           , and 
                              
                                 
                                    d
                                 
                                 
                                    A
                                    B
                                 
                              
                            denotes the distance between 
                              
                                 
                                    C
                                 
                                 
                                    A
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    B
                                 
                              
                           , as shown in Fig. 7(c). Accordingly, the derivative of this material composition function can be calculated as: 
                              
                                 (22)
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       |
                                       ∇
                                       f
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   A
                                                
                                             
                                             −
                                             
                                                
                                                   M
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                          
                                          
                                             
                                                d
                                             
                                             
                                                b
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      A
                                                      B
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Substituting Eqs. (22) and (9) into with 
                              d
                              =
                              2
                            yields 
                              
                                 (23)
                                 
                                    ρ
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ≈
                                    g
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          16
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      A
                                                      B
                                                   
                                                
                                             
                                             
                                                8
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Using the same approach, it is easy to know that for an arbitrary point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            in 
                              
                                 
                                    Ω
                                 
                                 
                                    2
                                 
                              
                           , the density function can be written as 
                              
                                 (24)
                                 
                                    ρ
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ≈
                                    
                                       
                                          81
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                4
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      b
                                                      i
                                                   
                                                
                                             
                                             
                                                8
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      A
                                                      C
                                                   
                                                
                                             
                                             
                                                12
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Since the density function does not have to be continuous over the whole domain as mentioned earlier, we simply combine the density functions of subregions into a complete density function by 
                              
                                 (25)
                                 
                                    ρ
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ≈
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      16
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     A
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     B
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  A
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      81
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     A
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     C
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  A
                                                                  C
                                                               
                                                            
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      2
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Table 2
                            lists the coefficients of this density function, upon which the following adaptive meshing procedure depends.

Following the same approach as presented in Section  3.2, the adaptive mesh for the complex HFT-based heterogeneous model can be generated. Fig. 8
                            shows two adaptive meshes with respect to different material thresholds for the heterogeneous model depicted in Fig. 7. Note that denser elements are accumulated to the interface curve (the red curve) to approximate the rapid material composition changes as well as in the boundary areas to approximate the curved boundaries. Therefore the proposed adaptive meshing scheme guarantees mesh adaptivity with respect to both material heterogeneities and geometric facilities.


                           Table 3
                            lists some mesh statistics relative to different meshing schemes for the heterogeneous model depicted in Fig. 7. The values of 
                              
                                 
                                    q
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    q
                                 
                                 
                                    a
                                    v
                                    g
                                 
                              
                            given in Table 3 demonstrate that the quality of the adaptive meshes is always very good at all refinement levels in terms of the material threshold. One can also observe that the adaptive meshes are much more efficient than the uniform meshes. For instance, to satisfy the material threshold 
                              
                                 
                                    δ
                                 
                                 
                                    0
                                 
                              
                              =
                              0.05
                           , 34,231 elements are generated in the uniform mesh, whereas only 9,042 elements are created in the adaptive mesh.


                           Fig. 9
                            illustrates the distributions of material composition variation over the elements of different meshes for the heterogeneous model depicted in Fig. 7. Notice that the material composition variation over the elements of the adaptive mesh falls into the interval [0.0, 0.1], which is smaller than that of the uniform mesh, [0.0, 0.16]. More importantly, the material composition variation of a majority of elements in the adaptive mesh concentrates to the interval [0.06, 0.09], which cannot be found in the uniform mesh. In addition, from Table 3, it can be noted that the average material composition of the adaptive mesh (e.g. 0.0556) is much closer to the material threshold (e.g. 0.1) than that of the uniform mesh (e.g. 0.0287). In light of the above observations, the adaptive meshing scheme indeed distributes the material composition variation more equally than does the uniform meshing scheme. As a remark, the elements of the adaptive mesh whose material composition variations fall into the interval [0.0, 0.02], as shown in Fig. 9(a), result from the geometric approximation of the curved boundaries (see Fig. 8).

In this section, four case studies are presented to demonstrate the efficacy of the proposed adaptive meshing approach.

The first case study, as shown in Fig. 10
                        , is a heterogeneous turbine blade composed of two material constituents, ceramic (blue) and metal (red)  [65]. Generally, ceramic is used on the high temperature side to improve heat resistance; metal is used on the low temperature side to enhance the mechanical toughness; and a mixture layer of metal and ceramic is utilized at the interface between ceramic and metal to reduce the stress concentration. For the sake of simplicity, we here assume the whole domain is a mixture of ceramic and metal and the material distribution satisfies 
                           
                              (26)
                              
                                 f
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          P
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       c
                                       
                                          
                                             d
                                          
                                          
                                             P
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         where 
                           f
                         is the material composition of metal, 
                           c
                         is a constant that prevents the function value from exceeding 1.0, and 
                           
                              
                                 d
                              
                              
                                 P
                              
                           
                         is the distance from an arbitrary point 
                           P
                         to the outer boundary 
                           C
                         as shown in Fig. 10(b).

Since the material composition function is analytic, we apply the algorithm described in Section  3.2 to generate an adaptive mesh of this heterogeneous model. Fig. 10(c) shows the adaptive mesh where the material threshold 
                           
                              
                                 δ
                              
                              
                                 0
                              
                           
                           =
                           0.1
                        . As seen in Table 5 (at the end of Section  4.3), 8,301 elements are generated in the uniform mesh, whereas only 3,806 elements are created in the adaptive mesh. It also can be noted from Table 5 that the average material composition variation over the adaptive mesh (0.0413) is closer to the material threshold than that of the uniform mesh (0.0246); the mesh quality of the adaptive mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.915
                        ) is high and comparable to that of the uniform mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.950
                        ).


                        Fig. 11
                         shows a complex heterogeneous object based on the HFT structure. In this case study, the HFT structure is exactly the same as that of the example in Section  3.3, but the geometry is a little bit complicated. As seen in Fig. 11(c), both boundary feature and interface feature are composed of curves and straight lines.

Applying the adaptive meshing algorithm that has been discussed in Section  3.3, the adaptive mesh associated with the material threshold 
                           
                              
                                 δ
                              
                              
                                 0
                              
                           
                           =
                           0.1
                         is depicted in Fig. 11(d). As shown in Table 5, 66,922 elements are generated in the uniform mesh, whereas only 9,717 elements are created in the adaptive mesh. We can also note from Table 5 that the average material composition variation over the adaptive mesh (0.0648) is much closer to the material threshold (0.1) than that of the uniform mesh (0.0193); the mesh quality of the adaptive mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.9122
                        ) is high and comparable to that of the uniform mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.9608
                        ).


                        Fig. 12
                         shows a case study derived from  [37], in which the material heterogeneity is also represented by HFT structure. Fig. 12(a) shows the material composition of one of the primary materials (Ceramic), and Fig. 12(b) shows the topology of the tree data structure used to represent this heterogeneity.

In this example, the 2D region 
                           
                              
                                 F
                              
                              
                                 2
                                 D
                              
                           
                        ’s material gradation is dependent on the top (
                           
                              
                                 F
                              
                              
                                 t
                                 o
                                 p
                              
                           
                        ) and bottom (
                           
                              
                                 F
                              
                              
                                 b
                                 o
                                 t
                              
                           
                        ) curves; therefore, these curve features are saved as the child features of the region 
                           
                              
                                 F
                              
                              
                                 2
                                 D
                              
                           
                        . For the bottom composite curve (bound by AH), its material compositions are case specific, depending on the different location of the point of interest, as shown in Fig. 12(c). The material of composite curve is defined to be dependent on the five sub-features; these features are therefore saved as its child features. Similarly, the material gradations of the heterogeneous arc features (
                           
                              
                                 C
                              
                              
                                 B
                                 C
                                 D
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 E
                                 F
                                 G
                              
                           
                        ) are dependent on their end points, and the parent–child relationship is applied to encode such relations, as shown in Fig. 12(c). Apparently, the HFT structure of this case study is much more complex than those mentioned above.

For an arbitrary point 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         on the domain, the constituent composition of one primary material at this point is defined as 
                           
                              (27)
                              
                                 f
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 W
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          b
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          t
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       M
                                    
                                    
                                       b
                                    
                                 
                                 +
                                 
                                    [
                                    1
                                    −
                                    W
                                    
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             b
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             t
                                             i
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    
                                       M
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         where 
                           
                              
                                 d
                              
                              
                                 b
                                 i
                              
                           
                           /
                           
                              
                                 d
                              
                              
                                 t
                                 i
                              
                           
                         are the distances from 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         to the bottom/top features, 
                           
                              
                                 M
                              
                              
                                 b
                              
                           
                           /
                           
                              
                                 M
                              
                              
                                 t
                              
                           
                         are the material compositions (in terms of one primary material) of the bottom/top features, and 
                           W
                         is a user defined weighting function  [37]. In this case study, 
                           W
                         is defined as 
                           
                              (28)
                              
                                 W
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          b
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       exp
                                    
                                    
                                       −
                                       5
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   b
                                                
                                             
                                             +
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         Furthermore, the material compositions at leaf nodes of Fig. 12(b) are listed in Table 4
                        ,  and the material distributions on 
                           
                              
                                 C
                              
                              
                                 B
                                 C
                                 D
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 E
                                 F
                                 G
                              
                           
                         are defined as linear gradations along the arc length  [37].

With the material heterogeneity information defined above, the adaptive mesh associated with the material threshold 
                           
                              
                                 δ
                              
                              
                                 0
                              
                           
                           =
                           0.1
                         is generated as shown in Fig. 13
                        . It can be noted that several interface curves (the red ones) are embedded in the adaptive mesh at which the material composition function is not continuous (see Fig. 12(a)) and no triangle elements straddle these interface curves. In this way, abrupt material composition changes within elements are effectively avoided. As shown in Table 5, to satisfy the material threshold 
                           
                              
                                 δ
                              
                              
                                 0
                              
                           
                           =
                           0.1
                        , 29,758 elements are generated in the uniform mesh whereas only 2,329 elements are created in the adaptive mesh. One can also observe that the average material composition variation over the adaptive mesh (0.0706) is much closer to the material threshold (0.1) than that of the uniform mesh (0.0125); the mesh quality of the adaptive mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.9376
                        ) is higher than that of the uniform mesh (
                           
                              
                                 q
                              
                              
                                 a
                                 v
                                 g
                              
                           
                           =
                           0.9217
                        ).

We next provide the fourth case study to illustrate the advantages of adaptive mesh over uniform mesh in terms of FEA computational performances. In this case study, the heterogeneous model under investigation has been shown in case study 3. Thermal–mechanical analysis is conducted on this heterogeneous model by using the adaptive mesh and uniform mesh, respectively, and FEA computational performances of both meshes are compared.

We assume that two material ingredients embedded in this heterogeneous model are Al2O3 (ceramic) and Ni (metal), whose properties  [20,37] are listed in Table 6
                        . Fig. 14
                         shows the boundary conditions for FEA of this heterogeneous model. Two heat sources, 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 1
                              
                           
                         (1173.15 K) and 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 2
                              
                           
                         (873.15 K), are located at the semicircle 
                           
                              
                                 C
                              
                              
                                 B
                                 C
                                 D
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 E
                                 F
                                 G
                              
                           
                        , respectively. The top of this model (straight line 
                           
                              
                                 L
                              
                              
                                 M
                                 N
                              
                           
                        ) is constrained to the room temperature (
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                           =
                           273.15
                           
                           
                              K
                           
                        ). Besides the thermal constraints, the mechanical constraints are defined that node A in Fig. 14 is constrained completely and node H is constrained against displacement in the vertical direction. For illustration purposes, the materials are assumed to be linear elastic and isotropic and only steady-state thermal conduction is considered. The thermal–structural problem is studied under the well-established plane strain assumption. Note that the boundary condition, loads and the finite element model are intentionally kept the same as those reported in  [37] for comparative reasons.

To conduct the thermal–mechanical analysis, we implement a commercial FEA package, COMSOL Multiphysics, into which the adaptive meshes can be imported. For the sake of simplicity, we will not restate the implementation details which have been comprehensively described in  [37]. Table 7
                         compares the FEA results of adaptive meshes with those of uniform meshes. Von Mises stresses are calculated at six test points, 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           6
                        , as depicted in Fig. 14. As no exact solutions can be referred to in the literature, we use the stress values with respect to 4600 uniform elements (see the italic data set in Table 7) as the reference values. Note from Table 7 that more accurate solutions can be obtained if we apply the adaptive mesh rather than the uniform mesh with nearly identical number of elements. It can also be noted that one can achieve very accurate solutions by using the adaptive mesh with 633 elements, but to obtain a comparatively accurate solution using the uniform mesh, this number is 931 (see the highlighted data sets in Table 7). In this example, a 32% mesh reduction is achieved using the adaptive mesh without sacrifice in FEA qualities.

Adaptive meshing for FEA of heterogeneous material objects is investigated in this paper. The major contributions of this paper includes: the material heterogeneity information is fully exploited in the mesh generation process, and a generic approach is proposed to generate adaptive meshes for various types of heterogeneous material models. Though only two types of heterogeneous objects are referred to, the proposed adaptive meshing method is generally applicable to other heterogeneous object representations that have been discussed in  [1]. In the proposed approach, a CVT-based method is employed to govern mesh adaptation according to a density function related to the material distribution. Armed with such a density function, one can control the allocation of mesh nodes to obtain an equal distribution of material composition variation over elements and hence minimize the number of elements in terms of a predefined material threshold. To our knowledge, there seems to be no similar methods that can achieve such a flexible control on the adaptive mesh in the context of mesh generation of heterogeneous materials. In addition, an adaptive sampling technique is developed to evaluate the validity of a mesh in terms of the material threshold. In this technique, the nodes of CVT-based meshes serve as sample points directly and thus the material composition variation within each element is calculated by just interrogating the material compositions at its vertices. In traditional approaches, however, substantial material interrogations at a large number of sampling points have to be called for.

We have successfully applied the proposed approach into several benchmarking case studies. Our numerical experiments show that the proposed approach can tackle adaptive meshing problems for heterogeneous objects with both complex geometries and material distributions. In particular, non-continuous material gradation problem can also be solved by using a divide and conquer-based method. Benefiting from CVT’s superior properties, no matter how complicated a heterogeneous model is, the proposed approach can always generate a high quality mesh. In addition, the experiments illustrate that the proposed approach can approximate the material distribution well (or satisfy the material threshold) with significantly less elements compared to the uniform mesh. Finally, FEA results demonstrate that the proposed approach can obtain significant reduction of mesh elements without sacrifice of FEA qualities.

The proposed method currently targets at adaptive mesh generation for 2D heterogeneous objects only and it is, however, a nontrivial task to directly extend it to adaptive meshing of 3D heterogeneous objects, though tetrahedral mesh generation based on CVT has been studied in  [50]. The main reason is that CVT-based tetrahedral mesh generation cannot fully eliminate the degenerated elements (e.g. slivers), while CVT-based triangular meshing can always guarantee high-quality meshes (provided the input domain has no sharp angles). In recent years, some researchers have proposed that using Optimal Delaunay Triangulation (ODT)-based techniques (alternative to CVT-based methods) can significantly reduce the number of slivers in the tetrahedral meshes and thus improve the mesh quality  [66,67]. In the future work, we are going to extend the presented approach to 3D elements in quest for adaptive tetrahedral mesh generation methods based on ODT approaches.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the Research Grant Council of HKUSAR Government and the Department of mechanical Engineering, the University of Hong Kong for supporting this project [HKU717409E].

@&#REFERENCES@&#

