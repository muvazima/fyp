@&#MAIN-TITLE@&#Modeling multiuser spectrum allocation for cognitive radio networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A scheme is proposed to allocate bands among multiple cognitive radio users.


                        
                        
                           
                           Suitability-Throughput Gain defines the suitability of a band for contending users.


                        
                        
                           
                           The scheme takes into account the impact of allocating a band to a user on others.


                        
                        
                           
                           It offers higher user satisfaction, less collision and better spectrum utilization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cognitive radio networks

Spectrum allocation

Dynamic spectrum access

Cooperative spectrum sensing

Spectrum utilizations

Interference loss

@&#ABSTRACT@&#


               
               
                  Spectrum allocation scheme in cognitive radio networks (CRNs) becomes complex when multiple CR users concomitantly need to be allocated new and suitable bands once the primary user returns. Most existing schemes focus on the gain of individual users, ignoring the effect of an allocation on other users and rely on the ‘periodic sensing and transmission’ cycle which reduces spectrum utilization. This paper introduces a scheme that exploits collaboration among users to detect PU’s return which relieves active CR users from the sensing task, and thereby improves spectrum utilization. It defines a Capacity of Service (CoS) metric based on the optimal sensing parameters which measures the suitability of a band for each contending user and takes into consideration the impact of allocating a particular band on other band seeking users. The proposed scheme significantly improves capacity of service, reduces interference loss and collision, and hence, enhances dynamic spectrum access capabilities.
               
            

@&#INTRODUCTION@&#

The use of cognitive radio (CR) technology allows radio devices to opportunistically access the radio frequency (RF) spectrum in an unlicensed fashion. The RF operation of a CR (i.e., secondary/unlicensed user) involves three major mechanisms: spectrum sensing, spectrum use, and spectrum switching. Spectrum sensing is used to find white spaces (vacant band) in licensed bands and does not interfere with the licensed networks’ activities. The most widely accepted method for detecting white spaces is energy detection based cooperative spectrum sensing [1]. After finding a suitable white space, the secondary user starts using that band and continues until it detects the return of the primary user (PU). At that point, it quickly evacuates the band to inflict minimum interference on the primary system [2]. Finally, the secondary user (SU) has to find and switch to another vacant band to resume transmission. However, finding a vacant band, assessing its suitability to SU’s need and switching smoothly to that band to continue uninterrupted transmission are the most critical factors affecting this mechanism.

Early works on spectrum allocation primarily focused on a simple scenario where a single SU requires finding and switching to the most appropriate band from a number of available vacant bands. Recent works have focused on a more complex but general scenario where multiple SUs require multiple bands for seamless transmission. The critical task in this scenario is to find currently unused licensed bands and allocate them among these users efficiently. In such band allocation, candidate bands’ suitability in meeting respective SU’s requirement as well as throughput achievable should be taken in consideration. Existing researches often use ‘periodic sensing’ (i.e., an SU senses and transmits in alternate cycle) and assume a priori knowledge on PU usage pattern. But ‘periodic sensing’ reduces spectrum utilization due to the time wasted in sensing and the usage pattern of PUs is most likely to vary over time. Another issue is the possible conflict arising from the selection of the same band at the same time by two or more users and has also generally been ignored in literature. Therefore, the following issues need to be addressed for real world implementation of CR networks: (i) improving sensing scheme and spectrum utilization removing the drawbacks of ‘periodic sensing’, such scheme should not depend on the known PU usage pattern; (ii) allocation of vacant bands among multiple users concomitantly in a way that meets individual SU’s requirement while maximizing utility gain; and (iii) resolution of any conflict when the same band is equally suitable for multiple SUs.

In this paper, we introduce a collaborative spectrum band allocation framework for cognitive radio networks where multiple users simultaneously seek spectrum bands for transmission. Our framework allocates spectrum bands to both types of users - new incoming users and ongoing users who are already using some other bands and need to change bands quickly due to the return of the corresponding licensed users. To develop this framework, we first propose a sensing model based on energy detection where non-active users (i.e., users that are not using any licensed band currently) are split into two groups, sensing and idle, based on some appropriate criteria. By selectively keeping the idle group silent and engaging the sensing group into cooperative spectrum sensing, the scheme achieves accurate sensing results and allows continuous spectrum utilization by active users, eliminating the necessity and essentially the drawbacks of periodic sensing [2]. We then define two parameters to determine suitability of a band once it is found vacant via spectrum sensing. One is named suitability throughput gain (STG) which is a measure of throughput of a utilized spectrum band and its suitability to a specific user, and the other is interference loss (IL) which we formulate to reflect the loss due to inflicted interference on the primary user. In order to maximize STG keeping IL below a certain level, we formulate a maximization problem to optimize the sensing time-bandwidth product and decision threshold of a set of energy detectors working in parallel for spectrum sensing over multiple spectrum bands. Based on STG and IL, a combined decision is taken to allocate unique spectrum bands to all the secondary users currently requesting for bands. In this respect, our proposed framework offers: (i) devising a collaborative spectrum sensing model that offers accurate sensing and better spectrum utilization, (ii) allocation of spectrum bands among multiple users aiming to maximize the spectrum efficiency and gain, and (iii) a solution to mitigate the collisions among users in selecting spectrum bands.

This paper is organized as follows. Section 2 presents the related background literature along with their limitations and the necessity of the proposed framework. Section 3 describes the network structure and the sensing model incorporated in our proposed framework. The parameters influencing the formulation of the optimization problem and their impact on the allocation scheme are discussed in Section 4. Section 5 formulates the optimization problem to maximize the suitability throughput gain and the solution is analyzed. The proposed spectrum allocation techniques based on the solution is presented in Section 6 and their performances are analyzed in Section 7. Finally, the paper is concluded with some remarks in Section 8.

@&#RELATED WORKS@&#

In spectrum allocation, the most common practice in the literature is selecting a band from a set based on its service properties. The spectrum pooling technique is considered to be the first approach for selection of a band. In this approach, spectrum bands from different owners (military, trunk radio, etc.) are merged into a common pool. From this pool, an SU may temporarily use a licensed band during its idle periods. To select the most appropriate band, a covariance matrix based cooperative detection method is used. The optimal capacity of the spectrum pool as well as two update strategies were investigated in [3] to determine the relationship between the optimal capacity of the spectrum pool and the system efficiency. One limitation of spectrum pooling is its size; if the pool is too small, then possibility exists that none of the bands in the pool will have a vacant band. Conversely, if the pool is too large, the usage of the vacant band will depend solely on the sensing ability of the SU and in this case the need to form a pool is questionable.

Another approach is to adjust the sensing parameters and to consider long term channel selection probability to find an appropriate band for an individual CR. In [4], a bank of narrowband energy detectors is jointly optimized to maximize the opportunistic throughput capacity and limit interference to the primary system. Long term channel observation is incorporated in a probability-based channel selection scheme in [5]. This scheme allows the CR to select a channel which has a lower probability of being interrupted by PU transmission. Analysis in [6] suggests that probability-based scheme require shorter system time (interval between data arrival at system to transmission) than sensing-based scheme at low SU traffic load and vice versa. However, one major shortcoming of this scheme is that a CR may select a band that has low PU transmission probability but is currently engaged.

A Least Cost First Serve (LCFS) scheduling algorithm for selecting a band from the available spectrum bands was proposed by Lee and Akyildiz in [7]. Assuming separate sensing and transmission periods, this scheme represents the sensing and transmission duration as functions of the average false alarm probability and optimizes them to maximize the opportunistic sensing capacity. Once the parameters are optimized, an opportunity cost is calculated for each band and the current time slot is assigned to the band with minimum opportunity cost. However, a major drawback of this scheme is that the PU transmission characteristics must be known to the CR system. Another limitation is that this approach assumes periodic sensing which reduces the spectrum utilization.

Some recent literature propose schemes to accommodate multiple SUs in multiple available bands. In that effort, an adaptive spectrum allocation method for centralized CR networks (with a secondary base station/ scheduling server and common control channel) was proposed by Yang et al. in [8]. In this method, a ‘Free Time Ratio’ (FTR) (i.e., fraction of free time over a certain interval) of a band was defined and estimated periodically by the CRs and shared through the control channel. A scheduling server then allocates a CR a band with the maximum achievable FTR for that CR. The allocation is then broadcast to all other CRs who can then access other bands according to their FTR value. In [9], a method was proposed that divides the target spectrum bands into a number of blocks and ‘squeezes’ a number of CRs into these blocks, ignoring their band requirements. The common drawback of these methods is that the average throughput reduces when the number of users increases. Moreover, the continuous rearrangement of spectrum bands already occupied with CRs requires a big overhead and consequently lowers the spectrum utilization. The work in [7] was later extended in [10] for centralized CR networks and proposed a spectrum decision framework that considers CR characteristics (e.g., application types and requirements) and PU activities either to minimize capacity variations among CRs or to maximize total network capacity. However, the framework is still based on alternate sensing and transmission cycles, and assumes multiple simultaneous transmissions in multiple non-contiguous bands by CR networks and known PU activity.

A spectrum allocation scheme was presented in [11] to utilize the open spectrum bands in CR networks. This scheme adopts a power control strategy to attain maximum end-to-end throughput in a multihop CR transmission link. The major drawback of this approach is employing multiple hops for a single transmission which wastes valuable white spaces and drains the power of the participating mobile radios (CRs). Utilizing the interference temperature to co-exist in a band with a licensed user is also another weak aspect as this restricts the transmission power of the CRs, thus failing them to attain the service level of current mobile devices. In [12], Wang et al. presented a technique of spectrum sharing using a selection diversity scheme for centralized CR networks by analyzing the secondary link capacity. This approach offers a closed-form expression of the capacity of an SU under Rayleigh fading conditions. From this expression, the capacity gains for multiuser and multispectra are separately found, depending only on the number of selectable licensed bands and SUs, respectively. However, this method only considers the gain of individual users using a specific spectrum band, ignoring the effect on other users when a band is assigned to a particular user.

In [13], Ding et al. defined a parameter called sensing confidence level based on the hard or soft sensing information and formulated a joint spectrum and power allocation policy as an optimization problem while keeping peak power budget and interference to PU within limits. However, the allocation based on hard sensing information reduces the system throughput and a trade-off exits between the system performance and sensing overhead. In [14], Liu et al. proposed a service-oriented spectrum allocation scheme by defining four reward matrices, namely, bandwidth, transmission power, spectrum availability and packet loss, and combined them using a preference weight to form a comprehensive reward matrix. Spectrum allocation based on this reward matrix was done using particle swarm optimization (PSO) method. However, the scheme is not very scalable as network scale has large impact on the computation, convergence and convergence rate of PSO. Also, when the competition is intense, the scheme tends to allocate spectrum to previous users which is not fair. Game or auction theory based approaches (e.g., [15–17]) are often used in allocating spectrum bands among multiple users, but the drawbacks are that the secondary network often need interaction with the primary system and in some cases reaching the equilibrium takes long time. Also, in auction based schemes secondary users have to pay for the spectrum usages. Beside these, there are few works on spectrum allocation that are generally transmission system specific (e.g., TDMA [18]) and suffer from a low secondary system throughput.

In the following, we describe the CR network and the sensing model to be used to meet the requirements of the spectrum allocation framework.

The CR network structure in this proposed allocation scheme is a typical centralized CR network, that is, an IEEE 802.22 standard CR network (http://www.ieee802.org/22, [19]) with a common control channel (CCC) and a secondary base station (SBS) but without any knowledge of the primary system usage pattern. The CRs are considered location aware, as per the same standard. However, unlike the model where a single primary user (PU), i.e., a single licensed band was considered (e.g., [2]), we now consider an RF environment with multiple licensed bands (multiple PUs) and a number of CRs among which some are already transmitting in licensed bands. The rest of the bands are either already occupied by PUs or vacant. All the CRs are controlled by a central controller named Band (Spectrum) Manager which communicates with them through a CCC. The band manager is located at the base station, and facilitates spectrum sensing through coordination among CRs and assumes a managing role in sharing and allocating spectrum. A snapshot of a CR scenario is presented in Fig. 1
                        .

In this scenario, 40 CRs are randomly spread over a two sq-km area. Among them, five CRs are currently transmitting using vacant licensed bands and termed as ‘active users’ (green circles). Assume that there are a total of 16 accessible spectrum bands in this particular region at present. As shown in Fig. 2
                        , five of them are being used by the active users, seven are occupied by the PUs and the rest are vacant. Suppose at a given instant, three of the active users are required to stop transmission because of PUs’ return to their bands (shown with an X in the figure). Our target is to distribute the vacant bands among the evacuating active users as well as to all new incoming users, which may result in situations where the number of band-seeking users exceeds the available bands. However, as there is no difference between the band allocation techniques for these two types of users (incoming and existing), we develop our framework around the evacuating users to cover a more generalized scenario. Spectrum allocation should be carried out in such a manner that all or as many users as possible
                           1
                        
                        
                           1
                           This case would occur when the number of vacant bands are lower than the total number of band demanding users.
                         get the best available bands without hampering the global user satisfaction and keeping the conflict among them to a minimum. We implement this process by means of the following steps:

                           
                              •
                              Detecting the return of PUs in active users’ transmitting bands.

Finding the vacant bands from the rest of the bands.

Optimizing the sensing parameters to find the best available band for each user.

Efficiently allocating these bands among the users so that the global user satisfaction is maximized.

The first step requires detection of PUs’ return to active users’ bands and the second step is to find vacant bands. Both steps require spectrum sensing in this given scenario which is described below. The third and fourth steps are dealt in Sections 4–6.

We model the primary user detection problem on band k (=1, 2, … , K) as a binary hypothesis testing problem where 
                           
                              H
                              
                                 0
                                 ,
                                 k
                              
                           
                        (0) represents the absence of PU, and 
                           
                              H
                              
                                 1
                                 ,
                                 k
                              
                           
                        (1) represents its presence on band k (k ∈ SK, SK
                         being the set of all K bands). To devise the spectrum allocation scheme, we need to detect the presence/absence of PU in all K bands. A bank of multiple narrowband energy detectors is used for simultaneous sensing of PUs over these K bands. However, depending on the band occupancy by active CRs, we divide this detection problem into two categories: one involves detection in L bands which are currently occupied by active CRs but needs to be sensed for PUs’ return and the other deals with sensing the rest 
                           
                              K
                              −
                              L
                           
                         bands to identify any spectrum holes. To carry out these tasks, we employ a soft decision based cooperative spectrum sensing method where the individual measurements by a group of dedicated sensing users are combined by the band manager and then compared to a threshold to find the final single bit decision.

Let us consider Fig. 1 where each green circle denotes an active user uc
                         (
                           
                              c
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              L
                           
                        ) in the active user set Sc
                        . The rest of the CRs (grey/blue squares) are termed as non-active users and defined by the sets Snc
                        . The shaded area around each uc
                         is termed as ‘idle user region’ where the impact due to its transmission is maximum. As a result, a non-active user in this region (hatched squares) cannot be reliably used to detect the return of PU on the transmission band of uc
                        . Such a user is denoted as an idle user (uzc
                        ), forming an idle user set 
                           
                              S
                              
                                 i
                                 d
                                 l
                              
                              c
                           
                         for band c. The rest of the users receive lower signal energy from uc
                         and hence can be used to detect the return of PU on band c reliably. Therefore, these users are the candidates to sense PU’s return and a subset of this set is used as the sensing set 
                           
                              S
                              
                                 s
                                 e
                                 n
                              
                              c
                           
                         for band c. The segregation of the users into the idle and sensing sets is described below.

To separate the sensing and idle users in a CR network, we utilize the energy detection based cooperative sensing scheme proposed in our earlier work [2]. Sensing users for a particular uc
                         are extracted by assigning a partition factor wic
                         to each non active user ui
                         (
                           
                              i
                              =
                              1
                              ,
                              
                              2
                              ,
                              
                              3
                              ,
                              …
                              ,
                              
                              n
                              ;
                              
                              
                                 u
                                 i
                              
                              ¬
                              ¬
                              ∉
                              
                                 S
                                 c
                              
                           
                        ). This partition factor depends on the physical distance dic
                         of user ui
                         from the active user uc
                         and its (ui
                        ) received energy Yic
                         due to the transmission of uc
                        . We define wic
                         as

                           
                              (1)
                              
                                 
                                    
                                       w
                                       
                                          i
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Y
                                             
                                                i
                                                c
                                             
                                          
                                          /
                                          
                                             Y
                                             
                                                m
                                                c
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                d
                                                
                                                   i
                                                   c
                                                
                                             
                                             /
                                             
                                                d
                                                
                                                   m
                                                   c
                                                
                                             
                                             )
                                          
                                          ν
                                       
                                    
                                    ,
                                 
                              
                           
                        where, ν is the path loss factor, 
                           
                              
                                 Y
                                 
                                    m
                                    c
                                 
                              
                              =
                              ∑
                              
                                 Y
                                 
                                    i
                                    c
                                 
                              
                              /
                              n
                           
                         and dmc
                         is the mean distance of all ui
                        s from the uc
                        . Then, we define a sensing user 
                           
                              
                                 u
                                 
                                    s
                                    c
                                 
                              
                              =
                              
                                 u
                                 i
                              
                              
                                 |
                              
                              
                                 w
                                 
                                    i
                                    c
                                 
                              
                              <
                              
                                 w
                                 *
                              
                              ,
                           
                         
                        w* being the value of partition factor which defines the idle user region. The value of the partition factor should be such that the sensing users can offer the maximum sensing accuracy. However, as w* does not have explicit mathematical relationship with sensing accuracy, we cannot find the optimum partition threshold mathematically. Therefore, we have adopted empirical analysis to find the optimum partition threshold that provides the maximum detection probability (Ψdk
                         in Eq. (2)), i.e., minimum missed detection probability (
                           
                              
                                 Ψ
                                 
                                    m
                                    k
                                 
                              
                              =
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    k
                                 
                              
                           
                        ) for a given value of false alarm (Ψfk
                         in Eq. (3)). To do this, we randomly created 100 scenarios and found the optimum w* numerically for different number of non-active users n. As Fig. 3
                         illustrates, changing the values of w* changes the formation of the sensing set and hence changes the probability of missed detection (Ψmk
                        ). Experiments in Fig. 3 indicates that a w* value between 0.5 and 1.0 provides minimum missed detection value and hence minimum interference is expected for a certain false alarm probability; suggesting this range appropriate for w*. Therefore, any of the non-active users with wic
                         < w* can act as a sensing user for uc
                        . However, in this particular work, for uniformity we select a fixed size subgroup of the size l from all sensing users usc
                         for each uc
                        . Therefore, for each of the L bands, we find dedicated set of sensing users 
                           
                              
                                 u
                                 
                                    s
                                    c
                                 
                              
                              =
                              
                                 u
                                 i
                              
                              
                                 |
                              
                              
                                 w
                                 
                                    i
                                    c
                                 
                              
                              <
                              
                                 w
                                 *
                              
                              ,
                           
                         (
                           
                              s
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              l
                           
                         and 
                           
                              c
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              L
                           
                        ). However, when the sensing is performed on the rest 
                           
                              K
                              −
                              L
                           
                         bands where no active user is present, it is not possible to calculate the values of the partition factor, and hence, the last used partition factor values are considered. Combining the individual measurements by sensing users, a final decision on band k’s occupancy is taken by the band manager. This decision process incorporates partition factor wsk
                         (corresponding to sensing user usk
                         and band k), the detected energy levels and a success parameter ηsk
                         calculated from the previous history of usk
                         in correctly predicting PU’s existence (details in [2]). In this way, the set of vacant bands 
                           
                              
                                 S
                                 B
                              
                              
                                 (
                                 |
                              
                              
                                 S
                                 B
                              
                              
                                 |
                                 =
                                 B
                                 )
                              
                           
                         are found. Note that the set of vacant bands 
                           
                              S
                              B
                           
                         is always a subset of the set of bands 
                           
                              S
                              
                                 K
                                 −
                                 L
                              
                           
                         not occupied by the active users, because among these 
                           
                              K
                              −
                              L
                           
                         bands some may be occupied by primary users.

The performance of any sensing based decision is measured mainly in terms of probabilities of detection and false alarm. As our scheme is based on sensing, we determine the theoretical probabilities of detection Ψd
                         and of false alarm Ψf
                         as the key performance metrics. We use the Nyquist Criterion [20] to calculate these probabilities and express them by means of Gaussian Q function as

                           
                              (2)
                              
                                 
                                    
                                       Ψ
                                       
                                          d
                                          k
                                       
                                    
                                    =
                                    Q
                                    
                                       (
                                       
                                          
                                             
                                                Λ
                                                k
                                             
                                             −
                                             2
                                             
                                                r
                                                k
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                l
                                             
                                             
                                                
                                                   
                                                      γ
                                                      
                                                         p
                                                         
                                                            s
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      η
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                
                                                
                                                   w
                                                   
                                                      s
                                                      k
                                                   
                                                
                                             
                                          
                                          
                                             
                                                4
                                                
                                                   r
                                                   k
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   l
                                                
                                                
                                                   
                                                      η
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       Ψ
                                       
                                          f
                                          k
                                       
                                    
                                    =
                                    Q
                                    
                                       (
                                       
                                          
                                             Λ
                                             k
                                          
                                          
                                             
                                                4
                                                
                                                   r
                                                   k
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   l
                                                
                                                
                                                   
                                                      η
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Here, ηsk
                         is the success parameter of user us, Λk
                         is the decision threshold, and rk
                         represents the product of the sampling time for energy sensing and the bandwidth of the band k. Having derived these probabilities, we define other factors which influence the selection of a band for a particular user, and hence, contribute to the final allocation process.

In addition to the above metrics, factors that should be considered in allocating a band to a user include the properties of the spectrum bands, the requirements of the SUs and the impacts that PUs have on band usage. In the following, we define and formulate these factors and analyze their impacts on spectrum selection.

Band factors reflect the properties or requirements of a band or the PU using the band. These factors remain the same regardless of the number or requirements of the SUs. The components of band factors are described below.

In CR networks, users are highly likely to use spectrum bands under strict time constraints and this makes a spectrum band with a higher throughput preferable to all users. For this reason, a user uc
                            should consider the achievable throughput when selecting a band from 
                              B
                            available bands. We denote the throughput achievable for an available band b as 
                              
                                 g
                                 
                                    b
                                 
                                 
                                    
                                    ′
                                 
                              
                            (
                              
                                 b
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 .
                                 .
                                 .
                                 ,
                                 B
                                 )
                              
                            and then normalize it over 
                              B
                            to find the normalized throughput gb
                            as

                              
                                 (4)
                                 
                                    
                                       
                                          g
                                          b
                                       
                                       =
                                       
                                          
                                             g
                                             
                                                b
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   b
                                                   =
                                                   1
                                                
                                                B
                                             
                                             
                                                g
                                                
                                                   b
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

A key requirement by the primary system is that the interference (due to a SU using a licensed band) should be kept below a recommended value (depends on the interference tolerance ability of a PU) and not exceeding a certain duration. We define two parameters to describe the interference tolerance limit of the PU in band b: the tolerable interference duration TIb
                            (ms) and the tolerable interference energy WIb
                            (Watt). We multiply these values to define the measure of interference limit of the primary user as

                              
                                 (5)
                                 
                                    
                                       
                                          h
                                          b
                                       
                                       =
                                       
                                          W
                                          
                                             I
                                             b
                                          
                                       
                                       
                                          T
                                          
                                             I
                                             b
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The value of hb
                            indicates the impact of inflicted interference on the primary system and a higher value means a more relaxed interference constraint. We define the interference cost as 
                              
                                 
                                    κ
                                    
                                       b
                                    
                                    ′
                                 
                                 =
                                 1
                                 /
                                 
                                    h
                                    b
                                 
                              
                            and the normalized cost over all 
                              B
                            bands is given by

                              
                                 (6)
                                 
                                    
                                       
                                          κ
                                          b
                                       
                                       =
                                       
                                          
                                             κ
                                             
                                                b
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   b
                                                   =
                                                   1
                                                
                                                B
                                             
                                             
                                                κ
                                                
                                                   b
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

By suitability factor we define a band’s quality in becoming a candidate band to be assigned to an active evacuating user. It incorporates the influence of the secondary and primary users’ previous use of a particular band. It consists of two parts: the secondary user inclination factor and the primary user impact factor.

An active user uc
                            is considered to be inclined towards a band b if it meets two of its (uc
                           ) basic requirements

                              
                                 •
                                 The availability of the band for frequent access by that particular active user.

Less interruptions in communication, i.e., longer possible transmission times when the band is accessed.

Combining these two factors, we define the inclination factor of a secondary user. Assuming 
                              Z
                            as the count of previous active times of uc
                            and Tbi
                            as the duration of uc
                           ’s residence on band b on the ith active time (
                              
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 .
                                 .
                                 .
                                 ,
                                 Z
                              
                           ), we express secondary user uc
                           ’s inclination factor αcb
                            towards band b as

                              
                                 (7)
                                 
                                    
                                       
                                          α
                                          
                                             c
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             m
                                             a
                                             x
                                             (
                                             
                                                T
                                                
                                                   b
                                                   i
                                                
                                             
                                             |
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             .
                                             .
                                             .
                                             ,
                                             Z
                                             )
                                          
                                          
                                             
                                                ∑
                                                
                                                   b
                                                   =
                                                   1
                                                
                                                B
                                             
                                             m
                                             a
                                             x
                                             
                                                (
                                                
                                                   T
                                                   
                                                      b
                                                      i
                                                   
                                                
                                                |
                                                i
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                .
                                                .
                                                .
                                                ,
                                                Z
                                                )
                                             
                                          
                                       
                                       .
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                Z
                                             
                                             
                                                x
                                                
                                                   b
                                                   i
                                                
                                             
                                          
                                          Z
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    x
                                    
                                       b
                                       i
                                    
                                 
                                 =
                                 1
                              
                            if the band b was used by uc
                            on its i-th active time, otherwise 
                              
                                 
                                    x
                                    
                                       b
                                       i
                                    
                                 
                                 =
                                 0
                              
                           . Here, the first term represents the fraction of the longest time that uc
                            spent on band b in the previous 
                              Z
                            active times while the second term indicates the fraction of the number of times uc
                            used band b. An illustrative example of a secondary user’s inclination towards a band is depicted in Fig. 4
                           . From the figure, it is clear that an evacuating active user uc
                            is more inclined towards band 1 than band 2 as the former offers more access and a longer maximum transmission time than the latter.

The impact of primary transmitter’s (PT) band usage on the band selection by band-seeking CRs can be calculated by the fraction of the frequency of occurrence and the fraction of time spent by the PT on band b. If V is the count of the cumulative number of previous occurrences of PTs on all 
                              B
                            bands, then we define the impact of PT, βb
                           , on band b as

                              
                                 (8)
                                 
                                    
                                       
                                          β
                                          b
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                V
                                             
                                             
                                                P
                                                
                                                   b
                                                   j
                                                
                                             
                                          
                                          V
                                       
                                       .
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                V
                                             
                                             
                                                T
                                                
                                                   b
                                                   j
                                                
                                                P
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                V
                                             
                                             
                                                ∑
                                                
                                                   b
                                                   =
                                                   1
                                                
                                                B
                                             
                                             
                                                T
                                                
                                                   b
                                                   j
                                                
                                                P
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    P
                                    
                                       b
                                       j
                                    
                                 
                                 =
                                 1
                              
                            when the PT appears on band b at the jth count, 0 otherwise; and 
                              
                                 T
                                 
                                    b
                                    j
                                 
                                 P
                              
                            indicates the length of the stay. The impact of PT on band selection is illustrated in Fig. 5
                           . From the figure, it is clear that band 2 is preferred over band 1 by uc
                           , as the impact of PT on band 1 is higher.

From the above discussion, it is evident that if a secondary user experiences a higher inclination towards a particular band, then that band is more suitable to the user. On the other hand, a higher impact of a primary transmitter on its designated band yields a lower suitability of that band to the secondary user and vice versa. Therefore, we define the suitability factor of band b to a user uc
                            as

                              
                                 (9)
                                 
                                    
                                       
                                          δ
                                          
                                             c
                                             b
                                          
                                       
                                       =
                                       
                                          α
                                          
                                             c
                                             b
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             β
                                             b
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           The sensing information comprising of the probability of detection (Eq. (2)) and false alarm (Eq. (3)) along with the parameters formulated above in Eqs. (6) and(9)
are combined to define the suitability-throughput gain (STG) and interference loss (IL) as presented in the following subsection.

STG represents the expected throughput of a particular spectrum band once it is being used and the secondary user’s bias towards it. We define STG as a measure of the preference of a secondary user towards utilizing a licensed spectrum band in terms of the probability of false alarm, achievable throughput, and its suitability [21]. A spectrum band is preferable to a secondary user whenever: a) it is suitable as per the measure δcb
                        , b) it has good throughput (gb
                        ), and c) it can be better utilized due to a lower false alarm probability (
                           
                              Ψ
                              
                                 f
                                 b
                              
                              c
                           
                        ). Combining these three factors and using Eqs. (3), (4) and (9), we define the STG for a band b of a user uc
                         as

                           
                              (10)
                              
                                 
                                    S
                                    T
                                    
                                       G
                                       
                                          b
                                       
                                       
                                          u
                                          c
                                       
                                    
                                    =
                                    
                                       δ
                                       
                                          c
                                          b
                                       
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          Ψ
                                          
                                             f
                                             b
                                          
                                          c
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

We define IL as a measure of the expected impact by the transmitting secondary user on the returning primary user in terms of the detection probability and interference cost. Hence, using Eqs. (2) and (6) we formulate IL of band b due to uc
                         as

                           
                              (11)
                              
                                 
                                    I
                                    
                                       L
                                       
                                          b
                                       
                                       
                                          u
                                          c
                                       
                                    
                                    =
                                    
                                       κ
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          Ψ
                                          
                                             d
                                             b
                                          
                                          c
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        The expression of IL affirms that when the impact of interference on a band is higher, the sensing on that band should be performed in such a way that the probability of missed detection remains below a certain level (i.e., Λb
                         should be low and rb
                         should be high). From the above discussion, it is evident that a user would always seek a band with higher STG and lower IL, which leads to a conflict in selecting the appropriate values for Λb
                         and rb
                         in the vacant bands (refer to Eqs. (2) and (3)). As these two are the only parameters that we can control in energy detection based approaches, we optimize them to maximize STG while keeping IL below a certain level. In the following section, we present the formulation of an optimization problem to determine the optimum values of Λ and r (Λ
                        * and r
                        *) applicable to all bands, which eventually maximizes STG and limits IL in order to develop an appropriate mechanism for the allocation of spectrum bands.

As both STG and IL are functions of the sensing parameters rb
                      and Λb
                      (all other parameters are constant given a particular RF scenario), we search for the uniform optimal values (r
                     *, Λ
                     *) applicable to all concurrent energy detectors, to maximize the cumulative STG over all 
                        B
                      bands. We formulate the maximization problem as

                        
                           (12)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          m
                                          a
                                          x
                                          i
                                          m
                                          i
                                          z
                                          e
                                          
                                          f
                                          =
                                          
                                             ∑
                                             
                                                b
                                                =
                                                1
                                             
                                             B
                                          
                                          
                                             f
                                             b
                                          
                                          =
                                          
                                             ∑
                                             
                                                b
                                                =
                                                1
                                             
                                             B
                                          
                                          
                                             δ
                                             
                                                c
                                                b
                                             
                                          
                                          
                                             g
                                             b
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                Ψ
                                                
                                                   f
                                                   b
                                                
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          s
                                          u
                                          b
                                          j
                                          e
                                          c
                                          t
                                          
                                          t
                                          o
                                          
                                          
                                             ∑
                                             
                                                b
                                                =
                                                1
                                             
                                             B
                                          
                                          
                                             κ
                                             b
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                Ψ
                                                
                                                   d
                                                   b
                                                
                                                c
                                             
                                             )
                                          
                                          <
                                          ϕ
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

To determine whether a feasible solution exists to the optimization problem, we test its convergence and the test of concavity of the objective function will guarantee its convergence. As the objective function is summed over all 
                        B
                      and all parameters are independent for each b, a test of concavity of fb
                      on any band b will assure the concavity of the cumulative STG objective function f.

An objective function is concave if the determinant of its Hessian matrix is negative [22]. For our maximization problem, with optimization variables rb
                         and Λb
                        , the Hessian matrix is represented as

                           
                              (13)
                              
                                 
                                    H
                                    
                                       (
                                       
                                          f
                                          b
                                       
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         f
                                                         b
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         r
                                                         
                                                            b
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         f
                                                         b
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         r
                                                         b
                                                      
                                                      ∂
                                                      
                                                         Λ
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         f
                                                         b
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         Λ
                                                         b
                                                      
                                                      ∂
                                                      
                                                         r
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         f
                                                         b
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         Λ
                                                         
                                                            b
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        We first find

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             r
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ∂
                                          2
                                       
                                       
                                          ∂
                                          
                                             r
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    
                                       [
                                       
                                          δ
                                          
                                             c
                                             b
                                          
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          (
                                          1
                                          −
                                          Q
                                          
                                             (
                                             
                                                
                                                   Λ
                                                   b
                                                
                                                
                                                   
                                                      4
                                                      
                                                         r
                                                         b
                                                      
                                                      
                                                         ∑
                                                         
                                                            s
                                                            =
                                                            1
                                                         
                                                         l
                                                      
                                                      
                                                         
                                                            η
                                                            
                                                               s
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        We can express the Gaussian Q function with an error function as [23]
                        
                           
                              (15)
                              
                                 
                                    Q
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    −
                                    
                                       1
                                       2
                                    
                                    e
                                    r
                                    f
                                    
                                       (
                                       
                                          x
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Hence, we represent Eq. (14) as

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   2
                                                
                                                
                                                   f
                                                   b
                                                
                                             
                                             
                                                ∂
                                                
                                                   r
                                                   
                                                      b
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   ∂
                                                   2
                                                
                                                
                                                   ∂
                                                   
                                                      r
                                                      
                                                         b
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   δ
                                                   
                                                      c
                                                      b
                                                   
                                                
                                                
                                                   g
                                                   b
                                                
                                                
                                                   (
                                                   
                                                      1
                                                      2
                                                   
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   e
                                                   r
                                                   f
                                                   
                                                      (
                                                      
                                                         
                                                            Λ
                                                            b
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  2
                                                                  
                                                                     r
                                                                     b
                                                                  
                                                                  
                                                                     ∑
                                                                     
                                                                        s
                                                                        =
                                                                        1
                                                                     
                                                                     l
                                                                  
                                                                  
                                                                     
                                                                        η
                                                                        
                                                                           s
                                                                           b
                                                                        
                                                                     
                                                                     
                                                                        w
                                                                        
                                                                           s
                                                                           b
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        As δcb
                         and gb
                         are both are independent of rb
                        , from the second derivative of the error function [23] we obtain

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             r
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             δ
                                             
                                                c
                                                b
                                             
                                          
                                          
                                             g
                                             b
                                          
                                       
                                       
                                          π
                                       
                                    
                                    .
                                    
                                       
                                          Λ
                                          b
                                       
                                       
                                          
                                             2
                                             
                                                r
                                                b
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                l
                                             
                                             
                                                
                                                   η
                                                   
                                                      s
                                                      b
                                                   
                                                
                                                
                                                   w
                                                   
                                                      s
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      b
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            
                                                               r
                                                               b
                                                            
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               l
                                                            
                                                            
                                                               
                                                                  η
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                               
                                                                  w
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    .
                                    
                                       
                                          ∂
                                          2
                                       
                                       
                                          ∂
                                          
                                             r
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             Λ
                                             b
                                          
                                          
                                             2
                                             
                                                
                                                   2
                                                   
                                                      r
                                                      b
                                                   
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         η
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        After simplification, we get

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             r
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             δ
                                             
                                                c
                                                b
                                             
                                          
                                          
                                             g
                                             b
                                          
                                       
                                       
                                          16
                                          
                                             r
                                             
                                                b
                                             
                                             3
                                          
                                          
                                             π
                                          
                                          
                                             ∑
                                             
                                                s
                                                =
                                                1
                                             
                                             l
                                          
                                          
                                             
                                                η
                                                
                                                   s
                                                   b
                                                
                                             
                                             
                                                w
                                                
                                                   s
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    .
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      b
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            
                                                               r
                                                               b
                                                            
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               l
                                                            
                                                            
                                                               
                                                                  η
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                               
                                                                  w
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        Similarly, we determine for Λ
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             Λ
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             δ
                                             
                                                c
                                                b
                                             
                                          
                                          
                                             g
                                             b
                                          
                                       
                                       
                                          π
                                       
                                    
                                    .
                                    
                                       
                                          Λ
                                          b
                                       
                                       
                                          
                                             2
                                             
                                                r
                                                b
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                l
                                             
                                             
                                                
                                                   η
                                                   
                                                      s
                                                      b
                                                   
                                                
                                                
                                                   w
                                                   
                                                      s
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      b
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            
                                                               r
                                                               b
                                                            
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               l
                                                            
                                                            
                                                               
                                                                  η
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                               
                                                                  w
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    .
                                    
                                       
                                          ∂
                                          2
                                       
                                       
                                          ∂
                                          
                                             Λ
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             Λ
                                             b
                                          
                                          
                                             2
                                             
                                                
                                                   2
                                                   
                                                      r
                                                      b
                                                   
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         η
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        As 
                           
                              
                                 
                                    ∂
                                    2
                                 
                                 
                                    ∂
                                    
                                       Λ
                                       
                                          b
                                       
                                       2
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       Λ
                                       b
                                    
                                    
                                       2
                                       
                                          
                                             2
                                             
                                                r
                                                b
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                l
                                             
                                             
                                                
                                                   η
                                                   
                                                      s
                                                      b
                                                   
                                                
                                                
                                                   w
                                                   
                                                      s
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              0
                              ,
                           
                         we conclude

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             Λ
                                             
                                                b
                                             
                                             2
                                          
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

The diagonal elements of the Hessian matrix are the same, i.e., 
                           
                              
                                 
                                    
                                       ∂
                                       2
                                    
                                    
                                       f
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       r
                                       b
                                    
                                    ∂
                                    
                                       Λ
                                       b
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ∂
                                       2
                                    
                                    
                                       f
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       Λ
                                       b
                                    
                                    ∂
                                    
                                       r
                                       b
                                    
                                 
                              
                           
                        . Using the first order derivative of the error function, we get

                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             r
                                             b
                                          
                                          ∂
                                          
                                             Λ
                                             b
                                          
                                       
                                    
                                    =
                                    
                                       ∂
                                       
                                          ∂
                                          
                                             r
                                             b
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             
                                                f
                                                b
                                             
                                          
                                          
                                             ∂
                                             
                                                Λ
                                                b
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       ∂
                                       
                                          ∂
                                          
                                             r
                                             b
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                δ
                                                
                                                   c
                                                   b
                                                
                                             
                                             
                                                g
                                                b
                                             
                                          
                                          
                                             π
                                          
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                
                                                   (
                                                   
                                                      
                                                         Λ
                                                         b
                                                      
                                                      
                                                         2
                                                         
                                                            
                                                               2
                                                               
                                                                  r
                                                                  b
                                                               
                                                               
                                                                  ∑
                                                                  
                                                                     s
                                                                     =
                                                                     1
                                                                  
                                                                  l
                                                               
                                                               
                                                                  
                                                                     η
                                                                     
                                                                        s
                                                                        b
                                                                     
                                                                  
                                                                  
                                                                     w
                                                                     
                                                                        s
                                                                        b
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          
                                             2
                                             
                                                
                                                   2
                                                   
                                                      r
                                                      b
                                                   
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         η
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        After calculation, we simplify Eq. (21) as

                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             r
                                             b
                                          
                                          ∂
                                          
                                             Λ
                                             b
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          
                                             f
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             Λ
                                             b
                                          
                                          ∂
                                          
                                             r
                                             b
                                          
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             δ
                                             
                                                c
                                                b
                                             
                                          
                                          
                                             g
                                             b
                                          
                                       
                                       
                                          2
                                          
                                             
                                                2
                                                π
                                                
                                                   r
                                                   
                                                      b
                                                   
                                                   3
                                                
                                                
                                                   ∑
                                                   
                                                      s
                                                      =
                                                      1
                                                   
                                                   l
                                                
                                                
                                                   
                                                      η
                                                      
                                                         s
                                                         b
                                                      
                                                   
                                                   
                                                      w
                                                      
                                                         s
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      b
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            
                                                               r
                                                               b
                                                            
                                                            
                                                               ∑
                                                               
                                                                  s
                                                                  =
                                                                  1
                                                               
                                                               l
                                                            
                                                            
                                                               
                                                                  η
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                               
                                                                  w
                                                                  
                                                                     s
                                                                     b
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       
                                          
                                             Λ
                                             b
                                          
                                          
                                             8
                                             
                                                r
                                                b
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                l
                                             
                                             
                                                
                                                   η
                                                   
                                                      s
                                                      b
                                                   
                                                
                                                
                                                   w
                                                   
                                                      s
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        Substituting the values from Eqs. (18), (20), and (22) into Eq. (13) we calculate the determinant of H(fb
                        ) as

                           
                              (23)
                              
                                 
                                    
                                       |
                                       H
                                       
                                          (
                                          
                                             f
                                             b
                                          
                                          )
                                       
                                       |
                                    
                                    =
                                    −
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   δ
                                                   
                                                      c
                                                      b
                                                   
                                                
                                                
                                                   g
                                                   b
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      2
                                                      π
                                                      
                                                         r
                                                         
                                                            b
                                                         
                                                         3
                                                      
                                                      
                                                         ∑
                                                         
                                                            s
                                                            =
                                                            1
                                                         
                                                         l
                                                      
                                                      
                                                         
                                                            η
                                                            
                                                               s
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             e
                                             
                                                −
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Λ
                                                            b
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  2
                                                                  
                                                                     r
                                                                     b
                                                                  
                                                                  
                                                                     ∑
                                                                     
                                                                        s
                                                                        =
                                                                        1
                                                                     
                                                                     l
                                                                  
                                                                  
                                                                     
                                                                        η
                                                                        
                                                                           s
                                                                           b
                                                                        
                                                                     
                                                                     
                                                                        w
                                                                        
                                                                           s
                                                                           b
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             
                                                
                                                   Λ
                                                   b
                                                
                                                
                                                   8
                                                   
                                                      r
                                                      b
                                                   
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         η
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          }
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                        As all the parameters of the above equation are real valued, the value of |H(fb
                        )| is always negative. Therefore, the optimization problem of maximizing STG is concave and hence converges to a global maxima.

The next step is to determine a value for the limiting parameter ϕ of Eq. (12). A logical analysis to determine this value is explained in the next subsection.

To determine the maximum tolerable value of ϕ, we need to consider the other two parameters in the nonlinearity constraints of Eq. (12). As 
                           
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    b
                                 
                              
                           
                         is the only parameter we control, we try to attain the recommended value for it. For example, in the IEEE 802.22 standard, the recommended minimum value for Ψdb
                         is 0.9, which makes the recommended maximum value for 
                           
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    b
                                 
                              
                           
                         to be 0.1. On the other hand, from the definition of κb
                         and from Eq. (6), it is clear that 
                           
                              
                                 ∑
                                 
                                    b
                                    =
                                    1
                                 
                                 B
                              
                              
                                 κ
                                 b
                              
                              =
                              1
                           
                        . For simplicity, let us consider that all the κb
                        ’s are equal. This assumption does not pose a problem because as long as the recommended values of 
                           
                              (
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    b
                                 
                              
                              )
                           
                         remain the same (e.g., 0.1) for all 
                           B
                         bands, equal or unequal values of κb
                         have same effect in meeting the constraint. Hence, for each b, 
                           
                              
                                 κ
                                 b
                              
                              =
                              1
                              /
                              B
                           
                         and the maximum value of 
                           
                              (
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    b
                                 
                              
                              )
                           
                         is 0.1. Substitution of these values into the inequality constraint of Eq. (12) sets the maximum value for ϕ as 0.1. Therefore, in general, we recommend value of ϕ to be the maximum allowable value of 
                           
                              (
                              1
                              −
                              
                                 Ψ
                                 
                                    d
                                    b
                                 
                              
                              )
                           
                        .

Once we determine the concavity of the STG maximization function f and define the limiting value ϕ, we aim to solve the maximization problem, i.e., find the optimal values of r and Λ for each uc
                        .
                           2
                        
                        
                           2
                           Note that as we seek uniform (same) values for rb
                               and Λb
                               over all 
                                 B
                               bands, we drop the subscript b from them.
                         In this regard, we used the Lagrangian and implied KKT conditions [24] to find a closed form expressions for the optimal points {
                           r*, Λ
                              *
                           
                        }∀c. However, we have concluded that neither r
                        * nor Λ
                        * has a closed form expression, the explanation of which is presented in Appendix. Hence, the maximization problem must be solved numerically.

We applied the interior point algorithm [25] and used MATLAB®release 2008a for the numeric solution of the optimization problem. Fig. 6
                         shows two sample plots for the STG maximization of Eq. (12). These plots illustrate that STG monotonically increases with Λ and decreases with r until it reaches the plateau where the optimum values are attained. For these particular examples, the value of the optimal cooperative detection threshold Λ
                        * is around 100 for all the concurrent energy detectors to maximize the cumulative STG over all 
                           B
                         bands for u
                        1 while keeping IL below 0.1. The optimal time-bandwidth product r
                        * has a value around 10. On determining the optimum values, the next step is to distribute the 
                           B
                         available bands among the L users. This scheme is explained in the following section.

We propose two approaches for accomplishing band allocation scheme based on the values of r
                     * and 
                        Λ*
                        
                     , namely selfish and compromising. In the selfish approach, only the individual gain of a user is taken into account, ignoring any effect on others, whereas the compromising approach considers the individual gain as well as any loss incurred to other users due to the allocation.

In this approach, the band manager assigns a band requesting user uc
                         with band b if the band offers the maximum capacity of service (CoS), which gives the best possible combination of the suitability-throughput gain and interference loss for that particular band. We define the CoS for a band b as

                           
                              (24)
                              
                                 
                                    C
                                    o
                                    
                                       S
                                       
                                          b
                                       
                                       c
                                    
                                    =
                                    
                                       δ
                                       
                                          c
                                          b
                                       
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          κ
                                          b
                                       
                                       )
                                    
                                    
                                       Ψ
                                       
                                          d
                                          b
                                       
                                       
                                          *
                                          c
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          Ψ
                                          
                                             f
                                             b
                                          
                                          
                                             *
                                             c
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where, 
                           
                              Ψ
                              
                                 d
                                 b
                              
                              
                                 *
                                 c
                              
                           
                         and 
                           
                              Ψ
                              
                                 f
                                 b
                              
                              
                                 *
                                 c
                              
                           
                         are the optimized values of 
                           
                              Ψ
                              
                                 d
                                 b
                              
                              c
                           
                         and 
                           
                              Ψ
                              
                                 f
                                 b
                              
                              c
                           
                         respectively, obtained using the solution (r
                        *, Λ
                        * ) to the maximization problem in Eq. (12) for user uc
                        . Based on CoS, we express the selection criterion of a suitable band (
                           
                              b
                              
                                 c
                              
                              *
                           
                        ) for uc
                         as

                           
                              (25)
                              
                                 
                                    
                                       b
                                       
                                          c
                                       
                                       *
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          
                                          m
                                          a
                                          x
                                       
                                       
                                          b
                                          ϵ
                                          B
                                       
                                    
                                    
                                       (
                                       
                                          δ
                                          
                                             c
                                             b
                                          
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             κ
                                             b
                                          
                                          )
                                       
                                       
                                          Ψ
                                          
                                             d
                                             b
                                          
                                          
                                             *
                                             c
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             Ψ
                                             
                                                f
                                                b
                                             
                                             
                                                *
                                                c
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        It is highly likely that two or more users seek for bands at the same time and depending on the CoS value, the same band is selected for these users. For example, band 3 has the highest CoS value for both the users u
                        1 and u
                        2, and therefore it is selected for both of them following Eq. (25), resulting in a collision. In this approach, we consider this possibility and assign the band to the secondary user which has a CoS value for that band that is higher than the CoS value of the other user(s). The other user(s) is assigned with another band which gave the second highest CoS value for that user. For example, if 
                           
                              
                                 CoS
                                 
                                    3
                                 
                                 1
                              
                              >
                              
                                 CoS
                                 
                                    3
                                 
                                 2
                              
                              ,
                           
                         then band 3 is assigned to user u
                        1 and user u
                        2 is assigned with the band which gave the second highest CoS value for it. However, if the selected band has the same CoS for both users, one of the users are selected randomly to be assigned with this band. This technique is repeated for all the bands until they are assigned to all the users.

In this approach, uc
                         is assigned with band b by the band manager if such allocation offers the maximum net Capacity of Service (nCoS). For each uc
                        , nCoS is calculated as its own individual CoS value minus the average of all other competing users’ CoS values for a particular band. This formulation represents the gain of any user while assigned with a particular band and the average loss to the rest of the users for not being assigned with the same band. In this way, nCoS represents the global satisfaction for all the users whereas CoS represents the individual satisfaction of user uc
                        . We assign user uc
                         with band 
                           
                              b
                              
                                 c
                              
                              *
                           
                         if

                           
                              (26)
                              
                                 
                                    
                                       b
                                       
                                          c
                                       
                                       *
                                    
                                    =
                                    
                                       
                                          a
                                          r
                                          g
                                          
                                          m
                                          a
                                          x
                                       
                                       
                                          b
                                          ϵ
                                          B
                                       
                                    
                                    
                                       [
                                       
                                          δ
                                          
                                             c
                                             b
                                          
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             κ
                                             b
                                          
                                          )
                                       
                                       
                                          Ψ
                                          
                                             d
                                             b
                                          
                                          
                                             *
                                             c
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             Ψ
                                             
                                                f
                                                b
                                             
                                             
                                                *
                                                c
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   i
                                                   ≠
                                                   c
                                                
                                                L
                                             
                                             
                                                δ
                                                
                                                   i
                                                   b
                                                
                                             
                                             
                                                g
                                                b
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   κ
                                                   b
                                                
                                                )
                                             
                                             
                                                Ψ
                                                
                                                   d
                                                   b
                                                
                                                
                                                   *
                                                   i
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   Ψ
                                                   
                                                      f
                                                      b
                                                   
                                                   
                                                      *
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             L
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        The terms within the parentheses represent the nCoS and the first term represents the CoS of band b for user uc
                         while the second term represents the average CoSs of band b for the rest of the users. Overall it represents the gain of any user while assigned with a band and the average loss to the rest of the users. The number of collisions arising from the selection of the same band by multiple users is much lower in this approach than in the selfish approach. However, if a collision occurs, it is resolved in the same manner as stated in the selfish approach.

This effect can be explained by means of a numerical example. Let us consider that there are four users competing to be assigned with the best possible band from four vacant bands. The randomly generated CoS and the corresponding calculated nCoS values of these four users for each bands are provided in Table 1
                        .

For instance, column 2 of the table shows that, for band b
                        1, u
                        1 has a CoS value of 0.4 while u
                        2, u
                        3 & u
                        4 have the corresponding values of 0.7, 0.6 & 0.6. Considering u
                        1, other users have an average CoS value of (0.7+0.6+0.6)/3=0.633 which yields an nCoS of 
                           −
                        0.233 (=0.4–0.633) for u
                        1. Similarly u
                        1 yields nCoS values for b
                        2, b
                        3 & b
                        4 respectively as 0.433=0.6
                           −
                        (0.2+0.1+0.2)/3, 0.3=0.8
                           −
                        (0.5+0.7+0.3)/3 & 0.2=0.6
                           −
                        (0.3+0.5+0.4)/3. For an individual user, a negative nCoS value for a particular band means that, there are other users who are better candidates to be allocated with that band. A positive nCoS means the opposite while a zero value indicates that there may be one or more users who can be equally good for this band. The nCoS value for an individual user lies in the range of 
                           −
                        1.0 to +1.0. For a user, an nCoS of 
                           −
                        1.0 will yield in the extreme case where it has ‘0’ CoS for the band while all other users have ‘1’ CoS; and vice versa for +1.0 nCoS value. To make a comparison, we assign each user with a band with the selfish (CoS based) or the compromising (nCoS based) approach. The steps for band allocation in both techniques are detailed in Table 2
                        . From the analyses provided in the table, it is clear that the compromising approach results in a lower collision among the users. Moreover, for this particular example, nCoS based allocation attains a higher total CoS.

The above two approaches allocate 
                           B
                         bands among L competing users. As long as 
                           
                              L
                              ≤
                              B
                              ,
                           
                         each of the competing users gets a band for transmission according to the selection criteria. But when 
                           
                              L
                              >
                              B
                              ,
                           
                         there are 
                           
                              L
                              −
                              B
                           
                         users who must be dropped. These users are selected based on the lowest CoS or nCoS values. The next section evaluates the performance of our proposed scheme under different scenarios and provides a comparative analysis of the results.

In this section, we evaluate the performance of our proposed spectrum allocation scheme by both selfish and compromising approaches. Our schemes are compared with the approach where the 
                        B
                      vacant bands are randomly allocated among the L contending users [18]. We analyze the results in both the cases when 
                        
                           L
                           ≤
                           B
                        
                      and 
                        
                           L
                           >
                           B
                        
                     . We randomly generated different parameters for the proposed scheme over 100 trials to cover a wide range of scenarios and the results presented in this section are averaged over all trials. One realization of some of the major parameters for 15 bands is listed in Table 3
                     .

In this situation, each of the users eventually gets a band for transmission. However, they may encounter some collisions before being assigned with a band.Fig. 7
                         shows the average number of collisions with an increasing number of users before the final allocation.

In the random approach, the bands are randomly distributed among the users and whenever a collision occurs, one but the colliding users are randomly assigned with the remaining vacant bands which may result in more collisions. In the random approach, the bands are randomly distributed among the users. Whenever a collision occurs due to the assignment of the same band to multiple users, the band is allocated to one user and the rest of the colliding users are randomly assigned with the remaining vacant bands. This process continues until each of the users are assigned with a unique band. The figure depicts that the compromising approach has the lowest average collisions. Interestingly, a random assignment has less average collisions than the selfish assignment. This is because if a band offers better transmission properties and exhibits higher suitability, it will provide the highest CoS values for most of the contending users and the selfish approach may initially try allocating this band to them before resolving any conflict.

In Fig. 8
                        , the global satisfaction in terms of average nCoS (averaged over all trials) is presented. The users are more satisfied if the bands are allocated with the compromising approach compared to the random or selfish approaches. This is due to its allocation policy that takes consideration of other users’ information and resolves the collision is a better way. Both the compromising and selfish approaches have positive average nCoS values, while that in the random approach is around zero. In the latter approach, due to the random nature of distribution of bands among users, the gain by an allocated user might be lower than the average possible gain of others, resulting in negative nCoS. Therefore, some users might get good bands whose nCoS values are high (positive) while others may get bands whose nCoS values are quite low (negative), giving a low average nCoS value around zero. Nevertheless, Fig. 9
                        
                        
                        
                         suggests that if we consider individual band satisfaction
                           3
                        
                        
                           3
                           Individual band satisfaction is the maximum attainable CoS values of the selected bands, averaged over participating users. The CoS values are calculated according to Eq. (24), with the optimum relevant parameters for band b as discussed earlier.
                        , the selfish approach attains satisfaction comparable to or slightly better than the compromising approach when user number is low to medium (below 11). But for a higher number of users (12+), the selfish approach provides better individual satisfaction. The reason behind this behavior lies in the method of selecting bands for competing users. In the selfish approach, the band with the highest CoS is assigned to a particular user. When the number of competing users are low (e.g., < 4), there are no or little collisions among the users, and hence each user usually gets the band that attains the maximum CoS value for it. In the compromising approach, nCoS values are used to determine bands for users, and in no or low collision scenario, bands with the highest nCoS values for respective users usually have the highest CoS values as well. Therefore, both approaches perform comparably for low number of users. When the number of users increases to moderate level (e.g., 4–11), collisions occur more frequently in the selfish approach than in the compromising approach, resulting in the selection of bands with lower CoS in the former. At this stage, the compromising approach provides slightly better individual satisfaction than the selfish approach. The example in Table 2 also demonstrates fewer collisions and higher CoS achievable by the compromising approach. However, when the number of users is close to the number of bands (e.g., ≥ 12), compromising approach exhibits slightly lower individual satisfaction than the selfish approach. This is because in this approach band allocation is based on nCoS and therefore attains higher global satisfaction as the expense of individual satisfaction (Figs. 8 vs 9). As demonstrated in the figures, both of our proposed approaches attain a significantly higher satisfaction than the random approach.

We also investigated how the proposed allocation schemes behave when the number of available bands and competing users are large. Figs. 10 and 11 show the average number of collisions and user satisfaction when the number of band is 100. Results show that the approaches maintain the similar trend with large number of available bands.

In this case, due to the scarcity of the available bands, 
                           
                              L
                              −
                              B
                           
                         users have to be dropped. As described previously, these discarded users are selected from the conflicting users based on the lowest nCoS (compromising approach), or CoS (selfish approach) or randomly. Fig. 12 presents the average number of collisions. It is evident that if we discard 
                           
                              L
                              −
                              B
                           
                         users following the compromising method, minimum collisions are experienced. Randomly discarding users results in more collisions than the compromising approach but less than the selfish approach. Fig. 13
                        
                         shows the loss in the global satisfaction due to the service drop of discarded users. The trend suggests that the more users are discarded, the lower the overall satisfaction arising from band allocation. Both our approaches yield lower loss in satisfaction than random approach, while compromising approach experiences the lowest loss.

So far the performance of the proposed spectrum allocation framework is investigated using only uniform optimized parameters (r
                        *, Λ
                        *) which maximizes STG and limits IL over all 
                           B
                         bands for a contending user. In the next sub-section, we analyze the performance of the framework where the parameters are optimized on individual bands and compare the results with those attained in the uniform parameter case.

Here we assume that the optimal values for the sensing parameters of the energy detectors vary over different bands, i.e., 
                           
                              
                                 r
                                 
                                    i
                                 
                                 *
                              
                              ,
                              
                              
                                 Λ
                                 
                                    i
                                 
                                 *
                              
                           
                         is not necessarily equal to 
                           
                              
                                 r
                                 
                                    j
                                 
                                 *
                              
                              ,
                              
                              
                                 Λ
                                 
                                    j
                                 
                                 *
                              
                           
                        . Nonetheless, the techniques for optimization of parameters and spectrum allocation remains the same as described in Section 5.3. We call this approach the non-uniform parameter based allocation. At first, we compare these two approaches in terms of the number of collisions in accommodating L users into 
                           B
                         bands. In this section, we only consider the case when 
                           
                              L
                              ≤
                              B
                              ,
                           
                         so that all the users get unique bands. A comparison between the uniform and non-uniform parameter based allocations in terms of the average number of collisions is presented in Fig. 14. The plots show that with fewer contending users, the allocation with uniform parameters exhibits a comparable performance to that using non-uniform parameters. However, with a higher number of users, the non-uniform parameter based allocation exhibits slight performance improvement.


                        Fig. 15
                         illustrates the global satisfaction for both cases. The figure shows that non-uniform parameter based allocation attains slightly better global satisfaction. The reason is that when non-uniform sensing parameters are used, the false alarm rate is lower in each participating band leading to a higher STG. Similarly, the individual satisfaction for both the compromising and selfish approaches is better exhibited with non-uniform parameters as shown in Fig. 16
                        .

Though non-uniform optimized sensing parameters for each band achieves slightly improved performance, this improvement is offset by the complexity arising from using separate sensing parameters for each band. With band specific parameters, the optimization solution takes much longer to converge than with uniform parameters, as found in our experiments. Hence, using uniform values for the sensing parameters is the better option unless a trivial performance improvement is necessary.

@&#CONCLUSION@&#

In allocating bands in cognitive radio networks, a scheme should consider a number of factors like band utilization and user’s past experience of using a particular band, interference cost, possibility of PT’s return in future on the band once allocated and the impact of allocating a particular band on other band seeking users. The existing schemes in literature do not consider all these aspects when multiple secondary users need to be simultaneously accommodated into multiple available spectrum bands and relies on the alternate sensing and transmission cycles which reduces spectrum utilization. The proposed scheme incorporates the above factors by defining a metric called Capacity of Service (CoS). In relation to CoS, two parameters are optimized. Using this metric, spectrum can be allocated in two approaches, namely, selfish and compromising. The compromising scheme yields reduced collision and higher user satisfaction among the users in a multiband multiuser scenario. The scheme improves spectrum utilization by eliminating the need for alternate sensing and transmission cycle. Future work aims further verification of the proposed scheme through experiments with real CR environments and extension of the scheme over multiple CR networks.

We formulated the optimization problem to find the optimal r
                     * and Λ
                     * as per Eq. (12) considering a simpler scenario where r and Λ are uniform across all 
                        B
                      bands. To solve the optimization problem in Eq. (12), we can formulate the Lagrangian [24] of the problem as below:

                        
                           (27)
                           
                              
                                 L
                                 
                                    (
                                    r
                                    ,
                                    Λ
                                    ,
                                    θ
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    δ
                                    b
                                 
                                 
                                    g
                                    b
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       Ψ
                                       
                                          f
                                          b
                                       
                                    
                                    )
                                 
                                 −
                                 θ
                                 
                                    (
                                    
                                       ∑
                                       
                                          b
                                          =
                                          1
                                       
                                       B
                                    
                                    
                                       κ
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          Ψ
                                          
                                             d
                                             b
                                          
                                       
                                       )
                                    
                                    −
                                    ϕ
                                    )
                                 
                                 ,
                              
                           
                        
                     where θ ≥ 0 is the Lagrangian multiplier. As we aim to determine the optimal values for user uc
                      only, we drop ‘c’ for simplicity of mathematical notations in the above equation and in the following steps. We can then find the KKT (Karush–Kuhn–Tucker) conditions [24] as follows:

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             1
                                          
                                          :
                                          
                                          
                                             
                                                δ
                                                L
                                             
                                             
                                                δ
                                                r
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             2
                                          
                                          :
                                          
                                          
                                             
                                                δ
                                                L
                                             
                                             
                                                δ
                                                Λ
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             D
                                             3
                                          
                                          :
                                          
                                          
                                             
                                                δ
                                                L
                                             
                                             
                                                δ
                                                θ
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                     From D
                     1, we find

                        
                           (28)
                           
                              
                                 
                                    
                                       δ
                                       L
                                    
                                    
                                       δ
                                       r
                                    
                                 
                                 =
                                 
                                    δ
                                    
                                       δ
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       ∑
                                       
                                          b
                                          =
                                          1
                                       
                                       B
                                    
                                    
                                       δ
                                       b
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          Ψ
                                          
                                             f
                                             b
                                          
                                       
                                       )
                                    
                                    −
                                    θ
                                    
                                       (
                                       
                                          ∑
                                          
                                             b
                                             =
                                             1
                                          
                                          B
                                       
                                       
                                          κ
                                          b
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             Ψ
                                             
                                                d
                                                b
                                             
                                          
                                          )
                                       
                                       −
                                       ϕ
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     
                  

By expressing the probabilities in terms of Q function [20] using Eqs. (2) & (3), Eq. (28) can be written as

                        
                           (29)
                           
                              
                                 
                                    δ
                                    
                                       δ
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       ∑
                                       
                                          b
                                          =
                                          1
                                       
                                       B
                                    
                                    
                                       δ
                                       b
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       (
                                       1
                                       −
                                       Q
                                       
                                          (
                                          
                                             Λ
                                             
                                                
                                                   4
                                                   r
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         η
                                                         
                                                            s
                                                            k
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    −
                                    θ
                                    
                                       (
                                       
                                          ∑
                                          
                                             b
                                             =
                                             1
                                          
                                          B
                                       
                                       
                                          κ
                                          b
                                       
                                       
                                          (
                                          1
                                          −
                                          Q
                                          
                                             (
                                             
                                                
                                                   Λ
                                                   −
                                                   2
                                                   r
                                                   
                                                      ∑
                                                      
                                                         s
                                                         =
                                                         1
                                                      
                                                      l
                                                   
                                                   
                                                      
                                                         
                                                            γ
                                                            
                                                               p
                                                               
                                                                  s
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            η
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         w
                                                         
                                                            s
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      4
                                                      r
                                                      
                                                         ∑
                                                         
                                                            s
                                                            =
                                                            1
                                                         
                                                         l
                                                      
                                                      
                                                         
                                                            η
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               s
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       −
                                       ϕ
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     
                  

Now, expressing Q function in terms of error function [23] we find from Eq. (29)
                     
                        
                           (30)
                           
                              
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    
                                       
                                          δ
                                          b
                                       
                                       
                                          g
                                          b
                                       
                                    
                                    2
                                 
                                 
                                    (
                                    
                                       δ
                                       
                                          δ
                                          r
                                       
                                    
                                    e
                                    r
                                    f
                                    
                                       (
                                       
                                          Λ
                                          
                                             2
                                             
                                                
                                                   2
                                                   r
                                                   
                                                      C
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 −
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    
                                       θ
                                       
                                          κ
                                          b
                                       
                                    
                                    4
                                 
                                 
                                    (
                                    
                                       δ
                                       
                                          δ
                                          r
                                       
                                    
                                    e
                                    r
                                    f
                                    
                                       (
                                       
                                          
                                             Λ
                                             −
                                             2
                                             r
                                             
                                                C
                                                2
                                             
                                          
                                          
                                             
                                                2
                                                r
                                                
                                                   C
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                     where, 
                        
                           
                              C
                              1
                           
                           =
                           
                              ∑
                              
                                 s
                                 =
                                 1
                              
                              l
                           
                           
                              
                                 η
                                 
                                    s
                                    k
                                 
                              
                              
                                 w
                                 
                                    s
                                    k
                                 
                              
                           
                        
                      and 
                        
                           
                              C
                              2
                           
                           =
                           
                              ∑
                              
                                 s
                                 =
                                 1
                              
                              l
                           
                           
                              
                                 
                                    γ
                                    
                                       p
                                       
                                          s
                                          k
                                       
                                    
                                 
                                 
                                    η
                                    
                                       s
                                       k
                                    
                                 
                              
                              
                                 w
                                 
                                    s
                                    k
                                 
                              
                           
                        
                      are the two constants independent of b. Finally, simplifying Eq. (30), we find

                        
                           (31)
                           
                              
                                 
                                    1
                                    
                                       4
                                       
                                          
                                             2
                                             π
                                             
                                                r
                                                3
                                             
                                             
                                                C
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    [
                                    
                                       δ
                                       b
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   Λ
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            r
                                                            
                                                               C
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    −
                                    
                                       
                                          θ
                                          
                                             κ
                                             b
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       Λ
                                       +
                                       2
                                       r
                                       
                                          C
                                          2
                                       
                                       )
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      −
                                                      2
                                                      r
                                                      
                                                         C
                                                         2
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            r
                                                            
                                                               C
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     
                  

Now, in a similar fashion, calculation of D
                     2 leads to

                        
                           (32)
                           
                              
                                 
                                    1
                                    
                                       4
                                       
                                          
                                             2
                                             π
                                             r
                                             
                                                C
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    [
                                    
                                       δ
                                       b
                                    
                                    
                                       g
                                       b
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   Λ
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            r
                                                            
                                                               C
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    −
                                    θ
                                    
                                       κ
                                       b
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Λ
                                                      −
                                                      2
                                                      r
                                                      
                                                         C
                                                         2
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            r
                                                            
                                                               C
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                     and that of D
                     3 leads to

                        
                           (33)
                           
                              
                                 
                                    ∑
                                    
                                       b
                                       =
                                       1
                                    
                                    B
                                 
                                 
                                    κ
                                    b
                                 
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    +
                                    
                                       1
                                       2
                                    
                                    e
                                    r
                                    f
                                    
                                       (
                                       
                                          
                                             Λ
                                             −
                                             2
                                             r
                                             
                                                C
                                                2
                                             
                                          
                                          
                                             
                                                2
                                                r
                                                
                                                   C
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     
                  


                     Eqs. (31)–(33) are the equations to derive a closed form expression for optimum r and Λ. However, a closed form expression is not achievable due to the presence of exponential functions and error function which yields in exponential integral. Also, further simplification results in functions of the form 
                        
                           l
                           n
                           (
                           x
                           +
                           y
                           )
                           ,
                        
                      which is not possible to solve theoretically. Hence, a numerical method is required to find r
                     * and Λ
                     *.

@&#REFERENCES@&#

