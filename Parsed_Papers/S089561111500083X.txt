@&#MAIN-TITLE@&#Automated 3D–2D registration of X-ray microcomputed tomography with histological sections for dental implants in bone using chamfer matching and simulated annealing

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We developed a novel method for automated 3D–2D registration of microCT and histology.


                        
                        
                           
                           We used the model of dental implant biopsies and found high agreement among the registered specimens.


                        
                        
                           
                           We directly compared the bone to implant contact (BIC) using the registered samples.


                        
                        
                           
                           We found significant positive association for the BIC measurements.


                        
                        
                           
                           Metal artifacts increased automated BIC measurements systematically.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image registration

Micro-computed tomography

Histology

Osseointegration

Dental implants

Histomorphometry

@&#ABSTRACT@&#


               
               
                  We propose a novel 3D–2D registration approach for micro-computed tomography (μCT) and histology (HI), constructed for dental implant biopsies, that finds the position and normal vector of the oblique slice from μCT that corresponds to HI. During image pre-processing, the implants and the bone tissue are segmented using a combination of thresholding, morphological filters and component labeling. After this, chamfer matching is employed to register the implant edges and fine registration of the bone tissues is achieved using simulated annealing.
                  The method was tested on n
                     =10 biopsies, obtained at 20 weeks after non-submerged healing in the canine mandible. The specimens were scanned with μCT 100 and processed for hard tissue sectioning. After registration, we assessed the agreement of bone to implant contact (BIC) using automated and manual measurements. Statistical analysis was conducted to test the agreement of the BIC measurements in the registered samples.
                  Registration was successful for all specimens and agreement of the respective binary images was high (median: 0.90, 1.–3. Qu.: 0.89–0.91). Direct comparison of BIC yielded that automated (median 0.82, 1.–3. Qu.: 0.75–0.85) and manual (median 0.61, 1.–3. Qu.: 0.52–0.67) measures from μCT were significant positively correlated with HI (median 0.65, 1.–3. Qu.: 0.59–0.72) between μCT and HI groups (manual: R
                     2
                     =0.87, automated: R
                     2
                     =0.75, p
                     <0.001).
                  The results show that this method yields promising results and that μCT may become a valid alternative to assess osseointegration in three dimensions.
               
            

@&#INTRODUCTION@&#

Biological processes associated with the osseointegration of endosseous dental implants have been extensively investigated in numerous preclinical and clinical studies [1–3].

The level of osseointegration is typically evaluated by histological assessment of bone to implant contact (BIC) areas in undecalcified hard tissue sections [4]. One major drawback of non-decalcified sectioning, however, is a significant loss of biological tissues during the histological (HI) processing of serial sections, and therefore, only a maximum of 2–3 sections are available which may not reflect the entire healing processes at the investigated site.

Another drawback is the amount of time needed for the processing of hard tissue sections, delaying data acquisition for several months after completion of the experimental procedures. Moreover, staining of specimens is a highly sensitive process and commonly associated with marked variances in color intensity. Furthermore, evaluation is limited to 2D, so different orientations can not be investigated, and killing of the animal is needed to harvest biopsies for histology thus for each time point different animals are needed.

In recent years, micro computed tomography (μCT) has become a promising tool for quantitative three-dimensional (3D) analyses of new bone formation following implant placement and various types of bone augmentation procedures. This non-destructive and non-invasive volumetric analysis offers many advantages including a fast and automated characterization of structural features such as bone volume density [5,6] or the assessment of BIC values [7,8] in different planes and even in 3D. Furthermore, with the advent of intravital μCT scanners, different time points can be studied within the same animal. Despite these advantages, assessment of BIC values in μCT scans may be impeded by beam hardening artifacts, partial volume effects and scattering [9,10] which occur in the proximity of dental titanium implants. While partial volume effects can be eliminated by performing BIC measurements few voxels away from the implant, beam hardening and scatter artifacts may distort BIC measurements. Due to the lacking proof of comparability, μCT analyses are usually complemented with conventional HI at the moment [11–13].

To verify if μCT and HI yield the same results, and to validate novel BIC measurements in the future, 2D corresponding slices have to be compared with the gold standard HI. For this a 3D–2D registration is required that aligns corresponding image elements from μCT and HI.

Few approaches for 3D–2D registration are described in literature, mostly reporting on the registration of CT or MRI volumes with projected 2D X-ray [14,15], ultrasound [16,17] or fluoroscopic images [18–20]. Registration of single 2D slices obtained during interventional procedures with CT [21] or HI section with μCT did not gain much attention so far since the registration relies on many-to-one correspondence of the underlying 3D-to-2D mapping as well as a statistical consistency problem owing to the reliance of a similarity measure on small sampling size of an input 2D image [22] and big differences in information content [23]. Manual approaches for 3D–2D registration are hard to realize because HI is usually not located parallel to a reference plane within μCT, thus, a seven dimensional optimization problem needs to be solved (rotation, translation and scaling).

Sarve et al. were the first to report on automated computerized registration for synchroton radiation microcomputed tomography and histology using the model of osseointegrated orthopedic titanium (TI) implants [10]. They used normalized mutual information to assess similarity and assumed HI being located directly at the implant axis. They also tried to employ simulated annealing without a prior first guess and fast cooling so a failure rate of 25% was reported by the authors [10].

The aim of the present study was to develop a robust automated computerized registration method for HI images with μCT volumes. The specific goals were (i) to establish an algorithm to automatically register 2D HI images with a 3D μCT volume, and (ii) to assess the agreement of BIC values in the registered images.

The specimens (n
                        =10) used for the present analysis were randomly selected from tissue biopsies obtained in a recently published experimental study [24]. In brief, each biopsy contained one commercially available titanium implant (Ø 3.8mm, length: 9mm, Conelog® Screw-Line Implant, Camlog Biotechnologies AG, Basel, Switzerland) connected with a diameter-reduced wide body Ti (Ti6Al4V) healing abutment (Ø 3.8mm, height: 4mm, Camlog). These biopsies were retrieved at 20 weeks after implant placement and non-submerged healing in the mandible of foxhounds. The study protocol was approved by the appropriate local authority (Landesamt fr Natur und Verbraucherschutz, Recklinghausen, Germany).

The biopsies were dehydrated using ascending grades of alcohol and xylene, infiltrated and embedded in methylmethacrylate (Technovit 9100 NEU; Heraeus Kulzer, Wehrheim, Germany), which is the standardized procedure for non-decalcified sectioning. This procedure takes 20h, during which negative influence of polymerization heat was avoided by storing the specimen at cold atmosphere (4°C).

After embedding in methylmethacrylate, the biopsies were scanned with a μCT 100 (Scanco Medical AG, Brttisellen, Switzerland). The X-ray tube was operated at an energy of 90kVp and an intensity of 88μA. The integration time was chosen to 1200ms and the frame averaging was set at 2×. The data was reconstructed into 3D volumes with an isotropic nominal resolution of 8.6μm.

The technique has been described in detail [24]. Briefly, after μCT analysis, histological preparation was performed. Each implant site was cut in the vestobulo-oral direction along with the long axis of the implant using a diamond band saw (Exact(r); Apparatebau, Nordersted, Germany). Serial sections of approximately 300μm in thickness were prepared, glued with acrylic cement (Technovit 7210 VLC; Hareus Kulzer), to silanized glass slides (Super Frost; Menzel GmbH, Braunschweig, Germany) and ground to a final thickness of approximately 40μm. Subsequently, from each tissue block, one specimen was randomly selected for the present analysis and stained with paragon.

For image acquisition a color CCD camera (Color View III, Olympus, Hamburg, Germany) mounted on a binocular light microscope (Olympus BX50, Olympus, Hamburg, Germany) was used. Digital images for registration (original magnification 100×) were obtained using the Cell D program (Cell D®, Soft Imaging System, Münster, Germany). Additionally, the specimens were scanned with Aperio ScanScope Slide Scanner (Aperio Technologies Inc., CA, USA) for BIC assessment (original magnification 200×) and the region of interest was exported as snapshot using Aperio ImageScope v11.1.2.752 (Aperio Technologies).

The image preprocessing and registration was performed with Matlab (Matlab R2013a 64-bit, The Mathworks Inc., Massachusetts, USA).

During preprocessing, both HI and μCT were each transformed into two binary images showing either the dental implant or the bone (Fig. 1
                        ).

To segment the implant from HI, thresholding and component labeling was applied. The edges were detected using Canny edge filter. For segmentation of the bone tissue from HI, a combination of thresholding, component labeling and morphological filters (erosion, dilation) with a 3×3 disk as structuring element was used.

On the μCT slices, the thresholds were chosen manually such that either the bone tissue or dental implant was segmented.

The element size of histology was obtained from a bar of fixed length (5mm) located within the histological images. The μCT element size was read from the header of the μCT-files given in Scanco Medical AIM-format. Adaption was achieved by scaling HI images with the ratio of both element sizes, i.e. size
                        
                           hi
                        /size
                        
                           ct
                        .

Chamfer matching (CM) was used to find a first guess for the start of the fine registration and was implemented as described by Borgefors [25] for the 2D case (Fig. 2
                        ).

Two pyramid levels were used and initialization was achieved by finding the implant axis from μCT, which was approximated with the first axis (PA) from principal component analysis (PCA): to conduct PCA, all edge vectors from HI and μCT were centered and stored as row vectors 
                           
                              v
                              i
                           
                         in a matrix. Then, its covariance matrix and eigenvalue decomposition were computed. The eigenvector with largest eigenvalue yielded PA.

Next, a vector orthogonal to the implant axis (third principal axis, i.e. eigenvector with smallest eigenvalue) was rotated in 5 degree steps around PA and a series of 72 slices was extracted from the μCT volume.

From each slice, the 3–4 distance transform (DT) was computed [25] and the implant edges e
                        
                           i
                         from HI were moved along DT until an optimal match was found. Since each intensity of DT reflects the approximated Euclidean distance to the nearest edge, the alignment score was given by the root mean squared average (RMS), which averages the intensities x
                        
                           i
                         to which the e
                        
                           i
                         were mapped:


                        
                           
                              (1)
                              
                                 RMS
                                 =
                                 
                                    1
                                    3
                                 
                                 
                                    
                                       
                                          1
                                          n
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          x
                                          i
                                       
                                    
                                 
                              
                           
                        
                     

The division by 3 is required since the 3–4 Chamfer distance was used instead of the Euclidean distance. The optimal match was found when no transformations were possible that would reduce RMS. Convergence of CM was shown by Borgefors [25].

Due to proximate rotation symmetry of the implant, RMS from CM with slices located around the implant axis was expected to be likewise. Thus the segmented bone from HI was mapped to the segmented bone from μCT slice using the transformation matrix from CM. Then, similarity L was measured between the binary images by averaging the L1 norm and subtraction from 1 (x
                        
                           i
                        , y
                        
                           i
                         denote the values of aligned pixels):


                        
                           
                              (2)
                              
                                 L
                                 =
                                 1
                                 −
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 ∥
                                 
                                    x
                                    i
                                 
                                 −
                                 
                                    y
                                    i
                                 
                                 
                                    ∥
                                    1
                                 
                              
                           
                        
                     

Hence, RMS was used to find the transformation of HI and a slice extracted from μCT. L was used to compare similarity of different slices extracted from μCT with HI. These slices were obtained by rotating a vector orthogonal to the implant axis in 5 degree steps.

At the position with highest L score, additional 1 degree rotations of the normal were performed (10° to each direction).

Missing intensity values of oblique slices were interpolated using trilinear interpolation. The parameters revealing the optimal L score finally yielded the first guess registration of the implants using CM.

Simulated annealing (SA) is a robust optimization method incorporated from thermodynamics. It was implemented with 6 degrees of freedom (rotation, translation) to find a slice from μCT that maximizes L when being aligned with HI. Input were the segmented bone binary images from μCT and HI as well as the so far optimal position and normal vector from Chamfer Matching. 3D–2D matching was achieved by refining the position and normal vector of the μCT slice, while HI remained fixed.

The algorithm uses a parameter temperature T that was initialized with 300 and cooled down to 30. The step width for transformations was set to s
                        =
                        T/100. The Boltzmann constant k was set to 0.01.

The energy states E
                        1, E
                        2 were set to the alignment scores L of the present and next slice to be extracted from the volume. The next transformation was chosen randomly and excepted if the probability p of a system to change energy from E
                        1 to E
                        2 was smaller than a random number.


                        
                           
                              
                                 p
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   exp
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  
                                                                     E
                                                                     1
                                                                  
                                                                  −
                                                                  
                                                                     E
                                                                     2
                                                                  
                                                               
                                                               kT
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      E
                                                      2
                                                   
                                                   ≤
                                                   
                                                      E
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      E
                                                      2
                                                   
                                                   >
                                                   
                                                      E
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The temperature was cooled down by 1% after 250 iterations and parameters yielding greatest L finally provided the optimal alignment. The code of the implementation can be found at: http://kathrin-becker.eu/code/Registration.zip.

For quantification of the registration results, the L scores from registration were used. In addition, the registration results were visually examined and to evaluate agreement of BIC between the two imaging modalities, BIC was assessed in the region below the implant shoulder both automated and manually. This measurement refers to the relative fraction of bone being in direct contact with the implant.

Manual measurements were performed using ImageJ (National Institutes of Health, USA) by two experienced investigators (histology: KB, μCT: MS). The length of the implant contour and the lengths of the implant outline in direct contact with the bone were measured in the region below the implant shoulders using the Segmented Line measurement tool (Fig. 3
                        ). Prior to the start of the analyses, a calibration procedure was initiated for the investigators and revealed that repeated measurements were similar at >95% level.

Automated measurements to obtain μCT BIC were implemented and performed using Matlab R2013a. The automated BIC was assessed within a mask of 2 pixel width located below the implant shoulder and 3 pixel distant from the implant surface (Fig. 4
                        ). The mask was computed by applying image dilation and erosion filters on the segmented implant. The position of the implant shoulders was specified manually using Matlab's impixel feature. The BIC measure was given by the relative fraction of pixels classified as bone. To segment the bone, the same procedure as described in Section 3.1 was used.

The statistical analyses were performed using the R statistics software version 2.12.2 [26]. Test for linear association between 2D HI BIC and 2D μCT BIC was performed by calculation of linear models. Results were considered statistically significant at p
                        <0.05.

@&#RESULTS@&#

Segmentation of the implants from μCT was successful for all specimens investigated. Segmentation of bone tissue from μCT was sometimes impeded by artifacts, which were classified as bone in close proximity to the implant surface (Fig. 5
                        ).

The implants could be segmented clearly from HI without adjustment of threshold levels. The bone tissue segmentation from HI required minor adjustments of threshold levels due to low staining intensities in three specimens. As small components were removed during segmentation, very small bone elements were missing after segmentation. It was found that this segmentation procedure was very sensitive to the staining process and may need to be adjusted for different staining procedures.

Computation of the implant axes and subsequent application of chamfer matching provided reliable first guesses when using similarity of the segmented bone L for inter-slice comparison. For the 2D matching of the segmented bone, RMS was in the range of 0.47–4.10. When comparing the RMS values obtained by rotating the normal around the implant axes, no clear global optimum could be found for RMS scores among different slices due to shape similarities of the implants around their axes. The transformation matrix from CM was used to match also the bone tissue which, in contrast to RMS, yielded clear optima and thus a reliant first guess for SA. The similarity scores L were on median 0.83 with 1st to 3rd quartile reaching from 0.83 to 0.87 (Table 1
                        ).

Simulated annealing provided successful fine registration for all specimen and increased the similarity scores L in all cases (median 0.9, 1.–3. Qu.: 0.89–0.91) (Table 1). Visual examination corroborated the high agreement of marrow spaces and bone crest (Fig. 6
                        ).

Significant correlation of BIC for both, manual (Pearson ρ
                        =0.94, p
                        <0.001, CI: 0.80–1) and automated measurements were found (Pearson ρ
                        =0.88, p
                        <0.001, CI: 0.65–1). Regression analysis yielded a significant association between HI and μCT groups (manual measurements: regression coefficient β
                        =1.01, 
                           
                              R
                              korr
                              2
                           
                           =
                           0.87
                        , p
                        <0.001; automated measurements: regression coefficient β
                        =1.7, 
                           
                              R
                              korr
                              2
                           
                           =
                           0.75
                        , p
                        <0.001). BIC values were higher for the automated measurements (median: 0.82; 1.–3. Qu.: 0.75–0.85) compared to the manual measurements (median 0.61; 1.–3. Qu.: 0.52*-0.67) and HI (median 0.65; 1.–3. Qu.: 0.59–0.72). Artifacts were present mainly in the apical portion of the μCT slices.

@&#DISCUSSION@&#

In this study, we presented a novel method for automated 3D–2D registration of X-ray microcomputed tomography with histological sections. This method was developed for the direct comparison of these two techniques, and to evaluate the agreement of the bone to implant contact (BIC). To prove that the correct position and normal vector for the corresponding μCT slice were found, the results were quantified by means of similarity scores and by visual examination.

To the best of the authors’ knowledge, the only study dealing with registration of HI and μCT for biopsies containing orthopedic implants was undertaken by Sarve and collaborators [10]. They employed chamfer matching (CM) with only one degree of freedom and therefore, they required the histological specimen to be taken exactly along the implant axis. However, this is a limitation that can hardly be achieved in practice. Their simulated annealing (SA) approach was not initialized with a first guess and used normalized mutual information instead of the binary images to assess similarity. This worked less reliable which was reflected in a high failure rate of 25% [10].

The results of the present study indicate that CM is a solid and fast method to pose a first guess for the bimodal registration of biopsies with dental implants. RMS was chosen as similarity measure to register the initial series of 2D μCT slices with HI. The implant edges were aligned successfully also for implants in tilted position in HI. Due to shape similarities of the implants around its axis, however, no clear optima could be found when comparing the 72 RMS scores obtained by rotation of the normal vector around the implant axis. Therefore, additional to the chamfer matching approach described by Borgefors [25], the transformation matrices from CM had to be applied to the segmented bone and the L score could be used to find the optimal orientation of the normal vector. The subsequent application of SA improved registration results especially for HI specimen taken rather away from the implant axis, such as specimen 6 (Fig. 6).

The combined registration with CM and SA using conjunct binary images yielded a highly precise registration with median similarity scores of L
                     =90%. This L score can hardly be increased closer to hundred percent due to segmentation limitations caused by artifacts and irregular staining of HI specimens or tissue damage on HI production (Fig. 7
                     ). The problem is that artifacts can be misclassified and that components from bone may be lost during HI segmentation. However, the registered slices have been compared visually and only minor differences could be observed. For example, in one reconstructed slice there were slight differences in the amount of bone tissue close to the implant (arrow in Fig. 6).

Few publications aimed at assessing the agreement of automated BIC measures in μCT and manually obtained values from HI. In particular, Vandeweghe et al. found significant correlation between 3D μCT BIC and HI BIC [8], but 3D to 2D comparison is problematic because BIC highly depends on the cutting position [27]. Song et al. [28] compared 2D μCT and HI BIC on manually registered slices to assess the influence of peri-implant artifacts on bone morphometric analysis. They reported correlation coefficients ranging from 0.29 to 0.43 depending on the distance from the measurement mask to the implant with best correlation at 5 pixel distance. Their results are very different from the present study and the reason may be that manual registration did not respect all degrees of freedom thus giving emphasis on the need for automated approaches.

BIC was measured and compared with HI (Fig. 8
                     ). The associations were significant both for automated and manual BIC measurements, which additionally confirmed goodness of the registration. While the manually assessed BIC values were almost likewise for both techniques, it was found that the automated BIC values were systematically elevated compared to the manual measurements. This may come from the fact that artifact correction was out of scope for this study and no threshold adoption was performed to segment bone in proximity of the implants. However, the results underline that adoption of thresholds and usage of artifact correction procedures may be suitable to bring manual and automated measurements closer together. The registration method proposed in this study may be a helpful tool to verify the results.

Thus future work should aim to find appropriate artifact correction and threshold adoption strategies to improve bone segmentation in proximity of titanium implants. The resulting corrected BIC values should be validated through direct comparison with the respective HI slide. As soon as both methods yield comparable results, intravital scanners may be used to study osseointegration in longitudinal studies. Hence BIC values obtained in the same animal can be compared and the overall number of animals can be reduced. Furthermore, hard tissue sections may be replaced by paraffin embedded decalcified sections which are much cheaper and better suitable for automated evaluation and immuno-histochemistry. Future work should also investigate which extent of mineralization and which trabecular thickness is needed for correct segmentation in proximity of titanium implants. This is essential because in the initial healing phase bone is less mineralized and trabecular thickness is low. Thus differences between HI and μCT may be also observed during new bone formation or bone remodeling. However, as the biopsies of this studies were harvested after 20 weeks of healing, mineralization of the bone was already completed.

In conclusion, the present work provided a novel reliable and highly accurate method to align corresponding image elements of HI and μCT. The visual observations confirmed the high quality of the registration results, which were also corroborated by significant association of BIC measures. However, future research is needed to find suitable thresholds and artifact correction methods for bone segmentation in proximity of titanium implants. This will bring manually obtained BIC values and automatically obtained BIC values closer together and the method provided in this work may be used to verify agreement.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by an unrestricted grant of the Camlog Foundation, Basel, Switzerland. We appreciate the help of Thomas Kaiser, Tina Hagena and Brigitte Hartig who prepared a separate series of histological slices for this study.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.compmedimag.2015.04.005.

The following are the supplementary data to this article: 
                        
                           
                        
                     
                  

@&#REFERENCES@&#

