@&#MAIN-TITLE@&#Analysis of in-air movement in handwriting: A novel marker for Parkinson's disease

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We exploit the fact that movement during handwriting of a text consists of on-surface and in-air movements and use it for differential diagnosis of PD.


                        
                        
                           
                           By applying feature selection algorithms and support vector machine learning methods to separate PD from HC, we demonstrated 85% classification accuracy.


                        
                        
                           
                           Decision support system based on handwriting analysis can be complementary method to diagnosis made by clinician or other decision support systems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Handwriting

Disease classification

Parkinson's disease

Micrographia

In-air movement

Decision support systems

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Parkinson's disease (PD) is the second most common neurodegenerative disease affecting significant portion of elderly population. One of the most frequent hallmarks and usually also the first manifestation of PD is deterioration of handwriting characterized by micrographia and changes in kinematics of handwriting. There is no objective quantitative method of clinical diagnosis of PD. It is thought that PD can only be definitively diagnosed at postmortem, which further highlights the complexities of diagnosis.
               
               
                  Methods
                  We exploit the fact that movement during handwriting of a text consists not only from the on-surface movements of the hand, but also from the in-air trajectories performed when the hand moves in the air from one stroke to the next. We used a digitizing tablet to assess both in-air and on-surface kinematic variables during handwriting of a sentence in 37 PD patients on medication and 38 age- and gender-matched healthy controls.
               
               
                  Results
                  By applying feature selection algorithms and support vector machine learning methods to separate PD patients from healthy controls, we demonstrated that assessing the in-air/on-surface hand movements led to accurate classifications in 84% and 78% of subjects, respectively. Combining both modalities improved the accuracy by another 1% over the evaluation of in-air features alone and provided medically relevant diagnosis with 85.61% prediction accuracy.
               
               
                  Conclusions
                  Assessment of in-air movements during handwriting has a major impact on disease classification accuracy. This study confirms that handwriting can be used as a marker for PD and can be with advance used in decision support systems for differential diagnosis of PD.
               
            

@&#INTRODUCTION@&#

Handwriting is a highly skilled and complex coordinated motor activity. Writing a sentence requires the dynamic interplay of the lower arm, wrist, and finger muscles. The accurate sequencing and online scaling of automated movements and the programming of subsequent strokes are also involved [1]. It has been well documented that handwriting is affected in Parkinson's disease (PD) and micrographia occurs in about 63% of PD patients as an early motor feature [2]. It is characterized by decreased letter size and by changes in kinematic aspects of movements [3,4]. Kinematic variables are sensitive measures for alterations of handwriting movements even with patients treated with dopaminergic medication [3,5].

Besides the PD, the alterations of the handwriting are connected with other diseases. Several authors investigated the temporal, kinematic, and dynamic aspects of handwriting movements to better characterize the handwriting difficulties of children with dysgraphia [6,7] or hyperactivity disorder [8]. Some aspects of the handwriting are also indicators for diagnosis of the Alzheimer disease – the most common neurodegenerative disease [9].

It has rarely been taken into account that hand movement during handwriting consists of two components: an on-surface component, comprising movements executed while exerting pressure on the writing surface, and an in-air component, comprising movements performed without touching the writing surface. The in-air movement has been mostly used for biometric applications [10], but some pilot data suggest that it could have meaningful applications for medical diagnostic purposes as well [11].

There were several attempts to design decision support systems for differential diagnosis of PD in recent years. These usually include speech assessment [12–14], gait monitoring [15,16,17] or tremor assessment [18]. Handwriting and especially in-air movement has not been explored so deeply even if there is proven relationship between symptoms of PD and handwriting. When compared to handwriting, both speech assessment and gait monitoring are more demanding in the terms of technical equipment and signal processing. Speech assessment requires high quality recording conditions without background noise and usually some further post-processing of recorded speech is necessary. This can include human operated speech segmentation that makes whole process much more tedious. Gait monitoring or tremor assessment techniques require specialized equipment such as accelerometers and gyroscopes. On the other hand, diagnosis of PD through the handwriting can be easily administrated at clinic or even patient's home. Handwriting acquisition is quite simple and natural, and does not require any timing or exhaustive repetitions.

Previous research has shown that there are some statistically significant differences between kinematics of PD patients and healthy controls. However extend to which any set of features could be useful in discriminating PD from HC was not given. The contribution of this work is twofold. First, we show that in-air movement has a significant role in diagnosis of PD providing together with on-surface movement clinically relevant classification accuracy. In addition, we proposed a classification model that can be used for automated differential diagnosis of PD. The achieved results indicate that in-air and on-surface trajectories can be used in decision support systems and assist in diagnosis of PD.

Altogether, 37 PD patients (19 men/18 women; mean age 69.3±10.9 years; mean disease duration 8.37±4.8 years; UPDRS V score [19] 2.27±0.84; daily levodopa equivalent dose 1373.4±714mg [20] and 38 age- and gender-matched HC (20 men/18 women; mean age 62.4±11.3 years) were enrolled at the First Department of Neurology, St. Anne's University Hospital in Brno, Czech Republic. (UPDRS V provides information on disease stage based on motor clinical symptoms and their body distribution. UPDRS score 2.27 means that patients suffered from bilateral parkinsonism with mild postural instability). All subjects were right-handed, completed at least 10 years of education, and reported Czech as their first language. None of the subjects had a history or presence of any psychiatric symptoms or any disease affecting the central nervous system (other than PD in the PD cohort). The subjects were non-demented based on the clinician's judgment, caregiver's interview, and the MMSE [21] score (>27 points). PD patients were examined only in their ON-state while on dopaminergic medication, i.e. 1–2h after taking their regular dose of dopaminergic medication. All patients were taking L-dopa dopamine agonist or COMT (catechol-o-methyl transferase) inhibitor. At the time of the study, their symptoms were successfully managed and they had no analgesic treatment. Age-matched healthy controls were examined and treated in St. Anne's University Hospital for cervical and/or back pain syndrome and had no speech problems and handwriting problems. All subjects signed an informed consent form that was approved by the ethics committee of St. Anne's Hospital in Brno.

Each subject wrote a Czech sentence: Tramvaj dnes už nepojede (the tram won’t go today). Sentence was written into template form so there was upper and lower boundary that limited handwriting height. Subjects were instructed to write within the limits, but they did not need exactly match row height. For more information about full template see [22].

Writing of sentence allows to acquire in-air movement not only as interruptions during the writing on particular words, but also between words when subject is proceeding from one word to another. An ink writing pen was held in a normal fashion and subjects were asked to write a sentence at a self-determined comfortable size and speed. Patients had visual feedback of their on-surface writing only. All signals were acquired using Intuos 4M digitizing tablet (Wacom); in the terms of x-coordinate, x(t); y-coordinate, y(t); time stamp t and button status, b(t). Button status is a binary variable, being 0 for pen-up state (in-air movement) and 1 for pen-down state (on-surface movement). The example signals are depicted in Fig. 1
                        . Fig. 1(a) illustrates the handwriting sample of HC and Fig. 1(b) sample of PD patient, respectively.

The x and y coordinates are segmented into on-surface and in-air strokes and analyzed in terms of handwriting measures. The feature calculation stage involves the extraction of kinematic features such as stroke speed, writing speed, velocity, acceleration, jerk (changes of acceleration with time), number of changes in velocity (NCV), number of changes in acceleration (NCA) and relative NCV/NCA. Relative NCV/NCA means that NCV/NCA was normalized by writing duration. Regarding the temporal features, we analyzed time spent in-air, i.e. in-air duration, on-surface duration and in-air to on-surface ratio. Complete feature description is provided in Table 1
                        .

Finally, to obtain complete statistical representation of available features, 30 statistical functionals of the vector features were computed. These include means (arithmetic mean, geometric mean, trimmed means (5, 10, 20, 30, 40, 50)), percentiles (quartiles (25/lower, 75/upper), percentiles (1, 5, 10, 20, 30, 90, 95, 99)), moments (moments (3rd, 4th, 5th, 6th), kurtosis) and other (range, median, mode, standard deviation, outlier robust range (percentile 99th – percentile 1st)) statistical functionals.

To obtain some preliminary insight into the statistical properties of handwriting features, we followed the approach of Tsanas et al. [23] and computed Pearson correlation coefficients and mutual information between feature vectors and associated diagnosis (HC vs. PD). The Pearson correlation expresses measure of linear dependence between features vectors and associated response [24]. Mutual information (MI) is a measure of the amount of the information shared by two random variables. It is defined as:
                           
                              (1)
                              
                                 I
                                 (
                                 X
                                 ;
                                 Y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                                 
                                    ∑
                                    
                                       y
                                       ∈
                                       Y
                                    
                                 
                                 p
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ·
                                 
                                    log
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                                p
                                                (
                                                x
                                                )
                                                p
                                                (
                                                y
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where x and y are possible variable values with a joint probability distribution function p(x, y) and marginal distribution functions p(x) and p(y), respectively [25]. We computed MI by evaluating the marginal entropies H(X), H(Y) and joint entropy H(X, Y) as I(X
                        ;
                        Y)=
                        H(X)+
                        H(Y)−
                        H(X, Y).The entropy is defined as
                           
                              (2)
                              
                                 
                                    H
                                    S
                                 
                                 (
                                 X
                                 )
                                 =
                                 −
                                 
                                    ∑
                                    
                                       x
                                       ∈
                                       X
                                    
                                 
                                 p
                                 (
                                 x
                                 )
                                 
                                    log
                                    2
                                 
                                 p
                                 (
                                 x
                                 )
                                 ,
                              
                           
                        where p(x) is probability density function computed using kernel density estimation with a Gaussian kernel.


                        Table 2
                         summarizes 10 handwriting features most strongly correlated with the target classification variable. All correlations are statistically significant (p
                        <0.05).

As an preprocessing step the data was analyzed using the Mann–Whitney U test for between-group (PD vs. HC) comparisons. The level of significance was set to p
                        <0.05. Features that did not pass Mann–Whitney test were discarded and were not used in further processing.

Our goal was to determine discriminative potential of handwriting and build predictive model only with relevant features. The most straightforward approach would be to try all possible feature combinations (brute force approach) and keep only those that contribute to correct prediction. However, this approach is computationally intractable, and requires huge amount of computational resources. An alternative is to use sequential forward feature selection (SFFS) that enables significant reduction of the computational complexity compared to that of a brute force search but still select relevant features. Since SFFS for large number of features is still computationally demanding, the minimum-redundancy-maximum-relevance (mRMR) [26] feature selection method was applied to reduce dimensionality to 50 features.

The first stage of mRMR, the maximum relevance method, selects the best individual features correlated to target classification variable [26]. Features selected according to the maximum relevance method could have a large redundancy. In order to remove redundancy among features, the minimum redundancy condition is introduced. Therefore, mRMR selects features that are mutually different from each other while still having a high correlation to yield well performing feature subset. Number of 50 features at the output of mRMR was decided as a trade-off between computational complexity and desire to include all relevant features in classification model.

In order to develop a functional relationship to map handwriting measures to subject classification (PD vs. HC), we employed supervised machine learning algorithm support vector machines (SVM) [27,28] with nonlinear radial basis function (RBF) kernel.

The SVM minimizes the classification error and maximizes the margin by determining a separating hyperplane to identify different classes of data. For two-class support vector machine, we consider the following decision function [29]:
                              
                                 (3)
                                 
                                    f
                                    (
                                    x
                                    )
                                    =
                                    sign
                                    [
                                    
                                       w
                                       T
                                    
                                    g
                                    (
                                    x
                                    )
                                    +
                                    b
                                    ]
                                 
                              
                           where 
                              w
                            is the d-dimensional weight vector and b is a bias. To obtain 
                              w
                            and b the following optimization problem with linear equality constraints is solved:
                              
                                 (4)
                                 
                                    minimize
                                    
                                    J
                                    (
                                    w
                                    ,
                                    b
                                    ,
                                    
                                       ξ
                                       i
                                    
                                    )
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       w
                                       T
                                    
                                    w
                                    +
                                    
                                       γ
                                       2
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       ξ
                                       i
                                       2
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       y
                                       i
                                    
                                    [
                                    
                                       w
                                       T
                                    
                                    g
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                    +
                                    b
                                    ]
                                    =
                                    1
                                    −
                                    
                                       ξ
                                       i
                                    
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                    .
                                 
                              
                           
                        

In this minimization problem, N is the number of samples in the training data set, y
                           
                              i
                            is the target value of the training data set, γ is the regularization hyperparameter and ξ
                           
                              i
                            the slack variable.

After solving Lagrangian
                              
                                 (6)
                                 
                                    L
                                    (
                                    w
                                    ,
                                    b
                                    ,
                                    
                                       α
                                       i
                                    
                                    ,
                                    
                                       ξ
                                       i
                                    
                                    )
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       w
                                       T
                                    
                                    w
                                    +
                                    
                                       γ
                                       2
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       ξ
                                       i
                                       2
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       α
                                       i
                                    
                                    {
                                    
                                       y
                                       i
                                    
                                    [
                                    
                                       w
                                       T
                                    
                                    g
                                    (
                                    
                                       x
                                       x
                                    
                                    )
                                    +
                                    b
                                    ]
                                    +
                                    
                                       ξ
                                       i
                                    
                                    −
                                    1
                                    }
                                 
                              
                           discriminant function of linear separating hyperplane is derived as
                              
                                 (7)
                                 
                                    f
                                    (
                                    x
                                    )
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                α
                                                i
                                             
                                             
                                                y
                                                i
                                             
                                             K
                                             (
                                             x
                                             ,
                                             
                                                x
                                                i
                                             
                                             )
                                             +
                                             b
                                          
                                       
                                    
                                 
                              
                           where α
                           
                              i
                           
                           ∈R is Lagrangian multiplier and K(x, x
                           
                              i
                           ) is a kernel function [30]. We used radial basis kernel function, defined as K(x, x
                           
                              i
                           )=exp(−||x
                           
                              i
                           
                           −
                           x||2/σ
                           2). The kernel parameter σ is referred to as the kernel width.

In general, SVM requires the specification of several internal parameters, and SVMs are known to be sensitive to the values of these parameters [28]. The performance of SVM with RBF kernel depends on three parameters: kernel width (σ), penalty parameter (γ) and convergence epsilon (ϵ). These parameters were optimized using a grid search of possible values. Specifically, we searched over the grid (γ, σ, ϵ) defined by the product of the sets γ
                           =[10−5, 10−4, …, 103, 104], σ
                           =[10−5, 10−4, …, 102, 103] and ϵ
                           =[10−5, 10−4, …, 102, 103].

Classifier validation was conducted using a leave-one-out approach. That is, we left out the sample of one individual as if it were an unseen individual; the remaining samples were used as a training dataset.

The whole process of feature selection and classification was repeated a total of 50 times, where in each repetition the original dataset was randomly permuted prior to splitting into the training and the testing subsets. The number of features at the SFFS output cannot be set to concrete number since algorithm itself evaluates the number of the most predictive features. In our experience fewer than ten features were usually selected during 50 repeated realizations. Classification accuracies over 50 repetitions were averaged. The standard deviation of averaged results is quite small indicating that feature selection (SFFS, mRMR) and classification are quite robust to initial conditions. The classification performance of the predictive model was evaluated for three different scenarios: using only features based on the in-air movement, using only features extracted from the on-surface movement, and using a combination of both groups of features. By combination, we mean that both feature groups were merged prior to the feature selection.

@&#RESULTS@&#

On average, the ratio of time spent in-air to time spent on-surface is 0.77 for HC and 0.75 for PD subjects. Of the ten features that most strongly correlated with the diagnosis, nine were in-air movement-related features. This result provided an initial confirmation of our hypothesis that the in-air features contain information relevant for discriminating PD from HC. The features with the largest relevance to the diagnosis, sorted according to an absolute correlation coefficient are: range of in-air jerk (R
                     =−0.428), range of in-air acceleration (R
                     =−0.424), and minima of in-air acceleration (R
                     =0.4148), see the Table 2. The decreased range/standard deviation of relevant kinematic features in PD as compared to HC reflect the monotonous motor performance in PD caused by bradykinesia (increased slowness of movements) and rigidity rigidity (increased muscle tone).

To discriminate between PD patients and HC controls we used SVM, that showed good prediction performance in problems similar to ours [12] and in general perform well in various biomedical applications [31,32]. Classification employing features based on the in-air movements revealed an accuracy of 84.43±2.88%. Classification accuracy was 78.16±1.96% when only features based on the on-surface movement were employed. The utilization of features from both modalities (in-air movement and on-surface movement) led to further improvement in classification accuracy: 85.61±1.72%. The results of classification accuracy together with sensitivity and specificity are provided in Table 3
                     .

@&#DISCUSSION@&#

The writing of a sentence consists of different strokes elicited at a fine-tuned speed and acceleration that requires a high degree of simultaneous processing and may therefore have a higher programming load than a sequence of identical stroke [4]. This becomes important in the evaluation of handwriting in PD, since both motor program sequencing and concurrent processing have been shown to be disturbed in PD [4,5,33].

By applying mRMR, SFFS procedure, and SVM learning methods to separate PD from HC, we demonstrated for the first time that the assessment of in-air hand movements during sentence handwriting has a higher impact than the pure evaluation of on-surface movements, leading to classification accuracies of 84% and 78%, respectively. Interestingly, combining both in-air and on-surface kinematic features for identifying PD patients on dopaminergic medication improved classification accuracy by only 1% over the pure evaluation of in-air movements.

The binary SVM classifier was applied to segment data from healthy controls and patients with PD. We chose SVM since it allows to capture complex multivariate relationships in the data, it has good generalization properties and can deal with feature vectors of high dimensionality. In fact, SVM classifier was successfully applied to the individual classification of a variety diseases and medical conditions [12,34,35]. Because of the nonlinear propagation of the features we selected RBF kernel. Even thought we tuned SVM classifier to obtain highest classification accuracy, we believe that there may be still some space for improvement. Currently, there are plenty of new classifiers or improvements of existing classifiers that can further enhance classification performance. However, this is beyond the scope of this paper that focuses on demonstrating the idea of utilization of in-air movement for diagnosis of PD.

Handwriting in PD is thought to be impaired mainly due to hypokinesia (decreased amplitude of movements) and bradykinesia [4,5]. The underlying pathophysiological mechanisms probably involve inefficiency of the basal ganglia-thalamocortical circuits and particularly disturbed activation of the supplementary motor area, which is thought to be involved in “open-loop” performances, in which a motor task is run off automatically [36]. It has been shown that PD patients are able to compensate if the task is modified to involve “closed loop” performance. This can be done either by providing visual cues or by otherwise drawing attention to the task. The lateral premotor cortex is additionally activated when attention must be paid during a motor task. This notion may at least partially explain the fact that the in-air kinematic features reflected the impaired open-loop performance in PD better than the on-surface writing to which patients devoted more attention under the visual guidance. As compared to on-surface movements, the in-air movements elicited during handwriting of a sentence may involve additional cognitive processes such as motor planning, programming of the alternating motor sequences, and movement initiation that may also have impacted on the kinematic features and our results.

The presented results show that in-air movement possess significant amount of information relevant to diagnosis of PD and as such can be incorporated in decision support systems that are the important part of the next generation health-care. The main advantage of the proposed approach is that acquisition of handwriting signals at clinic or at home is relatively simple and easily administered. In fact, all of the data used in this study were collected in a clinic environment with a tablet connected to a notebook computer without any previous preparation in a room or special environment. We did not use any custom made hardware, only commercially available tablet that makes the whole approach very feasible. Relatively simple management of the test makes it possible to use it at a patient's home, e.g. for disease monitoring, that is important advantage over other approaches.

Handwriting assessment for PD diagnosis can serve as a complementary method to diagnosis made be clinician or other decision support tools [12,37]. We believe that further investigation, utilization of new handwriting features and further tuning of machine learning techniques can improve prediction accuracy and make this approach even more useful and competitive. Here, we assume that mainly new handwriting features can provide more insight into effects of PD on handwriting and can be beneficial for diagnosis.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the project COSTIC 1206, NT13499 (Speech, its impairment and cognitive performance in Parkinson's disease), GAP102/12/1104, project CEITEC, Central European Institute of Technology: (CZ.1.05/1.1.00/02.0068) from the European Regional Development Fund and by FEDER and Ministerio de Economa y Competitividad TEC2012-38630-C04-03. The described research was performed in laboratories supported by the SIX project; the registration number CZ.1.05/2.1.00/03.0072, the operational program Research and Development for Innovation. Peter Drotár was supported by the project CZ.1.07/2.3.00/30.0005 of Brno University of Technology.

@&#REFERENCES@&#

