@&#MAIN-TITLE@&#Review of automatic pulmonary lobe segmentation methods from CT

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A detailed review of automated segmentation methods for the pulmonary lobes from clinical CT data.


                        
                        
                           
                           Formulation of a modular description, identifying common strategies.


                        
                        
                           
                           A methodological review of the challenges and solutions at each algorithmic stage.


                        
                        
                           
                           A proposed workflow for the future development of improved algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

CT

Fissure

Lobe

Lung

Pulmonary

Segmentation

@&#ABSTRACT@&#


               
               
                  The computational detection of pulmonary lobes from CT images is a challenging segmentation problem with important respiratory health care applications, including surgical planning and regional image analysis. Several authors have proposed automated algorithms and we present a methodological review. These algorithms share a number of common stages and we consider each stage in turn, comparing the methods applied by each author and discussing their relative strengths. No standard method has yet emerged and none of the published methods have been demonstrated across a full range of clinical pathologies and imaging protocols. We discuss how improved methods could be developed by combining different approaches, and we use this to propose a workflow for the development of new algorithms.
               
            

@&#INTRODUCTION@&#

The human lung is divided into five functional regions, known as the pulmonary lobes. The identification of these lobes has important applications in disease assessment and treatment planning. Many lung diseases act at a lobar level. For example, emphysema [1], postprimary tuberculosis [2] and silicosis [3] usually affect the upper lobes, while idiopathic pulmonary fibrosis is commonly associated with the lower lobes [4]. Measuring lung disease at a lobar level is therefore of great clinical importance for phenotyping disease and assessing its severity. There is currently a lack of quantitative, objective methods for the regional assessment of lung disease. Clinical imaging technologies such as computed tomography (CT) have the potential to provide such measurements [5], but to perform regional lobar-based analysis, they require techniques to segment the pulmonary lobes. Lobe segmentation has further applications in surgical treatment planning. Determining the location, shape and volume of the lobes is important for planning investigatory and surgical procedures such as bronchoscopy, endobronchial valve implantation and lobar volume reduction surgery (LVRS). Lobar volume measurements can be used to assess hyperinflation, which is a criterion for endobronchial valve implantation. LVRS offers improved outcomes for patients with upper lobe emphysema, but may not be appropriate for those with lower lobe emphysema [6]. Distinguishing these cases is therefore critical, but is currently often done using subjective visual assessment. Manual lobe segmentation is too time-consuming and suffers from some degree of inter-observer variability. There is therefore a need for robust and accurate computational algorithms for segmenting the pulmonary lobes from clinical data.


                     Fig. 1
                      shows a schematic diagram of the lungs. The lungs are bounded by two layers of membrane (pleura) separated by a thin layer of lubricating pleural fluid. The inner membrane (visceral pleura) folds into the lung between the lobes, forming the pulmonary fissures. These fissures separate the pulmonary lobes. The right lung normally comprises three lobes (upper, middle, lower). The left lung, which has a reduced volume due to the location and shape of the heart, normally has only two lobes (upper and lower) [7,8]. The lobes are served by separate bronchial and vessel trees, and are largely anatomically independent. Three main fissures separate the five lobes; the major (oblique) and minor (horizontal) fissures in the right lung, and the major (oblique) fissure in the left lung. The fissures contain pleural fluid and provide physical separation between the lobes while permitting some relative movement. Lobar anatomy can vary significantly between individuals; fissures are often incomplete (they do not fully separate the lobes) and additional fissures may be found within the lobes [9].

CT is the modality of choice for clinical lung imaging. While mostly used for visual assessment, CT offers clinically useful measurements such as analysis of density [10] and airways [11]. An important feature of CT is the high visibility of the lung boundaries and pulmonary fissures (Fig. 2
                     ). In isotropic CT images (where voxel dimensions are approximately the same in all three axes), lung boundaries exhibit a sharp density jump, while fissures appear as a locally bright sheet crossing the 3D volume of the lung. Given the lung boundaries and fissures, it is possible to delineate (segment) the pulmonary lobes and use these to derive lobar measurements. These lobar segmentations can also be registered to other imaging modalities such as hyperpolarized gas MRI [12], allowing lobar measurements in modalities where lobar boundaries are not visible. Acquiring CT images at different stages in the breathing cycle can be used to study lung mechanics and also estimate lung ventilation [13]. Segmenting the lobes would permit this analysis to be performed at a lobar level and allow the relative movement (sliding) and changes in the lobar volumes to be taken into account.

The current gold standard for CT lobar segmentation is the manual tracing of lobar boundaries by an experienced pulmonary radiologist. However, this is an extremely laborious task, typically taking hours per patient. As a result, manual lobe segmentation is rarely performed in clinical practice and clinicians instead rely on subjective visual inspection. It is not surprising therefore that there are high hopes and considerable interest in computational techniques for extracting the lobes automatically (no user interaction) or semi-automatically (minimal user interaction).

Computational lobe segmentation is based on segmenting the lungs and the three main pulmonary fissures. Lung segmentation methods are well established and are discussed in Section 3.3. However, fissure segmentation is more challenging. Fissures can exhibit density values that are similar to those for other lung features, and this is also true for higher-order metrics that are used to detect the fissures, such as the structure tensor and Hessian matrix. Fissures frequently appear blurred due to partial volume effects and patient motion. Furthermore, fissures vary between subjects, can be incomplete, and lobe-separating fissures can be confused with other minor and accessory fissures which are often visible on CT scans [9,14].

Several authors have presented computational methods for segmenting the pulmonary lobes from CT data [15–24]. This is an active area of research and no method has yet been demonstrated to be robust and accurate across the wide range of clinical imaging parameters and pathology experienced in clinical practice. The purpose of this review is to discuss and compare existing works, in order to highlight the key challenges of a lobe segmentation algorithm. We find that lobe segmentation is a complex multi-stage process that cannot be addressed by a simple algorithm. However, we find a great deal of commonality between the proposed methods, and the combination of features from different methods may be the best approach for developing a robust method that addresses the complexity and multiple challenges of lobe segmentation in clinical practice.

We have chosen to focus on a comparison of the methodologies used, rather than a quantitative comparison of results. We have chosen this approach for two principal reasons. First, direct quantitative comparison is difficult because published results use a variety of different validation metrics (see Section 3.7) and are based on different sets of data, each of which may present their own unique challenges. True quantitative comparison requires algorithms to be run on the same data, which is not possible because few authors openly publish their code or validation data. At a recent MICCAI grand challenge workshop, only two of the groups submitted lobar segmentation results [25,26].

Our second reason for preferring a methodological comparison is that the published methods share many common steps in their algorithms (see Section 3), and no attempt has yet been made to compare the effects of individual stages towards the final results. We believe the performance of a particular lobar segmentation method may arise not from its overall approach, but from the effectiveness of one of its component stages. Methods could be improved by identifying weak points and substituting more successful approaches from other published works.

This review is organized as follows. In Section 2 we present a brief summary of the published works on CT-based lobe segmentation. In Section 3 we perform a detailed methodological comparison of these works in the following areas: data and imaging protocols; automation; lung segmentation; fissure detection; validation and computational considerations. In Section 4 we use these insights to propose a workflow to aid in the development of new lobe segmentation methods. Finally, Section 5 discusses the future challenges and directions in this field.

In this section, we briefly discuss the published methods for lobe segmentation. These methods are summarized in Table 1
                     . We compare the methods in greater detail in Section 3.

van Rikxoort et al. [15] use an atlas-based registration to segment the pulmonary fissures, based on lung boundaries and fissure points detected using a supervised filter. They also construct an approximate lobar segmentation from the airways, which they use to guide the final registration in regions where no fissure points are found. Quantitative and qualitative results are reported on 20 and 120 datasets, respectively.

Zhou et al. [16] initialize their fissure search using the assumption that blood vessels are connected within lobes but do not cross the lobar boundaries. Segmented vessels are allocated to lobes using information from the airway tree. The gaps between lobar groups then define regions of interest for the fissures. Edge-detection filtering is used to find fissure points, which are connected using morphological operations. Quantitative validation is performed on seven datasets, although lobe separation is only performed where complete fissures have been found.

Kuhnigk et al. [17] use the vasculature in a similar way. However, instead of assigning vessels directly to lobes using the airway tree, they perform a watershed transform [27] on a search image combining intensity with a distance transform to the segmented vessels. The lobar allocation is based on marker points derived from the bronchial tree. The resulting fissure lines broadly follow the gaps between vessels but track high intensity fissure lines if they are close enough. Limited validation is presented for a single dataset. To improve fissure accuracy, Lassen et al. [18] added Hessian-based fissure point detection into the search image, again through a distance transform. Results for this extended method are presented on 42 datasets.

Zhang et al. [19] use an atlas to initialize a search for fissure regions of interest. The atlas is constructed from fissures and lung boundaries and initializes a fuzzy reasoning search for regions containing the oblique fissures. A graph search then finds optimal fissure curves using structure tensor-based fissure point detection and smoothing constraints. Manually placed marker points are required to segment the right horizontal fissure. In later work, Ukil and Reinhardt [20] replaced the atlas initialization with a vasculature-based transform similar to that used by Kuhnigk et al. [17]. The resulting watershed boundary is used to define the region of interest for the final graph searching stage. This is different to Lassen et al. [18], who incorporate fissure detection directly into the watershed transform. Ukil and Reinhardt [20] present results for 29 patients, although manual correction was performed in some cases to obtain correctly the right horizontal fissure.

In [24], we perform a watershed initialization step similar to Ukil and Reinhardt [20], but we use a “vascular density” rather than a distance transform. The vascular density is derived from a strongly smoothed vesselness filter and is more robust to small vessels close to fissures. The results initialize a fissure point search based on a Hessian-based fissureness filter. Outliers are removed using morphological operations and a smooth multilevel B-spline is fitted to the resulting points. Results are presented for 10 patients.

Wei et al. [21] use estimated fissure directions to search for a planar region of interest free of vessels and airways, and then detect possible fissures using a 2D wavelet transformation. Results are presented for nine patients. Ohkawa et al. [28] use a similar idea, fitting fissure planes between possible vessel and bronchial structures detected using local maxima filtering. However, the method is only applied to two subjects and validation results are not presented for the horizontal fissure. Further work is presented in [29].

Some authors have developed methods that do not depend on auxiliary pulmonary structures such as vessels and airways. However, some form of a priori information is generally still needed to correctly identify and separate the lobes.

Ross et al. [22] use a particle sampling approach to identify candidate fissure points. Fissure evaluation is based on 2nd order Hessian analysis, similar to that used by other methods [18]. However, rather than directly extracting fissure points, the Hessian is used to generate a vector field which directs the motion of a randomly-created system of interacting particles. After a number of iterations, particles tend to concentrate along the fissures. False candidates are removed using morphological analysis. A fissure surface is then estimated by a statistical approach, using a simple manually defined atlas of marker points as a prior. The final fissure curves are computed by fitting a smooth thin plate spline to the remaining points. Results are presented for six datasets.

Pu et al. [23] apply a threshold to detect candidate fissure points which they use to build a 3D geometric mesh. Successive smoothing operations reduce the mesh to a series of approximate fissure patches, which are separated and labeled according to their orientation. Radial basis functions are then used to extend the detected fissure patches to form a complete fissure surface. Qualitative results are presented for 65 patients. A related method with quadratic B-spline surface fitting is introduced in [30].

Lobe segmentation has been used in applications such as bronchial labeling [31] and model-building [32]. Some authors extend lobar segmentation ideas to extract the pulmonary segments [33–35]. However, validation is difficult as the segment boundaries are not generally identifiable on CT scans.

Recent methods have also proposed level-set lobe segmentation [36] and the use of atlas methods and graph cuts [37].

Other methods exist that detect fissures but do not extend this to lobe segmentation. Saita et al. [38] use a vasculature-based method similar to Zhou et al. [16], but they do not perform lobe segmentation since their fissure surfaces can be incomplete. Wang et al. [39] describe a semi-automated method for extraction of the oblique fissures only. The user segments an initial slice, which is used to iteratively initialize a 2D curve searching algorithm in neighboring slices. Other approaches include machine learning [40], a genetic algorithm for detecting the oblique fissures [41], filter-based fissure enhancement [42,43] and surface curvature analysis [44].

The natural approach to lobe segmentation is to first segment the lungs and then divide them into lobes by detecting the three principal fissures. The challenge for automated methods lies in the fissure segmentation. Interestingly, published works broadly follow the same strategy, which we summarize by the following stages:
                        
                           1.
                           Segmentation of the lung using standard methods (see Section 3.3);

detection of candidate fissure voxels using local image filtering (see Section 3.4);

use of prior information to reduce the set of candidate fissure points to a more likely subset (see Section 3.5);

construction of continuous fissure surfaces using the candidate points from stage 3, with extrapolation to span the whole lung volume (see Section 3.6).

To a certain extent, these stages are modular. For example, it would be possible to exchange the lung segmentation from one algorithm with that from another, without significantly affecting the results. For some methods, two of these stages are combined. For example, a watershed transform [27] may naturally implement stages 3 and 4 together.

We summarize the heuristics used in Table 2
                      under a number of categories. In the following we analyze each category of heuristics in turn to understand its relative importance and the strengths and weaknesses of the methods used by each author. For some categories, we include relevant algorithms that are not part of current lobe segmentations methods, but have been successfully used in other applications of pulmonary image analysis.

The quality of the CT images and imaging protocols used can have a significant effect on lobar segmentation results. Table 1 includes the main imaging parameters (where known) for the data used by the published lobe segmentation methods.

The works described here use high resolution multi-detector computed tomography (MDCT) images. In-plane spatial resolutions vary between 0.5 and 1mm, while slice spacing and thickness is typically below 1.5mm. These resolutions are now common in clinical practice, particularly for CT-based image analysis such as detection of emphysema in the lung parenchyma and surgical treatment planning. Images with a lower spatial resolution or greater slice thickness or slice spacing are less suited for lobe segmentation algorithms since the pulmonary fissures become less clear or undetectable due to partial volume effects. Small anatomical features that are used to guide lobe segmentation, such as airways and vessels, also become less visible. Pu et al. [23] are the only authors to investigate the effect of image resolution. They reconstruct five of their datasets at three different slice thicknesses (0.625mm, 1.25mm, 2.5mm). The qualitative evaluation of the segmentation results is similar for the 0.625mm and 1.25mm slice thicknesses, but significantly poorer for the 2.5mm slice thickness.

Another important factor affecting fissure detectability is the lung inflation level during imaging. CT is commonly performed during breathhold after maximal inspiration, known as total lung capacity (TLC). The increased volume of air in the lung parenchyma increases the contrast and separation between anatomical features including fissures. For this reason, most of the lobar segmentations described here are performed on images derived at TLC. However, CT may be performed at other levels of inflation, for example to increase reproducibility or reduce patient discomfort. Several authors apply their algorithms to both inspiratory and expiratory images (taken at breathhold after exhalation) [19,20,22]. They report good results, but without direct quantitative comparison. Lung inflation is important to lobe detection not just because of the detectability of the fissures, but also the significant change in lobar volume, shape and location as lobes expand and slide relative to each other during breathing.

Radiation dose also affects the quality of the images and therefore may affect the quality of lobar segmentations. This is particularly important because while standard dose imaging is common, there is increasing interest in the use of low dose CT to reduce the exposure to patients of ionizing radiation. While no existing published works directly compare segmentations from standard and low dose images, several include low dose images among their data and report good results [15,18,22,38]. Quantitative comparison has not been made, but reported results are similar to those for standard dose imaging. Not all authors define the meaning of low dose, but we assume the term to imply a current-time product of <60mAs compared to >100mAs for standard dose imaging.

In clinical practice, CT lung imaging is typically performed on patients who are already symptomatic of lung disease, and therefore some form of pathology is common in these images. Most authors include pathological images in their analysis, including lung nodules [16,18,19,21,39], emphysema [16,18,20,22], pulmonary fibrosis [18] and interstitial disease [22]. However, none have evaluated the effects of different pathologies on segmentation performance. Two authors report a complete failure in their methods for certain datasets exhibiting severe pathology [16,21]. While the lobe segmentation methods have been shown to be effective in the presence of disease, the effect of disease is an important consideration that has not been evaluated. For example, it is possible that high-density fibrotic tissue could be mistaken for part of a pulmonary fissure due to the similarity of its local appearance (see Section 3.4).

Pulmonary anatomy varies between individuals. This has important effects on all methods, since most heuristics incorporate anatomical assumptions, whether implicitly or explicitly. Of particular importance are variations in the airway branching structure to airway segmentation and labeling; the crossing of lobar boundaries by vasculature; and the shape and locations of the lobe-separating fissures. The importance of these anatomical variations is discussed in the corresponding sections below.

Segmentation algorithms are commonly classified as semi automated (requiring some user interaction) or fully automated (requiring no user interaction). However, this is not the best distinction for real-world applications. In clinical practice, an automated lobe segmentation would require reviewing before it is used, because it is impossible to guarantee any algorithm would be accurate for every possible dataset. Such a verification step is itself an interaction, and requires some user time. In practical terms therefore, all algorithms will be semi-automated. A fast and interactive correction mechanism can be combined with this review stage; some existing methods have simple methods for minimal user interaction [20].

For this reason, we define three types of automation: manual initialization, manual correction and fully automated. Manual initialization algorithms require user interaction before the algorithm can start. These are suboptimal because they may impose an unnecessary burden on the user and prevent fully automated preprocessing. Manual correction algorithms are those that proceed automatically, but permit interactive manual correction of the results. This approach is preferable, since further correction is only required if the user deems it necessary. Fully automated algorithms are those that have no interaction, although there is no reason a correction facility could not be added. While it is generally desirable to reduce user interaction as much as possible, fully automated methods should not be preferred over semi automated methods unless the additional burden to the user is significant.

In all the lobe segmentation algorithms, the first step is to segment the lung region. While not precisely defined [45], the lung region is usually considered to be the volume enclosed within the pleura, including the lung parenchyma, airways and vessels, but excluding those parts of the major airways and vessels which extend beyond the pleural boundary.

Much of the lung parenchyma falls within an “air-like” range of density values, bounded by high-density tissue at the pleura. Most authors here adopt a widely used lung extraction method, which is to search for a large connected region of the air-like values within the image [46–50]. A threshold is chosen using analysis of the gray level histogram, and an initial lung region is then extracted either by region growing from the airways [17] or by finding the largest connected component in the image [46]. When used with a fixed threshold, both methods produce the same result, a single region comprising the left and right lungs connected by the airway tree (see Fig. 3A).

In the recent MICCAI lung segmentation challenge workshop, these threshold-based methods gained the best overall scores [25,26,50,51] compared to other methods such as active shape methods [52] and supervised voxel classification [53]. However, while these methods are fast, robust and accurate for healthy lungs, they may perform less well in the presence of pathology [54–56]. In particular, pathological tissue near the lung borders may be interpreted as being exterior to the lung. Results may be improved using knowledge-based analysis of the segmented lung border. In their lung segmentation algorithm, Pu et al. [54] extend the threshold-based method to include lung nodules adjacent to the lung border. Their method refines the lung border to remove convex regions which may indicate oversegmentation. Prasad et al. [57] adjust the threshold used for the region-growing method based on how close the resulting lung border matches the shape of the segmented ribs. Sun et al. [58] also use the ribs, this time to guide an active shape model. Other lung segmentation methods include supervised voxel classification [59] and stochastic methods [60]. van Rikxoort et al. [56] use a hybrid approach where a conventional threshold-based lung segmentation is first performed. Shape and volume measurements are made to detect if a segmentation error occurred, in which case a multi-atlas lung registration is performed. They found the atlas method to be more accurate in cases where a segmentation error was detected, while the conventional approach is both more accurate and much faster in other cases.

In order to separate the lungs, the main bronchi must be identified and then removed from the segmentation. This is done using the airway segmentation methods described in Section 3.5. For most datasets, removing the airways completely separates the segmentations of the left and right lungs. However, sometimes they remain connected in regions where the physical boundary separating the lungs is particularly thin, such as near the apex. This results from partial volume effects; the boundary is so thin compared to the voxel size that the CT values of voxels around the border lie within the air-like threshold and can connect across the boundary. However, the border is still generally visible as a higher-density surface separating the lungs. Authors employ slightly different methods to find this surface and use it to separate the left and right lungs. Kuhnigk et al. [17] and Lassen et al. [18] use a watershed transform [27] seeded from automatically chosen points in each lung; this separates the original segmentation into two basins (lungs) at the higher-density ridge between them. Other authors [19,20,22,56] perform a morphological erosion to separate the lungs and then search the removed voxels for the boundary with the highest average density using dynamic programming. Zhou et al. [16] employ a similar method, but after the erosion, voxels are re-allocated to each lung using heuristics based on the curvature and normal vectors for the lung surface.

Once the left and right lungs have been separated, morphological operations are typically applied to fill holes within the segmented lung volumes and to smooth the lung surfaces (see Fig. 3B). This helps to correct small errors at the boundaries.

Fissures are the most visible boundaries between the lobes, and therefore fissure point detection is an essential part of any accurate lobe segmentation method. Fissures appear as locally bright sheets crossing the pulmonary volume (Fig. 2). All the published methods use local filtering to detect voxels that lie on this sheet, so that they can be used to construct a continuous surface. This is typically based on analyzing image intensity and its discrete derivatives, computed from the local neighborhoods around each voxel (Fig. 4
                        ). Lassen et al. [18], Ross et al. [22] and we [24] use eigen analysis of the second-order Hessian matrix for each voxel. A single, large negative eigenvalue indicates a bright plane-like structure in the direction perpendicular to the corresponding eigenvector, which may indicate a fissure. Ukil and Reinhardt [20] search for ridge-like structures on 2D slices using the MLSEC-ST approach [61], based on eigen analysis of the 1st order structure tensor. Other authors employ various edge detectors [16,38,39], 2D wavelet transforms [21], and supervised filtering trained on manual segmentations [15]. Even a simple threshold operation can be effective, if the subsequent filtering operations can remove the large number of false positives that result [23].

Detecting fissure points through filtering is a trade-off between finding as many true positives as possible (sensitivity) and reducing the number of false positives (specificity). Highly specific methods often do not perform well as they erroneously remove large areas of the fissures. This is due to inconsistency in fissure appearance caused by anatomical variability, patient breathing and partial volume effects. Therefore, fissure detection methods normally adopt a “greedy” over-segmentation approach (high sensitivity with poor specificity). However, this high sensitivity can produce many false positives because the local fissure appearance is similar to that of other lung structures. Morphological operations such as direction-based connected component analysis [22,23] can be used to reduce false positives. Another method is to use the anatomical information discussed in Section 3.5 to identify a ‘fissure region of interest’ and exclude points outside this region [16,19,20,38]. This has the additional advantage of improving execution time, since fissure detection need only be applied to the comparatively small number of voxels within this region. The drawback of this approach is that it relies on the anatomical methods being good enough to find a region of interest containing all of the fissures. If any fissure points lie outside the region, they are simply ignored and there is no mechanism allowing the strength of the fissure detection to compensate for the inaccuracy of the region of interest.

The method used for fissure detection may in fact be less important that the method used for removing false positives. van Rikxoort et al. note that their atlas registration algorithm, while making use of detected fissure points, does not depend on the particular method of fissure detection, and that an alternative, faster method could be substituted without significantly affecting their results [15].

Most authors use prior information as part of fissure detection, either directly through the segmentation of pulmonary structures and atlas methods, or indirectly through a priori assumptions about the location and appearance of fissures.

A number of works [16–18,20,24,38] use the airways and vasculature to help localize the fissures. This is based on the idea that small airways and blood vessels do not cross lobar boundaries, so fissures should be located in the gaps between airway and vessel trees. The vasculature provides a more precise fissure localization than the airways, because more generations of vessels can be detected using CT, and these vessels span the entire lung volume [62]. In the airways, around seven generations can be detected, which cover only the central part of the volume [45]. The difference between the detectable airway and vessel trees is illustrated using a 3D rendering in Fig. 5
                        .

However, airways still have an important role in initialization of the fissure search, because the lobar branching structure of the main bronchi can be analyzed with reasonable reliability [63–65]. The vasculature branching structure is more problematic as some connections are hard to detect and the arterial and venous trees are difficult to separate [45,62]. Therefore, authors adopt the method of using the airway tree, labeled by lobe, to initialize a fissure search based on the vasculature [16,18,20,24,38].

Segmentation of the airways is an ongoing research area and was the subject of a recent MICCAI workshop challenge [66]. The most widely used methods are based on region-growing and wave propagation [63,67–69]. Other approaches include detecting tube-like airway structures and connecting them to form a tree [70,71], and morphological methods [72]. Model-based approaches make use of additional information such as vessel locations [73]. Other authors use a hybrid approach, typically combining region-growing with other methods [74–77].

All the lobar segmentation methods which segment the airways [16–18,20,24,38] use variants of a threshold-based region-growing algorithm. Starting from the trachea, this extracts the air space inside the bronchial tree by adding neighboring points with intensities similar to that of air (−1000 Hounsfield Units) to the segmentation. The trachea location can be automatically determined through analysis of the lung segmentation found in Section 3.3, due to the trachea's distinctive shape and location. An explosion control heuristic prevents the segmentation leaking into the lung parenchyma at points where airway walls are not detectable due to partial volume effects [69,74,77].

The next stage is to analyze the resulting bronchial tree to determine which lobes are supplied by each bronchus. This is typically done through a knowledge-based approach where the branching structure of the bronchial tree is compared to a standard textbook model, with heuristics to deal with segmentation errors and minor variations in anatomy [63–65]. Analysis is typically performed on the airway centerline, which is computed using a skeletonization procedure (see Fig. 6
                           ).

Algorithms that make use of the airway tree are highly sensitive to the labeled airway segmentation and make two assumptions: (a) that the airways have been correctly segmented for enough generations to determine the lobar branching structure; and (b) that the airway labeling heuristic performs correctly for the dataset. Both of these assumptions could be problematic. The airway segmentation may fail in the presence of imaging artifacts, caused by surgical implants, noise or patient motion. In low dose or thick-slice data the bronchi leading to the middle right lobe are particularly vulnerable to omission. If this happens, part of the lower right lobe may be mislabeled as the middle right lobe. The second assumption may fail if the heuristics do not take into account variations in human bronchial anatomy, where lobar divisions do not always follow the simplified ‘textbook’ model [78].

In some approaches, blood vessels are extracted next, either using a threshold-based region-growing method similar to that used for the airways [15–18,38], or through detection of tube-like structures using second-order image information from the Hessian matrix [20,24]. The vasculature provides a powerful approach to assist with fissure detection [16–21,24,38], although it does not provide sufficient information to be used on its own [18]. However, inaccuracies or mislabeling in the segmentations may require manual correction [20] and cause some authors to consciously avoid using the vasculature altogether [15,22,23].

Distance transforms to the vasculature are computed and used to find the region of interest in two different ways. Zhou et al. [16] and Saita et al. [38] directly allocate vessels to lobes using the nearest labeled bronchus. Distance transforms are computed from each lobar vessel group, and the difference between the two locates a region of interest for fissure detection. This region is typically narrow in the center of the lungs but can become quite wide in regions where there are few detected vessels, such as near the lung boundaries. This method provides no information about where in the region of interest the fissure might be located; this is left entirely to the fissure detection (Section 3.4) and surface fitting (Section 3.6) stages.

To produce a more refined fissure location, Ukil and Reinhardt [20] and Lassen et al. [18] combine the vasculature distance transform with image intensity, and then apply a watershed transform to separate the image into lobes. The watershed is seeded using lobar points derived from the labeled bronchial tree. The resulting boundaries more accurately track the fissure location but can still produce significant errors. Because of this, both groups added filter-based fissure detection to their algorithms in different ways. Ukil and Reinhardt [20] expand the resulting boundary to define a region of interest and search for fissure points within this, in a similar way to the methods described above [16,38]. By contrast, Lassen et al. [18] add fissure detection directly into the watershed cost function, so that the resulting watershed boundary determines their final lobar segmentation.

A limitation with the use of the vasculature is the reliability of the vessel segmentation. The use of the distance transform means that the predicted fissure locations will tend to track the line equidistant to lobar vessel groups. There is no anatomical reason this should be the case, and it means results are very sensitive to vessels near the fissure boundaries. Pulmonary nodules can be incorrectly labeled as vessels due to their similar local appearance. Any vessel-like structures which appear close to the fissure boundaries are likely to disrupt the fissure detection algorithm, since the distance transform pushes the predicted path away (see Fig. 7
                           ). A similar problem occurs with vessels labeled with the wrong lobe. Missing vessels cause less serious problems, such as slight deviations in predicted fissure path or a widening of the extracted regions of interest. Nevertheless, the inaccuracies caused by vessel segmentation are responsible for Ukil and Reinhardt requiring manual correction in some cases [20]. They are also responsible for the unsatisfactory results by Kuhnigk et al. [17], causing Lassen et al. to introduce fissure detection directly into their watershed algorithm to help correct for this [18], although they note the continued requirement for good vessel and airway segmentations. We replaced the distance transform with a vessel density measure in order to make the watershed transform less sensitive to individual vessel points [24]. This approach is more robust to poor vessel segmentations, but still requires a reliable segmentation of the airways down to the lobar bronchi.

Atlas-based approaches [15,19] guide fissure detection based on similarity to existing human anatomy. They can be used to avoid potential failures in airway or vessel segmentation. However, authors find that atlas registration is not in itself sufficient to generate an accurate result and have added both fissure detection and auxiliary structures to aid the fissure segmentation, namely airways [15] or vasculature [19]. Major disadvantages of atlas-based approaches are their computational cost and their dependence on the atlas data being representative of the subject anatomy.

van Rikxoort et al. [15] choose not to use the vasculature in their atlas registration, citing it as too unreliable. However, they do make use of airway segmentation to guide the registration in regions where fissures are incomplete or hard to detect. The airways are used to construct approximate lobar boundaries by first establishing the lobar divisions of the bronchial tree, and then allocating every voxel in the lung to the lobe of the nearest segmented bronchus. This is similar to the way Zhou et al. [16] and Saita et al. [38] assign voxels to the lobe of the nearest segmented vessel. The registration then proceeds by constructing a cost image combining distance transforms to automatically detected lung boundaries and candidate fissure points. In regions with no nearby candidate fissure points, this is replaced with a distance transform to the approximate lobar boundary derived from the airways. The cost image is used to register a template image selected from an atlas of manually delineated fissure curves and lung boundaries. The registered fissure surfaces are used to segment the lobes.

This combined cost function allows the lobar boundaries to track candidate fissure points where they are available, and elsewhere to track the approximate lobar boundary derived from the airways. This improves the robustness of the method where fissures are incomplete or where candidate fissure points cannot be detected. The use of airways avoids the pitfalls of unreliable vessel segmentations, but produces a less accurate lobar approximation than the vasculature could potentially provide. This is because the segmented bronchial tree covers much less of the lung volume than the segmented vasculature (Fig. 5) and is less able to localize the fissures. Furthermore, lobar boundaries derived from airways are sensitive to the number of airways detected in each subtree. In the method of van Rikxoort et al. [15] this will not affect results close to detected fissure points, since the approximate fissure segmentations are not used there. However, in regions of incomplete fissure detection, the use of airways will improve the results but may not achieve the accuracy that would be possible using the vasculature, if reliability issues could be overcome.

In their atlas method, Zhang et al. [19] also use an atlas of manually segmented fissures and lung boundaries. They construct a single averaged fissure image to provide an approximate initialization for fissure searching. This is different from van Rikxoort et al. [15], who perform a full registration using an image selected from the atlas database. In both methods, the atlas provides a priori information which helps localize the fissure search. However, atlas-based approaches have several limitations. The atlas needs to be created using a set of manually segmented training data, which can be a time consuming process with laborious work performed by clinicians, although this need only be performed once and atlases can be shared in a public repository. Atlas methods can lead to poor results if none of the atlas images is representative of the dataset being processed. Zhang et al. [19] cite this as the reason why their atlas is only used as an initialization to their fissure detection procedure and not as part of a registration procedure. The horizontal right fissure in particular can vary significantly between subjects in shape and location, especially in the presence of disease. Zhang et al. [19] were unable to use the atlas to initialize the horizontal right fissure and instead used a semi-automatic method with manually placed marker points.

In later work, Ukil and Reinhardt [20] abandoned the atlas initialization, replacing it with the vasculature-based approach described above. This allows automatic initialization for the horizontal right fissure detection, but still requires manual correction in some cases. This substitutes the limitations of an atlas-based approach with the possible inaccuracies which can result from segmentation of the airways and vasculature. This is a general problem faced by automatic segmentation methods dealing with the inter-subject variability of human anatomy. A final problem with atlas registration approaches is that nonlinear registration can be very slow, as found by van Rikxoort et al. [15]. We discuss execution time considerations further in Section 3.8.

Wei et al. [21] make use of vessel and airway information without lobar labeling. Airways and vessels are detected on axial slices using thresholding and dilation operators, and fissure regions of interest found as areas free of vessels and airways. Fissures are then detected using a 2D wavelet transformation and 2D graph searching, with fissure lines extrapolated between slices in a similar way to the method used by Wang et al. [39]. Manually placed marker points are required to segment the horizontal right fissure.

Other authors [22,23] have developed methods which avoid using auxiliary structures (airways and vessels); however, a priori anatomical knowledge is still introduced implicitly. In their Bayesian fissure detection, Ross et al. [22] use a fissure prior which is, in effect, a simplified atlas built from manually selected points rescaled to normalized axes. Again, the quality of the results depends on this simplified atlas being representative of the fissure curves being detected.

Pu et al. [23] apply a threshold range to the orientation of detected plane patches to identify those belonging to each fissure. This approach does not take into account the variable shape of fissures, and is very sensitive to the fissures having the expected orientations. In their results, Pu et al. [23] found that this approach removed large patches of the fissures they were searching for, but the subsequent curve fitting corrected for this. This approach may fail if a fissure is incomplete or has an unusual shape or orientation (Fig. 8
                           ). Too much of the fissure could be removed by the orientation thresholds, in which case the surface fitting will be poor, or, for the right lung, parts of the fissure may be mislabeled as belonging to a different fissure. Connected component analysis will not be able to correct for this if the mislabeled patches include regions where the fissures connect. Pu et al. found that errors in their results correlate with the estimated incompleteness of detectable fissures, and propose introducing more anatomical information into future work [23].

Most authors have found that that anatomical information is necessary, but not sufficient, for segmentation of the lobes. The vasculature approach of Kuhnigk et al. [17] does not have sufficient accuracy on its own, motivating Lassen et al. to add fissure point detection [18]. For similar reasons, Zhang et al. [19] avoid the use of the vasculature in their atlas initialization. van Rikxoort et al. [15] added airway information to their atlas registration method to improve its accuracy around regions of incomplete fissures. Ukil and Reinhardt [20] use vasculature and airway information to replace the atlas initialization method of Zhang et al. [19]. They cite the computational and user definition time as their reasons for avoiding an atlas-based approach. Both Ross et al. [22] and Pu et al. [23] seek to avoid the use of anatomical structures but incorporate anatomical information in the form of a priori assumptions. Pu et al. believe that introducing more anatomical information into their method may improve their results [23]. Ross et al. explicitly aim to create a method independent of airway and vessel segmentations. This method is potentially more robust when used with pathological datasets where airways and vessels are difficult to segment, although this has not been demonstrated. Airways and vessels provide useful clues about the location of the lobar boundaries, particularly in the case of incomplete fissures. In general it is better to make use of this information where it is available.

The use of anatomical information – whether in the form of segmented auxiliary structures, or through a priori assumptions – is a trade-off between robustness and accuracy. Increased use of airway and vasculature segmentations can improve the accuracy of the lobe detection but is dependent on correctly segmented and labeled structures. Conversely, minimizing dependence on anatomical information will improve the robustness of the method, but is likely to reduce accuracy since valuable information from the airways and vasculature is being ignored.

In Section 3.4 we described the fissure detection methods that have been applied to lobe segmentation. Other fissure detection and enhancement methods were listed in Section 2. However, the detected fissure points rarely form a continuous surface. Fissures may be partially undetectable due to pathology or partial volume effects, or they may be physically incomplete due to the common anatomical variation between subjects, particularly with the right horizontal fissure [9]. Fissure detection may also produce false positives such as on minor fissures. In order to divide the segmented lung volume into lobes, it is necessary to remove the false positives, and then interpolate and extrapolate the remaining fissure points to form continuous surfaces. For convenience, we refer to these as the fissure surfaces, although this terminology is not quite correct because the surfaces found are the complete boundaries spanning the entire lung volume, regardless of whether the pulmonary fissures are anatomically complete.

Small segmentation gaps can be closed and outlying false positives can be removed using morphological operations. This approach is adopted by Zhou et al. [16] and Saita et al. [38]. However this approach performs poorly on larger gaps and at fissure extrapolation; neither method guarantees finding a complete fissure surface that separates the lobes.

Other authors use methods that guarantee a separation of lobe segmentations. We categorize these methods as explicit and implicit. Explicit methods fit a surface to the detected fissure points, with heuristics to remove outliers, interpolation to fill the gaps and extrapolation to the lung boundaries. Implicit methods generate a lobar boundary as a natural outcome of the segmentation algorithm, such as atlas or watershed approaches.

Fitting a surface with a smoothness constraint helps to create a more anatomically realistic surface, which is robust to false positives near the true fissure surface. Pu et al. [23] extend their fissure detection method by fitting radial basis functions and extrapolating to divide the lung volume into lobes. Ross et al. [22] fit thin plate splines to the fissure points found using their particle sampling and statistical refinement methods. We [24] fit a multilevel B-spline curve through points of maximum fissureness detected perpendicular to a fissure approximation plane. In general, the main fissures can be well modeled by simple surfaces. The difficulty lies in the surface fitting to noisy fissure data; simple surface fitting methods such as least squares minimization are robust to random noise, but not systematic noise. Detected fissure candidates suffer from systematic outliers due to features such as minor fissures. These systematic outliers can significantly disrupt the surface fitting procedure. Therefore, in some senses the most important feature of the surface fitting mechanism is not the mathematical surface model but the effectiveness of the method for removing outliers.

Zhang et al. [19] and Ukil and Reinhardt [20] use a graph searching method to find an optimal surface using a ridgeness measure and curvature constraints. They also describe a curve fitting method for fissure interpolation and extrapolation. Wei et al. [21] and Wang et al. [39] also employ a form of graph searching to find their final fissure curves, where the curves are detected slice by slice using those from the neighboring slices to guide the search. These methods do not make full use of the 3D data, and are prone to error propagation if the fissure curve becomes poorly segmented on one slice.

For some methods, the fissure surface fitting is implicitly part of the rest of the method. Kuhnigk et al. [17] and Lassen et al. [18] derive their lobar boundaries from a watershed transform, which naturally produces a continuous surface spanning the whole volume. Furthermore, the use of distance transforms has some smoothing effect. For Lassen et al. [18], weightings are biased towards detected fissure points so that the surface will tend to track candidate fissure points where they are available, and high intensity values where they are not. However, no explicit constraints exist on the shape or curvature of the surface. Hence, in regions where no candidate fissure points are detected, this method suffers from the issues we discussed in Section 3.5: it will tend to locate the centerline between lobar vessel groups. While this may provide a reasonable approximation, there is no reason why a fissure should lie exactly on the halfway point between vessel groups, and indeed this position will be inaccurate if parts of the vasculature tree were not segmented. The inaccuracy will be increased in regions with few vessels such as near the lung boundaries.

The atlas registration of van Rikxoort et al. [15] also implicitly incorporates surface fitting. In this case curvature and shape are constrained by the regularization in the registration method. However, the final fissure surface could be drawn away from the true segmentation if the chosen atlas image does not sufficiently match the true fissure shapes. In locations where there are no candidate fissure points, their registration will be driven by the approximate lobar segmentation derived from the bronchial tree. This is intended to correct for cases of incomplete fissures. However, as described above, the lobar approximation is highly dependent on segmentation of the bronchial tree and, if it differs considerably from the true fissure locations, could result in two curves of attraction being introduced into the registration cost images.

Authors use several different types of validation to assess their algorithms, and we summarize their results in Table 1. However, methods cannot always be compared directly, even if they use the same validation method. This is because methods use different levels of automation (some allow for manual correction) and are tested on different types of data. It is difficult to quantitatively evaluate these different methods, since few authors have presented results on shared datasets or made their segmentation code available to allow independent validation. For this reason we have chosen to evaluate and compare methods primarily on their methodology. In terms of quantitative results, the most widely available comparative measure we have is the root mean square (RMS) distance from manually placed fissure markers to the automatically segmented lobar boundary. We note that all of these methods perform similarly, giving an RMS measure of approximately 2mm.

The gold standard for pulmonary lobe segmentation is the manual delineation of the lobar boundaries on each CT slice by an experienced pulmonary radiologist. Even this is not considered completely accurate, as many authors report small but significant inter- and intra-observer variability [15,18,22]. The main difficulty with manual segmentation, however, is the time required. The lung region of a CT image typically contains 400 axial slices, and complete manual segmentation of lung boundaries and fissures could take several hours. To repeat this over a large number of testing datasets is impractical. Authors therefore turn to simplified methods for validation.

Lassen et al. [18] use a semi-automatic method to obtain reference segmentations. This involves manual segmentation of lobar boundaries on 10–15 slices, automatic interpolation and interactive manual correction. They use these to evaluate their automatic lobe segmentation using Dice coefficients for the lobar volume overlap. Zhou et al. [16] manually trace lobar regions on seven patients chosen because the fissures are clearly visible. Coincidence degree percentage measures are computed for the volumes, and average distance separation for the boundaries.

Most authors concentrate on validation only of the fissure surfaces, since lung segmentation methods have been well validated elsewhere (see Section 3.3). Ross et al. [22] compute mean distances from the automatic fissure curves to gold standard segmentations by two radiologists. Zhang et al. [19], Wei et al. [21] and Wang et al. [39] perform similar validation on selected 2D slices of each dataset. Saita et al. [38] do not perform lobe segmentation, but they validate their (incomplete) fissures against radiologist-verified manually segmented curves. They compute extraction and overextraction percentage measures for a range of fissure extraction parameter values.

An alternative validation method [15,20,24] is for the radiologist to manually place fissure marker points on a small subset of image slices from each CT volume. A quantitative distance measure can then be computed from each ‘true’ fissure marker to the nearest point on the automatically detected lobar boundary, and maximum, mean and RMS values calculated. The advantage of this approach is that it provides a quantitative measure with which to compare different methods. Manual marker placement is relatively fast (400 points can be placed in around 15min) and only needs to be performed once per patient. The drawback of this approach is that a two-way validation is not possible: a distance cannot be computed from the automatic fissure surfaces to the manually placed points, since this would be dependent on which slices were chosen and where the markers were placed. Therefore, parts of the fissure may be unvalidated if no marker is placed nearby. This is particularly a problem where there are indistinct fissures; if the radiologist chooses not to place a marker point because a fissure is unclear, the fissure line will not be validated at that point and the results will be correspondingly over-optimistic. Furthermore, nothing in this validation method is specifically testing the lobar segmentation.

A second validation method used in some of the above papers [15,20] is based on a subjective assessment by the radiologist. A 5-point score is awarded to each fissure segmentation based on the accuracy of the fissure compared visually with the image. The advantage of this method is that it provides an assessment of the predicted lobar boundary, including extrapolation regions where the fissure is incomplete. Assessment can be carried out relatively quickly over a large number of datasets. The drawback is that the evaluation is subjective and observer-dependent, potentially introducing bias, and must be repeated for every algorithm to be compared.

Pu et al. [23] use a subjective 3-point score of lobar segmentation, but their score is based on the overall performance of the algorithm across all 5 lobes; they do not report results for individual lobes. For quantitative validation, they quote a previous evaluation of their fissure segmentation [79] where they compute mean distances from radiologist-placed markers. However, the latter results cannot be compared directly with other methods [15] because the fissures detected in that paper do not represent lobe-separating curves; they are incomplete fissure sections and the right fissures are not separated.

One important consideration is the performance of lobe segmentation where complete fissures could not be detected. Most authors recognize that fissures may be anatomically incomplete. However, parts of fissures may simply be undetectable on images due to imaging effects such as partial volume effects or motion. Even in the case of anatomically incomplete fissures, the lobes may retain a large amount of functional independence, so identifying the correct boundary between the functional regions is still important. In vivo validation is difficult in the case of incomplete fissures due to the lack of identifiable visual clues for verification, but can be done via qualitative assessment. Several authors explicitly choose datasets which include incomplete fissures [15,22], although only van Rikxoort et al. [15] assess the robustness of their algorithm to incomplete fissures. They artificially remove fissure voxels from their 20 standard dose datasets and re-compute their lobar segmentations for comparison. They find a good agreement (RMS<6mm) with the true lobe boundaries even when 70% of the fissure voxels have been removed. Their low dose datasets (100) are selected because they exhibit incomplete fissures, although validation of these low dose cases is limited to the subjective 5-point validation method described above.

Ukil and Reinhardt [20] develop a metric for measuring the completeness of a detected fissure. This could be an important measurement in assessing lung function, because collateral ventilation is affected by the physical separation between lobes. However, this metric cannot distinguish between anatomically incomplete fissures and fissures that are present but not detected by the segmentation algorithm.

Direct comparisons between methods should be performed with awareness of the limitations discussed above, namely that each method is validated on different data, the qualitative lobar evaluations are highly subjective, and the quantitative fissure evaluations do not measure algorithm performance for incomplete fissures. Nevertheless, the validation results summarized in Table 1 suggest that segmentation accuracy is comparable between all methods, and also comparable to inter-observer variability.

The segmented lobar boundaries comprise of the outer lung boundaries and the separating fissures. Since lung segmentation accuracy has been well validated in previous work, it is the accuracy of the fissure segmentations that is commonly used to quantitatively evaluate and compare lobe segmentation results. Most authors report an RMS error (distance between the segmented and true fissures) of around 2mm. The required accuracy depends on the clinical application of the lobar segmentation. For example, if the lobar boundaries are registered to analyze hyperpolarized gas MRI images via image registration [12], the typical length scale of the gas imaging pixels (3×3mm2) is larger than the RMS error. However, for lobar analysis of CT data, the optimal value should approach the typical dimensions of a CT voxel (0.5mm). Pulmonary fissures have a typical surface area of around 100cm2. An error of 2mm in the fissure location represents a possible misallocation of approximately 5% of the voxels from each lobe (10% of the voxels in the smaller mid right lobe). This could lead to a significant error when deriving lobar measurements which must be taken into consideration. This suggests that more accurate lobar segmentations are desirable, either through improved segmentation methods or semi-automatic correction.

A typical MDCT thoracic dataset may have an approximate resolution of 0.68×0.68×0.63mm3 and contain more than 400 axial slices, each a 512×512 16-bit image. This amounts to over 100 million voxels, requiring 200MB of memory to store at full resolution. While storage of a single image poses no problem for a modern computer, some algorithms require multiple auxiliary images to be used simultaneously, such as vessel and airway segmentations, lung boundaries and fissure points. Higher order structures can consume even more memory. For example, storing the Hessian matrices for a typical dataset (6 unique components for each voxel) requires over 5GB of memory at double precision. High memory usage can be a drain on system resources and can significantly impact program execution time.

Some authors report memory issues [20,23] but this is almost certainly an artifact of using a 32-bit operating system, which limits each running program to 2GB (Microsoft Windows) or 4GB (Unix), regardless of how much physical memory is available. Use of 64-bit software effectively eliminates “out of memory” errors up to the limitations of the hard disk, but the performance will be substantially affected if high memory usage leads to frequent hard disk swapping.

Another issue with large datasets is that for some algorithms, execution time depends exponentially on the number of voxels to be processed. This is particularly true for global optimization problems such as atlas registration and graph searching. Table 1 includes the reported typical execution times for each algorithm, ranging from several minutes to 2h. Longer times are mostly accounted for by particular parts of algorithms, and in some cases could be significantly improved. The longest execution time is for the atlas registration method by van Rikxoort et al. [15]. This time is mostly accounted for by the supervised fissure detection (90min) and atlas registration (25min). The authors note that a much faster fissure segmentation could potentially be introduced without affecting the results [15]. Similarly, the algorithm by Zhou et al. [16] takes 40min to segment and label the airways, for which much shorter times have been reported elsewhere. While execution times have been reduced by image downsampling [33], this also has significant effects on accuracy and is thus seldom used in current algorithms.

One final consideration to note is that, in a clinical setting, there is typically a time gap between clinical imaging and its analysis by a radiologist. This time gap is often used by clinical software to run “preprocessing” algorithms so that pre-computed results are available immediately to the radiologist when they begin the reading. Automated lobe segmentations are a natural candidate for such preprocessing, provided the preprocessing step requires no manual initialization. Therefore, the execution time of fully automated algorithms may not be important for clinical practice if it is shorter than the typical clinical delay between image acquisition and radiologist reading.

In a broad sense, the existing lobe segmentation methods reviewed here follow the same approach, which is lung segmentation using standard methods; candidate fissure point detection using 2D or 3D local filtering operations; elimination of outlying false candidates (or, equivalently, narrowing of the fissure search space to a region of interest) using anatomical or a priori knowledge; and finally, division of the lungs into lobes by constructing a continuous surface using the candidate fissure points, with extrapolation to the lung boundaries.

We offer the following suggestions for researchers wishing to adapt existing methods or develop their own.

Lobe detection will perform best with high-resolution isotropic MDCT data, with imaging at TLC to improve feature contrast. Low slice thickness and slice spacing (below 1.5mm) will improve the 3D detection of anatomical features such as airways, vessels and fissures. TLC imaging will maximize feature contrast. Lobe segmentation works for a wide range of dose levels, although accuracy may be improved in high dose.

In a clinical environment, a practical lobe segmentation process may involve an automatic pre-processing stage, where the bulk of the segmentation work is performed, followed by an interactive method for manual review and correction. The pre-processing stage will be the most computationally intensive, but can be performed automatically between image acquisition and review. For this reason, no user interaction should be required to initialize the algorithm. However, interactive manual correction of the segmentation results is acceptable, because in a clinical environment, it is unlikely that any automatic lobar segmentation would be used without manual review and the option of correcting errors. Furthermore, correction methods may be essential to deal with segmentation errors caused by severe pathology or unusual anatomy. Nevertheless, it is still important to reduce user interaction requirements by making the automatic segmentation as reliable as possible. Any correction method should be fast and interactive, ideally requiring just a small number of mouse clicks or equivalent from the user.

Standard threshold-based methods can be used [17,46], unless a specialized method is required to deal with particular pathology [54].

Filter-based fissure detection provides precise localization of the lobar boundaries. Ideally, the chosen filtering method should be resolution-independent and three-dimensional, to make maximum use of the local information. Common methods include analysis of the Hessian matrix [15,18,22,24] or the structure tensor [19,20]. Intensity-based thresholding is not sufficiently specific to be used on its own, but may be combined with other filtering metrics in a weighted approach, such as in a watershed transform. The precise filtering method and weightings chosen may be determined experimentally to achieve the best results for the required data protocols, in particular image resolution and dose.

Airway and vessel segmentation can assist with fissure localization. The reliability of these segmentations can be assessed according to the number of airway and vessel generations that are detectable, and will depend on the image resolution, dose and the presence of pathology. Where airways and vessels cannot be reliably segmented, for example due to noise or severe pathology, methods using an atlas [15,19] or other types of prior information [22,23] may still produce reliable lobar segmentations.

Incomplete fissures should be expected due to partial volume effects, failures of the fissure detection algorithm, or anatomical incompleteness of the fissure. Fissure curves can be completed using explicit methods such as curve fitting with extrapolation [22–24], or implicit methods using a watershed transform [18] or atlas registration [15]. The amount of extrapolation and interpolation performed should be measured, in order to assess the performance of the fissure detection algorithm and to highlight regions of possible collateral ventilation.

To allow comparison with other methods, validation should be performed using shared databases with gold standard segmentations. Measurements should be quantitative, and could include standard metrics described above, such as the Dice coefficient and separation distances between the segmented lobar boundaries and the gold standard segmentations. Subjective assessments are of little value when comparing between different publications. Ideally, source code should be published, allowing other researchers to validate and compare algorithms using their own data. The extent to which incomplete fissures are detected and the accuracy of the interpolation and extrapolation steps should also be measured. These additional metrics would allow assessment of different components of a lobe segmentation algorithm, so that the particular strengths and weaknesses of a method can be identified.

While it is always desirable to make algorithms fast and efficient, and optimization is an important topic in itself, these should not be the primary driving factors in the prototyping stage of lobar segmentation algorithms. The speed and memory usage of an algorithm is highly implementation dependent, and algorithms can always be optimized later. Segmentation accuracy and the minimization of time demands on the user should be the main focus of comparison between methods.

As quantitative image analysis becomes increasingly more common in disease assessment and treatment planning, there is a need for accurate computational methods for lobe segmentation from CT data. These methods will need to be robust to a wide range of clinical data, and sufficiently fast for use in routine clinical practice. It is likely that lobe segmentation methods will continue to follow the broad approach outlined in this review, encompassing the use of lung segmentation, fissure detection, anatomical information and curve fitting. A practical implementation may involve an automatic pre-processing stage, followed by an interactive method for manual review and correction. Even with the possibility of manual correction, there is a strong need to improve the accuracy of lobar segmentation algorithms to reduce the burden on the user.

The variability of clinical data is an important issue that has not been fully considered by any of the existing works. Several authors include low dose [15,18,22,38], expiratory [19,20,22] and pathological [16,18–23,39] images, but none assess the effects of these factors on segmentation performance. Only limited evaluation has been performed on the effects of slice thickness [23] and incomplete fissures [15,20]. If lobar measurements are to be adopted more widely into clinical practice, then it is important to assess the effects of factors such as image resolution, inflation level, dose and pathology, in order to determine the best imaging protocols and to understand the accuracy of results in a particular context. Such investigations should ideally be performed not just by adopting a wider range of test data, but by assessing the performance of individual stages of the lobe segmentation method against specific imaging parameters and pathological factors. For example, image resolution will have significant effects on heuristics where pixel-level detail is important, such as fissure, airway and vessel detection, but is less important for more global operations such as lung segmentation and curve fitting.

Comparing the performance of current methods is difficult because each method is validated on different data, the qualitative lobar evaluations are highly subjective, and the quantitative fissure evaluations do not measure algorithm performance for incomplete fissures. Validation should be performed using standard quantitative metrics, on shared image databases with gold standard segmentations. Software should be made publicly available for other researchers to validate and reproduce results.

We believe there is value in adopting a more explicitly modular approach, reflecting the step-by-step nature of the algorithms, which comprise of largely independent stages for operations such as curve fitting and lung, airway, fissure and vessel segmentation. This will allow the performance of individual stages in the algorithm to be assessed and compared, allowing hybrid approaches. For this reason, there may be benefits from future challenge workshops assessing performance for different stages of the algorithm, rather than treating each method as a single black box.

The authors do not hold any conflicts of interest relevant to this manuscript.

@&#ACKNOWLEDGEMENTS@&#

The main author has received funding from EPSRC EP/E501680/1 and the Oxford Biomedical Research Centre.

@&#REFERENCES@&#

