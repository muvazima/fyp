@&#MAIN-TITLE@&#Collaborative forecasting, inventory hedging and contract coordination in dynamic supply risk management

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Examine the intertemporal effects on managing supply disruption risks.


                        
                        
                           
                           Develop a Markov model to capture the dynamic nature of forecasting.


                        
                        
                           
                           Characterize the optimal policy and propose a coordinating subsidy contract.


                        
                        
                           
                           Quantify the value of three instruments and show they are strategic complements.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supply risk

Signal-based forecast

Inventory

Contract coordination

Dynamic programming

@&#ABSTRACT@&#


               
               
                  We examine the intertemporal and decentralization effects on managing disruption risks in a supply chain with lost sales and fixed transportation cost. The disruption risk is continuously monitored via collaborative forecasting based on advance supply signals—such as financial health and operational viability. We first develop a Markov model to capture the nonstationary, volatile, and dynamic nature of the forecast evolution. We then integrate the forecast into a dynamic programming for inventory hedging under three hierarchies. We derive an easy-to-implement coordination contract and a simple policy structure that facilitates ex ante strategic planning and ex post dynamic execution. The optimal strategy is driven by properly balanced adaptiveness, resilience and intertemporal imperatives. It outperforms the conventional inventory hedging and lean management by reducing premature inventory holding in good times, and timely ramping up safety stock ahead of looming disruptions. The proposed subsidy contract can effectively address double marginalization and information concealment problems via risk sharing, power preserving, and Pareto improving. We show that dynamic forecast is valuable for high margin products, moderate fixed cost, and low demand volatility. Without coordination, mandating supply information sharing can exacerbate supply disruptions. The three instruments are strategic complements and most effective when deployed jointly. This research highlights the importance of integrating forecast, inventory, and contract instruments in managing supply risk dynamically. It also explains two rationales—the resilience and information imperatives—behind recent trends of onshoring and vertical integration.
               
            

@&#INTRODUCTION@&#

For companies with a global footprint, recent years have not been kind to their supply chains.
                        1
                     
                     
                        1
                        For example, Hurricane Katrina in 2005 shut down transportation in the Gulf Coat for days, paralyzing the supply chain of United Technologies Corp. (UTC). The 2011 Japan earthquake shattered auto industry, disrupting the production of Toyota, Honda, and Ford for weeks (Archstone Consulting, 2011). The 2011 Thailand floods crippled the production of major hard-drive suppliers (e.g., Western Digital and Seagate), inflicting severe parts shortages and financial losses on downstream purchasers. For example, the UK set-top boxes maker Pace shares dropped by 12 percent; PC maker Dell shares fell by 5.4 percent (Makan & Simon, 2011).
                      To better manage supply risks in this turbulent time, many of them begin to closely track the status of their suppliers, including their production progression (Gaukler, Özer, & Hausman, 2008), quality performance (Choi, Blocher, & Gavirneni, 2008), financial health (Babich, 2010), etc. These advance supply signals, though noisy and volatile, contain rich information on suppliers’ likelihood of operational disruptions, bankruptcy, and hence their availability (Gao, Yang, Zhang, & Luo, 2015). If properly maintained and utilized in forecasting, they can greatly leverage companies’ ability to predict future supply, and enhance their risk preparation and response capability.
                        2
                     
                     
                        2
                        For example, UTC, a Fortune 100 aerospace manufacturer, relies on lean management and sole-sourcing strategy for many highly specialized components. Thus any single supply disruption can have catastrophic implications. The cost of switching suppliers is extremely high, and the impact of missed deliveries can be financially crippling and can even affect national security. To manage suppliers proactively, UTC implemented SBManager—a real-time supplier monitoring system developed by Open Ratings Inc. (SupplyChainBrain.com, 2005). The system uses predictive technology to constantly track advance signals from UTC, its suppliers, and the third-party data to determine the dynamic risk profile of each supplier. In 2004, the system warned UTC of the potential bankruptcy of a key casting supplier, giving UTC precious head-ups to increase inventory buffer and avert a disaster (Bacheldor, 2005).
                      For most companies, however, these activities are generally ad hoc and have not been systematically integrated into their risk management strategies. The academic literature is also sparse on how to model and utilize advance supply signals.

Our work is motivated by dynamic supply risk management in decentralized supply chains. Three factors complicate the problem. First, the nature, likelihood, and magnitude of supply risks evolve dynamically over time, which requires real-time monitoring, longer planning horizons and dynamic execution capabilities.
                        3
                     
                     
                        3
                        For example, the devastating Hurricane Katrina in 2005 first crossed southern Florida as a moderate Category 1 hurricane, then strengthened to a Category 5 over the warm Gulf water, and weakened to Category 3 hurricane when landing in southeast Louisiana.
                      Second, the decentralized structure leads to incentive misalignment and uncoordinated decision making, which necessitates coordination devices. Third, the stressed suppliers are often reluctant to share with the buyers the information on their vulnerability and reliability. All three factors can severely exacerbate supply risks.

This paper has four objectives: (1) to model the nonstationary, volatile, and dynamic nature of advance supply signals; (2) to integrate this advance information into real-time risk management process and identify the main determinants of the optimal hedging strategies; (3) to develop a coordination mechanism that ensures collaborative forecasting and efficient decision making; and (4) to characterize the role of dynamic forecast, inventory hedging, and contract coordination in dynamic risk management.

Specifically, we study a dynamic inventory hedging problem in a single product, one-supplier-one-buyer supply chain. The supplier is vulnerable to supply disruptions. During disruptions, no replenishment is possible. The supplier tracks the advanced signals on his risk level; different risk levels entail different disruption or recovery probabilities. Depending on the nature of the relationship, he may or may not share the forecast with the buyer. In each period the supplier first updates the forecast using newly available signals, then replenishes the buyer at fixed and variable transportation costs if operational. Afterwards the customer demand arrives and the buyer sells as much as possible. Unsatisfied demand is lost and the leftover inventory incurs holding cost. Both parties seek to maximize their individual expected total profit.

Our main results are summarized as follows. First, we develop a Markov chain model that captures nonstationary, volatile, and dynamic properties of supply signal evolution. The high fidelity of the model allows uneven distribution of availability over time, diverse forecast accuracy, and frequent revision of risk profile. It provides a unified framework to incorporate both historical-data-based statistical forecast and advance-signal-based judgmental forecast. As the model does not rely on specific functional structures, it facilitates designing general and robust mitigation strategies.

Second, we characterize the optimal inventory hedging strategy under three organizational structures—centralized, coordinated, and noncoordinated. Although the inclusion of fixed cost and lost sales captures the essential characteristics of a wide range of applications, it also complicates structural analysis. Despite the problem complexity, we are able to derive strong analytical results on the structure of the optimal strategies.

Third, we propose a coordinating subsidy contract that induces collaborative forecasting and efficient decision making in a dynamic setting. It rectifies many inefficiencies in commonly used contracts (e.g., wholesale, buy-back, inventory return). Three properties of the subsidy contract—risk sharing, power preserving, Pareto improving—drive its superior performance. (1) Risk sharing promotes the buyer to take channel-optimal action by subsidizing overstock and discouraging excessively frequent ordering, thereby eliminating double marginalization deficiency. (2) Power preserving ensures that power balance remains intact, thereby lowering the negotiation barrier and facilitating coordination building. (3) Pareto improving promotes objective alignment and voluntary compliance, thereby fostering collaborative forecasting and truthful information sharing. As such, the subsidy contract effectively addresses double marginalization and information concealment problems—two main challenges in decentralized supply risk management.

Fourth, we characterize the role of dynamic forecast, inventory hedging, and contract coordination in supply risk management. Our model endogenizes the dynamic interactions of the three instruments. They are strategic complements—advance supply information has a greater impact on profitability under dynamic hedging strategy and well-coordinated supply chains. By tracing early warning signals dynamic forecast provides real-time risk monitoring capability that facilitates adaptive, resilient strategy design and dynamic execution: The risk mitigation strategy is planned ex ante in light of the forecasted risk profile, and hence sufficient capacity for emergency can be secured for resilience imperative; it is executed ex post in response to a changing environment, and hence the countermeasures are properly calibrated in timing and magnitude for efficiency imperative. Unlike conventional inventory hedging strategy that hoards large stock for a long time, our adaptive strategy does not raise safety stock prematurely, thereby saving on inventory cost. In contrast to some ill-informed “lean” initiatives that push for unguarded operational efficiency by relentlessly slashing needed inventory, our resilience-driven strategy is capable of swift inventory buildup for imminent disruptions, thereby reducing shortage penalty.

@&#LITERATURE REVIEW@&#

Our work contributes to the literature on forecasting, contracting and supply risk management. In the forecasting literature, collaborative forecasting has been widely credited for improving channel efficiency (e.g., Lee, So, and Tang, 2000; Chen, 2003; Aviv, 2003; 2007). There are two ways to model forecasting evolution. The first uses time series framework, e.g., Martingale Model of Forecast Evolution (MMFE) (Chen & Lee, 2009; Milner & Kouvelis, 2005). The second approach employs Markov models to study forecast evolution in production and inventory problems (e.g., Gao, Xu, and Ball, 2012). Our work follows the second approach but focuses on supply forecast.

Our work contributes to this literature in two aspects. (1) Theoretically, most of the literature considers inventory systems with demand forecast under backorder without fixed cost; in contrast, we examine settings with dynamic supply signals, lost-sales and fixed cost. In particular, we develop a high fidelity Markov model that captures real-time supply information for execution-level decision making. Despite problem complexity, we derive the optimal hedging strategy and coordination contract—the first such endeavor in the literature. (2) Practically, most of the known results assume a static, coordinated structure, and concern hedging demand risk only. In contrast, we propose a dynamic coordination contract and derive an easy-to-implement policy that mitigates both supply and demand risks.

The central theme of the supply chain contracting literature is how various contract types affect supply chain performance and coordination. Exemplary works include Cachon (2003), Corbett, Zhou, and Tang (2004), Iyer, Schwarz, and Zenios (2005), Özer and Wei (2006), Cachon and Zhang (2006), Burnetas, Gilbert, and Smith (2007), Li and Debo (2009), Zhang (2010), Yan and Zhao (2011), Babich, Li, Ritchken, and Wang (2012), Chen (2013), Gao (2014). This literature mainly focuses on static coordination without fixed cost; none of them investigates how dynamic information and fixed cost affect risk mitigation strategies and contracting. As most supply chains operate in dynamic environments and fixed transportation cost is prevalent, the existing literature offers insufficient tools and guidance for actual risk mitigation. Our model incorporates crucial features of fixed cost and dynamic forecast evolution, thereby providing more accurate account of global supply chains. Our subsidy contract can dynamically coordinate the supply chain under evolving market conditions. By examining the interplay of three instruments we provide guidance for managers on how to deploy these instruments jointly for effective risk management.

We also contribute to supply risk literature. Recent contributions include Santoso, Ahmed, Goetschalckx, and Shapiro (2005), Altay and Green III (2006), Dolgui and Prodhon (2007), Schütz, Tomasgard, and Ahmed (2009), Yang, Aydın, Babich, and Beil (2009), Rong, Shen, and Snyder (2009), Ouyang and Li (2010), Springer and Kim (2010), Gümüs, Ray, and Gurnani (in press), Chaturvedi and Martínez-de Albéniz (2011), Dong and Tomlin (2012), Babich and Tang (2012), Yang, Aydın, Babich, and Beil (2012), Simchi-Levi and Wei (2012), Dolgui, Ammar, Hnaien, Louly et al. (2013), Lim, Bassamboo, Chopra, and Daskin (2013), Qi (2013), Baghalian, Rezapour, and Farahani (2013), Ivanov and Sokolov (2013), Kim and Tomlin (2013), Hu, Gurnani, and Wang (2013), Yang and Babich (2013), Bernstein, Deng, and Pekec (2013), Bolandifar, Feng, and Zhang (2014), Gao (2014), Chen and Lee (2014); For recent reviews, please see Klibi, Martel, and Guitouni (2010), Sodhi, Son, and Tang (2012), Ivanov, Sokolov, and Dolgui (2014) and references therein. With a few exceptions in the centralized framework (e.g. Ivanov, Sokolov, and Kaeschel, 2010; Federgruen and Yang, 2011; 2014), much of this literature adopts stylized static game or one-period principal-agent paradigm for steady state analysis. Though powerful for strategic issues, this paradigm necessarily aggregates out real fluctuations of fast-paced environments. Hence it cannot capture the progressive information revelation and sequential decision making—two essential elements in dynamic risk management. As such, adaptivity plays no role in this paradigm. In contrast, our model demonstrates that accounting for system dynamics can greatly alleviate supply risk, coordinate the channel, and improve efficiency—adaptivity plays a central role in managing dynamic supply risks.

Consider a one-supplier-one-buyer supply chain that sells a single durable product over multiple periods. We make three assumptions. (1) The supplier is vulnerable to disruption risks, whose occurrences destroy the supplier’s production and inventory. Disruptions differ in frequency and magnitude: severe ones occur infrequently but take long time to recover. (2) Due to the long distance, shipping between the supplier and the buyer incurs substantial transportation cost. (3) Excess consumer demand is lost.

The objectives of both parties are to minimize their individual cost over the horizon. The sequence of events unfolds as follows. At the beginning of period 
                        
                           t
                           ∈
                           T
                           ,
                        
                      the supplier observes and shares the supply state st
                      = i with the buyer to collectively produce the forecast 
                        
                           
                              (
                              
                                 p
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                           
                              j
                              ∈
                              B
                           
                        
                     . If the supplier is down (
                        
                           i
                           ∈
                           
                              B
                              0
                           
                        
                     ), no order is possible until next period (t + 1). Otherwise (
                        
                           i
                           ∈
                           
                              B
                              1
                           
                        
                     ), the buyer places an order to bring his net inventory from x to y, based on system state (i, x). The supplier then fulfills the order at variable cost c and fixed cost K. Upon the receipt, the buyer pays KR
                      fixed cost and unit wholesale price w. Demand D then arises and is satisfied with inventory y to the extent possible; the buyer collects sales revenue r · (y∧D). Unmet demand (D − y)+ is lost. The leftover inventory (y − D)+ costs the buyer h to carry over, but it is also compensated by the supplier with unit subsidy b. Afterwards, the system advances to period t + 1 and the trade repeats. We summarize the main notation in Table 1
                      and relegate all the proofs to Appendix A.

This setup captures the business reality many companies face (Gao, Thomas, & Freimer, 2014). For example, due to lean management and highly specificized nature, UTC uses sole-sourcing strategy for many of its components. Its 25,000 strong suppliers scatter around the world, imposing substantial transportation costs (Rudzki & Trent, 2011). (1) A realistic account of transportation cost, therefore, entails both fixed and variable costs: The fixed cost, which depends on the frequency of ordering, mainly comes from expenses such as parking fare and rewards to the driver; the variable cost is proportional to the order quantity. Including fixed transportation cost and supply risk is also consistent with total landed cost metrics in assessing operations strategies (e.g., offshoring and outsourcing). (2) We consider lost sales case because of its ubiquity: the worldwide out-of-stock rate is rather high at 7–8 percent; but only 23 percent of the customers will delay the purchase in case of stockout; the remaining 77 percent will either buy a different product, visit another store, or do not buy at all (Verhoef & Sloot, 2010). (3) We focus on the supply chain of one buyer and one supplier, because of its prevalence and significance in practice; e.g., Apple and Foxconn Toyota and its valve supplier Aisin, UTC and its sole-sourcing suppliers (Kouvelis, Dong, Boyabatli, & Li, 2011).

The supplier is privy to advance signals on supply state, such as production schedules and machinery status. The signals may also describe the financial health of the supplier: the firms near bankruptcy could face labor strike, lose key personnel, reduce quality control efforts, or forgo capacity investments (Babich, 2010). These signals contain rich information on the operational and financial risks and are widely used in risk monitoring and forecasting. Formally, let 
                        
                           
                              s
                              t
                           
                           ∈
                           B
                        
                      be the supply state in period 
                        
                           t
                           ∈
                           T
                        
                     ; let δ
                     
                        τ, t
                      be the advance signal acquired in period τ that is relevant to supply state st
                      in future period t > τ. To manage dynamic supply risks, the buyer and the supplier may jointly conduct collaborative forecasting as the foundation for their cooperation.
                        4
                     
                     
                        4
                        For example, Boeing and its suppliers use Exostar system to share real-time information during the 787 Dreamliner program (Rudzki & Trent, 2011).
                     
                  

Supply states differ in their present operational characteristics and future likelihood of disruption (or recovery). In each period 
                        
                           t
                           ∈
                           T
                           ,
                        
                      the supplier is either up or down: in the down states 
                        
                           B
                           0
                        
                      the supplier cannot fulfill any order; in the up states 
                        
                           B
                           1
                        
                      he is capable of meeting the buyer’s order in full. Hence 
                        
                           B
                           =
                           
                              B
                              0
                           
                           ∪
                           
                              B
                              1
                           
                        
                     . The evolution of the supply forecast on st
                      is governed by a Markov process, with transition probability 
                        
                           
                              p
                              
                                 i
                                 j
                              
                           
                           ≡
                           P
                           
                              {
                              
                              
                                 
                                    s
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 j
                              
                              ∣
                              
                                 
                                    s
                                    t
                                 
                                 =
                                 i
                              
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           i
                           ,
                           j
                           ∈
                           B
                        
                     . Let 
                        
                           
                              P
                           
                           =
                           
                              
                                 [
                                 
                                    p
                                    
                                       i
                                       j
                                    
                                 
                                 ]
                              
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 B
                              
                           
                        
                     ; let 
                        
                           
                              {
                              
                              
                                 π
                                 i
                              
                              
                              }
                           
                           
                              i
                              ∈
                              B
                           
                        
                      be the stationary probability of the process. When the supplier is in up or down state i, the one-period disruption or recovery probability is 
                        
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    B
                                    0
                                 
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                        
                      or 
                        
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    B
                                    1
                                 
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                        
                     . Severer disruptions 
                        
                           i
                           ∈
                           
                              B
                              0
                           
                        
                      have lower occurrence frequency πi
                     , take longer time to recover and hence have lower one-period recovery probability 
                        
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    B
                                    1
                                 
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                        
                     .
                        5
                     
                     
                        5
                        For example, hurricane Katrina in 2005, one of the most destructive and deadliest US hurricane, occurs with a 1 in 200 annual odds. It claimed at least 1833 people and $81 billion property loss. Although the government failed miserably in response, Wal-Mart was one of the few success stories in how organizations should respond to such disruptions (Horwitz, 2009).
                     
                  

To illustrate, consider widely used Altman Z-score method for predicting bankruptcy probability of publicly held manufacturers within two years (Altman, 2000). Based on the associated Z-score, the method classifies firms into three states: Distress for Z < 1.81, Grey for Z ∈ (1.81, 2.99), and Safe for Z > 2.99. In our parlance, 
                        
                           
                              B
                              0
                           
                           =
                           
                              {
                              Distress
                              ,
                              Grey
                              }
                           
                           ,
                        
                     
                     
                        
                           
                              B
                              1
                           
                           =
                           
                              {
                              Safe
                              }
                           
                        
                     . In practice, the stochastic behavior of each supplier can be extracted from historical data (Higle & Kempf, 2011). The dynamic evolution of a supplier’s state is given by transition probability P. For example,

                        
                           
                              
                                 
                                    P
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                0.50
                                             
                                          
                                          
                                             
                                                0.30
                                             
                                          
                                          
                                             
                                                0.20
                                             
                                          
                                       
                                       
                                          
                                             
                                                0.10
                                             
                                          
                                          
                                             
                                                0.10
                                             
                                          
                                          
                                             
                                                0.80
                                             
                                          
                                       
                                       
                                          
                                             
                                                0.05
                                             
                                          
                                          
                                             
                                                0.00
                                             
                                          
                                          
                                             
                                                0.95
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     In this case, the disruption probability from up state Safe is 5 percent, while the one-period recovery probabilities for down states Distress and Grey are 20 percent and 80 percent. Clearly, state Distress is severer than state Grey.

Now we discuss how to incorporate the advance supply signals 
                        
                           
                              {
                              
                              
                                 δ
                                 
                                    τ
                                    ,
                                    t
                                 
                              
                              
                              }
                           
                           
                              τ
                              <
                              t
                           
                        
                     . Consider a dynamic evolution specified by AR(1) time series model: s
                     
                        t + 1 = ρst
                      + λ + ε
                        t
                      for 
                        
                           t
                           ∈
                           T
                           ,
                        
                      where |ρ| < 1, λ is a constant term, and ε
                        t
                      is a white-noise process. In our notation, transition probability 
                        
                           
                              p
                              
                                 
                                    s
                                    t
                                 
                                 ,
                                 
                                    s
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                           =
                           P
                           
                              {
                              
                              
                                 
                                    
                                       ɛ
                                    
                                    t
                                 
                                 =
                                 
                                    s
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 −
                                 ρ
                                 
                                    s
                                    t
                                 
                                 −
                                 λ
                              
                              
                              }
                           
                           ,
                        
                      while the advanced supply information 
                        
                           
                              {
                              
                              
                                 δ
                                 
                                    τ
                                    ,
                                    t
                                 
                              
                              
                              }
                           
                           
                              τ
                              <
                              t
                           
                        
                      updates the term 
                        
                           
                              
                                 ɛ
                              
                              t
                           
                           =
                           
                              ∑
                              
                                 τ
                                 <
                                 t
                              
                           
                           
                              δ
                              
                                 τ
                                 ,
                                 t
                              
                           
                           +
                           
                              
                                 ɛ
                              
                              t
                              0
                           
                           ,
                        
                      where 
                        
                           
                              ɛ
                           
                           t
                           0
                        
                      is the pure white noise. This specification reflects the fact that forecast variations can be statistically explained in advance by using the advance signals δ
                     
                        τ, t
                      collected in period τ for each specific random term ε
                        t
                     .

The signal δ
                     
                        t, τ
                      has context-specific interpretations and calibrations. For example, δ
                     
                        t, τ
                      can be considered as an explanatory variable (e.g., the commodity price) that will influence the supplier’s production capability (e.g., Kahn, 1987; Lee et al., 2000; Aviv, 2007). Our signal model can also be calibrated to the settings where the suppliers bear availability disruption risk (Tomlin & Snyder, 2006), default risk (Babich, Burnetas, & Ritchken, 2007), technology obsolescence risk (Liu, Chung, & Chang, 2013), or credit risk (Jarrow, Lando, & Turnbull, 1997).

In practice, many companies still rely on legacy supplier scorecards to manage supply risks. However, scorecards usually only use historical data to estimate the near future; hence they are backward looking, lack timeliness, and thus ineffective for risk mitigation purpose. In contrast, the new breed of supplier monitoring systems incorporates the advance information in the market “signals” and uses predictive risk metrics to anticipate risk situations before they occur. For example, the SBManager system categorizes each supplier’s risk exposure with a risk probability index in real-time, using the data from both the buyers and the suppliers as well as the third party. UTC uses this system to regularly monitor its 25,000 suppliers. The system has a 92 percent success rate in predicting bankruptcies six months ahead (Rudzki & Trent, 2011).

Our Markov forecast model provides a natural framework to incorporate advance supply information. It can be estimated easily from data, it captures key empirical properties of supply signals’ evolution, and its analytical tractability facilitates real-time decision making. As such, it can be readily integrated with the supply risk management execution, as shown in Section 5.

This section characterizes the optimal inventory hedging strategy under three organizational structures—coordinated, noncoordinated, and centralization. Stochastic dynamic inventory problems with fixed costs are technical challenging because the objective function is neither concave nor convex; our problem is further complicated by lost-sales and dynamic forecast mechanisms.

Under the coordinating contract, the incentives of the supplier and the buyer are well aligned. Therefore, both parties actively engage in collaborative forecasting (see Section 4) and replenishment activities to hedge against demand and supply risks.

We first derive the buyer’s optimal strategy. To rule out triviality, we assume that the retail price is larger than the wholesale price (r > w), and that the buyer has no incentive to hold inventory for subsidy (h > b). By convention, we treat sales revenue as negative cost. Let Vt
                        (i, x) be the total expected cost under state (i, x) from period t forward. Vt
                         then satisfies the Bellman recursive optimality equations:

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                V
                                                t
                                             
                                             
                                                (
                                                i
                                                ,
                                                x
                                                )
                                             
                                             =
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   y
                                                   ∈
                                                   A
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                               R
                                                            
                                                            ·
                                                            
                                                               I
                                                               
                                                                  {
                                                                  
                                                                  
                                                                     y
                                                                     >
                                                                     x
                                                                  
                                                                  
                                                                  }
                                                               
                                                            
                                                            +
                                                            w
                                                            
                                                               (
                                                               y
                                                               −
                                                               x
                                                               )
                                                            
                                                            +
                                                            
                                                               (
                                                               h
                                                               −
                                                               b
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            ×
                                                            
                                                            
                                                               ∫
                                                               R
                                                            
                                                            
                                                               d
                                                            
                                                            F
                                                            
                                                               (
                                                               D
                                                               )
                                                            
                                                            
                                                               
                                                                  (
                                                                  y
                                                                  −
                                                                  D
                                                                  )
                                                               
                                                               +
                                                            
                                                            −
                                                            r
                                                            
                                                               ∫
                                                               R
                                                            
                                                            
                                                               d
                                                            
                                                            F
                                                            
                                                               (
                                                               D
                                                               )
                                                            
                                                            
                                                               (
                                                               y
                                                               ∧
                                                               D
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            +
                                                            
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ∈
                                                                  B
                                                               
                                                            
                                                            
                                                               p
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                            
                                                               ∫
                                                               R
                                                            
                                                            
                                                               d
                                                            
                                                            F
                                                            
                                                               (
                                                               D
                                                               )
                                                            
                                                            
                                                               V
                                                               
                                                                  t
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               j
                                                               ,
                                                               
                                                                  
                                                                     (
                                                                     y
                                                                     −
                                                                     D
                                                                     )
                                                                  
                                                                  +
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                             ,
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where action space
                        
                           
                              A
                              
                                 (
                                 i
                                 ,
                                 x
                                 )
                              
                              ≡
                              
                                 {
                                 x
                                 }
                              
                              ·
                              
                                 I
                                 
                                    {
                                    
                                    
                                       i
                                       ∈
                                       
                                          B
                                          0
                                       
                                    
                                    
                                    }
                                 
                              
                              +
                              
                                 {
                                 
                                 
                                    y
                                    ∈
                                    R
                                    :
                                    y
                                    ≥
                                    x
                                 
                                 
                                 }
                              
                              ·
                              
                                 I
                                 
                                    {
                                    
                                    
                                       i
                                       ∈
                                       
                                          B
                                          1
                                       
                                    
                                    
                                    }
                                 
                              
                              ,
                           
                         with singleton {x} for the disruptive down state 
                           
                              i
                              ∈
                              
                                 B
                                 0
                              
                           
                        . The boundary condition is V
                        
                           T + 1(i, x) = −wx, meaning that each unit of leftover inventory can be refunded for w at the end of the horizon. The terms in (1) are the fixed cost, the procurement cost, the inventory holding cost and subsidy, the sales revenue, and the expected future cost, respectively. By letting Rt
                        (i, x) = Vt
                        (i, x) + wx and R
                        
                           t + 1(j, x) = V
                        
                           t + 1(j, x) + wx, we can simplify (1) to

                           
                              (2)
                              
                                 
                                    
                                       R
                                       t
                                    
                                    
                                       (
                                       i
                                       ,
                                       x
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          y
                                          ∈
                                          A
                                          (
                                          i
                                          ,
                                          x
                                          )
                                       
                                    
                                    
                                       {
                                       L
                                       
                                          (
                                          y
                                          ;
                                          x
                                          )
                                       
                                       +
                                       E
                                       [
                                       
                                          R
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          j
                                          ,
                                          
                                             
                                                (
                                                y
                                                −
                                                D
                                                )
                                             
                                             +
                                          
                                          )
                                       
                                       |
                                       
                                       i
                                       ]
                                       }
                                    
                                    ,
                                 
                              
                           
                        where per-period cost
                        
                           
                              L
                              
                                 (
                                 y
                                 ;
                                 x
                                 )
                              
                              =
                              
                                 K
                                 R
                              
                              ·
                              
                                 I
                                 
                                    {
                                    
                                    
                                       y
                                       >
                                       x
                                    
                                    
                                    }
                                 
                              
                              −
                              
                                 (
                                 r
                                 −
                                 w
                                 )
                              
                              E
                              
                                 (
                                 y
                                 ∧
                                 D
                                 )
                              
                              +
                              
                                 (
                                 h
                                 −
                                 b
                                 )
                              
                              E
                              
                                 
                                    (
                                    y
                                    −
                                    D
                                    )
                                 
                                 +
                              
                           
                        .

To characterize the optimal hedging strategy with fixed cost K, we use the notion of K-convexity.

                           Definition 1
                           A function 
                                 
                                    f
                                    :
                                    R
                                    →
                                    R
                                 
                               is K-convex for K ≥ 0, if

                                 
                                    (3)
                                    
                                       
                                          f
                                          
                                             (
                                             y
                                             +
                                             z
                                             )
                                          
                                          +
                                          K
                                          ≥
                                          f
                                          
                                             (
                                             y
                                             )
                                          
                                          +
                                          z
                                          
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                y
                                                −
                                                b
                                                )
                                             
                                             b
                                          
                                          ,
                                          
                                          ∀
                                          z
                                          ≥
                                          0
                                          ,
                                          
                                          b
                                          >
                                          0
                                          ,
                                          
                                          y
                                          ∈
                                          R
                                          .
                                       
                                    
                                 
                              
                           

The following lemma summarizes the key step for solving problem (2).

                           Lemma 1
                           
                              Suppose that constant r and
                              
                                 
                                    K
                                    ∈
                                    
                                       
                                          R
                                       
                                       +
                                    
                                    ,
                                 
                               
                              g(x) is K-convex for x ≥ 0, and
                              
                                 
                                    
                                       g
                                       +
                                       ′
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    ≡
                                    
                                       lim
                                       
                                          x
                                          ↓
                                          0
                                       
                                    
                                    
                                       g
                                       ′
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≥
                                    −
                                    r
                                 
                              . Then function
                              
                                 
                                    (4)
                                    
                                       
                                          f
                                          
                                             (
                                             x
                                             )
                                          
                                          ≡
                                          
                                             (
                                             −
                                             r
                                             x
                                             )
                                          
                                          ∨
                                          0
                                          +
                                          g
                                          
                                             (
                                             
                                                x
                                                +
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              is also K-convex.

Let gt
                        (y; i, x) be the objective function of (2). For each 
                           
                              i
                              ∈
                              
                                 B
                                 1
                              
                              ,
                           
                         define bask-stock level
                        
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         and reorder point
                        
                           
                              s
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         by

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             S
                                             
                                                i
                                                ,
                                                t
                                             
                                             R
                                          
                                       
                                       
                                          
                                             ≡
                                             min
                                             
                                                {
                                                
                                                
                                                   y
                                                   ∈
                                                   R
                                                   :
                                                   
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      y
                                                      ;
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                   =
                                                   
                                                      inf
                                                      
                                                         y
                                                         ∈
                                                         R
                                                      
                                                   
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      y
                                                      ;
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             s
                                             
                                                i
                                                ,
                                                t
                                             
                                             R
                                          
                                       
                                       
                                          
                                             ≡
                                             min
                                             
                                                {
                                                
                                                
                                                   y
                                                   ≤
                                                   
                                                      S
                                                      
                                                         i
                                                         ,
                                                         t
                                                      
                                                      R
                                                   
                                                   :
                                                   
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      y
                                                      ;
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                   ≤
                                                   
                                                      K
                                                      R
                                                   
                                                   +
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         S
                                                         
                                                            i
                                                            ,
                                                            t
                                                         
                                                         R
                                                      
                                                      ;
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Intuitively, conditional on purchasing under state i, 
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         is the order-up-to level, at which the marginal purchasing cost w equals the marginal value of the inventory for the current and future periods. 
                           
                              s
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         is the triggering point for state i, below which the benefit of ordering up to 
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         outweighs both fixed cost KR
                         and variable cost w. We are now ready to characterize the optimal strategy for the buyer under collaborative forecasting.

                           Theorem 1
                           
                              The optimal strategy for problem 
                              (2) 
                              is a signal-dependent
                              
                                 
                                    (
                                    
                                       s
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                    ,
                                    
                                       S
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                    )
                                 
                               
                              policy: the buyer orders
                              
                                 
                                    (
                                    
                                       S
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                    −
                                    x
                                    )
                                 
                               
                              if net inventory
                              
                                 
                                    x
                                    <
                                    
                                       s
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                 
                               
                              and
                              
                                 
                                    i
                                    ∈
                                    
                                       B
                                       1
                                    
                                 
                              ; he orders nothing if
                              
                                 
                                    i
                                    ∈
                                    
                                       B
                                       0
                                    
                                 
                               or 
                                 
                                    x
                                    ≥
                                    
                                       s
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                 
                              .


                        Theorem 1 establishes the optimality of two-threshold (s, S) policy under lost sales and dynamic supply forecast. The optimality of (s, S) policy (order up to S once stock falls below s) for the fixed cost under backorder was first established by the seminal work of Scarf (1960); see Zipkin (2000) and Porteus (2002) for more recent applications. The operations literature pays less attention to the lost sales case, a prevalent selling mechanism in industries such as retailing and transportation. The main technical challenge is the nonlinear system dynamics of (y − D)+ caused by lost sales. The nonlinearity paralyzes the propagation of K-convexity through backward induction—a general approach for backorder case in the literature (Song & Zipkin, 1993). Because the usual convexity is a special case of K-convexity, our result also applies to negligible fixed cost cases. As such, we are able to establish the general optimality result for the lost sales case with fixed cost in dynamic supply risk management.


                        Theorem 1 reveals that adaptiveness, resilience and intertemporal imperatives are key principles in dynamic supply risk management. The optimal hedging strategy is adaptive since it tightly couples inventory investment with market risk conditions; it is resilient since it can timely scale up safety stock ahead of imminent disruptions. More importantly, the optimal strategy exhibits the intertemporal imperative: the wedge between order-up to level 
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         and reordering point 
                           
                              
                                 s
                                 
                                    i
                                    ,
                                    t
                                 
                                 R
                              
                              ,
                           
                         driven by fixed cost, promotes temporal consolidation of orders through deferred purchase, while risk criticality dependent threshold 
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                         necessitates advance purchase for future usage. This characterization has important implications for planning and executing inventory hedging strategy. Observe from (5) to (6) the inventory-independent property of 
                           
                              (
                              
                                 s
                                 
                                    i
                                    ,
                                    t
                                 
                                 R
                              
                              ,
                              
                                 S
                                 
                                    i
                                    ,
                                    t
                                 
                                 R
                              
                              )
                           
                        . This implies hedging can be planned ex ante without resource information. The signal-dependent nature dictates that this ex ante planned strategy should be dynamically executed ex post after observing internal resource state x and external supply risk level i. Moreover, the safety stock in this case is driven by both supply and demand risks, as opposed to demand risk only in the classical models (Zipkin, 2000).

In practice, inventory hedging is one of the most widely used strategies—often the last resort—to manage supply disruptions (Kouvelis et al., 2011). Its effectiveness, however, is often compromised by misaligned incentives between efficiency and resilience. This is because traditional inventory management usually has neither the real-time visibility provided by advance signal-based forecast, nor the dynamic response capability enabled by the coordinated supply chains. Hedging supply shocks therefore requires hoarding large safety stock for a prolonged time. However, short-term performance-driven managers, for example, tend to view inventory investment as operational inefficiency rather than strategic necessity for resilience, especially for infrequent disruptions because of opportunity cost (the substantial capital tied up with safety stock) and temptation (inventory is hardly seen as active or diligent use for protection). They are strongly tempted to cut back needed stock, especially when the disruptions are rare events. This situation is further exacerbated by some misguided lean (or kaizen) initiatives, whose main theme is to save costs through the ruthless elimination of inventory, as muda—waste. By squeezing inventory out of the system, they also reduce the buffers that the firm could fall back on in time of disruptions, jeopardizing the firm’s long-term profitability and viability. For example, when earthquake struck Japan’s auto parts output in 2011, Toyota’s India unit had to cut production by 70 percent for six weeks due to parts shortage (Archstone Consulting, 2011); when the six months long Thai floods set in, Western Digital had only four weeks of inventory on hand and suffered severe loss in profit and market share (Makan & Simon, 2011).

Our resilience-driven, adaptive hedging strategy can help alleviate this tension. In the planning stage, it secures sufficient flexible capacity for disruptions via coordination; in the execution stage, it tailors the buffer size 
                           
                              (
                              
                                 s
                                 
                                    i
                                    ,
                                    t
                                 
                                 R
                              
                              ,
                              
                                 S
                                 
                                    i
                                    ,
                                    t
                                 
                                 R
                              
                              )
                           
                         to the actual level of risks 
                           
                              i
                              ∈
                              B
                           
                         through collaborative forecasting. As a result, it eliminates the need for prematurely raising and keeping inventory, thereby saving on inventory cost; it swiftly ramps up emergency stock only when the disruption is imminent, thereby reducing shortage cost. Thus, by jointly deploying contract coordination and collaborative forecasting, our hedging strategy flexes with risk criticality 
                           
                              i
                              ∈
                              B
                           
                        . It ensures that the risk mitigation measures are properly calibrated in timing and magnitude, a fine balance between resilience and efficiency imperatives for the management.

Collaborative forecasting on supply risk entails costly efforts and investment from the supplier, such as gathering relevant data, improving data quality and integrity, developing information infrastructures. Although the buyer benefits from improved forecast accuracy, the benefit to the supplier often remains unclear. Worse, when the supply chain is not coordinated (e.g., under the wholesale contract), sharing supply information may lead to the exploitation by the buyer that eventually hurts the supplier (Ferguson & Ketzenberg, 2005). Thus, the supplier may not share information, resulting in noncollaborative forecasting.

We now analyze this situation. Because the supplier does not share his private information 
                           
                              s
                              ∈
                              B
                              ,
                           
                         the buyer’s information set 
                           
                              B
                              ˜
                           
                         is a partition of the supplier’s 
                           B
                        . The buyer only has the common knowledge P = [pij
                        ] and imperfect signal
                        
                           
                              
                                 s
                                 ˜
                              
                              
                                 (
                                 s
                                 )
                              
                              ∈
                              
                                 B
                                 ˜
                              
                           
                         of s for decision making, where 
                           
                              
                                 s
                                 ˜
                              
                              
                                 (
                                 s
                                 )
                              
                              :
                              B
                              →
                              
                                 B
                                 ˜
                              
                           
                        . Upon observing imperfect signal 
                           
                              k
                              ∈
                              
                                 B
                                 ˜
                              
                              ,
                           
                         the buyer infers the true supply state 
                           
                              i
                              ∈
                              B
                           
                         by

                           
                              (7)
                              
                                 
                                    i
                                    ∈
                                    
                                       
                                          s
                                          ˜
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                    ≡
                                    
                                       {
                                       
                                       
                                          s
                                          ∈
                                          B
                                          :
                                          
                                             s
                                             ˜
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          =
                                          k
                                       
                                       
                                       }
                                    
                                    ,
                                    
                                    k
                                    ∈
                                    
                                       B
                                       ˜
                                    
                                    ,
                                 
                              
                           
                        and 
                           
                              B
                              =
                              
                                 ∪
                                 
                                    k
                                    ∈
                                    
                                       B
                                       ˜
                                    
                                 
                              
                              
                                 
                                    s
                                    ˜
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        . In the absence of collaborative forecasting, the buyer is indifferent to distinct states 
                           
                              i
                              ,
                              j
                              ∈
                              
                                 
                                    s
                                    ˜
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 k
                                 )
                              
                              ,
                           
                        
                        
                           
                              ∀
                              k
                              ∈
                              
                                 B
                                 ˜
                              
                           
                        . Based on these information, the buyer updates his forecast on disruption risk via 
                           
                              
                                 Q
                              
                              =
                              
                                 
                                    [
                                    
                                       q
                                       
                                          k
                                          ℓ
                                       
                                    
                                    ]
                                 
                                 
                                    k
                                    ,
                                    ℓ
                                    ∈
                                    
                                       B
                                       ˜
                                    
                                 
                              
                              ,
                           
                         where 
                           
                              
                                 q
                                 
                                    k
                                    ℓ
                                 
                              
                              ≡
                              P
                              
                                 {
                                 
                                 
                                    
                                       
                                          s
                                          ˜
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    ℓ
                                 
                                 ∣
                                 
                                    
                                       
                                          s
                                          ˜
                                       
                                       t
                                    
                                    =
                                    k
                                 
                                 
                                 }
                              
                           
                         is the transition probability that the buyer observes imperfect signal ℓ in the next period given current observation k. As such, q
                        
                           kℓ is obtained via Bayesian updating

                           
                              (8)
                              
                                 
                                    
                                       q
                                       
                                          k
                                          ℓ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      s
                                                      ˜
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                ∈
                                                
                                                   
                                                      s
                                                      ˜
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   ℓ
                                                   )
                                                
                                             
                                          
                                          
                                             π
                                             i
                                          
                                          
                                             p
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      s
                                                      ˜
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             π
                                             i
                                          
                                       
                                    
                                    ,
                                    
                                    k
                                    ,
                                    ℓ
                                    ∈
                                    
                                       B
                                       ˜
                                    
                                    ,
                                 
                              
                           
                        where πi
                         is the stationary probability under P.

To illustrate the loss of forecast accuracy, consider the following case. The supplier’s information set 
                           B
                         consists of one down state 
                           
                              
                                 B
                                 0
                              
                              =
                              
                                 {
                                 1
                                 }
                              
                           
                         and four up states 
                           
                              
                                 B
                                 1
                              
                              =
                              
                                 {
                                 2
                                 ,
                                 3
                                 ,
                                 4
                                 ,
                                 5
                                 }
                              
                           
                        . The buyer, however, only observes an imperfect signal 
                           
                              
                                 s
                                 ˜
                              
                              ∈
                              
                                 B
                                 ˜
                              
                              =
                              
                                 {
                                 
                                    1
                                    ˜
                                 
                                 ,
                                 
                                    2
                                    ˜
                                 
                                 ,
                                 
                                    3
                                    ˜
                                 
                                 }
                              
                           
                         of 
                           
                              s
                              ∈
                              B
                              ,
                           
                         where 
                           
                              
                                 s
                                 ˜
                              
                              
                                 (
                                 
                                    {
                                    1
                                    }
                                 
                                 )
                              
                              =
                              
                                 1
                                 ˜
                              
                              ,
                           
                        
                        
                           
                              
                                 s
                                 ˜
                              
                              
                                 (
                                 
                                    {
                                    2
                                    ,
                                    3
                                    }
                                 
                                 )
                              
                              =
                              
                                 2
                                 ˜
                              
                              ,
                           
                         and 
                           
                              
                                 s
                                 ˜
                              
                              
                                 (
                                 
                                    {
                                    4
                                    ,
                                    5
                                    }
                                 
                                 )
                              
                              =
                              
                                 3
                                 ˜
                              
                           
                        . Thus the buyer cannot distinguish states s = 2, 3 and states s = 4, 5. If the buyer can only observe up or down, the original Markov chain P aggregates to a two-state Q.

Under noncollaborative forecasting, the buyer’s problem can be formulated as

                           
                              (9)
                              
                                 
                                    
                                       
                                          R
                                          ˜
                                       
                                       t
                                    
                                    
                                       (
                                       k
                                       ,
                                       x
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          y
                                          ∈
                                          
                                             A
                                             ˜
                                          
                                          
                                             (
                                             k
                                             ,
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       {
                                       
                                          L
                                          
                                             (
                                             y
                                             ;
                                             x
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                ℓ
                                                ∈
                                                
                                                   B
                                                   ˜
                                                
                                             
                                          
                                          
                                             q
                                             
                                                k
                                                ℓ
                                             
                                          
                                          E
                                          
                                             
                                                R
                                                ˜
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             ℓ
                                             ,
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   D
                                                   )
                                                
                                                +
                                             
                                             )
                                          
                                       
                                       }
                                    
                                    ,
                                    
                                    k
                                    ∈
                                    
                                       B
                                       ˜
                                    
                                    .
                                 
                              
                           
                        This formulation shares the same mathematical structure with (2), with lower forecast accuracy and dynamics given by Q instead of P. Therefore, the optimal hedging strategy under noncollaborative forecasting is also signal-dependent policy with 
                           
                              (
                              
                                 
                                    s
                                    ˜
                                 
                                 
                                    
                                       s
                                       ˜
                                    
                                    ,
                                    t
                                 
                                 R
                              
                              ,
                              
                                 
                                    S
                                    ˜
                                 
                                 
                                    
                                       s
                                       ˜
                                    
                                    ,
                                    t
                                 
                                 R
                              
                              )
                              ,
                           
                        
                        
                           
                              
                                 s
                                 ˜
                              
                              ∈
                              
                                 B
                                 ˜
                              
                           
                         similarly defined as in Theorem 1, albeit in a reduced granularity.

A common concern in pursuing offshoring strategy is incentive misalignment. Without proper cooperative mechanisms in place, information sharing and collaborative forecasting will not take place in decentralized supply chains. This deficiency is especially devastating in the event of supply disruptions, creating supply chain resilience imperative. To address this deficiency, many multinationals opt to centralize their supply chains via vertical integration; e.g., Intel and Samsung offshore their production via this model (Feenstra & Hanson, 2005).

In a centralized system, collaborative forecasting is a natural outcome of well-aligned incentives of all divisions. The central planner thus has the complete visibility of the chain and solves the following problem for the optimal strategy:

                           
                              (10)
                              
                                 
                                    
                                       T
                                       t
                                    
                                    
                                       (
                                       i
                                       ,
                                       x
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          y
                                          ∈
                                          A
                                          (
                                          i
                                          ,
                                          x
                                          )
                                       
                                    
                                    
                                       {
                                       
                                          H
                                          
                                             (
                                             y
                                             ;
                                             x
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                B
                                             
                                          
                                          
                                             p
                                             
                                                i
                                                j
                                             
                                          
                                          E
                                          
                                             [
                                             
                                                T
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                j
                                                ,
                                                
                                                   
                                                      (
                                                      y
                                                      −
                                                      D
                                                      )
                                                   
                                                   +
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        where per-period cost is 
                           
                              H
                              
                                 (
                                 y
                                 ;
                                 x
                                 )
                              
                              =
                              K
                              ·
                              
                                 I
                                 
                                    {
                                    
                                    
                                       y
                                       >
                                       x
                                    
                                    
                                    }
                                 
                              
                              −
                              
                                 (
                                 r
                                 −
                                 c
                                 )
                              
                              E
                              
                                 (
                                 y
                                 ∧
                                 D
                                 )
                              
                              +
                              h
                              E
                              
                                 
                                    (
                                    y
                                    −
                                    D
                                    )
                                 
                                 +
                              
                              .
                           
                        
                     

In the centralized system, the supplier’s wholesale revenue is the buyer’s procurement cost and the supplier’s inventory subsidy payment is the buyer’s income. These transfer payments cancel out each other when computing the channel profit. Solving (10) yields the supply signal-dependent hedging strategy (s
                        
                           i, t
                        , S
                        
                           i, t
                        ), whose definition is analogous to Theorem 1.

The vertical integration model reveals two deficiencies of the uncoordinated decentralized chains in Section 5.2—double marginalization and information concealment. Both deficiencies are rooted in the decentralized organizational structure and resultant misaligned objectives. First, double marginalization leads to undersupply of the final product, thereby reducing the profits for both parties (Cachon & Lariviere, 2001). Second, information concealment reduces forecast accuracy and system visibility, exacerbates supply–demand mismatch, and jeopardizes the supply chain’s ability to prepare for and respond to disruption risks. Thus, the inefficiency and fragility of the uncoordinated supply chains is the compounded result of both double marginalization and information concealment.

The supply chain resilience and information imperatives also help explain the recent trend of onshoring and vertical integration in manufacturing. For example, an increasing number of U.S. manufacturers (e.g., Caterpillar, NCR, GE) are bringing their production back home or “onshore”; the factors driving this trend include raising transportation and labor costs, reduced visibility, quality and intellectual property concerns, geographic and political risks (Archstone Consulting, 2011; Wu & Zhang, 2011). In China’s high-tech sectors, the export by foreign owned firms (vertical integration) increases from $52 billion in 2000 to $434 billion in 2008, and accounts for 64 percent of China’s total processing export (Sheng & Yang, 2011). The trade literature interprets these shifts in the lens of property-right and managerial incentive systems (Feenstra & Hanson, 2005); our model suggests that they may also be driven by supply chain resilience and information imperatives.

Although vertical integration can effectively rectify the problems of double marginalization and information concealment (Section 5.3), such centralized structure is often infeasible due to financial, regulatory, technological, or political difficulties. Designing and implementing coordinating contracts is then central for decentralized supply risk management. Our problem is unique for its dynamic and fixed cost feature. In this section, we propose a coordinating contract and characterize its allocation, coordination, and information efficacy.

We begin with a supply chain specified by cost parameters (r, c, K, h), the wholesale price contract w, and the bargaining power ρ of the buyer—the share of expected chain profit he appropriates (Zipkin, 2012). Now define the associated subsidy contract
                     
                        
                           (
                           
                              w
                              *
                           
                           ,
                           
                              K
                              R
                              *
                           
                           ,
                           
                              b
                              *
                           
                           )
                        
                      by

                        
                           (11)
                           
                              
                                 
                                    w
                                    *
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    ρ
                                    )
                                 
                                 r
                                 +
                                 ρ
                                 c
                                 ,
                                 
                                 
                                    K
                                    R
                                    *
                                 
                                 =
                                 ρ
                                 K
                                 ,
                                 
                                 
                                    b
                                    *
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    ρ
                                    )
                                 
                                 h
                                 .
                              
                           
                        
                     The subsidy contract 
                        
                           (
                           
                              w
                              *
                           
                           ,
                           
                              K
                              R
                              *
                           
                           ,
                           
                              b
                              *
                           
                           )
                        
                      stipulates that, in each period, the supplier changes a wholesale price w* for each unit delivered to the buyer plus a fixed delivery fee 
                        
                           
                              K
                              R
                              *
                           
                           ,
                        
                      and pays the buyer subsidy b* for each unit of unsold inventory (Gao & Li, 2010). The following theorem characterizes the coordination and allocation properties of the subsidy contract.

                        Theorem 2
                        
                           For any supply chain (r, c, K, h, w, ρ), the subsidy contract
                           
                              
                                 (
                                 
                                    w
                                    *
                                 
                                 ,
                                 
                                    K
                                    R
                                    *
                                 
                                 ,
                                 
                                    b
                                    *
                                 
                                 )
                              
                            
                           in 
                           (11) 
                           coordinates the chain and maintains the power balance, such that, for
                           
                              
                                 t
                                 ∈
                                 T
                                 ,
                              
                           
                           
                              
                                 (i)
                                 
                                    
                                       
                                          
                                             s
                                             
                                                i
                                                ,
                                                t
                                             
                                             *
                                          
                                          =
                                          
                                             s
                                             
                                                i
                                                ,
                                                t
                                             
                                             R
                                          
                                       
                                     
                                    and
                                    
                                       
                                          
                                             S
                                             
                                                i
                                                ,
                                                t
                                             
                                             *
                                          
                                          =
                                          
                                             S
                                             
                                                i
                                                ,
                                                t
                                             
                                             R
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          ∀
                                          i
                                          ∈
                                          B
                                          ,
                                       
                                     
                                    and
                                 


                                    Rt
                                    (i, x) = ρ · Tt
                                    (i, x), 
                                       
                                          ∀
                                          i
                                          ∈
                                          B
                                          ,
                                          x
                                          ∈
                                          R
                                       
                                    .

Part (i) establishes the coordination efficacy of the subsidy contract: it induces the buyer in the decentralized chain to order the centrally optimal quantity. This efficacy stems from the embedded risk sharing mechanism: by subsidizing the buyer for unsold units, it mitigates the buyer’s risk of overstock, thereby boosting the buyer’s order quantity to the supplier’s potential benefit; by charging the buyer a fixed delivery fee 
                        
                           
                              K
                              R
                              *
                           
                           ,
                        
                      it discourages excessively frequent ordering from the buyer and reduces transportation cost, thereby improving channel efficiency. Thus, the coordination efficacy of the subsidy contract effectively eliminates double marginalization—the main deficiency in the decentralized supply chain.

Part (ii) characterizes the allocation efficacy of the subsidy contract: it achieves channel coordination without altering the power allocation ρ of the chain. As the power allocation is often the main culprit for coordination failure (Cachon & Terwiesch, 2008), the allocation efficacy can greatly ease the negotiation process, remove the implementation barrier, and facilitate building a coordinated supply chain.

Next we examine how the contractual structure affects forecast information sharing. The benchmark we use is the wholesale price contract—one of the most prevalent types in practice and literature (Cachon, 2003).

                        Theorem 3
                        
                           For any benchmark wholesale price contract, there exists a Pareto improving subsidy contract under which collaborative forecasting improves all parties’ profits.
                        


                     Theorem 3 establishes the information efficacy of the subsidy contract: it induces the supplier to share supply information. Because of the Pareto improving property, both parties benefit from truthfully sharing information and the resultant improved supply–demand match. Thus, the information efficacy of the subsidy contract rectifies information concealment—the second deficiency in the decentralized supply chain.

Interestingly, it has been argued that the truthful information sharing can also occur under the wholesale price contract. For example, Özer, Zheng, and Chen (2011) show that truthful information sharing may take place even in the absence of reputation-building mechanisms and complex contracts, and argue that the underlying reason for cooperation is trust. By contrast, our subsidy contract relies on Pareto improving property for forecast collaboration.

Our subsidy contract has the following appealing features for adoption. First, by encouraging larger order quantity via overstock subsidy, it alleviates the double marginalization problem—the main drawback of the wholesale price contract. Second, by simplifying accounting and operations procedures, it eliminates unnecessary costs for transporting the unsold stock—the main deficiency of the inventory return contract and the buy-back contract (Cachon, 2003). Third, by employing linear payment scheme based on actual inventory records and ordering history, the subsidy contract is easy to verify and implement, thereby avoiding challenging accounting problems in non-linear payments contract schemes (Cachon & Zipkin, 1999). Fourth, by aligning objectives and improving profits for all, the subsidy contract neutralizes the incentives for information distortion—a prominent problem in the wholesale price contract—and hence facilitates collaborative forecasting. We shall further quantify the effects of the subsidy contract on risk mitigation in Section 7.

Next, we discuss the extension to the case of time- and state-dependent cost parameters and demand distribution. We use subscript i and subscript t to denote state- and time-dependency; e.g., 
                        
                           
                              D
                              t
                              i
                           
                           ∼
                           
                              F
                              t
                              i
                           
                        
                      is the demand in period t under state 
                        
                           i
                           ∈
                           B
                        
                     . Let 
                        
                           
                              
                                 w
                                 ¯
                              
                              t
                              i
                           
                           =
                           
                              ∑
                              
                                 j
                                 ∈
                                 B
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                           
                              w
                              
                                 t
                                 +
                                 1
                              
                              j
                           
                        
                      be the expected wholesale price in the next period given current state i. Define 
                        
                           
                              
                                 c
                                 ¯
                              
                              t
                              i
                           
                           =
                           
                              ∑
                              
                                 j
                                 ∈
                                 B
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                           
                              c
                              
                                 t
                                 +
                                 1
                              
                              j
                           
                        
                      analogously. The optimality equation for the buyer is

                        
                           
                              
                                 
                                    R
                                    t
                                 
                                 
                                    (
                                    i
                                    ,
                                    x
                                    )
                                 
                                 =
                                 
                                    min
                                    
                                       y
                                       ∈
                                       A
                                       (
                                       i
                                       ,
                                       x
                                       )
                                    
                                 
                                 
                                    {
                                    
                                       
                                          L
                                          t
                                       
                                       
                                          (
                                          i
                                          ,
                                          x
                                          ;
                                          y
                                          )
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             B
                                          
                                       
                                       
                                          p
                                          
                                             i
                                             j
                                          
                                       
                                       E
                                       
                                          R
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          j
                                          ,
                                          
                                             
                                                (
                                                y
                                                −
                                                
                                                   D
                                                   t
                                                   i
                                                
                                                )
                                             
                                             +
                                          
                                          )
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     where Lt
                     (i, x; y) is the per-period cost function given by

                        
                           
                              
                                 
                                    
                                       
                                          
                                             L
                                             t
                                          
                                          
                                             (
                                             i
                                             ,
                                             x
                                             ;
                                             y
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             K
                                             
                                                R
                                                ,
                                                t
                                             
                                             i
                                          
                                          ·
                                          
                                             I
                                             
                                                {
                                                
                                                
                                                   y
                                                   >
                                                   x
                                                
                                                
                                                }
                                             
                                          
                                          −
                                          
                                             (
                                             
                                                r
                                                t
                                                i
                                             
                                             −
                                             
                                                w
                                                t
                                                i
                                             
                                             )
                                          
                                          E
                                          
                                             (
                                             y
                                             ∧
                                             
                                                D
                                                t
                                                i
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             (
                                             
                                                h
                                                t
                                                i
                                             
                                             +
                                             
                                                w
                                                t
                                                i
                                             
                                             −
                                             
                                                b
                                                t
                                                i
                                             
                                             −
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                t
                                                i
                                             
                                             )
                                          
                                          E
                                          
                                             
                                                (
                                                y
                                                −
                                                
                                                   D
                                                   t
                                                   i
                                                
                                                )
                                             
                                             +
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Assume that the overstock cost 
                        
                           
                              h
                              t
                              i
                           
                           +
                           
                              w
                              t
                              i
                           
                           −
                           
                              b
                              t
                              i
                           
                           −
                           
                              
                                 w
                                 ¯
                              
                              t
                              i
                           
                           >
                           0
                        
                      (e.g., neither hyperinflation nor speculation occurs), and that the fixed cost 
                        
                           
                              K
                              t
                              i
                           
                           ≥
                           
                              ∑
                              
                                 i
                                 ∈
                                 B
                              
                           
                           
                              p
                              
                                 i
                                 j
                              
                           
                           
                              K
                              
                                 t
                                 +
                                 1
                              
                              j
                           
                        
                      (e.g., the fixed cost is nonincreasing over time). It can be shown that a supply state-dependent 
                        
                           (
                           
                              s
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                           ,
                           
                              S
                              
                                 i
                                 ,
                                 t
                              
                              R
                           
                           )
                        
                      policy is optimal, and the subsidy contract is given by

                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          w
                                          t
                                          
                                             i
                                             *
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ρ
                                          
                                             c
                                             t
                                             i
                                          
                                          +
                                          
                                             (
                                             1
                                             −
                                             ρ
                                             )
                                          
                                          
                                             r
                                             t
                                             i
                                          
                                          ,
                                          
                                          
                                             K
                                             
                                                R
                                                ,
                                                t
                                             
                                             
                                                i
                                                *
                                             
                                          
                                          =
                                          ρ
                                          
                                             K
                                             t
                                             i
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          b
                                          t
                                          
                                             i
                                             *
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             ρ
                                             )
                                          
                                          
                                             h
                                             t
                                             i
                                          
                                          +
                                          ρ
                                          
                                             (
                                             
                                                w
                                                t
                                                
                                                   i
                                                   *
                                                
                                             
                                             −
                                             
                                                
                                                   w
                                                   ¯
                                                
                                                t
                                                
                                                   i
                                                   *
                                                
                                             
                                             )
                                          
                                          −
                                          ρ
                                          
                                             (
                                             
                                                c
                                                t
                                                i
                                             
                                             −
                                             
                                                
                                                   c
                                                   ¯
                                                
                                                t
                                                i
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     All our results hold.

This section conducts experiments to address two questions: (1) What are the main determinants of the optimal hedging strategies? (2) How do collaborative forecasting, contract coordination and inventory hedging jointly mitigate supply risks in a dynamic environment? To this end, we first consider a coordinated supply chain in Section 7.1. This allows us to isolate double marginalization effect and focus on the interactions between forecast and inventory hedging strategies. We examine the joint effects of all three levers in Section 7.2. All our results are robust and hold for a large variety of parameter specifications. For brevity, we only report the typical examples.

To address the first question, we examine the relative and absolute performance gaps of a coordinated supply chain under collaborative and noncorroborative forecastings: 
                           
                              Δ
                              %
                              =
                              
                                 (
                                 E
                                 
                                    T
                                    0
                                 
                                 −
                                 E
                                 
                                    
                                       T
                                       ˜
                                    
                                    0
                                 
                                 )
                              
                              /
                              E
                              
                                 
                                    T
                                    ˜
                                 
                                 0
                              
                           
                         and 
                           
                              Δ
                              =
                              (
                              E
                              
                                 T
                                 0
                              
                              −
                              E
                              
                                 
                                    T
                                    ˜
                                 
                                 0
                              
                              )
                           
                        . The four main factors of interest include the demand risk cv = σ
                        D/μ
                        D, the supply disruption risk 
                           
                              
                                 π
                                 0
                              
                              =
                              P
                              
                                 {
                                 
                                 
                                    i
                                    ∈
                                    
                                       B
                                       0
                                    
                                 
                                 
                                 }
                              
                              ,
                           
                         the fixed cost K, and the retail price r. We vary 
                           
                              cv
                              ∈
                              
                                 {
                                 
                                 
                                    0.10
                                    ,
                                    0.19
                                    ,
                                    0.28
                                    ,
                                    0.37
                                    ,
                                    0.44
                                 
                                 
                                 }
                              
                              ,
                           
                        
                        
                           
                              
                                 π
                                 0
                              
                              ∈
                              
                                 {
                                 
                                 
                                    0.15
                                    ,
                                    0.33
                                    ,
                                    0.76
                                 
                                 
                                 }
                              
                              ,
                           
                        
                        
                           
                              K
                              ∈
                              
                                 {
                                 
                                 
                                    0
                                    ,
                                    20
                                    ,
                                    40
                                 
                                 
                                 }
                              
                              ,
                           
                         and 
                           
                              r
                              ∈
                              
                                 {
                                 
                                 
                                    6
                                    ,
                                    10
                                    ,
                                    14
                                 
                                 
                                 }
                              
                           
                        . We specify the baseline case as follows. Let h = 4, c = 0, ρ = 0.5. The demand follows truncated normal distribution with μ = 10 and cv = 0.2. The supply process is specified by one down state 
                           
                              
                                 B
                                 0
                              
                              =
                              
                                 {
                                 0
                                 }
                              
                           
                         and two up states 
                           
                              
                                 B
                                 1
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 }
                              
                           
                        . Under collaborative forecasting, the evolution of the forecast follows P with disruption risk π
                        0 = 0.24 and stationary distribution π = (0.24, 0.63, 0.13); under noncollaborative forecasting, the buyer cannot differentiates up states and his forecast is governed by Q with π
                        0 = 0.24 and π = (0.24, 0.76), where

                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            0.50
                                                         
                                                      
                                                      
                                                         
                                                            0.50
                                                         
                                                      
                                                      
                                                         
                                                            0.00
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0.01
                                                         
                                                      
                                                      
                                                         
                                                            0.80
                                                         
                                                      
                                                      
                                                         
                                                            0.19
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0.90
                                                         
                                                      
                                                      
                                                         
                                                            0.05
                                                         
                                                      
                                                      
                                                         
                                                            0.05
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                Q
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            0.50
                                                         
                                                      
                                                      
                                                         
                                                            0.50
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0.16
                                                         
                                                      
                                                      
                                                         
                                                            0.84
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Note that 
                           
                              {
                              
                              
                                 i
                                 =
                                 1
                              
                              
                              }
                           
                         is the safe state with negligible disruption risk p
                        1, 0 = 0.01, while 
                           
                              {
                              
                              
                                 i
                                 =
                                 2
                              
                              
                              }
                           
                         is the warning state with substantial disruption risk p
                        2, 0 = 0.90. The results are summarized in Tables 2
                         and 3
                        . We have the following observations.

Collaborative forecasting facilitates adaptive and resilient strategy design (cf. Section 5.1). The resulting dynamic policy is adaptive—stock decision (si, Si
                        ) is guided by the real-time supply information 
                           
                              i
                              ∈
                              B
                           
                        ; it is also resilient—it stocks twice as much inventory in warning state 2 for looming disruptions as in safe state 1 (see S
                        1 and S
                        2 in Table 2). The stock gap reveals two drivers of the dynamic policy: the stock S
                        1 in safe state 1 is used only for mitigating demand risk cv. In warning state 2, however, stock S
                        2 must hedge both demand and supply risks; the additional stock (S
                        2 − S
                        1) is deployed to counter the surging disruption risk p
                        2, 0 − p
                        1, 0 = 0.90 − 0.01 = 0.89. Thus, the dynamic policy is driven by the imperative to hedge both demand and supply risks—a departure from the classic inventory literature (Zipkin, 2000).

The adaptiveness and resilience of the dynamic policy enhances both the efficiency and the robustness of the chain. Driven by the dynamic execution mechanism and enhanced forecasting power, the profit advantage of the dynamic policy over the static one can be as high as 12 percent (cf. Table 2). Unlike the static policy 
                           
                              (
                              
                                 s
                                 ˜
                              
                              ,
                              
                                 S
                                 ˜
                              
                              )
                              ,
                           
                         the dynamic policy flexes with supply volatility: it tailors the stock to the actual risk level 
                           
                              i
                              ∈
                              
                                 B
                                 1
                              
                              ,
                           
                         and accurately times the procurement to the imminence of supply disruption. The dynamic policy thus eliminates redundant stock 
                           
                              (
                              
                                 S
                                 ˜
                              
                              −
                              
                                 S
                                 2
                              
                              )
                           
                         in safe times (i = 1), thereby saving on inventory cost; it promptly ramps up sufficient inventory 
                           
                              (
                              
                                 S
                                 3
                              
                              −
                              
                                 S
                                 ˜
                              
                              )
                           
                         when disruption is imminent (i = 2), thereby saving on shortage cost. The sharp surge of the stock, (S
                        2 − S
                        1), allows the firm to navigate difficult times ahead (p
                        2, 0 = 0.9). For example, in 2004 the supplier monitoring system alerted UTC of the worsening situation of Wellman Dynamics—a key supplier to a number of UTC’s product lines; UTC immediately stepped in, increased its inventory buffer, and warded off a major disruption (Bacheldor, 2005). This result also echoes the finding in Aviv (2007)—advance information is valuable only when there are sufficient resources to act upon.

When collaborative forecasting is absent, the system resorts to the static policy
                        
                           
                              (
                              
                                 s
                                 ˜
                              
                              ,
                              
                                 S
                                 ˜
                              
                              )
                           
                         in Section 5.2. Structurally, it is the weighted average of the dynamic policy {(si, Si
                        )}
                           i = 1, 2, where the weights (0.83, 0.17) are roughly the normalized stationary probabilities π of the Markov process on 
                           
                              B
                              1
                           
                        . Moreover, 
                           
                              
                                 (
                                 
                                    s
                                    1
                                 
                                 ,
                                 
                                    S
                                    1
                                 
                                 )
                              
                              ≤
                              
                                 (
                                 
                                    s
                                    ˜
                                 
                                 ,
                                 
                                    S
                                    ˜
                                 
                                 )
                              
                              ≤
                              
                                 (
                                 
                                    s
                                    2
                                 
                                 ,
                                 
                                    S
                                    2
                                 
                                 )
                              
                           
                         (cf. Tables 2 and 3). Operationally, the static policy is inefficient and fragile. It lacks the real-time visibility and must carry constant stock all the time—even in safe times i = 1—hence inefficient. The stock decision 
                           
                              S
                              ˜
                           
                         is mainly driven by demand risk cv and insensitive to supply risk π
                        0 (cf. Table 2), hence vulnerable to severe disruption risk (e.g., p
                        2, 0 = 0.90).

Collaborative forecasting on supply is more valuable for high margin products, moderate fixed cost, and stable demand. This is evident from Tables 2 and 3 that the performance gap Δ percent is (1) increasing in retail price r, (2) nonmonotone (unimodal) in fixed cost K, and (3) decreasing in demand risk cv. The first two results are intuitive. What comes as a surprise is the last result that the value of forecast collaboration decreases in demand volatility—the academic literature suggests otherwise. This counterintuitive result can be explained by the nature of the forecast and the role of safety stock. First, unlike the literature on sharing demand forecast, we focus on sharing supply forecast. Second, a higher cv pushes up safety stock for demand risk, reduces the relative share of the supply-risk-driven safety stock (because increased safety stock can also be used, inadvertently, to mediate supply shortage during disruptions). Consequently, the effect of the supply information is relatively less prominent under volatile demand.

We now quantify the impact of contract coordination and collaborative forecasting (information sharing) in dynamic risk management, and identify their most applicable business environments.

We design the experiment as follows. The uncoordinated chain uses wholesale price contract, while the coordinated chain implements the subsidy contract in Section 5.1. Two chains have the same power allocation ρ and other parameters as in Section 7.1. We compare the channel performance under the following four mitigation strategies:

                           
                              
                                 
                                    
                                       
                                          Base
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Uncoordinated
                                             
                                             +
                                             
                                             No
                                             
                                             information
                                             
                                             sharing
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          Info
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Uncoordinated
                                             
                                             +
                                             
                                             Information
                                             
                                             sharing
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             Cont
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Coordinated
                                             
                                             +
                                             
                                             No
                                             
                                             information
                                             
                                             sharing
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          Joint
                                       
                                       
                                          =
                                       
                                       
                                          
                                             Coordinated
                                             
                                             +
                                             
                                             Information
                                             
                                             sharing
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For each strategy, we compute the average profit and the optimal policy for each party. The profit improvement of each strategy 
                           
                              π
                              ∈
                              
                                 {
                                 
                                 
                                    Info,
                                    
                                    Cont,
                                    
                                    Joint
                                 
                                 
                                 }
                              
                           
                         over Base strategy, defined by 
                           
                              Δ
                              
                                 T
                                 π
                              
                              =
                              
                                 
                                    E
                                    
                                       T
                                       Base
                                    
                                    −
                                    E
                                    
                                       T
                                       π
                                    
                                 
                                 
                                    E
                                    
                                       T
                                       Base
                                    
                                 
                              
                              ,
                           
                         quantifies the value of information sharing, the value of contract coordination, and the value of jointly employing information sharing and contract coordination, respectively. For each strategy, higher reordering point s indicates higher frequency of ordering, while higher base-stock level S implies lower supply shortage probability.

The results are summarized as follows. Table 4
                         reports the average profit and optimal policy of the supply chain under each strategy. Fig. 1
                         quantifies the profit potential of information sharing, contract coordination, and their joint benefits relative to power allocation ρ (by changing w ∈ [4.5, 9.5]). Figs. 2
                         and 3
                         depict the optimal static and dynamic inventory policies. We have the following observations.

For any wholesale price contract and power allocation ρ, both parties are better off by adopting the coordinating subsidy contract (Section 5.1): ΔT
                        Cont ≥ 0 in Fig. 1. This Pareto improving property is the result of the coordination efficacy of the subsidy contract: by sharing overstock cost, it incentivizes the buyer to order more, thereby eliminating double marginalization effect; by sharing fixed cost, it induces the buyer to properly batch the order, thereby eradicating excessively frequent ordering. For example, under Case 4 in Table 4, if the coordinating contract is used, the static policy reduces the order frequency (reorder point s* decreases from 11 to 7) and increases order quantity (base-stock level S* jumps from 11 to 21). Moreover, the allocation efficiency ensures that the power allocation ρ remains intact, thereby facilitating the implementation. Thus, contract coordination is an effective mechanism to alleviate supply risk regardless of power allocation and forecasting capability (ΔT
                        Cont ≥ 0, ∀ρ, see Fig. 1).

Sharing supply information always benefits the buyer, but may hurt the supplier. More surprisingly, it can even compromise the supply chain’s profitability, as shown for the uncoordinated chain in Case 4 (see Table 4 and Fig. 1). This is because the uncoordinated chain suffers efficiency loss from double marginalization—the buyer orders less than the centrally optimal quantity. Sharing advance supply information enables the dynamic policy, which may allow the buyer to further squeeze inventory at the expense of the supplier and the chain (see Section 7.1). This in turn exacerbates the double marginalization effect, eroding the profits of the supplier and the chain. Therefore, without a coordination contract in place, collaborative forecasting may not be forthcoming; worse, mandating supply information sharing may even exacerbate the gravity of supply disruptions. This result helps explain many high profile failures in implementing collaborative forecasting initiatives; e.g., grocery manufacturing industry in U.S. (GMA, 2011). 
                           6
                        
                        
                           6
                           It is reported that 67 percent of Grocery Manufacturers of America (GMA) member companies are engaged in some form of collaborative forecasting activity, but only 19 percent move beyond pilot studies (GMA, 2011).
                        
                     

Power allocation ρ determines the relative effectiveness of the two risk mitigation mechanisms. When the supplier dominates the chain (ρ < 0.5), the efficiency loss is mainly driven by frequent ordering and double marginalization. The solution is to induce proper incentives from the buyer. Therefore, contract coordination is more effective than information sharing for this purpose, and hence ΔT
                        Cont > ΔTInfo (see cases 1–3). When the buyer appropriates the major share of the chain profit (ρ > 0.5), the incentive distortion is no longer a dominant issue (see increasing stock levels as ρ↑ in Figs. 2 and 3). The efficiency loss is mainly driven by supply–demand mismatch. Hence, information sharing is more effective ΔT
                        Info > ΔT
                        Cont for ρ > 0.5 (see cases 4–6).

Contract coordination and information sharing are complementary in managing supply risk: they strengthen the effectiveness of each other. Although the relative efficacy of each lever varies with respect to power allocation ρ, jointly deploying both levers is always more effective than using each in isolation: ΔT
                        Joint ≥ max (ΔT
                        Info, ΔT
                        Cont) for all cases. In particular, Case 4 shows that individually neither lever is effective in managing supply risk, but jointly they engender significant synergy effect that can improve the chain’s profit by more than 10 percent.

We study a dynamic risk management problem with inventory hedging, contract coordination and collaborative forecasting. The model features advance supply signals, lost sales, and fixed transportation cost. Our contributions are summarized below.

From an academic perspective, we develop a high fidelity Markov model to capture stochastic attributes of ever-changing real-time supply information, and to integrate it with dynamic procurement decisions. Despite the problem complexity, we derive strong analytical results. The optimal hedging strategy is driven by adaptiveness, resilience and intertemporal imperatives. It is more efficient than conventional inventory hedging in reducing premature inventory holding when in safe times; it is also more robust than lean management in reducing the shortage by prompt stock buildup in light of looming disruptions. We propose a coordination subsidy contract with three properties—risk sharing, power preserving, and Pareto improving. The contract can effectively address double marginalization and information concealment problems—the main challenges in managing dispersed supply risks. Our study enriches the risk management tools, where few analytical results exist for the dynamic problems under decentralized supply chains. More importantly, our modeling paradigm demonstrates how real-time, dynamic data sources can be used to support execution-level decision making, although the bulk of research into supply risk management models has been based on stable, static supply forecasts. To our best knowledge, this is a new research endeavor in risk management literature.

From a management perspective, we demonstrate the central role of dynamic forecast and coordination in dynamic risk management. The key is a balanced approach to efficiency, adaptiveness and resilience imperatives. We provide an easy-to-implement coordination contract and a simple policy structure that facilitates ex ante strategic planning and ex post dynamic execution. If properly implemented, the strategy can help address many deficiencies in conventional inventory hedging and lean management practices. We show that the value of dynamic supply forecast is substantial for high margin products, moderate fixed cost, and low demand volatility. Collaborative forecasting is effective for supply–demand mismatch and hence more preferable when the buyer dominates. Contract coordination is effective for double marginalization and frequent ordering, and hence more desirable when the supplier dominates. Without coordination, mandating supply information sharing can exacerbate supply disruptions. The three instruments are strategic complements: advance supply information has a greater impact on mitigating disruptions under the dynamic strategy and well-coordinated supply chains. Our study also helps explain the rationales behind recent trends of onshoring in manufacturing and vertical integration in export-processing trade: among other factors, they may also be driven by resilience and information imperatives.

Below we summarize the main properties of K-convex functions (e.g., Zipkin, 2000; Porteus, 2002).

                        Lemma 2
                        
                           
                              
                                 1.
                                 
                                    A real-valued convex function is K-convex for all K ≥ 0.


                                    A K
                                    1-convex function is also a K
                                    2-convex function for K
                                    1 ≤ K
                                    2.


                                    If g
                                    1(y) and g
                                    2(y) are K
                                    1-convex and K
                                    2-convex respectively, then for α, β ≥ 0, αg
                                    1(y) + βg
                                    2(y) is (αK
                                    1 + βK
                                    2)-convex.


                                    If g(y) is K-convex and w is a random variable, then
                                    
                                       
                                          E
                                          g
                                          (
                                          y
                                          −
                                          w
                                          )
                                       
                                     
                                    is also K-convex, provided that
                                    
                                       
                                          E
                                          g
                                          (
                                          y
                                          −
                                          w
                                          )
                                          <
                                          ∞
                                       
                                     
                                    for all y.


                           Assume that g is a continuous K-convex function and g(y) → ∞ as |y| → ∞. Let A ≤ B be two extended real numbers with the understanding that interval [A, B]becomes open at A (or B) if A = −∞ (or B = ∞). Define
                           
                              
                                 
                                    g
                                    *
                                 
                                 =
                                 
                                    inf
                                    
                                       A
                                       ≤
                                       x
                                       ≤
                                       B
                                    
                                 
                                 g
                                 
                                    (
                                    x
                                    )
                                 
                                 >
                                 −
                                 ∞
                                 ,
                              
                            
                           Let S ≥ s ≥ −∞ andS = min {x|g(x) = g*, A ≤ x ≤ B}, and s = min {x|g(x) ≤ K + g(S), A ≤ x ≤ S}.Then
                           
                              
                                 1.
                                 
                                    g(x) ≥ g(S), for all
                                    
                                       
                                          y
                                          ∈
                                          [
                                          A
                                          ,
                                          B
                                          ]
                                       
                                    .


                                    g(x) ≤ g(y) + K, for any s ≤ x ≤ y ≤ B.


                                    It holds that
                                    
                                       
                                          
                                             
                                                h
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   inf
                                                   
                                                      y
                                                      ≥
                                                      x
                                                      ,
                                                      A
                                                      ≤
                                                      y
                                                      ≤
                                                      B
                                                   
                                                
                                                
                                                   [
                                                   K
                                                   ·
                                                   
                                                      I
                                                      
                                                         {
                                                         
                                                         
                                                            y
                                                            >
                                                            x
                                                         
                                                         
                                                         }
                                                      
                                                   
                                                   +
                                                   g
                                                   
                                                      (
                                                      y
                                                      )
                                                   
                                                   ]
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               K
                                                               +
                                                               g
                                                               (
                                                               S
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               <
                                                               s
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               g
                                                               (
                                                               x
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               s
                                                               ≤
                                                               x
                                                               ≤
                                                               B
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    And h(x) is continuous and K-convex on ( − ∞, B].


                                    Moreover, if s > A, then g(s) = K + g(S) and g(x) is strictly decreasing on (A, s].

To prove

                              
                                 (A.1)
                                 
                                    
                                       f
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          (
                                          −
                                          r
                                          x
                                          )
                                       
                                       ∨
                                       0
                                       +
                                       g
                                       
                                          (
                                          
                                             x
                                             +
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      −
                                                      r
                                                      x
                                                      +
                                                      g
                                                      (
                                                      0
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      x
                                                      <
                                                      0
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      g
                                                      (
                                                      x
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      x
                                                      ≥
                                                      0
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           is K-convex, it suffices to show that ∀z ≥ 0, b > 0, and y, the inequality 
                              
                                 f
                                 
                                    (
                                    y
                                    +
                                    z
                                    )
                                 
                                 +
                                 K
                                 ≥
                                 f
                                 
                                    (
                                    y
                                    )
                                 
                                 +
                                 z
                                 
                                    
                                       f
                                       (
                                       y
                                       )
                                       −
                                       f
                                       (
                                       y
                                       −
                                       b
                                       )
                                    
                                    b
                                 
                              
                            holds for the following four mutually exclusive and collectively exhaustive cases.

                              
                                 Case 1:
                                 0 ≤ y − b < y ≤ y + z. We have

                                       
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                         =
                                                         g
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         ≥
                                                         g
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               g
                                                               (
                                                               y
                                                               )
                                                               −
                                                               g
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         
                                                         by
                                                         
                                                         
                                                         K
                                                         -convexity
                                                         
                                                         of
                                                         
                                                         g
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    y − b < y ≤ y + z < 0. We have

                                       
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                         =
                                                         −
                                                         r
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         g
                                                         (
                                                         0
                                                         )
                                                         +
                                                         K
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         
                                                            [
                                                            −
                                                            r
                                                            y
                                                            +
                                                            g
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            ]
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               (
                                                               −
                                                               r
                                                               )
                                                               y
                                                               −
                                                               (
                                                               −
                                                               r
                                                               )
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         +
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         ≥
                                                         
                                                            [
                                                            −
                                                            r
                                                            y
                                                            +
                                                            g
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            ]
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               (
                                                               −
                                                               r
                                                               )
                                                               y
                                                               −
                                                               (
                                                               −
                                                               r
                                                               )
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         
                                                         since
                                                         
                                                         
                                                         K
                                                         ≥
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         =
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    y − b < y ≤ 0 ≤ y + z. First we claim that

                                       
                                          (A.2)
                                          
                                             
                                                g
                                                (
                                                z
                                                )
                                                +
                                                K
                                                ≥
                                                g
                                                (
                                                0
                                                )
                                                −
                                                r
                                                z
                                                ,
                                                
                                                ∀
                                                z
                                                ≥
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    (A.2) holds for z = 0. Suppose z > 0. By K-convexity of g, we have

                                       
                                          
                                             
                                                g
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                +
                                                K
                                                ≥
                                                g
                                                
                                                   (
                                                   d
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   z
                                                   −
                                                   d
                                                   )
                                                
                                                
                                                   
                                                      g
                                                      (
                                                      d
                                                      )
                                                      −
                                                      g
                                                      (
                                                      0
                                                      )
                                                   
                                                   d
                                                
                                                ,
                                                
                                                0
                                                <
                                                d
                                                ≤
                                                z
                                             
                                          
                                       
                                    Letting d → 0 and invoking 
                                       
                                          
                                             g
                                             +
                                             ′
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          ≥
                                          −
                                          r
                                          ,
                                       
                                     we conclude (A.2).

Thus,

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         g
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      ≥
                                                   
                                                   
                                                      
                                                         g
                                                         (
                                                         0
                                                         )
                                                         +
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         ·
                                                         (
                                                         −
                                                         r
                                                         )
                                                         
                                                         by
                                                         
                                                         (A.2)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            [
                                                            −
                                                            r
                                                            y
                                                            +
                                                            g
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            ]
                                                         
                                                         +
                                                         z
                                                         ·
                                                         
                                                            
                                                               (
                                                               −
                                                               r
                                                               )
                                                               y
                                                               −
                                                               (
                                                               −
                                                               r
                                                               )
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    y − b < 0 < y ≤ y + z. We consider two subcases.

First, if 
                                       
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                0
                                                )
                                             
                                             
                                                y
                                                −
                                                0
                                             
                                          
                                          ≥
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                y
                                                −
                                                b
                                                )
                                             
                                             b
                                          
                                          ,
                                       
                                     then

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         g
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      ≥
                                                   
                                                   
                                                      
                                                         g
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               g
                                                               (
                                                               y
                                                               )
                                                               −
                                                               g
                                                               (
                                                               0
                                                               )
                                                            
                                                            y
                                                         
                                                         
                                                         by
                                                         
                                                         K
                                                         -convexity
                                                         
                                                         of
                                                         
                                                         g
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               0
                                                               )
                                                            
                                                            y
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      ≥
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         by
                                                         
                                                         subcase
                                                         
                                                         hypothesis
                                                         
                                                         and
                                                         
                                                         z
                                                         >
                                                         0
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Second, consider 
                                       
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                0
                                                )
                                             
                                             
                                                y
                                                −
                                                0
                                             
                                          
                                          <
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                y
                                                −
                                                b
                                                )
                                             
                                             b
                                          
                                       
                                    . We have, from this subcase hypothesis,

                                       
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         −
                                                         f
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                         <
                                                         
                                                            y
                                                            b
                                                         
                                                         
                                                            [
                                                            f
                                                            
                                                               (
                                                               y
                                                               )
                                                            
                                                            −
                                                            f
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            +
                                                            r
                                                            
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            ]
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               y
                                                               b
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            f
                                                            (
                                                            y
                                                            )
                                                            −
                                                            f
                                                            (
                                                            0
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      <
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            −
                                                            r
                                                            )
                                                         
                                                         y
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               y
                                                               b
                                                            
                                                            )
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Because 0 < y < b, 
                                       
                                          (
                                          1
                                          −
                                          
                                             y
                                             b
                                          
                                          )
                                          >
                                          0
                                          ,
                                       
                                     we thus conclude from the above

                                       
                                          (A.3)
                                          
                                             
                                                f
                                                (
                                                y
                                                )
                                                −
                                                f
                                                (
                                                0
                                                )
                                                <
                                                −
                                                r
                                                y
                                                ,
                                                
                                                ∀
                                                y
                                                >
                                                0
                                                .
                                             
                                          
                                       
                                    Therefore,

                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         +
                                                         K
                                                      
                                                   
                                                   
                                                      ≥
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         0
                                                         )
                                                         −
                                                         r
                                                         (
                                                         y
                                                         +
                                                         z
                                                         )
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                         
                                                         and
                                                         
                                                         (A.2)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      <
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         y
                                                         )
                                                         −
                                                         r
                                                         z
                                                         
                                                         by
                                                         
                                                         (A.3)
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               0
                                                               )
                                                               −
                                                               r
                                                               y
                                                               −
                                                               f
                                                               (
                                                               0
                                                               )
                                                               +
                                                               r
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            y
                                                            )
                                                         
                                                         +
                                                         z
                                                         
                                                            
                                                               f
                                                               (
                                                               y
                                                               )
                                                               −
                                                               f
                                                               (
                                                               y
                                                               −
                                                               b
                                                               )
                                                            
                                                            b
                                                         
                                                         
                                                         by
                                                         
                                                         (A.1)
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    Thus, f is K-convex.


                           □

We prove the theorem by induction on t. Since R
                           
                              T + 1(i, x) ≡ 0, the result holds trivially for the case t = T + 1. Next, we hypothesize that for some 
                              
                                 (
                                 t
                                 +
                                 1
                                 )
                                 ∈
                                 T
                                 ,
                              
                            (a) R
                           
                              t + 1(i, x) is continuous and KR
                           -convex in x, and (b) R
                           
                              t + 1(i, x) → ∞ as x → ∞. We shall show that the results hold for Rt
                           .

First, consider when the supplier is up (
                              
                                 i
                                 ∈
                                 
                                    B
                                    2
                                 
                              
                           ). Let r
                           0 = (r − w) and h
                           0 = (h − b). Then r
                           0 ≥ 0, h
                           0 ≥ 0. In view of the identity − r
                           0(y∧D) = [ − r
                           0(y − D)]∨0 − r
                           0
                           D, we have

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      A
                                                      (
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                {
                                                
                                                   K
                                                   R
                                                
                                                
                                                   I
                                                   
                                                      {
                                                      
                                                      
                                                         y
                                                         >
                                                         x
                                                      
                                                      
                                                      }
                                                   
                                                
                                                −
                                                
                                                   r
                                                   0
                                                
                                                E
                                                
                                                   (
                                                   y
                                                   ∧
                                                   D
                                                   )
                                                
                                                +
                                                
                                                   h
                                                   0
                                                
                                                E
                                                
                                                   
                                                      (
                                                      y
                                                      −
                                                      D
                                                      )
                                                   
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                   +
                                                   
                                                   
                                                      ∑
                                                      j
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   E
                                                   
                                                      R
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      j
                                                      ,
                                                      
                                                         
                                                            (
                                                            y
                                                            −
                                                            D
                                                            )
                                                         
                                                         +
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      min
                                                      
                                                         y
                                                         ∈
                                                         A
                                                         (
                                                         i
                                                         ,
                                                         x
                                                         )
                                                      
                                                   
                                                   {
                                                   
                                                      K
                                                      R
                                                   
                                                   
                                                      I
                                                      
                                                         {
                                                         
                                                         
                                                            y
                                                            >
                                                            x
                                                         
                                                         
                                                         }
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      j
                                                   
                                                   
                                                      p
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      E
                                                      [
                                                   
                                                   
                                                      [
                                                      −
                                                      
                                                         r
                                                         0
                                                      
                                                      
                                                         (
                                                         y
                                                         −
                                                         D
                                                         )
                                                      
                                                      ]
                                                   
                                                   ∨
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                +
                                                
                                                
                                                   h
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      y
                                                      −
                                                      D
                                                      )
                                                   
                                                   +
                                                
                                                +
                                                
                                                   R
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   j
                                                   ,
                                                   
                                                      
                                                         (
                                                         y
                                                         −
                                                         D
                                                         )
                                                      
                                                      +
                                                   
                                                   )
                                                
                                                
                                                   ]
                                                   }
                                                   −
                                                
                                                
                                                   r
                                                   0
                                                
                                                μ
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      A
                                                      (
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   {
                                                   
                                                      
                                                         K
                                                         R
                                                      
                                                      
                                                         I
                                                         
                                                            {
                                                            
                                                            
                                                               y
                                                               >
                                                               x
                                                            
                                                            
                                                            }
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         j
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      E
                                                      
                                                         f
                                                         t
                                                      
                                                      
                                                         (
                                                         j
                                                         ,
                                                         y
                                                         −
                                                         D
                                                         )
                                                      
                                                   
                                                   }
                                                
                                                −
                                                
                                                   r
                                                   0
                                                
                                                μ
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where

                              
                                 (A.4)
                                 
                                    
                                       
                                          f
                                          t
                                       
                                       
                                          (
                                          i
                                          ,
                                          x
                                          )
                                       
                                       =
                                       
                                          (
                                          −
                                          
                                             r
                                             0
                                          
                                          x
                                          )
                                       
                                       ∨
                                       0
                                       +
                                       
                                          [
                                          
                                             h
                                             0
                                          
                                          
                                             x
                                             +
                                          
                                          +
                                          
                                             R
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             i
                                             ,
                                             
                                                x
                                                +
                                             
                                             )
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Now in light of Lemmas 2 and 3, we only need to show that (a) ft
                           (i, x) is continuous and KR
                           -convex in x, and (b) ft
                           (i, x) → ∞ as x → ∞.

By our hypothesis on R
                           
                              t + 1(i, x), and hx
                           + → ∞ as x → ∞, it is immediate that ft
                           (i, x) is continuous in x and ft
                           (i, x) → ∞ as x → ∞. It remains to show that ft
                           (i, x) is KR
                           -convex.

By our hypothesis, the optimal policy for period t + 1 is of 
                              
                                 (
                                 
                                    s
                                    
                                       i
                                       ,
                                       t
                                       +
                                       1
                                    
                                    R
                                 
                                 ,
                                 
                                    S
                                    
                                       i
                                       ,
                                       t
                                       +
                                       1
                                    
                                    R
                                 
                                 )
                              
                            form, such that

                              
                                 
                                    
                                       
                                          R
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          x
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                            R
                                                         
                                                         +
                                                         
                                                            ∑
                                                            j
                                                         
                                                         E
                                                         
                                                            f
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            j
                                                            ,
                                                            
                                                               S
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                                  +
                                                                  1
                                                               
                                                               R
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            r
                                                            0
                                                         
                                                         μ
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                      <
                                                      
                                                         s
                                                         
                                                            i
                                                            ,
                                                            t
                                                            +
                                                            1
                                                         
                                                         R
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            j
                                                         
                                                         E
                                                         
                                                            f
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            j
                                                            ,
                                                            x
                                                            )
                                                         
                                                         −
                                                         
                                                            r
                                                            0
                                                         
                                                         μ
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                      ≥
                                                      
                                                         s
                                                         
                                                            i
                                                            ,
                                                            t
                                                            +
                                                            1
                                                         
                                                         R
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Taking the right derivative, we obtain 
                              
                                 
                                    lim
                                    
                                       x
                                       ↓
                                       0
                                    
                                 
                                 
                                    R
                                    
                                       t
                                       +
                                       1
                                    
                                    ′
                                 
                                 
                                    (
                                    i
                                    ,
                                    x
                                    )
                                 
                                 =
                                 0
                              
                           . Let g(x) = h
                           0
                           x + R
                           
                              t + 1(i, x). We have

                              
                                 (A.5)
                                 
                                    
                                       
                                          lim
                                          
                                             x
                                             ↓
                                             0
                                          
                                       
                                       g
                                       
                                          (
                                          
                                             x
                                             +
                                          
                                          )
                                       
                                       
                                       =
                                       
                                       
                                          lim
                                          
                                             x
                                             ↓
                                             0
                                          
                                       
                                       
                                          [
                                       
                                       
                                          h
                                          0
                                       
                                       
                                          x
                                          +
                                       
                                       
                                       +
                                       
                                       
                                          R
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          
                                             x
                                             +
                                          
                                          )
                                       
                                       ]
                                       
                                       =
                                       
                                       
                                          h
                                          0
                                       
                                       
                                       =
                                       
                                       h
                                       −
                                       b
                                       ≥
                                       −
                                       
                                          (
                                          r
                                          −
                                          w
                                          )
                                       
                                       
                                       =
                                       
                                       −
                                       
                                          r
                                          0
                                       
                                       ,
                                    
                                 
                              
                           where the inequality holds since h ≥ b and r ≥ w. Now Lemma 1, along with (A.4) and (A.5), implies that ft
                           (i, x) is indeed KR
                           -convex in x, as desired.

Now, consider when the supplier is down (
                              
                                 i
                                 ∈
                                 
                                    B
                                    0
                                 
                              
                           ). It is clear that

                              
                                 
                                    
                                       
                                          
                                             R
                                             t
                                          
                                          
                                             (
                                             i
                                             ,
                                             x
                                             )
                                          
                                          =
                                          −
                                          
                                             r
                                             0
                                          
                                          E
                                          
                                             (
                                             x
                                             ∧
                                             D
                                             )
                                          
                                          +
                                          
                                             h
                                             0
                                          
                                          E
                                          
                                             
                                                (
                                                x
                                                −
                                                D
                                                )
                                             
                                             +
                                          
                                          +
                                          
                                             ∑
                                             j
                                          
                                          
                                             p
                                             
                                                i
                                                j
                                             
                                          
                                          E
                                          
                                             R
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             j
                                             ,
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   D
                                                   )
                                                
                                                +
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           Hence, similar to the proof for the case when 
                              
                                 i
                                 ∈
                                 
                                    B
                                    1
                                 
                                 ,
                              
                            one can show that Rt
                           (i, x) is KR
                           -convex. This completes the induction.□

For the subsidy contract 
                              
                                 (
                                 
                                    w
                                    *
                                 
                                 ,
                                 
                                    K
                                    R
                                    *
                                 
                                 ,
                                 
                                    b
                                    *
                                 
                                 )
                              
                            that satisfies (11), we have the relations 
                              
                                 
                                    
                                       r
                                       −
                                       
                                          w
                                          *
                                       
                                    
                                    
                                       r
                                       −
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       K
                                       
                                          R
                                       
                                       *
                                    
                                    K
                                 
                                 =
                                 
                                    
                                       h
                                       −
                                       
                                          b
                                          *
                                       
                                    
                                    h
                                 
                                 =
                                 ρ
                                 ,
                              
                            which specify per-period cost function L(y; x) in problem (2) and H(y; x) in problem (10) as

                              
                                 (A.6)
                                 
                                    
                                       L
                                       
                                          (
                                          y
                                          ;
                                          x
                                          )
                                       
                                       
                                       =
                                       
                                       −
                                       ρ
                                       K
                                       
                                          I
                                          
                                             {
                                             
                                             
                                                y
                                                >
                                                x
                                             
                                             
                                             }
                                          
                                       
                                       
                                       +
                                       
                                       ρ
                                       
                                          (
                                          r
                                          −
                                          c
                                          )
                                       
                                       E
                                       
                                          (
                                          y
                                          ∧
                                          D
                                          )
                                       
                                       
                                       −
                                       
                                       ρ
                                       h
                                       E
                                       
                                          
                                             (
                                             y
                                             −
                                             D
                                             )
                                          
                                          +
                                       
                                       
                                       =
                                       
                                       ρ
                                       H
                                       
                                          (
                                          y
                                          ;
                                          x
                                          )
                                       
                                       .
                                    
                                 
                              
                           We prove parts (i) and (ii) by induction on t. The statement holds trivially for t = T + 1. Now suppose for some t + 1, 
                              
                                 
                                    (
                                    
                                       s
                                       
                                          i
                                          ,
                                          t
                                       
                                       *
                                    
                                    ,
                                    
                                       S
                                       
                                          i
                                          ,
                                          t
                                       
                                       *
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       s
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                    ,
                                    
                                       S
                                       
                                          i
                                          ,
                                          t
                                       
                                       R
                                    
                                    )
                                 
                              
                            and R
                           
                              t + 1(i, x) = ρ · T
                           
                              t + 1(i, x) hold. We shall show that they also hold for t. This follows from

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   R
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      A
                                                      (
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   {
                                                   
                                                      L
                                                      
                                                         (
                                                         y
                                                         ;
                                                         x
                                                         )
                                                      
                                                      +
                                                      
                                                         ∑
                                                         j
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      E
                                                      
                                                         R
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         j
                                                         ,
                                                         
                                                            
                                                               (
                                                               y
                                                               −
                                                               D
                                                               )
                                                            
                                                            +
                                                         
                                                         )
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                             
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                               
                                                                  (
                                                                  
                                                                     S
                                                                     
                                                                        i
                                                                        ,
                                                                        t
                                                                     
                                                                     R
                                                                  
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  R
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           S
                                                                           
                                                                              i
                                                                              ,
                                                                              t
                                                                           
                                                                           R
                                                                        
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                            if
                                                            
                                                            x
                                                            <
                                                            
                                                               s
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               R
                                                            
                                                            ,
                                                            i
                                                            ∈
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            by
                                                            
                                                            the
                                                            
                                                            optimality
                                                            
                                                            of
                                                            
                                                            
                                                               (
                                                               
                                                                  s
                                                                  
                                                                     i
                                                                     ,
                                                                     t
                                                                  
                                                                  R
                                                               
                                                               ,
                                                               
                                                                  S
                                                                  
                                                                     i
                                                                     ,
                                                                     t
                                                                  
                                                                  R
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                               
                                                                  (
                                                                  y
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  R
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        y
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                             
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                               H
                                                               
                                                                  (
                                                                  
                                                                     S
                                                                     
                                                                        i
                                                                        ,
                                                                        t
                                                                     
                                                                     *
                                                                  
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  [
                                                                  ρ
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     j
                                                                     ,
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              S
                                                                              
                                                                                 i
                                                                                 ,
                                                                                 t
                                                                              
                                                                              *
                                                                           
                                                                           −
                                                                           D
                                                                           )
                                                                        
                                                                        +
                                                                     
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            
                                                               s
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            i
                                                            ∈
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            by
                                                            
                                                            (A.6)
                                                            
                                                            and
                                                            
                                                            the
                                                            
                                                            hypothesis
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                               H
                                                               
                                                                  (
                                                                  y
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  [
                                                                  ρ
                                                                  
                                                                     T
                                                                     
                                                                        t
                                                                        +
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     j
                                                                     ,
                                                                     
                                                                        
                                                                           (
                                                                           y
                                                                           −
                                                                           D
                                                                           )
                                                                        
                                                                        +
                                                                     
                                                                     )
                                                                  
                                                                  ]
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      A
                                                      (
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   {
                                                   
                                                      ρ
                                                      ·
                                                      H
                                                      
                                                         (
                                                         y
                                                         ;
                                                         x
                                                         )
                                                      
                                                      +
                                                      ρ
                                                      ·
                                                      
                                                         ∑
                                                         j
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      E
                                                      
                                                         T
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         j
                                                         ,
                                                         
                                                            
                                                               (
                                                               y
                                                               −
                                                               D
                                                               )
                                                            
                                                            +
                                                         
                                                         )
                                                      
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                by
                                                
                                                the
                                                
                                                optimality
                                                
                                                of
                                                
                                                (
                                                
                                                   s
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                   *
                                                
                                                ,
                                                
                                                   S
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                             
                                          
                                          
                                             
                                                ρ
                                                ·
                                                
                                                   T
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           This completes the proof.□

For each given wholesale price contract, the power allocation ρ is uniquely defined by the share of channel cost the buyer shoulders. Hence we can construct a subsidy contract 
                              
                                 (
                                 
                                    w
                                    *
                                 
                                 ,
                                 
                                    K
                                    R
                                    *
                                 
                                 ,
                                 
                                    b
                                    *
                                 
                                 )
                              
                            from (11). We now consider the supply chain operating under the contract 
                              
                                 (
                                 
                                    w
                                    *
                                 
                                 ,
                                 
                                    K
                                    R
                                    *
                                 
                                 ,
                                 
                                    b
                                    *
                                 
                                 )
                              
                           . The collaborative forecasting, defined by information set 
                              B
                            and transition [p
                           
                              i, j
                           ], degenerates to two-state noncollaborative forecasting defined by 
                              
                                 B
                                 ˜
                              
                            and [q
                           
                              k, ℓ]. Let 
                              
                                 
                                    
                                       T
                                       ˜
                                    
                                    t
                                 
                                 
                                    (
                                    k
                                    ,
                                    x
                                    )
                                 
                              
                            be the optimal value function for the chain under noncollaborative forecasting. We shall show 
                              
                                 
                                    T
                                    t
                                 
                                 
                                    (
                                    i
                                    ,
                                    x
                                    )
                                 
                                 ≤
                                 
                                    
                                       T
                                       ˜
                                    
                                    t
                                 
                                 
                                    (
                                    k
                                    ,
                                    x
                                    )
                                 
                                 ,
                              
                            for 
                              
                                 i
                                 ∈
                                 B
                              
                            and 
                              
                                 k
                                 =
                                 
                                    s
                                    ˜
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ∈
                                 
                                    B
                                    ˜
                                 
                                 ,
                              
                           
                           
                              
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    +
                                 
                                 ,
                              
                            and 
                              
                                 t
                                 ∈
                                 T
                              
                           .

The case for t = T + 1 holds trivially. Now suppose the inequality holds for t + 1. The case for t holds because

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   T
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      A
                                                      (
                                                      i
                                                      ,
                                                      x
                                                      )
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      
                                                         (
                                                         y
                                                         ;
                                                         x
                                                         )
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            B
                                                         
                                                      
                                                      
                                                         p
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      E
                                                      
                                                         [
                                                         
                                                            T
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            j
                                                            ,
                                                            
                                                               
                                                                  (
                                                                  y
                                                                  −
                                                                  D
                                                                  )
                                                               
                                                               +
                                                            
                                                            )
                                                         
                                                         ]
                                                      
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  
                                                                     S
                                                                     
                                                                        i
                                                                        ,
                                                                        t
                                                                     
                                                                     *
                                                                  
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  T
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           S
                                                                           
                                                                              i
                                                                              ,
                                                                              t
                                                                           
                                                                           *
                                                                        
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            
                                                               s
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            i
                                                            ∈
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            by
                                                            
                                                            the
                                                            
                                                            optimality
                                                            
                                                            of
                                                            
                                                            (
                                                            
                                                               s
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            
                                                               S
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  y
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  T
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        y
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        S
                                                                        ˜
                                                                     
                                                                     
                                                                        k
                                                                        ,
                                                                        t
                                                                     
                                                                     *
                                                                  
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  T
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              S
                                                                              ˜
                                                                           
                                                                           
                                                                              k
                                                                              ,
                                                                              t
                                                                           
                                                                           *
                                                                        
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            
                                                               
                                                                  s
                                                                  ˜
                                                               
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            k
                                                            =
                                                            
                                                               s
                                                               ˜
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            ∈
                                                            
                                                               
                                                                  B
                                                                  ˜
                                                               
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            by
                                                            
                                                            the
                                                            
                                                            optimality
                                                            
                                                            of
                                                            
                                                            (
                                                            
                                                               s
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            
                                                               S
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  y
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  j
                                                               
                                                               
                                                                  p
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                               
                                                               E
                                                               
                                                                  T
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        y
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        S
                                                                        ˜
                                                                     
                                                                     
                                                                        k
                                                                        ,
                                                                        t
                                                                     
                                                                     *
                                                                  
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     ℓ
                                                                     ∈
                                                                     
                                                                        B
                                                                        ˜
                                                                     
                                                                  
                                                               
                                                               
                                                                  q
                                                                  
                                                                     k
                                                                     ℓ
                                                                  
                                                               
                                                               E
                                                               
                                                                  
                                                                     T
                                                                     ˜
                                                                  
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  k
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              S
                                                                              ˜
                                                                           
                                                                           
                                                                              k
                                                                              ,
                                                                              t
                                                                           
                                                                           *
                                                                        
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            
                                                               
                                                                  s
                                                                  ˜
                                                               
                                                               
                                                                  k
                                                                  ,
                                                                  t
                                                               
                                                               *
                                                            
                                                            ,
                                                            k
                                                            =
                                                            
                                                               s
                                                               ˜
                                                            
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            ∈
                                                            
                                                               
                                                                  B
                                                                  ˜
                                                               
                                                               1
                                                            
                                                            
                                                            by
                                                            
                                                            the
                                                            
                                                            hypothesis
                                                            
                                                            and
                                                            
                                                            (7)
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               H
                                                               
                                                                  (
                                                                  y
                                                                  ;
                                                                  x
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     ℓ
                                                                     ∈
                                                                     
                                                                        B
                                                                        ˜
                                                                     
                                                                  
                                                               
                                                               
                                                                  q
                                                                  
                                                                     k
                                                                     ℓ
                                                                  
                                                               
                                                               E
                                                               
                                                                  
                                                                     T
                                                                     ˜
                                                                  
                                                                  
                                                                     t
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  (
                                                                  k
                                                                  ,
                                                                  
                                                                     
                                                                        (
                                                                        y
                                                                        −
                                                                        D
                                                                        )
                                                                     
                                                                     +
                                                                  
                                                                  )
                                                               
                                                               ,
                                                               
                                                               otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      y
                                                      ∈
                                                      
                                                         A
                                                         ˜
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         x
                                                         )
                                                      
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      
                                                         (
                                                         y
                                                         ;
                                                         x
                                                         )
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            ℓ
                                                            ∈
                                                            
                                                               B
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         q
                                                         
                                                            k
                                                            ℓ
                                                         
                                                      
                                                      E
                                                      
                                                         
                                                            T
                                                            ˜
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         k
                                                         ,
                                                         
                                                            
                                                               (
                                                               y
                                                               −
                                                               D
                                                               )
                                                            
                                                            +
                                                         
                                                         )
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                by
                                                
                                                the
                                                
                                                optimality
                                                
                                                of
                                                
                                                (
                                                
                                                   
                                                      s
                                                      ˜
                                                   
                                                   
                                                      k
                                                      ,
                                                      t
                                                   
                                                   *
                                                
                                                ,
                                                
                                                   
                                                      S
                                                      ˜
                                                   
                                                   
                                                      k
                                                      ,
                                                      t
                                                   
                                                   *
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      T
                                                      ˜
                                                   
                                                   t
                                                
                                                
                                                   (
                                                   k
                                                   ,
                                                   x
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The buyer also improves his cost under collaborative forecast, because

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                ρ
                                                
                                                   T
                                                   t
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                                
                                                part
                                                
                                                (ii)
                                                
                                                of
                                                
                                                Theorem
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                ρ
                                                
                                                   
                                                      T
                                                      ˜
                                                   
                                                   t
                                                
                                                
                                                   (
                                                   k
                                                   ,
                                                   x
                                                   )
                                                
                                                
                                                T
                                                
                                                   (
                                                   i
                                                   ,
                                                   x
                                                   )
                                                
                                                ≤
                                                
                                                   T
                                                   ˜
                                                
                                                
                                                   (
                                                   k
                                                   ,
                                                   x
                                                   )
                                                
                                                
                                                for
                                                
                                                k
                                                =
                                                
                                                   s
                                                   ˜
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                      ˜
                                                   
                                                   t
                                                
                                                
                                                   (
                                                   k
                                                   ,
                                                   x
                                                   )
                                                
                                                
                                                part
                                                
                                                (ii)
                                                
                                                of
                                                
                                                Theorem
                                                
                                                2
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           An analogous argument establishes the case for the supplier. Therefore, under the subsidy contract, collaborative forecasting is Pareto improving.□

@&#REFERENCES@&#

