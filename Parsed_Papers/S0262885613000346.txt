@&#MAIN-TITLE@&#Contrast-Adaptive Removable Visible Watermarking (CARVW) mechanism

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The transparency of the watermark is applicable to the various host images.


                        
                        
                           
                           The browsers can recognize the watermark, and the host image is not seriously obscured.


                        
                        
                           
                           The new scheme can remove the embedded watermark from the watermarked image.


                        
                        
                           
                           The PSNR values of the various restored images are around 56dB after the visible watermark has been removed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Restoration

Transparency

Visible watermark

Contrast-adaptive

Copyright protection

@&#ABSTRACT@&#


               
               
                  Engineers have proposed many watermark mechanisms for protecting the content of digital media from unauthorized use. The visible watermark scheme indicates the copyright of digital media posted over the Internet by embedding an inconspicuous but recognizable pattern into media. However, the embedding process often results in serious distortion of the protected image. Since the strength of the watermark in conventional methods mainly depends on the feature of protected media, this may lead to unsatisfactory transparency of watermarked images. This paper proposes a removable solution for visible watermark mechanism. By adopting the subsampling technique, the method proposes a contrast-adaptive strategy to solve this problem. This method can also guarantee the essentials of general visible watermark schemes. Experimental results show that the proposed method outperforms related works in terms of preserving the quality of the restored image.
               
            

@&#INTRODUCTION@&#

Digital watermark techniques [1–11] have recently been utilized to protect the content of multimedia from unauthorized use. According to the visibility of the watermark embedded in the protected media, watermark mechanisms are classified as visible or invisible. Although they are applied to different applications and possess the same importance, engineers often pay more attention on invisible methods. This paper offers a novel solution for visible watermark mechanism to mitigate this unbalance. For simplicity, we focus our research on the digital images presented in this article.

For commercial consideration, valuable images are digitalized and posted over the Internet by resource provider. Naturally, people can freely browse and download these online media; thus, how to protect the digital media from illegal use is an important issue. Visible watermark mechanisms [12–16] are employed to indicate the copyright of digital media by embedding an inconspicuous but recognizable logo into media. The embedded visible watermark, however, can seriously distort the protected image. Removable visible watermark (RVW) mechanisms are proposed to resolve this issue [14]. In addition to being capable of preventing the online resource from unauthorized use, this version allows authorized users to remove the visible watermark and obtain an unmarked image with acceptable quality. Hu and Jeon proposed an improved version in which the embedded visible watermark can be completely removed [15]; nevertheless, this visible watermark can only protect a local area of the whole image. This limitation cannot fulfill the protection requirement of the visible watermark mechanisms [2,3].

Tsai and Chang proposed a reversible visible image watermarking using the pixel value mapping (PVM) function [17]. The visible logo is embedded into the host image according to two principles: creating a bright logo on the dark regions of the host image, and constructing a dark logo on the bright regions of the host image. Nevertheless, the PVM is irreversible, and the quality of the reconstructed unmarked image approximates to that of the host image with a difference value of 0 or 1 (the distortion of each pixel is at most unity). To restore the lossless unmarked image, the scheme records the difference values between the restored areas and the original image areas. A compression technique, JBIG, afterward is used to reduce the payload of the difference values.

The main concerns in designing an RVW mechanism are transparency and restoration. The transparency focuses on how the strength of the watermark influences the host image. Generally speaking, the perceptual translucence of a host image and its watermark recognition is a tradeoff. To obtain good watermark recognition from a host image, the visibility strength of the watermark must be increased. However, increasing visibility of the watermark may cause distortion on a host image. The restoration addresses the quality of the reconstructed image. Without loss of generality, the host image is seriously distorted after being embedded a visible logo. RVW methods must permit authorized users to restore watermarked images to unmarked images with excellent quality; otherwise, the reconstructed image may become distorted and valueless.

The strength of the watermark in conventional methods mainly depends on the feature of the protected media. This dependency may result in the unsatisfactory transparency of watermarked images. Employing the subsampling technique, we propose a contrast-adaptive strategy to solve this problem. In addition to the feature of the protected media, the proposed scheme employs an adaptive weight that allows resource provider to adjust the energy of the watermark according to the visual requirement of the protected image. Furthermore, the experimental results show that the performances of the proposed scheme are superior to those of the others [13–17].

The rest of this paper is organized as follows. Prior works are introduced in Section 2. The embedding procedure of the novel mechanism is elaborated in Section 3, while the removing procedure is addressed in Section 4, followed by an instance of the proposed method in Section 5. Experimental results and performance analyses are discussed in Section 6. Finally, we make conclusions in Section 7.

Here, we describe the essentials of RVW mechanisms and introduce the subsampling technique adopted in the novel method.

In the following, we define the essentials of the novel RVW mechanism as follows [2,3]:
                           
                              Essential 1: Restoration

The commercial value of the original image may be reduced due to distortion resulting from the embedded visible watermark. Thus, RVW mechanisms must guarantee that an authorized user can restore a host image with satisfactory quality.

Essential 2: Transparency

The host image must not be seriously obscured by the RVW; otherwise, browsers cannot recognize the content of the host image. That is, the RVW method must ensure that the strength of the visible watermark is appropriate.

Essential 3: Global protection

It is clear that the visible watermark is used to protect a whole image from illegal use. Therefore, the RVW must not be applied to the local area of a host image but to the global area.

Essential 4: Multiple authorizations

The RVW mechanism must be able to authorize a host image to distinct users; this makes the system more flexible and practical. That is, for each authorized user, the RVW mechanism must generate an individual watermarked image for the same subject image with a unique secret key. Later, the users can remove the visible watermark to obtain an unmarked image with their own secret key.

Essential 5: Robustness

An unauthorized user may intend to eliminate the visible logo from the watermarked image. Hence, a robust RVW algorithm shall be able to resist such malicious attack. Without the authorized information, it is difficult for the attacker to erase the visible logo. That is, the elimination process is labor intensive, and its cost is more expensive than purchasing the copyright of the digital image.

The proposed contrast-adaptive RVW (CARVW) mechanism consists of two procedures: embedding and removing. The first procedure embeds a visible watermark into the image to be protected, while the second allows an authorized user to remove the logo from the watermarked image and restore the unmarked image.


                        Fig. 1
                         shows the block diagram of CARVW. The host image O is an N
                        ×
                        N gray-scale image. First, we adopt the subsampling technique [5] to divide the host image O into four sub-images, O
                        1, O
                        2, O
                        3, and O
                        4, with N/2×
                        N/2pixels. The subsampling process is defined as follows:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             O
                                             1
                                          
                                          
                                             p
                                             q
                                          
                                          =
                                          O
                                          
                                             
                                                2
                                                p
                                                ,
                                                2
                                                q
                                             
                                          
                                          ,
                                       
                                       
                                          
                                             O
                                             2
                                          
                                          
                                             p
                                             q
                                          
                                          =
                                          O
                                          
                                             
                                                2
                                                p
                                                ,
                                                2
                                                q
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             O
                                             3
                                          
                                          
                                             p
                                             q
                                          
                                          =
                                          O
                                          
                                             
                                                2
                                                p
                                                +
                                                1
                                                ,
                                                2
                                                q
                                             
                                          
                                          ,
                                       
                                       
                                          
                                             O
                                             4
                                          
                                          
                                             p
                                             q
                                          
                                          =
                                          O
                                          
                                             
                                                2
                                                p
                                                +
                                                1
                                                ,
                                                2
                                                q
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        where p
                        =0, 1, …, (N/2)−1 and q
                        =0, 1, …, (N/2)−1.

We subsequently apply discrete wavelet transformation (DWT) to sub-images O
                        1, O
                        2, O
                        3, and O
                        4 to obtain four corresponding decomposed wavelet domains D
                        1, D
                        2, D
                        3, and D
                        4, respectively. Let the t-level lowest-frequency subband of Di
                         be LLi
                         with size N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1, i∈{1, 2, 3, 4} as shown in Fig. 2
                        . It is clear that the four lowest-frequency subbands are similar, i.e. LLi
                        
                        ≈
                        LLj
                        , for j∈{1, 2, 3, 4} and j
                        ≠
                        i. This is because the coefficients of the four lowest-frequency subbands at the same locations are highly correlated. The property especially occurs in the smooth areas. As to the significant texture areas, however, differences between the corresponding coefficients may arise. Based on these characteristics, we utilize the coefficient correlations of sub-images to estimate the strength of the visible watermark.

To begin, each authorized user is assigned a unique secret key SK by the resource provider. Next, the SK is applied to generate a total of N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1 individual pairs (i, j), for i, j∈{1, 2, 3, 4} and i
                        ≠
                        j. For simplicity, we use P as a pool to host all the pairs. To enhance security, we employ these pairs to produce an individual visible watermarked image for each legal user. Therefore, only the authorized user with SK can remove the embedded watermark to restore the host image O.
                           Nomenclature


                           
                              O
                           
                           
                              the host gray-level image with size N
                                 ×
                                 N pixels

the watermarked image

four sub-images of O, i∈{1, 2, 3, 4}

four DWT corresponding to Oi
                                 
                              


                                 t-level discrete wavelet transformation (DWT)

the t-level lowest-frequency subband of Di
                                 
                              

the watermark with size N/2
                                    t
                                    +1
                                 ×
                                 N/2
                                    t
                                    +1
                              


                                 k
                                 =1, 2, …, N/2
                                    t
                                    +1
                                 ×
                                 N/2
                                    t
                                    +1
                              

the k-th bit of M
                              

a unique secret key for each authorized user

the N/2
                                    t
                                    +1
                                 ×
                                 N/2
                                    t
                                    +1 pairs

the k-th pair in P
                              

the k-th coefficient value in the lowest-frequency subband 
                                    
                                       L
                                       
                                          L
                                          
                                             α
                                             k
                                          
                                       
                                    
                                 
                              

the k-th coefficient value in the lowest-frequency subband 
                                    
                                       L
                                       
                                          L
                                          
                                             β
                                             k
                                          
                                       
                                    
                                 
                              

a difference between coefficients 
                                    
                                       L
                                       
                                          L
                                          
                                             α
                                             k
                                          
                                       
                                       
                                          k
                                       
                                    
                                  and 
                                    
                                       L
                                       
                                          L
                                          
                                             β
                                             k
                                          
                                       
                                       
                                          k
                                       
                                    
                                 
                              

a variance among all dk
                                 
                              

the strength of the watermark

the strength of the significant texture of host images

the visible weight for the watermark bit mk
                                 
                              

This procedure includes two subroutines: weight estimation and watermark embedding. First, we address how to estimate the perceptible weight for the visible watermark. According to the weight, we subsequently illustrate how to embed the visible watermark into the host image. Fig. 2 illustrates the embedding process.

Assume that the embedded visible watermark M is a binary watermark image, M
                        ={mk
                         | k
                        =1, 2, …, N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1}. According to the requirements of RVW mechanisms, the embedded visible watermark should be as translucent as possible. In addition to ensuring that the visible watermark is recognizable, we strive to protect the original image quality from distortion.

Here, we follow two rules. First, for smooth areas, the weight of visible watermark must be diminished so that the watermark does not seriously obscure the host image. Second, we must enhance the visual perception of embedded watermark while dealing with rough areas; that is, we increase the weight to highlight the logo in the complex region. Consequently, we estimate the weight as follows:
                           
                              Step 1: Let (αk
                                 , βk
                                 ) be the k-th pair in pair pool P, k
                                 =1, 2, …, (N/2
                                    t
                                    +1
                                 ×
                                 N/2
                                    t
                                    +1).

Step 2: For a pair (αk
                                 , βk
                                 ), we can obtain the k-th coefficient values of subbands 
                                    
                                       L
                                       
                                          L
                                          
                                             α
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       L
                                       
                                          L
                                          
                                             β
                                             k
                                          
                                       
                                    
                                 , depicted as x and y, respectively:
                                    
                                       (2)
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      =
                                                      L
                                                      
                                                         L
                                                         
                                                            α
                                                            k
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      y
                                                      =
                                                      L
                                                      
                                                         L
                                                         
                                                            β
                                                            k
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Here, 
                                    
                                       L
                                       
                                          L
                                          
                                             α
                                             k
                                          
                                       
                                       
                                          k
                                       
                                    
                                  denotes the k-th coefficient value in the lowest-frequency subband 
                                    
                                       L
                                       
                                          L
                                          
                                             α
                                             k
                                          
                                       
                                    
                                 , and 
                                    
                                       L
                                       
                                          L
                                          
                                             β
                                             k
                                          
                                       
                                       
                                          k
                                       
                                    
                                  denotes the k-th coefficient value in the lowest-frequency subband 
                                    
                                       L
                                       
                                          L
                                          
                                             β
                                             k
                                          
                                       
                                    
                                 .

Step 3: The integer difference dk
                                  between the coefficient values x and y is calculated as
                                    
                                       (3)
                                       
                                          
                                             
                                                d
                                                k
                                             
                                             =
                                             
                                                
                                                   x
                                                   −
                                                   y
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Step 4: We then obtain the variance σk
                                  of the coefficient values x and y by computing
                                    
                                       (4)
                                       
                                          
                                             
                                                σ
                                                k
                                             
                                             =
                                             
                                                
                                                   
                                                      d
                                                      k
                                                   
                                                   −
                                                   
                                                      d
                                                      min
                                                   
                                                
                                                
                                                   
                                                      d
                                                      max
                                                   
                                                   −
                                                   
                                                      d
                                                      min
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 where d
                                 min and d
                                 max are the minimum and maximum difference values among all dk
                                 s, for k
                                 =1, 2, …, (N/2
                                    t
                                    +1
                                 ×
                                 N/2
                                    t
                                    +1).

Step 5: The weight wk
                                  for the watermark bit mk
                                  is defined as
                                    
                                       (5)
                                       
                                          
                                             
                                                w
                                                k
                                             
                                             =
                                             
                                                w
                                                u
                                             
                                             +
                                             
                                                
                                                   
                                                      w
                                                      v
                                                   
                                                   ×
                                                   
                                                      σ
                                                      k
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The values of wu
                         and wv
                         are determined by the strength of the user-defined watermark and the significant texture of the protected image, respectively.

Since the content energy of watermark M mainly gathers in black pixels, we must highlight these black regions of M in the watermarked image to emphasize visibility. In contrast to the black pixels, the white pixels, which possess less energy, are not considered to alter the original image. In CARVW, we only embed the black regions of M to protect the copyright of the original image. Thus, we can reduce the alteration of the original image to preserve the quality of watermarked image while enhancing the visibility of the watermark.

Obeying the above concept, if a watermark bit mk
                         belongs to the black regions (i.e. the watermark bit mk
                        
                        =0), we employ the corresponding weight wk
                         to adjust the k-th coefficient values of the lowest-frequency subbands LL
                        1, LL
                        2, LL
                        3, and LL
                        4 by the following equation:
                           
                              (6)
                              
                                 
                                    L
                                    
                                       L
                                       δ
                                       ′
                                    
                                    
                                       k
                                    
                                    =
                                    L
                                    
                                       L
                                       δ
                                    
                                    
                                       k
                                    
                                    −
                                    
                                       w
                                       k
                                    
                                    .
                                 
                              
                           
                        
                     

Here, LL
                        
                           δ
                        ′(k) denotes the k-th coefficient value in the lowest-frequency subband of the processed image LL
                        
                           δ
                        ′, for δ
                        =1, 2, 3, and 4 and k
                        =1, 2, …, (N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1).

Subsequently, we apply the inverse discrete wavelet transformation (IDWT) to the processed D
                        1, D
                        2, D
                        3, and D
                        4 to obtain four corresponding sub-images. By employing the inverse subsampling technique on the sub-images, we can derive the watermarked image O′. The resource provider thereby can issue O′ to the individual user along with the secret factors {wu
                        , wv
                        }, unique key SK, and logo M. Moreover, to enhance the security, the secret parameters {wu
                        , wv
                        }, SK, and M can be encrypted by the individual user's secret key firstly.

With weight wk
                        , the quality of the watermarked image O′ is capable of highlighting the energy of the watermark. Specifically, each weight is adjustable with the correlation variance of the two selected lowest-frequency subbands. That is, the perceptual quality of the watermarked image is sensitively adapted according to the watermark image, the feature of host image, and user-defined {wu
                        , wv
                        }.

An authorized user can remove the embedded information in order to restore an unmarked image from the watermarked image by employing the decrypted secret factors {wu
                     , wv
                     }, user key SK, and logo M.
                        
                           Step 1: Suppose that O′ is the watermarked image. We apply the subsampling technique in Eq. (1) and DWT transform to O′ to obtain four watermarked lowest-frequency subbands LL
                              
                                 δ
                              ′, for δ
                              =1, 2, 3, and 4.

Step 2: We then input the user key SK to generate the same pairs in P.

Step 3: For the k-th pair (αk
                              , βk
                              ) of P, we can obtain the k-th coefficient values of subbands 
                                 
                                    L
                                    
                                       L
                                       
                                          α
                                          k
                                       
                                       ′
                                    
                                 
                               and 
                                 
                                    L
                                    
                                       L
                                       
                                          β
                                          k
                                       
                                       ′
                                    
                                 
                              , respectively.


                              
                                 
                                    (7)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      ′
                                                   
                                                   =
                                                   L
                                                   
                                                      L
                                                      
                                                         α
                                                         k
                                                      
                                                      ′
                                                   
                                                   
                                                      k
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      ′
                                                   
                                                   =
                                                   L
                                                   
                                                      L
                                                      
                                                         β
                                                         k
                                                      
                                                      ′
                                                   
                                                   
                                                      k
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Here, 
                                 
                                    L
                                    
                                       L
                                       
                                          δ
                                          k
                                       
                                       ′
                                    
                                    
                                       k
                                    
                                 
                               denotes the k-th coefficient value in the lowest-frequency subband 
                                 
                                    L
                                    
                                       L
                                       
                                          δ
                                          k
                                       
                                       ′
                                    
                                 
                              , for k
                              =1, 2, …, (N/2
                                 t
                                 +1
                              ×
                              N/2
                                 t
                                 +1).

Step 4: The difference value d
                              
                                 k
                              ′ between x′ and y′ is computed by
                                 
                                    (8)
                                    
                                       
                                          
                                             d
                                             k
                                             ′
                                          
                                          =
                                          
                                             
                                                
                                                   x
                                                   ′
                                                
                                                −
                                                
                                                   y
                                                   ′
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Step 5: The variance σ
                              
                                 k
                              
                              ′ of x′ and y′ is obtained by
                                 
                                    (9)
                                    
                                       
                                          
                                             σ
                                             k
                                             ′
                                          
                                          =
                                          
                                             
                                                
                                                   d
                                                   k
                                                   ′
                                                
                                                −
                                                
                                                   d
                                                   min
                                                   ′
                                                
                                             
                                             
                                                
                                                   d
                                                   max
                                                   ′
                                                
                                                −
                                                
                                                   d
                                                   min
                                                   ′
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              where d
                              min
                              ′ and d
                              max
                              ′ are the minimum and maximum difference values among all d
                              
                                 k
                              
                              's, for k
                              =1, 2, …, (N/2
                                 t
                                 +1
                              ×
                              N/2
                                 t
                                 +1).

Step 6: Since the values of difference d
                              
                                 k
                              ′, d
                              min
                              ′, and d
                              max
                              ′, and variance σ
                              
                                 k
                              
                              ′ are invariant (i.e. d
                              
                                 k
                              ′=
                              d
                              
                                 k
                              , d
                              min
                              ′
                              =
                              d
                              min, d
                              max
                              ′
                              =
                              d
                              max, and σ
                              
                                 k
                              
                              ′
                              =
                              σ
                              
                                 k
                              ), we can further acquire accurate weight w
                              
                                 k
                              ′ by
                                 
                                    (10)
                                    
                                       
                                          
                                             w
                                             k
                                             ′
                                          
                                          =
                                          
                                             w
                                             u
                                          
                                          +
                                          
                                             
                                                
                                                   w
                                                   v
                                                
                                                ×
                                                
                                                   σ
                                                   k
                                                   ′
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Here, only the authorized owner can decrypt the SK and {wu
                              , wv
                              } to attain the accurate w
                              
                                 k
                              ′.

Step 7: According to w
                              
                                 k
                              ′ and the logo M
                              ={mk
                               | k
                              =1, 2, …, (N/2
                                 t
                                 +1
                              ×
                              N/2
                                 t
                                 +1)}, if the watermark bit mk
                              
                              =0, we remove the weight wk
                               from the k-th coefficient values of lowest-frequency subbands LL
                              1′, LL
                              2′ LL
                              3′, and LL
                              4′ by
                                 
                                    (11)
                                    
                                       
                                          L
                                          
                                             L
                                             δ
                                             *
                                          
                                          
                                             k
                                          
                                          =
                                          L
                                          
                                             L
                                             δ
                                             ′
                                          
                                          
                                             k
                                          
                                          +
                                          
                                             w
                                             k
                                          
                                          .
                                       
                                    
                                 
                              where LL
                              
                                 δ
                              
                              ⁎(k) denotes the k-th reconstructed coefficient value in the lowest-frequency subband LL
                              
                                 δ
                              ′ of the restored image, for δ
                              =1, 2, 3, and 4 and k
                              =1, 2, …, (N/2
                                 t
                                 +1
                              ×
                              N/2
                                 t
                                 +1).

Step 8: Employ IDWT to obtain four corresponding sub-images. Finally, the unmarked image O
                              ⁎ can be reconstructed by employing the inverse subsampling techniques to these sub-images.

In Eq. (6), the four coefficient values LL
                     
                        δ
                     ′ are subtracted by wk
                      (LL
                     
                        δ
                     ′(k)=
                     LL
                     
                        δ
                     (k)−
                     w
                     
                        k
                     , for δ
                     =1, 2, 3, and 4 and k
                     =1, 2, …, (N/2
                        t
                        +1
                     ×
                     N/2
                        t
                        +1)). According to Eq. (3), the original difference value dk
                     
                     =| x
                     −
                     y |=| LLα
                     (k)−
                     LLβ
                     (k) |=| (LLα
                     (k)−
                     wk
                     )−(LLβ
                     (k)−
                     wk
                     ) |=|LL
                     
                        α
                     ′(k)−
                     LL
                     
                        β
                     ′(k)|=
                     d
                     
                        k
                     ′. Hence, the values of difference d
                     
                        k
                     ′, d
                     min
                     ′, and d
                     max
                     ′, and variance σ
                     
                        k
                     
                     ′ are invariant (i.e. d
                     
                        k
                     ′=
                     d
                     
                        k
                     , d
                     min
                     ′
                     =
                     d
                     min, d
                     max
                     ′
                     =
                     d
                     max, and σ
                     
                        k
                     ′=
                     σ
                     
                        k
                     ).

Here, we demonstrate an instance of CARVW in Fig. 3
                     . To simplify the illustration, we only describe how to embed the weight into watermarked coefficients and how to remove the weight from the coefficients.

Let (αk
                     , βk
                     )=(3, 1), wu
                     
                     =60, and wv
                     
                     =80. Suppose that the k-th coefficient values of the four corresponding subbands LL
                     1, LL
                     2, LL
                     3, and LL
                     4 are 736, 822, 843, and 793, respectively. At first, we calculate the difference between the coefficients of LL
                     3(k) and LL
                     1(k) by Eq. (3) as
                        
                           
                              
                                 
                                    d
                                    k
                                 
                                 =
                                 
                                    
                                       843
                                       −
                                       736
                                    
                                 
                                 =
                                 107.
                              
                           
                        
                     
                  

By repeating Eq. (3) to all pairs, we can learn dk
                     s, for k
                     =1, 2, …, (N/2
                        t
                        +1
                     ×
                     N/2
                        t
                        +1). Thereby, we can acquire the minimum and maximum difference values d
                     min
                     =0, and d
                     max
                     =280 among all dk
                     s.

Subsequently, we can obtain the variance by Eq. (4),
                        
                           
                              
                                 
                                    σ
                                    k
                                 
                                 =
                                 
                                    
                                       107
                                       −
                                       0
                                    
                                    
                                       280
                                       −
                                       0
                                    
                                 
                                 =
                                 0.382
                                 .
                              
                           
                        
                     
                  

By Eq. (5), we can further compute the weight as
                        
                           
                              
                                 
                                    w
                                    k
                                 
                                 =
                                 60
                                 +
                                 
                                    
                                       80
                                       ×
                                       0.382
                                    
                                 
                                 =
                                 90
                                 .
                              
                           
                        
                     
                  

According to Eq. (6), we have the four corresponding coefficients of the processed image as
                        
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             L
                                             1
                                             ′
                                          
                                          
                                             k
                                          
                                          =
                                          736
                                          −
                                          90
                                          =
                                          646
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             2
                                             ′
                                          
                                          
                                             k
                                          
                                          =
                                          822
                                          −
                                          90
                                          =
                                          732
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             3
                                             ′
                                          
                                          
                                             k
                                          
                                          =
                                          843
                                          −
                                          90
                                          =
                                          753
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             4
                                             ′
                                          
                                          
                                             k
                                          
                                          =
                                          793
                                          −
                                          90
                                          =
                                          703
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Hereafter, we introduce how an authorized user removes the weight from the watermarked image. Since the authorized user can decrypt the secret factors {wu
                     , wv
                     }, SK, and M. The accurate parameters thereby can be generated as {wu
                     , wv
                     }={60, 80}, and (αk
                     , βk
                     )=(3, 1). The difference, d
                     
                        k
                     ′=|753−646|=107 between subbands LL
                     3′(k) and LL
                     1′(k) can be computed by Eq. (8). We can observe that the value, d
                     
                        k
                     ′=107=
                     d
                     
                        k
                     , is invariable. By applying the same manner for all pairs, we can acquire the values d
                     
                        k
                     ′=
                     d
                     
                        k
                     , for k
                     =1, 2, …, (N/2
                        t
                        +1
                     ×
                     N/2
                        t
                        +1). Subsequently, the minimum and maximum difference values d
                     min
                     =0, and d
                     max
                     =280 can be computed among all dk
                     s.

According to Eq. (9), we obtain the same 
                        
                           
                              σ
                              k
                              ′
                           
                           =
                           
                              
                                 107
                                 −
                                 0
                              
                              
                                 280
                                 −
                                 0
                              
                           
                           =
                           0.382
                           =
                           
                              σ
                              k
                           
                        
                     . Given σ
                     
                        k
                     ′ and {wu
                     , wv
                     }, we can compute the estimated weight, w
                     
                        k
                     ′=60+⌊80×0.382⌋=90, by Eq. (10). Finally, we can remove the weight from watermarked coefficients by Eq. (11):
                        
                           
                              
                                 
                                    
                                       
                                          L
                                          
                                             L
                                             1
                                          
                                          
                                             k
                                          
                                          =
                                          646
                                          +
                                          90
                                          =
                                          736
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             2
                                          
                                          
                                             k
                                          
                                          =
                                          732
                                          +
                                          90
                                          =
                                          822
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             3
                                          
                                          
                                             k
                                          
                                          =
                                          753
                                          +
                                          90
                                          =
                                          843
                                          ,
                                       
                                    
                                    
                                       
                                          L
                                          
                                             L
                                             4
                                          
                                          
                                             k
                                          
                                          =
                                          703
                                          +
                                          90
                                          =
                                          793.
                                       
                                    
                                 
                              
                           
                        
                     
                  

For RVW mechanisms, the greatest concerns are the transparency of the watermarked image and the quality of the restored images. In this section, we conduct several simulations to demonstrate the practicability of the new scheme. Moreover, we compare related well-known schemes to highlight the superiority of CARVW over other mechanisms.

The peak-signal-to-noise rate (PSNR) is used to measure the image quality of the watermarked and restored images. The PSNR formula is described as follows:
                        
                           (12)
                           
                              
                                 PSNR
                                 =
                                 10
                                 
                                    log
                                    10
                                 
                                 
                                    
                                       
                                          255
                                          2
                                       
                                       MSE
                                    
                                 
                                 
                                 dB
                                 .
                              
                           
                        
                     Where the mean square error (MSE) of an image with H
                     ×
                     W pixels is defined as
                        
                           (13)
                           
                              
                                 MSE
                                 =
                                 
                                    1
                                    
                                       H
                                       ×
                                       W
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          H
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                W
                                             
                                             
                                                
                                                   
                                                      
                                                         o
                                                         ij
                                                      
                                                      −
                                                      
                                                         
                                                            o
                                                            ˜
                                                         
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    2
                                 
                                 .
                              
                           
                        
                     
                  

Here, oij
                      is the original pixel value and 
                        
                           
                              o
                              ˜
                           
                           ij
                        
                      is the processed pixel value. The sizes of the test images and the visible logo are set to 512×512pixels and 128×128pixels, respectively.

We examine the strength of the visible watermark in various test images. As shown in Fig. 4
                        , the transparency of the watermark is applicable to the protected image when we set the secret factors to wu
                        
                        =80 and wv
                        
                        =80. That is, browsers can recognize the watermark, and the host image is not seriously obscured.

Using Airplane image as the representative example, we illustrate the effect of using different values of wu
                         to obtain a suitable watermarked image. Given a fixed wv
                        , we raise the value of wu
                         to adjust the strength of the watermark. As displayed in Fig. 5
                        , the increase of wu
                         makes the visibility of the watermark become more perceivable. Moreover, the transparency of the watermark is still acceptable under different settings of wu
                        . Through various evaluations, we suggest that wu
                         is in the range of [60, 80] for almost all images.

More precisely, we adopt the secret factor wv
                         in Eq. (5) to highlight the significant feature of the original image. That is, if the protected image is complex, then wv
                         can be used to increase the strength of watermark so that browsers can recognize the logo. However, the larger value of wv
                         may result in underflow coefficient. That is, we cannot recover the watermarked image back to the original host image because of the underflow problem. According to the experimental results, setting wv
                         to 80 is appropriate for almost images to retain their significant features. Consequently, CARVW can preserve Essential 2. In Fig. 9, we set wu
                        
                        ≤80 to prevent our scheme from the underflow problem. In the experiments, the setting of wu
                         and wv
                         is equal to 80 because it is sufficient for all natural images in order to meet the requirements of high transparency, great restoration quality, and little underflow problems.

In general, the distortion of the restored image is usually caused by the embedded watermark. The quality of a restored image is an important concern in evaluating an RVW mechanism. In this section, we demonstrate that CARVW is superior to related work in preserving reconstructed image.

Without the loss of generality, if the PSNR value of a processed image is less than 35dB, some of the important signal characteristics may be lost. While the PSNR value is less than 30dB, the quality is unacceptable [18]. That is, the PSNR value of a processed image should be larger than 35dB for providing acceptable quality. As illustrated in Fig. 6
                        , the PSNR values of the various restored images are around 56dB after the visible watermark has been removed. The quality of the unmarked image is satisfactory, with wu
                         in the range of [20, 120] and wv
                        
                        =80. Table 1
                         compares Hu et al.'s [14] RVW method with CARVW in terms of the restored image quality. Obviously, the novel mechanism outperforms the method [14] under the suggested setting of wu
                        
                        =80 and wv
                        
                        =80. In addition, the wPSNR (weight peak signal-to-noise ratio) [19] and the SSIM (structural similarity) [20] values are adopted to evaluate the perceptual quality of the proposed scheme in the human visual system and similarity. The high values of the wPSNR and SSIM indicate that the unmarked images approximate to the original image after the watermark removing processes.

Next, we enlarge the Lena image to examine the performance of CARVW in terms of human visual perception. Fig. 7(b) and (c) presents the enlarged partial areas of the watermarked image and recovered image, respectively. Compared with Fig. 7(a), the recovered image is nearly identical to the original image. This indicates that the proposed scheme is capable of removing the embedded information such that the recovered image is nearly equivalent to the original image; therefore, CARVW can preserve Essential 1.

@&#DISCUSSIONS@&#

Resource provider will sell a valuable image to different customers for practicability and commerce considerations. Namely, the RVW mechanism must be capable of authorizing the copyright of an image to multiple users. All authorized users must be able to obtain a similar watermarked image from the resource provider. Afterward, they can recover an original-like image using their own secret keys.

In fact, each authorized user should acquire a unique watermarked image to certify the identification. As depicted in Fig. 8
                        
                        , the left and center images have been watermarked using different secret keys. The white values shown in Fig. 8(c) reveal the differences between Fig. 8(a) and (b). It is clear that the numerical distinction occurs in the entire logo; that is, the figures are quite different. This is because the strength of the embedded watermark is determined by the secret factors {wu
                        , wv
                        } and the different secret keys SKs. Here, the secret key SK is used to generate N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1 random pairs. The combination of pairs is N/2
                           t
                           +1
                        ×
                        N/2
                           t
                           +1
                        ×6. Hence, CARVW is able to generate individual watermarked image with the wu
                        , wv
                        , and unique secret key SK, and can confirm Essential 4.

In the procedure of restoring host image, the host image might not be completely restored while it suffers from the underflow problem. Based on the transparency experiments in Subsection 6.1, the suggested setting of wu
                         is in the range of [60, 80], and wv
                         set to 80 is suitable for most of the images to avoid the underflow problem. As shown in the experiments of restoration in Subsection 6.2, the setting of wu
                         and wv
                         does not seriously influence the reconstructed image quality.


                        Table 2
                         presents functionality comparisons between related mechanisms to demonstrate the superiority of CARVW. The well-known method in [13,16] does not allow for the embedded logo to be removed in order to recover an unmarked image; thus, it is unable to fulfill Essential 1. Moreover, it is claimed in [15] that authorized users can recover a lossless host image from the watermarked image, but the embedded logo only covers a local area of the protected image; this contradicts Essential 3. The main purpose of Essential 3 is to prevent cropping attack. That is, an effective visual watermark system ought to embed the visible watermark in multiple locations or in a center position for the sake of preventing cropping [18]. In the proposed CARVW approach, the visible watermark is embedded in the center position of the whole image (as shown in Fig. 4). Thus, CARVW can resist the cropping attacks while the method in [15] cannot achieve the same purpose.

In [15], the most significant bits (MSB) of pixel values of the host image have been modified, so that satisfactory transparency of the embedded logo cannot be obtained. The embedded logo in [17] is used to highlight the copyright of the protected image. However, the pixel value mapping function seriously distorts the content of the protected image. Thus, the visibility and transparency of the watermarked image are unsatisfactory. Figs. 4 and 5 show that CARVW can eliminate these conditions. Specifically, CARVW allows resource provider to tune the strength of the watermark through two secret factors. Provider can determine an appropriate watermarked image according to the contrast between the host image and the logo. Although Hu and Jeon's method [15] also allows provider to adjust the strength of the embedded watermark, CARVW still outperforms [15] in terms of strength adaptability. Because the adjustment of the strength in [15] is based on the most significant bits (MSB) of pixel values of the host image, there are at most eight variations of strength. The adaptability of CARVW profits by comparison, since the strength is decided by user-defined secret factors and keys.

Considering the quality of the restored image, it is obvious that the RVW method in [15] outperforms others. As far as overall essentials are concerned, Hu et al.'s method [14] offers good performance. As shown in Table 1, however, CARVW is superior to their method in terms of the quality of the recovered image. This implies that the novel mechanism is practical.


                        Fig. 10
                         shows the performances of the proposed scheme in the context of three types of attacks, including Gaussian blurring (radius with 1pixel), Gaussian noising (5%), and JPEG compression. The blurring and noising attacks distort the contents of the watermarked images. From the visual perception, the new scheme can remove the embedded watermark from the watermarked image. The content of the restored image is acceptable after removing the watermark. However, the watermarked images become less perceptible due to the attacks, and the restored image still contains some noises and becomes more blurred. As for the compression attack, the restored image is satisfactory after removing the watermark.

The main contributions of CARVW are as follows. The contrast-adaptive capability of the novel method allows resource provider to adjust the strength of the embedded watermark according to the contrast between the host image and the watermark. This allows authorized users to obtain a watermarked image with more satisfactory transparency. Simulation results show that CARVW outperforms other methods in terms of the quality of the recovered image. Furthermore, the novel mechanism can authorize a protected image to distinct users; this enhances the flexibility and practicability of the system.

Finding a method that better preserves the quality of restored images and complies with the essentials of RVW mechanisms remains a crucial challenge in designing new systems. A lossless recovered image would be an important breakthrough in this field. To achieve the lossless purpose in CARVM, we can record the differences between the original LL
                     
                        δ
                     (k) and restored LL
                     
                        δ
                     
                     ⁎(k) coefficients. Generally, the difference value is smaller than three. A compression technique can be used to compress the differences and reduce the payload. Moreover, to recover the watermarked image without extra storage will be the focus of our future works. Besides, the related quality measure (such as the mean opinion score) will be considered to estimate the quality of the watermarked and restored images in the future works.

@&#REFERENCES@&#

