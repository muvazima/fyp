@&#MAIN-TITLE@&#Image super-resolution via 2D tensor regression learning

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Presenting a novel framework on 2D tensor regression learning model.


                        
                        
                           
                           Proposing three types of regularization to assist the model learning.


                        
                        
                           
                           Implementing the optimization algorithms for each specific model.


                        
                        
                           
                           Conducting comprehensive experiments on testing images.


                        
                        
                           
                           Demonstrating the high performance & efficiency of reconstruction.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image super-resolution

Tensor regression

Multi-task regression

Non-negative constraint

Orthogonal constraint

Frobenius norm

@&#ABSTRACT@&#


               
               
                  Among the example-based learning methods of image super-resolution (SR), the mapping function between a high-resolution (HR) image and its low-resolution (LR) version plays a critical role in SR process. This paper presents a novel framework on 2D tensor regression learning model to favor single image SR reconstruction. From the image statistical point of view, the statistical matching relationship between an HR image patch and its LR counterpart can be efficiently represented in tensor spaces. Specifically, in this paper, we define a generalized 2D tensor regression framework between HR and LR image patch pairs to learn a set of tensor coefficients gathering statistical dependency between HR and LR patches. The framework is imposed by different constraint terms resulting in an interesting interpretation for the linear mapping function relating the LR and HR image patch spaces for image super-resolution. Finally, the HR image is then synthesized by a set of patches from one LR image input under the learned tensor regression model. Experimental results show that our algorithm generates HR images that are competitive or even superior to images produced by other similar SR methods in both PSNR (peak signal-to-noise ratio) and visual quality.
               
            

@&#INTRODUCTION@&#

As one of software resolution enhancement techniques, image super-resolution aims to recover high-resolution (HR) images from low-resolution (LR) input images [27]. Actually, image super-resolution (SR) processing is often desirable for low-cost imaging devices with resolution limitations [13], such as mobile phones, satellite imaging, video surveillance, microscopy, and digital mosaicing. With the assistance of SR, we can offer high quality images for the growing capability of modern HR displays. The basic idea behind SR is the fusion of a single or a sequence of LR noisy blurred images to produce an HR image or sequence. In many cases, multiple LR images of the same scene offer more information to recover a HR image of the scene. However, sometimes we only acquired few even a single LR input image in real world, thus an SR algorithm or technique using a single LR input image to recover HR image is more practical [25,39]. In this paper, we only consider the case that the input is a single LR image.

In general, SR task is usually cast as the inverse problem [7] of recovering original HR image by fusing the observed LR images. The inverse problem is formulated under the following generic model,
                        
                           (1)
                           
                              y
                              =
                              H
                              x
                           
                        
                     where 
                        
                           y
                        
                      is the observed LR image (vectorized) and 
                        
                           x
                        
                      is the unknown HR image (vectorized). The matrix H represents the imaging system, consisting of several processes, such as blurring and down-sampling operations. However, finding 
                        
                           x
                        
                      from 
                        
                           y
                        
                      based on the above model is severely ill-posed because of the insufficient information from LR images thus the solution from the reconstruction constraint is not unique.

Generally speaking, the existing super-resolution methods can be roughly categorized into three types, which are interpolation based [5], reconstruction based [22] and learning-based [3] approaches. Interpolation based techniques have their roots in sampling theory and the HR image is directly recovered through an interpolation from the LR input. These approaches tend to blur high frequency details resulting in noticeably smooth images with ringing and jagged artifacts particularly along edges, however, they remain popular due to their computational simplicity. In reconstruction based approaches, SR problem is cast as an inverse problem [7] of recovering an HR image based on a reasonable observation model assumption that maps HR image to the LR image(s) together with prior knowledge [6] about HR images. In this process, many kinds of regularization [24] are incorporated into the model as prior knowledge to stabilize the inversion procedure of this ill-posed problem, see [11,30]. However, the performance of the mentioned approaches is only acceptable for small upscaling factors, leading to the development of example-based learning approaches [12], which aim to learn the co-occurrence prior between local HR and LR image structures from an external training database [3,29].

As the contemporary super-resolution approach, learning-based methods provide some promising results according to reported experiments. In [3], Chang et al. adopted the philosophy of Locally Linear Embedding (LLE) from manifold learning to recover the high-resolution image given its low-resolution counterpart as input. It is worth mentioning that Yang et al. [37] proposed a learning based super-resolution scheme based on the sparse representation and Gao et al. [13] implemented the sparse dictionary learning for image super-resolution by using the-state-of-the-art Restricted Boltzmann Machine (RBM). Fundamentally all the mentioned approaches rely on the assumed linear (maybe locally linear) relationships between the LR and HR pairs. For better exploiting the underlying context information of image, Yang et al. [39] modeled the relationship between the HR and LR patches by learning similar textural context for image sparse representation. In order to enhance the performance of image restoration (IR), Dong et al. [10] introduced two adaptive regularization terms, i.e., piecewise autoregressive (AR) model and non-local (NL) self-similarity, into the adaptive sparse representation framework. To further improve the capability of sparse representation based IR, the authors [9] proposed the concept of sparse coding noise and recast the IR goal into how to suppress the sparse coding noise.

On the other hand, other researchers also proposed SR techniques by exploiting nonlinear relations, for example, the Gaussian process (GP) based regression models have been utilized to learn such nonlinear mappings at pixel levels [16]. Although the resulting HR image is pleasing, there exists huge computational overhead because all the Gaussian models have to be re-calculated for each pixel of each input image. To extend their work of [37], the authors proposed a bilevel optimization model for the coupled dictionary training under sparse representation framework [36]. For image SR, they considered the case where the mapping function may take nonlinear forms. The experimental results showed that the new learning method outperform their old one, i.e., joint dictionary training method, both quantitatively and qualitatively.

In the above techniques for learning the mapping function, the HR/LR image patches are all manually vectorized. Thus some important spatial information among pixels tends to lose in the vectorization process. To effectively exploit such spatial information, appropriate feature representation for image patches are desired. 2D tensor [1] is an effective representative for images without damaging pixel spatial relationships. Jia et al. [18] proposed a Bayesian framework to perform face image super-resolution for recognition in tensor space. Furthermore, to effectively explore the spatial local information and avoid the curse of dimensionality dilemma, Wu et al. [34] proposed a regression model in the tensorPCA subspace for face super-resolution reconstruction. They separately learn the tensor subspaces for the high-resolution images and low-resolution counterparts, however it is more desired to learn the matching relations between LR and HR images.

Currently, tensor learning methods are drawing considerable attentions [15,41]. Motivated by the idea of using this popular tool, in this paper, we propose a generalized 2D tensor regression learning framework for single image super-resolution via learning tensor coefficients for HR and LR image patch pairs simultaneously. In light of the importance of the mapping function in the learning-based SR, the intent of our work will be understood explicitly since the SR quality largely depends on whether the mapping function can represent well the underlying relation between HR and LR pairs. Meanwhile it is well known that some patches in a natural image may redundantly occur many times not only within the same scale, but across different scales. This observation motivates us to better exploit the relationship between HR/LR patch pairs for image SR task. Different from the existing vectorizing-based methods, the pixel spatial information can be preserved well when image patches are represented as tensorial data. By imposing different constraint terms, we can obtain three kinds of 2D tensor regression learning task for image SR.

Our main contributions are summarized as follows. Firstly, by taking advantage of tensorial representation, we propose a general 2D tensor regression learning framework to learn a mapping function for image super-resolution; and secondly, to stabilize the solution of the 2D tensor learning task, we further impose three different regularization terms, i.e., Orthogonal constraint, Squared 
                        
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        
                     -norm constraint and Non-negative constraint, on the generic model, which can leverage the power of this combination for image super-resolution.

The remainder of the paper is organized as follows. In Section 2, a generalized 2D tensor regression learning framework is proposed to learn a mapping function for single image SR problem followed by a detailed description of algorithm in Section 3. In Section 4, we discuss how to apply the learned mapping function to the single image SR. The extensive experimental results for image SR and their analysis are reported in Section 5, where our results show the proposed methods are quantitatively and qualitatively competitive or even superior to the existing interpolation and learning-based SR approaches. Finally, the conclusion is drawn in Section 6.

To review some related existing learning-based SR techniques and introduce our proposed model, we first borrow some useful notations for tensorial algebra that will be used throughout this paper. More specifically, matrices will be denoted by capital letters, e.g., X, vectors by boldface lowercase letters, e.g., 
                        
                           x
                        
                     , and scalars by lowercase letters, e.g., x. As for tensors, we denote it by Euler script calligraphic letters, e.g. 
                        
                           X
                        
                     .

In [15], Guo et al. considered the following linear regression model based on the tensor representation,
                        
                           
                              y
                              =
                              
                                 
                                    
                                       X
                                       ,
                                       W
                                    
                                 
                              
                              +
                              b
                              .
                           
                        
                     Similar to the vectorial case, the inner product 
                        
                           〈
                           X
                           ,
                           W
                           〉
                        
                      is defined as the sum of elementwise products of two tensors 
                        
                           X
                        
                      and 
                        
                           W
                        
                      in the same size. In least square learning, we may assume 
                        
                           b
                           =
                           0
                        
                      if we centralize all the training data by removing their mean. In this paper, we are particularly interested in the case of 2D matrix tensors 
                        
                           X
                        
                      and 
                        
                           W
                        
                     . In particular, we consider the following bilinear model
                        
                           
                              y
                              =
                              
                                 
                                    uXv
                                 
                                 
                                    T
                                 
                              
                              +
                              b
                           
                        
                     where u and v are two parameter vectors. To apply this model in our SR setting, we need generalize the above bilinear model to suit image patch outputs.

To efficiently utilize 2D visual data in the SR setting, Wu et al. [34] proposed a regression model over the tensorPCA subspaces [1]. In their approach, an HR tensor subspace and an LR tensor subspace are learned from the training HR tensors 
                        
                           X
                           =
                           
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      and their LR tensors 
                        
                           Y
                           =
                           
                              
                                 {
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                     , respectively, under the PCA criterion, i.e., maximizing the tensor variances. In fact, each defines a mapping from a higher dimensional 2D tensor (an image patch in HR) to a lower dimensional 2D tensor given by 
                        
                           Y
                           =
                           
                              
                                 UXV
                              
                              
                                 T
                              
                           
                        
                     , where U and V are the left projection matrix and the right projection matrix, respectively. After two sets of tensorPCA subspace projection for HR tensor and LR tensor pairs are obtained, a co-occurrent linear model for the relationship between the HR and its LR tensorPCA subspaces is trained [34]. More specifically, an approximate conditional probability model was applied for the tensor subspace coefficients and the maximum-likelihood (ML) estimator gives an ordinary linear regression model.

Motivated by [15,34], in this section, we focus on how to train the mapping function between LR and HR patch pairs by using tensorial data and then propose a generalized 2D tensor regression learning framework. Without loss of generality, we assume that there exists a set of HR and LR image patch pairs, denoted by 
                        
                           
                              
                                 {
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                     , where each 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 m
                                 ×
                                 n
                              
                           
                        
                      and 
                        
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 p
                                 ×
                                 q
                              
                           
                        
                     . The dimensions satisfy 
                        
                           m
                           >
                           p
                        
                      and 
                        
                           n
                           >
                           q
                        
                     .

The traditional learning-based super-resolution methods usually focus on modeling the relationship between HR image patch 
                        
                           
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      and its counterpart LR 
                        
                           
                              
                                 {
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      by exploiting priors of specific images [6,7,24,37]. However, these models often treat each image patch as a single feature vector, thus the pixel spatial relations tend to lose in this conversion. As referred in [34], the vectorization of data degrades the underlying structural information due to losing spatial localization ability. Moreover, vectorizing a tensor data often leads to an algorithm suffering from the curse of dimensionality dilemma. Actually, tensors can often be considered as a more natural representation of visual data, as observed in [41].

Different from the method [34] assuming a linear regression model on the learned tensor subspace, we directly regress HR image patches 
                        
                           
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      over LR inputs 
                        
                           
                              
                                 {
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      with a multiple tensor regression learning model. Our proposed model can be formulated as follows,
                        
                           (2)
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    UY
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                        
                     where U and V are the left and the right parameter matrices, respectively. It seems that the proposed model is contradictory to intuition by using less information (LR) to prediction more information (HR), however there exists an implicit relation between 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                        
                      which admits a possible recovery of the model. Meanwhile, the model still defines a linear relation between 
                        
                           {
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           }
                        
                      (output) and 
                        
                           {
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           }
                        
                      (input) and the coefficients/weights are constrained though. It is this constrained condition that enforces the model to learn the information among the spatially related pixels. We can see this from the following example. Consider a pixel 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                        
                      of HR patch X. Under model (2), we can write 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                        
                      as follows
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              Y
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       kl
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    ik
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    lj
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    kl
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           =
                           (
                           
                              
                                 u
                              
                              
                                 i
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 ip
                              
                           
                           )
                        
                      is the ith row of 
                        
                           U
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       qj
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                      is the jth column of V and 
                        
                           
                              
                                 y
                              
                              
                                 kl
                              
                           
                        
                     s are pixels of image patch Y. In the above bilinear relation, the coefficient of 
                        
                           
                              
                                 y
                              
                              
                                 kl
                              
                           
                        
                      has been decomposed into two parts 
                        
                           
                              
                                 u
                              
                              
                                 ik
                              
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 lj
                              
                           
                        
                      which capture row and column relation information independently.

In fact, if we vectorize both 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                        
                     , then (2) is equivalent to the following structured linear model,
                        
                           
                              vec
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              (
                              U
                              ⊗
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              )
                              vec
                              (
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     where the overall coefficient matrix 
                        
                           W
                           =
                           U
                           ⊗
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                        
                      is composed of two separate matrices U and V. 
                        
                           ⊗
                        
                      means the matrix Kronecker product. In other words, the generic LR image formulation model (1) is defined with 
                        
                           H
                           =
                           
                              
                                 W
                              
                              
                                 +
                              
                           
                           =
                           
                              
                                 (
                                 U
                                 ⊗
                                 
                                    
                                       V
                                    
                                    
                                       T
                                    
                                 
                                 )
                              
                              
                                 +
                              
                           
                        
                      where 
                        
                           
                              
                                 W
                              
                              
                                 +
                              
                           
                        
                      is pseudo-inverse of W.

Inspired by the advance of tensor regression learning [15], we consider a generalized 2D tensor learning task below. Given a training set 
                        
                           
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                     , our purpose is to find two appropriate parameter matrices U and V such that the following criterion is satisfied
                        
                           (3)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       U
                                       ,
                                       V
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                UY
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    J
                                 
                                 
                                    U
                                 
                              
                              (
                              U
                              )
                              +
                              
                                 
                                    J
                                 
                                 
                                    V
                                 
                              
                              (
                              V
                              )
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                              
                                 F
                              
                           
                        
                      is the matrix Frobenius norm defined as 
                        
                           
                              
                                 
                                    
                                       X
                                    
                                 
                              
                              
                                 F
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                     . Functionals 
                        
                           
                              
                                 J
                              
                              
                                 U
                              
                           
                           (
                           U
                           )
                        
                      and 
                        
                           
                              
                                 J
                              
                              
                                 V
                              
                           
                           (
                           V
                           )
                        
                      are regularization terms, which are applied to enforce certain application-dependent characteristics of the optimal solution.

To obtain stable parameter matrices U and V, we propose the following regularized version, named as the Orthogonally Constrained Learning Model:
                           
                              (4)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                U
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          =
                                          I
                                          ,
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          V
                                          =
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   UY
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where I is the identity matrix. The explicit motivation for this regularization is to regard U and V as projection operator (or bases) along the row and column directions.

In the next section, we will propose an algorithm to solve problem (4). Once U and V have been learnt, the HR resolution image patch X can be easily worked out from the low-resolution image patch Y. Finally the whole HR image can be recovered by averaging over those corresponding HR patches given by the model.
                           Remark 1
                           Here we would like to stress the difference between our learning model and the tensor regression learning presented in [15]. In our case, rather than the scalar output in [15,41], the regression output is an image patch. Indeed, our new model can be regarded as a multi-task tensor regression learning [35] as all the pixels will share the same set of 2D tensors. Under such a constraint, it is likely for a model concerning 2D spatial information to perform better, thus as a consequence in our case it is likely that a better model relationship between HR patches and LR inputs can be learned.

The above orthogonally constrained SR model places strong regularized conditions 
                           
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                              U
                              =
                              I
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              V
                              =
                              I
                           
                         over U and V, respectively. Thus (4) is an optimization problem over Stiefel manifold [31]. We can relax the orthogonal conditions by regularizing the norms of U and V. Here, we set 
                           
                              
                                 
                                    J
                                 
                                 
                                    U
                                 
                              
                              (
                              U
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    J
                                 
                                 
                                    V
                                 
                              
                              (
                              V
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    ij
                                 
                                 
                                    2
                                 
                              
                           
                        . This can be implemented with an unconstrained regularized version by introducing Lagrangian multipliers,
                           
                              (5)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          U
                                          ,
                                          V
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   UY
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ‖
                                 U
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 V
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        We call model (5) the Regularized Learning Model. In this model, we impose the squared 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    2
                                 
                              
                           
                        -norm onto the variables in order to find a smooth solution for (3). Since the regularized SR model (5) is an unconstrained optimization problem, it is relatively easy to solve it by using a standard optimization algorithm, such as the gradient descent algorithm [4]. We discuss algorithms for this model in the next section.

As both U and V in (2) can be considered as up-sampling and filtering, we can propose to find out U and V with only positive elements by imposing non-negative constraints on both of them.
                           
                              (6)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          U
                                          ⩾
                                          0
                                          ,
                                          V
                                          ⩾
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   UY
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              U
                              ⩾
                              0
                           
                         and 
                           
                              V
                              ⩾
                              0
                           
                         mean all the matrix elements are non-negative. The optimization problem (6) is termed as the Non-negative Learning Model. In fact, the non-negative SR model gives a more natural interpretation that an HR image can be recovered by a positively additive combination of low-resolution image patches.

Non-negative Matrix Factorization (NMF) [20,26] is a useful tool to find a suitable representation of data, which typically makes latent structures for the given data. Applications of NMF are broad, including image processing [40], text data mining [2,23], face recognition [28], subspace learning [38], etc. To find such a part-based subspace, NMF is formulated as the following optimization problem,
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          U
                                          ⩾
                                          0
                                          ,
                                          V
                                          ⩾
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                             -
                                             UV
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where X is the data matrix, U is the basis matrix and V is the coefficient matrix. The inequalities are referred to as bound constraints since the variables are lower-bounded in this case. In our context here, model (6) imposes non-negative constraints on the parameter matrices U and V, which leads to a part-based HR image representation since they allow only additive, not subtractive, combinations of the LR patches data. To solve the NMF problem, researchers proposed many algorithms and variants in recent years [8,19,20,26]. The optimization problem for NMF is convex with respect to one matrix U or V while fixing the other, however, it is not convex in both simultaneously. Paatero et al. [26] presented a gradient algorithm for this optimization, whereas Lee and Seung [20] provided a multiplicative update rule that is somewhat simpler to implement and also showed good performance. Although it is simple to implement, this algorithm even does not guarantee to converge to a stationary point. To tackle this drawback, Kim and Park [19] proposed the alternating non-negative least squares (NNLS) algorithm for which the convergence to a stationary point has been proved. Meanwhile, Ding et al. [8] extended the traditional NMF to semi-NMF which removes the non-negative regularization on the data X and basis matrix U. The authors applied a gradient-descent-based update rule to efficiently solve the semi-NMF problem.

Similarly, model (6) can also be tackled by using projected gradient descent methods [21]. In this paper, we propose to use alternative coordinate algorithms to solve the problem. Details of the algorithm for model (6) is presented in the following section.

In this section, we detail how to solve the 2D tensor-learning SR optimization problems along with different constraints on the parameter matrices U and V.

First we re-write the objective function (4) as follows,
                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               UY
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             tr
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     UY
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     V
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        UY
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             tr
                                             
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             tr
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             2
                                             tr
                                             
                                                
                                                   
                                                      
                                                         
                                                            UY
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              tr
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         is the trace function. Since 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are constants, the above problem is equivalent to
                           
                              (8)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                U
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          =
                                          I
                                          ,
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          V
                                          =
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                UY
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Note that problem (8) is not jointly convex over both variables U and V, but it is convex with respect to either one variable while the other is fixed. For example, when V is known and fixed, optimization problem (8) is actually a well-posed problem that could be efficiently solved [32],
                           
                              (9)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                U
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          =
                                          I
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                UY
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                U
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          =
                                          I
                                       
                                    
                                 
                                 
                                 tr
                                 
                                    
                                       
                                          U
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           
                              M
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                                 
                                    T
                                 
                              
                           
                        . Suppose M has its SVD computed by 
                           
                              svd
                              
                                 
                                    
                                       M
                                    
                                 
                              
                              =
                              
                                 
                                    U
                                 
                                 
                                    ˆ
                                 
                              
                              Σ
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        . Then (9) can be written as
                           
                              
                                 tr
                                 
                                    
                                       
                                          U
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 tr
                                 
                                    
                                       
                                          U
                                          
                                             
                                                U
                                             
                                             
                                                ˆ
                                             
                                          
                                          Σ
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 tr
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          
                                             
                                                U
                                             
                                             
                                                ˆ
                                             
                                          
                                          Σ
                                       
                                    
                                 
                              
                           
                        Denote by 
                           
                              Z
                              =
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              U
                              
                                 
                                    U
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , then problem (9) is finally recast as follows,
                           
                              (10)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                U
                                             
                                             
                                                T
                                             
                                          
                                          U
                                          =
                                          I
                                       
                                    
                                 
                                 
                                 tr
                                 
                                    
                                       
                                          Z
                                          Σ
                                       
                                    
                                 
                              
                           
                        As 
                           
                              Σ
                           
                         is diagonal and Z is orthogonal, we have 
                           
                              tr
                              (
                              Z
                              Σ
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ii
                                 
                              
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                           
                        . Hence the solution to the above problem in terms of Z should be given by 
                           
                              Z
                              =
                              I
                           
                        . Therefore, the solution U is given by 
                           
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    ˆ
                                 
                              
                              I
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        , where 
                           
                              [
                              
                                 
                                    U
                                 
                                 
                                    ^
                                 
                              
                              ,
                              Σ
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ^
                                 
                              
                              ]
                              =
                              svd
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        .

Alternatively, fixing the variable U, we can obtain the solution of 
                           
                              
                                 
                                    V
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    ^
                                 
                              
                              I
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        , where 
                           
                              [
                              
                                 
                                    U
                                 
                                 
                                    ^
                                 
                              
                              ,
                              Σ
                              ,
                              
                                 
                                    V
                                 
                                 
                                    ^
                                 
                              
                              ]
                              =
                              svd
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             U
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        . Finally, the main procedure of the optimization algorithm for Orthogonally Constrained Learning Model can be summarized in Algorithm 1.
                           Algorithm 1
                           Training orthogonally constrained learning model. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Ensure: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1: Initialization: 
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 is set as a rand matrix; 
                                                   
                                                      tol
                                                   
                                                 = 1e-5;
                                          
                                          
                                             
                                                2: While not converged 
                                                   
                                                      
                                                         
                                                            
                                                               k
                                                               =
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                            
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                3: 
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      ,
                                                      Σ
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      ]
                                                      =
                                                      svd
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     V
                                                                  
                                                                  
                                                                     k
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                4: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      I
                                                      
                                                         
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                5: 
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      ,
                                                      Σ
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      ]
                                                      =
                                                      svd
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                6: 
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                      I
                                                      
                                                         
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                7: check convergence:
                                          
                                          
                                             
                                                8: 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        U
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            F
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      <
                                                      tol
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                9: 
                                                break;
                                          
                                          
                                             
                                                10: 
                                                end if
                                             
                                          
                                          
                                             
                                                11: end while
                                             
                                          
                                       
                                    
                                 
                              
                           

Next, we shift our attention to the Regularized Learning Model 
                        (5) and give its algorithm to find the optimal solution. The problem is an unconstrained optimization problem and the objective function is quadratic in one variable while fixing the other. Hence it is easy to use an alternative coordinate method to solve it.

Supposed that U is known, we let 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    UY
                                 
                                 
                                    i
                                 
                              
                           
                         and the problem (5) is recast as,
                           
                              
                                 L
                                 (
                                 V
                                 )
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          V
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Taking the derivative of 
                           
                              L
                              (
                              V
                              )
                           
                         w.r.t V and setting the derivative to zero, we have,
                           
                              
                                 
                                    
                                       ∂
                                       L
                                       (
                                       V
                                       )
                                    
                                    
                                       ∂
                                       V
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 V
                                 =
                                 0
                              
                           
                        Then the solution for 
                           
                              
                                 
                                    V
                                 
                                 
                                    ∗
                                 
                              
                           
                         is given by,
                           
                              (11)
                              
                                 
                                    
                                       V
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             ·
                                             I
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              I
                           
                         is an identity matrix with appropriate dimensions.

Alternatively, fixing V and letting 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                        , we can obtain the following formulation as well.
                           
                              
                                 L
                                 (
                                 U
                                 )
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          U
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             U
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             U
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Similarly, we take the derivative of 
                           
                              L
                              (
                              U
                              )
                           
                         w.r.t U and set the derivative to zero, then we have
                           
                              
                                 
                                    
                                       ∂
                                       L
                                       (
                                       U
                                       )
                                    
                                    
                                       ∂
                                       U
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          U
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 U
                                 =
                                 0
                              
                           
                        The optimal solution for 
                           
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                           
                         is obtained as,
                           
                              (12)
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             +
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             ·
                                             I
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        Alternatively, after updating U, one may iterate Eq. (11) and then Eq. (12) until a convergence criterion is satisfied. In summary, the algorithm for Regularized Learning Model 
                        (5) is described in Algorithm 2.
                           Algorithm 2
                           Training Regularized Learning Model. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Ensure: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1: Initialization: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 is set as a rand matrix; 
                                                   
                                                      tol
                                                   
                                                 = 1e-5;
                                          
                                          
                                             
                                                2: While not converged 
                                                   
                                                      
                                                         
                                                            
                                                               k
                                                               =
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                            
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                3: fixing U and setting 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                , update V by
                                          
                                          
                                             
                                                4: 
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           Y
                                                                        
                                                                        
                                                                           ∼
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    Y
                                                                                 
                                                                                 
                                                                                    ∼
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Y
                                                                           
                                                                           
                                                                              ∼
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ·
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                5: fixing V and setting 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                , update U by
                                          
                                          
                                             
                                                6: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Y
                                                                              
                                                                              
                                                                                 ∼
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     T
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Y
                                                                           
                                                                           
                                                                              ∼
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    Y
                                                                                 
                                                                                 
                                                                                    ∼
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  ·
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                7: check convergence:
                                          
                                          
                                             
                                                8: if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        U
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            F
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      <
                                                      tol
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                9: 
                                                break;
                                          
                                          
                                             
                                                10: 
                                                end if
                                             
                                          
                                          
                                             
                                                11: end while
                                             
                                          
                                       
                                    
                                 
                              
                           

For problem (6), it is well known that the objective is non-convex. Therefore it is impractical to provide an algorithm of seeking the global minimum solution of the problem. Here we propose an iterative algorithm which can achieve a local minimum.

Firstly, initializing V with non-negative values, we let 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                        . Then, problem (6) is reformulated as follows,
                           
                              
                                 L
                                 (
                                 U
                                 )
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          U
                                          ⩾
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             U
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        Alternatively, fixing U and letting 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    UY
                                 
                                 
                                    i
                                 
                              
                           
                        , then let V be updated by,
                           
                              
                                 L
                                 (
                                 V
                                 )
                                 =
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          V
                                          ⩾
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Now, our task is to iteratively solve these two subproblems, termed as alternating non-negativity least squares (ANLS) problems, until a convergence criterion is satisfied. The solutions are represented as
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         is equal to 
                           
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                        , and
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         is equal to 
                           
                              
                                 
                                    UY
                                 
                                 
                                    i
                                 
                              
                           
                        .

In the cases that the normal matrices 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             VY
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                         or 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             UY
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             U
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                         become very ill-conditioned, the above two solutions can be achieved by using the regularized pseudo-inversion, that is,
                           
                              (13)
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          0
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                      ·
                                                      I
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         = 
                           
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                           
                        . Similarly
                           
                              (14)
                              
                                 
                                    
                                       V
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          0
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               ∼
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                      ·
                                                      I
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         = 
                           
                              
                                 
                                    UY
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    ·
                                    )
                                 
                                 
                                    +
                                 
                              
                           
                         is pseudo-inverse operator.


                        
                           
                              α
                           
                         in (13) and (14) is a regularization parameter introduced for the algorithm to avoid from getting stuck in local minima. The value of 
                           
                              α
                           
                         is adjusted in the k-th iterative step in our algorithm as
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 ·
                                 exp
                                 
                                    
                                       
                                          -
                                          k
                                          /
                                          ρ
                                       
                                    
                                 
                              
                           
                        In our paper, 
                           
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              ρ
                           
                         are empirically set 20 and 10, respectively.

In optimization procedure, both U and V are updated alternatively. That is, one may iterate Eq. (14) and then Eq. (13) until a convergence condition is met. In summary, the algorithm for Non-negative Learning Model 
                        (6) is described in Algorithm 3.
                           Algorithm 3
                           Training Non-negative Learning Model. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                
                                                   
                                                      
                                                         
                                                            {
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            }
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Ensure: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1: Initialization: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 is set as a rand matrix with positive value; 
                                                   
                                                      tol
                                                   
                                                 = 1e-5; 
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                =20; 
                                                   
                                                      ρ
                                                   
                                                
                                                =10.
                                          
                                          
                                             
                                                2: While not converged 
                                                   
                                                      
                                                         
                                                            
                                                               k
                                                               =
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                            
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                3: fixing U and setting 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                , update V by
                                          
                                          
                                             
                                                4: 
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      max
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∑
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              T
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    Y
                                                                                 
                                                                                 
                                                                                    ∼
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           ·
                                                                           I
                                                                           +
                                                                           
                                                                              
                                                                                 ∑
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Y
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                              
                                                                                 kT
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Y
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                5: fixing V and setting 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                , update U by
                                          
                                          
                                             
                                                6: 
                                                
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      max
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              ∑
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    Y
                                                                                 
                                                                                 
                                                                                    ∼
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              kT
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 α
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           ·
                                                                           I
                                                                           +
                                                                           
                                                                              
                                                                                 ∑
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Y
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       Y
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                              
                                                                                 kT
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                ,
                                          
                                          
                                             
                                                7: updating 
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ·
                                                      exp
                                                      
                                                         
                                                            
                                                               -
                                                               k
                                                               /
                                                               ρ
                                                            
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                8: check convergence:
                                          
                                          
                                             
                                                9: 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        U
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        Y
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        V
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        T
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            F
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      <
                                                      tol
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                10: 
                                                break;
                                          
                                          
                                             
                                                11: 
                                                end if
                                             
                                          
                                          
                                             
                                                12: end while
                                             
                                          
                                       
                                    
                                 
                              
                           

In this section, we discuss how to perform the patchwise SR recovery by the learned mapping function. At the training stage, we collect a large number of HR and LR image pairs to efficiently learn the relationship between them. In order to accurately represent the mapping, we first classify each training patch pairs into a certain cluster. Specifically, we apply a high-pass filter to each HR patch to output the feature for clustering similar to [9,10]. Given 
                        
                           
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        
                      patches, we categorize the dataset into K clusters. And the mapping function for each of the K clusters is learned by using the above three 2D tensor learning model (4)–(6).

After training each 2D tensor learning model, we obtain the parameter matrices U and V for subsequent SR processing. For simplicity, we first interpolate the input LR image into the size of desired HR one with Bicubic method, and then separate the initial HR image into a set of overlapping patches with the same size as in the phase of learning the mapping function. Then, these image patches are also categorized into K clusters. In terms of the mapping function belonging to each cluster, the most suitable mapping function can be selected for each given low-resolution patch. Given each LR image patch 
                        
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                        
                     , we remove its dc component and then recover its HR counterpart 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      by computing 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 UY
                              
                              
                                 i
                              
                           
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                        
                     . And then the mean value is added into the HR counterpart. Then, we can efficiently recover HR image via tiling those HR patches together, where the average of multiple estimates is taken for each pixel in the overlapping region. Since the obtained HR image may not satisfy the reconstruction constraint as (1), a back-projected process is required to be carried out to further refine the recovered HR image. In particular, the recovered HR image should be projected onto the solution space of (1) to correct the high-resolution image pixels in a back-projected way [17]. This process validates that the final recovered HR image is consistent with the input LR image.

@&#EXPERIMENTAL RESULTS@&#

In order to investigate the performance of our proposed SR schemes based on our 2D tensor regression learning model, we conducted several experiments of single image super-resolution using the proposed method and other existing methods. Except for Parthenon, the size of most test images are all 256
                     
                        
                           ×
                        
                     
                     256 which are popular for validating image super-resolution performance in literature [7,24,37]. An observed LR image is synthesized by simply down-sampling an HR image at a certain scaling factor in both horizontal and vertical directions without any blurring processing. We apply three magnification factors, i.e., 2, 3 and 4, in our experiments. These scaling factors are widely used in all the literatures of single image super-resolution. Regarding the fact that the human visual system is more sensitive to luminance changes, in our experiments, we only apply the SR methods to the luminance component. As for the other components, a simple Bicubic interpolator is utilized to up-sample them.

To train the parameter matrices U and V in the suggested tensor regression learning model, we collected 100,000 patch pairs as for both HR images and LR images by randomly sampling from natural images. Some examples of training images are illustrated in Fig. 1
                        . Specifically, similar to [37], we extract the up-sampled LR image using Bicubic interpolation as the training patches instead of the original LR image. To efficiently cluster the image patches, the Gauss filter with 
                           
                              σ
                              =
                              2.2
                           
                         is adopted to capture the image features. Then the clustering is performed in a feature space.

To further efficiently describe the feature relationship, we just choose those patches with its variance larger than some threshold, i.e., 
                           
                              var
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              )
                              >
                              10
                           
                        . The patches with lower variance values are excluded due to their smoothness. These patches are subtracted from their mean and normalized to eliminate the mismatch problem.

To compare our proposed method with existing techniques both qualitatively and quantitatively, we take into account the following state-of-the-art methods since our proposed algorithm belongs to the family that only learns the mapping information from the collected LR and HR image pairs without any statistical priors beforehand. Therefore, the following four methods for image SR methods are applied for performance comparison.
                           
                              1.
                              The Bicubic interpolation method: as a benchmark for super-resolution.

Yang’s method [37]: sparse representation for SR, a state-of-the-art method of example-based SR utilizing the information learned from training image data.

Chang’s method [3]: example-based SR using neighbour embedding.

Glasner’s method [14]: a classical self-exemplar based SR exploiting similar patches across multiple scale versions of the input image.

In our experiments, we apply two criteria to assess experimental results. One is the peak signal-to-noise ratio (PSNR), which is the most popular measure for image objective quality. Besides PSNR, we also use the Structural Similarity (SSIM) index [33] value to measure the visual quality of recovered image. Similar to most current works on super-resolution, we just report the experimental results of the luminance component. For the sake of convenience, we simply call SR based on Orthogonally Constrained learning method (4) as the Orthogonal SR (O-SR), Regularized learning method (5) as the Regularized SR (R-SR), and Non-negative learning method (6) as the Non-negative SR (NN-SR).

Firstly, we should determine the size of image patch for preparing effective training dataset and recovering the high resolution image. It is known that the patch size cannot be too big. Otherwise, if the patch size is too big, their self-similarities will be too low to effectively reflect the information among the spatially related pixels in images. For simplicity, the low resolution image is obtained by down-sampling the original image with a factor of 2 to assess SR performance for different patch sizes
                           1
                           We also test over down-sampling with factor of 3 and 4 and we can get the similar conclusion, so we exclude those experiments in this paper.
                        
                        
                           1
                        . We here choose three types of patches, i.e., 3
                        
                           
                              ×
                           
                        
                        3, 5
                        
                           
                              ×
                           
                        
                        5 and 7
                        
                           
                              ×
                           
                        
                        7, to compare the image super-resolution performance. Table 1
                         reports the experimental results of super-resolution on test images via the Orthogonal SR (4), in which the best result is denoted with bold digits. From the table, we can see that these different patch sizes lead to different SR performance in terms of PSNR and SSIM results at the given down-sampling factor. After checking details carefully, we can observe that the smaller patch size (i.e, 3
                        
                           
                              ×
                           
                        
                        3) is able to achieve better performance both in quantitative and qualitative respects. Based on the comprehensive visual and quantity consideration, we finally adopt 3
                        
                           
                              ×
                           
                        
                        3 as the best image patch size in our experiments.

@&#EXPERIMENTAL RESULTS@&#


                        Table 2
                         reports PSNR values of 9 different images magnified by a up-sampling factor of 3, where our proposed methods are used for single image super-resolution with patch size of 3
                        
                           
                              ×
                           
                        
                        3 and overlap of 2 pixels. In addition, other four super-resolution methods are also applied to extensive performance comparison. Besides PSNR comparison, we further provide SSIM values to measure the visual quality of the recovered SR images in Table 3
                        . In order to clearly show the gain in terms of PSNR and SSIM, we present the average value by each SR method and the gain achieved by our method against the others. In particular, we select our best record to compute the gain. As we can see, the results demonstrate that our proposed SR methods can generally outperform other methods in terms of PSNR values. The proposed methods always achieve better performance than the classical Bicubic interpolation method with a gain of 1.15dB on average. Meanwhile, our proposed methods also provide much improvement over other SR methods. As for Chang’s method [3], it is often to find a similar training image to the input test image so that the high-resolution image reconstruction weight can be learned efficiently. When the training image is not similar enough, however, the quality of the recovered image is degraded significantly. In our work, our PSNR gain against this method [3] is up to 2.42dB on average. On the other hand, since the spatial localization among image patches is exploited, the learned mapping can provide a heavy likelihood to synthesize HR images with more realistic details. As for Glasner’s method [14], although it has an advantage of finding similar patches in some slightly down-sampled input images, the number of patches is too limited to recover good high-resolution image in the end.

Although our proposed methods can achieve pleasing objective quality improvement, they behave poorly in respect of SSIM for some test images, e.g., Plants,Hat and Girl. This may be explained by the fact that Yang’s method [37] can learn a good dictionary to capture a certain detail from some infrequent patches. While this kind of high-resolution information can not be learned due to the special character of the test image. However, this difference is relatively minor, which is even hard to be noticed. We further provide a visual comparison with the test images by using different methods in Figs. 2–6
                        
                        
                        
                        
                        . Figs. 2–6 show the images magnified by factor of 3 via applying different methods with zoom part. Though the difference of the qualitative results is not noticeable like the quantitative one, by carefully checking, we can see our methods can recover HR images with clear and sharp details yet.

According to the reported results, our proposed three models show the similar performance. More specifically, we also observe that the Orthogonally Constrained Learning model (4) can achieve the best performance among our three tensor learning models. This observation can be further demonstrated by results in Tables 4 and 5
                        
                         with the up-sampling scale of 4. When the up-sampling factor is 4, it can be seen that the PSNR gain is significantly improved against the Bicubic interpolation method and Chang’s method [3], illustrated in Tables 4 and 5. This can be explained by the fact that the learned mapping function can capture the details from HR and LR patches even for the bigger down-sampled factor. In addition, the advantage is also attributed to the usage of the back-projection technique in each up-sampling loop.

The computational complexity of our proposed methods mainly focuses on training the parameter matrices U and V. Once U and V are learned, the recovery of HR image can be executed very fast. For an image with size of 256
                        
                           
                              ×
                           
                        
                        256, our proposed methods only require limited time to implement super-resolution on a PC with Intel Core2 Duo 2.0GHz processor and 2.0G RAM memory. If we decrease the overlap size of every patch, the speed of HR image recovery can be much faster at the cost of degradation quality of the recovered image. In order to give the concrete value for algorithm, Table 6
                         lists actual runtime for different SR methods. The average computation time (in minutes) for training and testing, i.e. 
                           
                              
                                 
                                    T
                                 
                                 
                                    Tr
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    Te
                                 
                              
                           
                        , are both reported. We simply report the training/test time using the Matlab code either implemented by ourselves or released by the authors. As can be seen, the computation time of our SR algorithm is actually less than or comparable to state-of-the-art learning based SR methods.

@&#CONCLUSION@&#

In this paper, we proposed a generalized 2D tensor regression learning framework for single image super-resolution reconstruction, which can efficiently preserve 2D pixel spatial information between HR and LR images. Instead of using the linear regression model to represent the relationship between vectorized HR/LR image patch pairs, we directly regress the HR patch over LR patch by a multiple 2D tensor regression learning model imposed on different constraints. Once the appropriate model parameter matrices have been learned, the desired HR image can be efficiently recovered by computing a 2D tensor model value for a given LR input. The extensive experimental results on the test LR images validate our proposed methods are competitive or even superior to many existing state-of-the-art methods in both PSNR and visual quality.

@&#ACKNOWLEDGMENTS@&#

Junbin Gao’s work is supported by the Australian Research Council (ARC) through the Grant DP130100364. The work of the first and third authors is supported by NSF China under Grants No. 61201392.

@&#REFERENCES@&#

