@&#MAIN-TITLE@&#Random walks in directed hypergraphs and application to semi-supervised image segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop the directed hypergraph theory and introduce it in computer vision.


                        
                        
                           
                           We develop the random walk concept in directed hypergraphs.


                        
                        
                           
                           We propose a directed hypergraph model for image data representation.


                        
                        
                           
                           We use random walks to perform image segmentation with directed hypergraphs.


                        
                        
                           
                           Results show an improvement compared to traditional undirected hypergraphs.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Directed hypergraph

Random walks

Image segmentation

Semi-supervised learning

@&#ABSTRACT@&#


               
               
                  In this paper, we introduce for the first time the notion of directed hypergraphs in image processing and particularly image segmentation. We give a formulation of a random walk in a directed hypergraph that serves as a basis to a semi-supervised image segmentation procedure that is configured as a machine learning problem, where a few sample pixels are used to estimate the labels of the unlabeled ones. A directed hypergraph model is proposed to represent the image content, and the directed random walk formulation allows to compute a transition matrix that can be exploited in a simple iterative semi-supervised segmentation process. Experiments over the Microsoft GrabCut dataset have achieved results that demonstrated the relevance of introducing directionality in hypergraphs for computer vision problems.
               
            

@&#INTRODUCTION@&#

Graph-based methods have played an important role in Computer Vision and Pattern Recognition (CVPR) due to their ability to represent relational patterns [1,2]. However, in many situations, a graph-based representation is incomplete, as only binary relations between nodes can be represented through graph edges. An extension is provided by hypergraphs [3,4], where each edge is a subset of the set of nodes. Hence higher-order relations between nodes can be directly modeled in a hypergraph, by the means of hyperedges. Since such a mode of representation is closer to the human visual grouping system, hypergraphs have been shown as more effective than graphs to solve many problems in applications of practical interest that includes VLSI design and partitioning [5], parallel scientific computing [6], database design [7] or categorical data clustering [8]. The introduction of hypergraphs in the image processing domain dates back to Bretto et al. [9] and has recently received an increasing attention [10–15]. In particular, hypergraph representations based on the INH (Image Neighborhood Hypergraph) model have achieved competitive results in unsupervised image segmentation [15–17] that outperform graph-based methods. Recently, Ding et al. [14,18] introduced new image hypergraph models and exploited them in an semi-supervised segmentation framework that relies on a transductive setting given by Zhou’s random walk formulation on a hypergraph [8] that generalizes the graph random walk formulation.

All the above methods are based on undirected hypergraph models. While the notion of directionality (by the concept of a directed graph) has been developed for a large number of years in the graph theory, a generalization to the hypergraph case has been slow to appear and a standard mathematically formal definition is yet to be defined. First attempts for defining directed hypergraphs [19,20] considered a hyperarc (a generalization of a directed graph edge) as a single vertex connecting a set of vertices. In this paper we use a more complete generalization by defining a hyperarc as a connection between two sets of vertices [4]. In addition, the use of directed hypergraphs for practical applications remains marginal and only few papers report using directed hypergraphs for applications such as relational databases [20], natural language parsing [21], or for modeling high-level processes such as biochemical [22], wireless [23,24] or social networks [25]. The main goal of this paper is to introduce the notion of directed hypergraphs in the computer vision domain, and judge its relevance especially compared to simple undirected hypergraphs. For this purpose, we followed the idea of directed graphs that were recently introduced in image segmentation [26–28]. Few previous works that involve some image analysis report using directed hypergraphs, but only to model high-level relationships between visual elements, such as video events [29] or pre-segmented cells motion [30]. None of these representations are directly linked to the image analysis and processing methods or make use of the low-level image data. To the best of our knowledge, and unlike undirected hypergraphs, no image processing technique that involve directed hypergraphs and no directed hypergraph-based representation of image data has been investigated. This paper has the objective to investigate these two aspects and show that directed hypergraphs can be useful at image data representation.

Image segmentation is a low-level image analysis process that aims at partitioning an image into a number of disjoint regions, such that the visual features are coherent among the pixels of a single region. Although humans can easily extract meaningful segments from an image, this task remains difficult at computer level, where unsupervised segmentation algorithms are still unable to produce satisfactory results. In fact, fully automated segmentation is known to be an ill-posed problem due to the absence of a clear definition of a semantically meaningful segmentation, and the difficulty to judge its objective quality. Prior information about the image to segment should then be provided to make the segmentation problem well-posed. Such information can be supplied by the user through a set of representative pixels that labels the existing regions in the image. This issue has been addressed as interactive segmentation, and has been successfully used for foreground extraction in intelligent scissors [31], GrabCut [32], or interactive graph cuts [27].

Recent directions in this field rely on graph-based machine learning [33–36]. The main idea is to model the image data by the means of an affinity graph where each edge encodes the similarity of two neighboring pixels in the image. The segmentation problem is then formulated as an energy function minimization, where the target function to estimate is smooth with respect to the underlying graph structure. The graph is represented by a symmetric affinity matrix where each entry models the penalty if the two corresponding pixels belong to separated regions in the segmentation. Segmentation becomes then a labeling problem than can be solved by graph-based learning methods. Such methods include harmonic energy minimization [37], graph min-cuts [27,38], random walks [33], transduction by Laplacian regularization [35], geodesics [39], or watersheds [36].

Traditional variational methods for interactive (or semi-supervised) segmentation such as active contours [40] approach the segmentation problem by minimizing energy functions that favor alignment of the object boundaries with regions of high intensity gradient. Later, Vasilevskiy et al. [26] noted that the direction of the gradient contains valuable information that can improve the segmentation. This concept has been translated to discrete optimization by using graphs with directed edges (by opposition to the above methods that relies on undirected symmetric graphs), resulting in asymmetric affinity matrices. Directed graphs for semi-supervised segmentation have been used in min-cut [27] and random walk [28] algorithms. In practice, asymmetric penalties can help at segmenting thin elongated structures and can further improve the segmentation results in regions of low contrast.

As noted above, and following the idea in [27,28], the objective of this paper is to investigate the reliability of adding directional information in hypergraph-based models and to judge the relevance of using directed hypergraphs as a means for image data representation. Consequently, we introduce the notion of directed hypergraphs in computer vision problems by proposing a directed version of the INH (Image Neighborhood Hypergraph) model. It is important to note that this article is, to the best of our knowledge, the first attempt to use directed hypergraphs in image analysis as a low-level image data representation tool. A first application of this DINH (Directed Image Neighborhood Hypergraph) representation is developed in terms of semi-supervised image segmentation, where the labels of all pixels are predicted according to the labels of pre-defined seed pixels. The problem is expressed in terms of Markov random walks, and a solution is found by estimating the probability that a random walk, starting at an unlabeled pixel, will first hit a given seed pixel. The random walk should be designed with respect to the underlying directed hypergraph structure, and by analogy with the undirected case, we give a formulation of the transition matrix of a random walk in a directed hypergraph. A theoretical solution to the hypergraph-learning process is given by considering the random walk as an absorbing Markov chain 
                     [41]. The transition matrix also served as a basis to design a simple iterative algorithm for semi-supervised segmentation based on label propagation, which solution converges to the theoretical one. Experiments over the GrabCut [32] dataset achieved interesting results, particularly compared to the same algorithm with transition matrices obtained from graphs and undirected hypergraphs. These results essentially demonstrate that the introduction of directed hypergraphs is relevant in the computer vision domain, and that they provide a richer model of representation than undirected hypergraphs and simple graphs.

The remainder of this paper is organized as follows: we first present some preliminary definitions for undirected and directed hypergraphs (Section 2). We then give our formulation of a random walk in a directed hypergraph as well as its transition matrix (Section 3), and describe our proposed directed hypergraph model to represent the content of an image (Section 4). We then present the theoretical solution to the learning process on directed hypergraphs in terms of random walks, and the iterative label propagation procedure used to approach this solution (Section 5). Finally, some experimental results are given and discussed (Section 6).

The general undirected hypergraph theory [3] is well-known in the field of mathematics, and we refer the reader to [3,4] for more details and definitions. We will here focus on the definition of directed hypergraphs.

A directed hypergraph (dirhypergraph) is an ordered pair:
                        
                           
                              
                                 
                                    H
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              V
                              ;
                              
                                 
                                    E
                                 
                                 
                                    →
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                              :
                              i
                              ∈
                              I
                              }
                              )
                              ,
                           
                        
                     where V is a finite set of vertices and 
                        
                           
                              
                                 E
                              
                              
                                 →
                              
                           
                        
                      is a set of hyperarcs with index set 
                        
                           I
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                           }
                           ,
                           
                           M
                           =
                           |
                           
                              
                                 E
                              
                              
                                 →
                              
                           
                           |
                        
                     . Each hyperarc 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      is written
                        
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                                
                                                   +
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                ,
                                                i
                                             
                                          
                                       
                                       ;
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                                
                                                   -
                                                
                                             
                                          
                                          
                                             →
                                          
                                       
                                       =
                                       
                                          
                                             
                                                i
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      -
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

The set 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                        
                      is the set of vertices of 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       +
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      and the set 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 -
                              
                           
                        
                      is the set of vertices of 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       -
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                     . The vertices of 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      are denoted by 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                           ∪
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 -
                              
                           
                        
                      and 
                        
                           E
                           =
                           {
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           :
                           i
                           ∈
                           I
                           }
                        
                     . The hypergraph 
                        
                           H
                           =
                           (
                           V
                           ;
                           E
                           )
                        
                      is the underlying hypergraph of the dirhypergraph 
                        
                           
                              
                                 H
                              
                              
                                 →
                              
                           
                           =
                           (
                           V
                           ;
                           
                              
                                 E
                              
                              
                                 →
                              
                           
                           )
                        
                     . The element 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       +
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      is called the tail of the hyperarc 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                     , whereas 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       -
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      is its head. A limb is either a head or a tail. We do not allow 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                           =
                           ∅
                        
                      or 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 -
                              
                           
                           =
                           ∅
                        
                      and 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                           ∩
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 -
                              
                           
                           ≠
                           ∅
                        
                      for all 
                        
                           i
                           ∈
                           I
                        
                     . The index i stored in each limb of a hyperarc allows to distinguish from two hyperarcs that have the same set of vertices either in its head or in its tail.

A dirhypergraph 
                        
                           
                              
                                 H
                              
                              
                                 →
                              
                           
                           =
                           (
                           V
                           ;
                           
                              
                                 E
                              
                              
                                 →
                              
                           
                           )
                        
                      can be represented by two incidence matrices, the positive (or outer) incidence matrix 
                        
                           
                              
                                 H
                              
                              
                                 +
                              
                           
                        
                      and the negative (or inner) incidence matrix 
                        
                           
                              
                                 H
                              
                              
                                 -
                              
                           
                        
                     , representing respectively the tails and the heads of the hyperarcs. Entries of 
                        
                           
                              
                                 H
                              
                              
                                 +
                              
                           
                        
                      are given by 
                        
                           
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           =
                           1
                        
                      if 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 e
                              
                              
                                 j
                              
                              
                                 +
                              
                           
                        
                      and 0 otherwise. Entries of 
                        
                           
                              
                                 H
                              
                              
                                 -
                              
                           
                        
                      are given by 
                        
                           
                              
                                 (
                                 
                                    
                                       H
                                    
                                    
                                       -
                                    
                                 
                                 )
                              
                              
                                 ij
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           =
                           1
                        
                      if 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 e
                              
                              
                                 j
                              
                              
                                 -
                              
                           
                        
                      and 0 otherwise. We will consider that any hyperarc e can be weighted by a positive function 
                        
                           w
                           (
                           
                              
                                 e
                              
                              
                                 →
                              
                           
                           )
                        
                      (called the weight of hyperarc 
                        
                           
                              
                                 e
                              
                              
                                 →
                              
                           
                        
                     ) representing the importance of the hyperarc in the dirhypergraph structure, and we will note W the diagonal matrix containing the hyperarc weights. The positive (or outer) degree of a vertex 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           V
                        
                      is given by 
                        
                           
                              
                                 d
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       →
                                    
                                 
                              
                           
                           w
                           (
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           
                              
                                 h
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                        
                     . The negative (or inner) degree of 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                      is defined as 
                        
                           
                              
                                 d
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       →
                                    
                                 
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       →
                                    
                                 
                              
                           
                           w
                           (
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           
                              
                                 h
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                        
                     . Let 
                        
                           
                              
                                 D
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       +
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 D
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       -
                                    
                                 
                              
                           
                        
                      be the diagonal matrices containing respectively the positive and negative degrees of the vertices. We define the positive and negative degrees of a hyperarc 
                        
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                        
                      by 
                        
                           
                              
                                 δ
                              
                              
                                 +
                              
                           
                           (
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           =
                           |
                           
                              
                                 e
                              
                              
                                 j
                              
                              
                                 +
                              
                           
                           |
                        
                      and 
                        
                           
                              
                                 δ
                              
                              
                                 -
                              
                           
                           (
                           
                              
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 →
                              
                           
                           )
                           =
                           |
                           
                              
                                 e
                              
                              
                                 j
                              
                              
                                 -
                              
                           
                           |
                        
                     . Let 
                        
                           
                              
                                 D
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       +
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 D
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       -
                                    
                                 
                              
                           
                        
                      be the diagonal matrices containing the positive and negative degrees of the hyperarcs. The transpose of a matrix (or vector) A will be noted 
                        
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                        
                     .

A directed path or hyperpath from x to y in 
                        
                           
                              
                                 H
                              
                              
                                 →
                              
                           
                           =
                           (
                           V
                           ;
                           
                              
                                 E
                              
                              
                                 →
                              
                           
                           )
                        
                      is a sequence 
                        
                           
                              
                                 P
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                           =
                           (
                           x
                           =
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                        
                     , …, 
                        
                           
                              
                                 v
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 e
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 t
                                 +
                                 1
                              
                           
                           =
                           y
                           )
                        
                      such that 
                        
                           x
                           =
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ∈
                           
                              
                                 e
                              
                              
                                 1
                              
                              
                                 +
                              
                           
                           ,
                           
                           y
                           =
                           
                              
                                 v
                              
                              
                                 t
                                 +
                                 1
                              
                           
                           ∈
                           
                              
                                 e
                              
                              
                                 t
                              
                              
                                 -
                              
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 e
                              
                              
                                 i
                                 -
                                 1
                              
                              
                                 -
                              
                           
                           ∩
                           
                              
                                 e
                              
                              
                                 i
                              
                              
                                 +
                              
                           
                        
                      for 
                        
                           i
                           ⩾
                           2
                        
                     .

A random walk [33,42,43] is a particular case of a Markov random chain, a random process that consists on visiting a certain number of locations (or states) by taking random steps. Consider a starting location u. Then the next location visited by the random walk is taken randomly (following a given probability law) among all the neighbors of u. A random walk of length t is then a sequence of 
                           
                              t
                              +
                              1
                           
                         locations 
                           
                              {
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         with 
                           
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              =
                              u
                           
                         the starting location and 
                           
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                              =
                              v
                           
                         the ending location. The random walks are useful in a machine learning manner, where the different locations are data points to classify using a few sample seed points. The learning process can be interpreted by the following assumption: given a random walk starting at an unlabeled location, what is the probability that it first reaches each of the seed points? The final label of the starting location is then taken from the ending seed point of the random walk with the highest probability. In a random walk each step is taken independently from the previous steps, and consequently its behavior is completely determined by a transition probability matrix P where entry 
                           
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                              
                           
                         is the probability for a random walk at location 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         to “jump” to the location 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                        . The “t-step” probabilities (representing the probabilities that a random walk starting at location 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         will reach the location 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         after exactly t steps) are simply given by the tth power of the transition matrix 
                           
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                              
                           
                        .

When the random walk is defined on a graph [33,43] the transition matrix is computed with respect to the underlying graph structure. In practice the random walk matrix is given by 
                           
                              P
                              =
                              
                                 
                                    D
                                 
                                 
                                    -
                                    1
                                 
                              
                              A
                           
                        , where D denotes the diagonal matrix containing the vertex degrees and A is the graph adjacency matrix. It has been shown in many occasions that random walks on graphs have a strong connection with usual electric networks problems [33,42,44]. In this paper we are interested in designing such a learning process on a directed hypergraph. The next sections will give a formulation of the transition matrix associated to a natural random walk in such a directed hypergraph.

Following the concepts introduced by Zhou [8], we can associate a natural random walk to an undirected hypergraph with the following transition rule: given the current position 
                           
                              u
                              ∈
                              V
                           
                        , we first choose a hyperedge 
                           
                              e
                              ∈
                              E
                           
                         over all the hyperedges incident to u with a probability proportional to 
                           
                              w
                              (
                              e
                              )
                           
                        . We then choose a vertex 
                           
                              v
                              ∈
                              V
                              ,
                              
                              v
                              ≠
                              u
                           
                         uniformly at random. With the definitions given by Zhou in [8], the probability 
                           
                              p
                              (
                              u
                              ,
                              v
                              )
                           
                         associated to that transition rule is
                           
                              (1)
                              
                                 p
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                 
                                 w
                                 (
                                 e
                                 )
                                 
                                    
                                       h
                                       (
                                       u
                                       ,
                                       e
                                       )
                                    
                                    
                                       d
                                       (
                                       u
                                       )
                                    
                                 
                                 
                                    
                                       h
                                       (
                                       v
                                       ,
                                       e
                                       )
                                    
                                    
                                       δ
                                       (
                                       e
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

Obviously, a nonzero transition probability between u and v exists only if the two vertices are linked by at least one hyperedge (otherwise 
                           
                              h
                              (
                              u
                              ,
                              e
                              )
                           
                         or 
                           
                              h
                              (
                              v
                              ,
                              e
                              )
                           
                         equals 0). The normalization by the degrees of u and e is motivated by, respectively, that a vertex with a large degree has a smaller chance to choose a distinct hyperedge for the transition, and that the transition between u and an incident vertex v is chosen uniformly at random. The transition matrix P of the random walk is then defined by 
                           
                              P
                              =
                              
                                 
                                    D
                                 
                                 
                                    v
                                 
                                 
                                    -
                                    1
                                 
                              
                              H
                              
                                 
                                    WD
                                 
                                 
                                    e
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    T
                                 
                              
                           
                        .

At that time, very little attention has been dedicated to the study of random walks on hypergraphs, and especially on directed hypergraphs. A first tentative to define a random walk on a directed hypergraph was reported in [45], but this definition comes from the interpretation of a directed hypergraph as a bipartite graph, as we propose a direct formulation. More importantly, only the undirected case is further considered in [45] and consequently the application of a random walk on a directed hypergraph is not investigated. In [46], the authors propose the extension of a specific random walk named loop-erased random walk, but only consider directed hypergraphs where the tail is reduced as a single vertex. Consequently, we propose here a formal definition of a random walk on a directed hypergraph, as well as its associated transition matrix.

By analogy with the random walks defined in [8] for undirected hypergraphs, we associate a random walk to a dirhypergraph 
                           
                              
                                 
                                    H
                                 
                                 
                                    →
                                 
                              
                              =
                              (
                              V
                              ;
                              
                                 
                                    E
                                 
                                 
                                    →
                                 
                              
                              )
                           
                         that has the following natural transition rule. Given the current position 
                           
                              u
                              ∈
                              V
                           
                        , we choose a hyperarc 
                           
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    →
                                 
                              
                           
                         such that 
                           
                              u
                              ∈
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                         with a probability proportional to 
                           
                              w
                              (
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                              )
                           
                        . If we consider that a transition can only be made from a tail to a head of a hyperarc (following the definition a directed hyperpath given above), then we choose a vertex 
                           
                              v
                              ∈
                              
                                 
                                    e
                                 
                                 
                                    -
                                 
                              
                           
                         uniformly at random. The probability 
                           
                              p
                              (
                              u
                              ,
                              v
                              )
                           
                         associated to that transition rule can be formulated as
                           
                              (2)
                              
                                 p
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                →
                                             
                                          
                                          ∈
                                          
                                             
                                                E
                                             
                                             
                                                →
                                             
                                          
                                       
                                    
                                 
                                 w
                                 (
                                 
                                    
                                       e
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       u
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       u
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             -
                                          
                                       
                                       (
                                       v
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             -
                                          
                                       
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

With this formulation, a nonzero transition probability between u and v exists only if 
                           
                              ∃
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                           
                         such that 
                           
                              u
                              ∈
                              
                                 
                                    e
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              v
                              ∈
                              
                                 
                                    e
                                 
                                 
                                    -
                                 
                              
                           
                        , which follows the intuitive idea that a transition can only be done in the direction given by a hyperarc. The probability is normalized by the outer degree of u to represent the probability of choosing a distinct hyperarc between those which contain u in their tails. The inner degree of the hyperarc 
                           
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                           
                         is also introduced to take into account that a vertex is chosen uniformly at random in the head of 
                           
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                           
                        . In matrix notation, the transition matrix P of the directed random walk is defined by
                           
                              (3)
                              
                                 P
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             +
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       +
                                    
                                 
                                 
                                    
                                       WD
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             -
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       -
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                        
                           Proposition 1
                           
                              The matrix P given by Eq. 
                              
                                 (3)
                               
                              is stochastic, i.e. 
                              
                                 
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                    
                                    ⩾
                                    0
                                 
                               
                              and 
                              
                                 
                                    ∀
                                    i
                                    ,
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    1
                                 
                              
                              , and is then suitable for the definition of a random walk.
                           

It is easy to verify that : for all 
                                 
                                    u
                                    ,
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    p
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    ⩾
                                    0
                                 
                              . Now:
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       p
                                       (
                                       u
                                       ,
                                       v
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                          
                                       
                                       w
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             v
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                          
                                       
                                       w
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             v
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                          
                                       
                                       w
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             v
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   e
                                                
                                                
                                                   -
                                                
                                             
                                             |
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                          
                                       
                                       w
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                          
                                       
                                       w
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                
                                             
                                             w
                                             (
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                             
                                                
                                                   h
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             u
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       1
                                       .
                                       
                                       □
                                    
                                 
                              
                           

The INH (Image Neighborhood Hypergraph) model has been found very effective at representing the image content [11,15]. In this section we present an improvement of the INH that takes into account directed relationships between pixels.

Let 
                           
                              I
                              :
                              V
                              ⊆
                              
                                 
                                    Z
                                 
                                 
                                    2
                                 
                              
                              ⟶
                              F
                              ⊆
                              
                                 
                                    Z
                                 
                                 
                                    n
                                 
                              
                           
                         be an image. Elements of V are the collection of the image pixels, and elements of F are the visual features associated to each pixel. A distance d on V defines a grid (a connected, regular graph, without both loop and multi-edge, associated with a regular lattice 
                           
                              L
                           
                         of 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        ). In this contribution, we will be concerned only with 8-connected grids defined by the distance 
                           
                              d
                              (
                              v
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              max
                              {
                              |
                              x
                              -
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              |
                              ,
                              
                              |
                              y
                              -
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              |
                              }
                           
                        , where 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         denote respectively the spatial coordinates of v and 
                           
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                           
                         on the grid. Thus, we define the 
                           
                              β
                           
                        -neighborhood of a pixel 
                           
                              v
                              ∈
                              V
                           
                         by:
                           
                              (4)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                                 (
                                 v
                                 )
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 V
                                 |
                                 d
                                 (
                                 v
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩽
                                 β
                                 }
                                 .
                              
                           
                        
                     

Let 
                           
                              
                                 
                                    d
                                 
                                 
                                    ′
                                 
                              
                           
                         be a distance measure on F, we have a neighborhood relation on an image defined for each pixel v by:
                           
                              (5)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       λ
                                       ,
                                       β
                                    
                                 
                                 (
                                 v
                                 )
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                                 (
                                 v
                                 )
                                 |
                                 
                                    
                                       d
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 F
                                 (
                                 v
                                 )
                                 ,
                                 F
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 )
                                 ⩽
                                 λ
                                 }
                                 .
                              
                           
                        
                     

Here 
                           
                              β
                           
                         and 
                           
                              λ
                           
                         are real values, called respectively spatial threshold and feature threshold. Thanks to this neighborhood relation, to each image we can associate a hypergraph called Image Neighborhood Hypergraph (INH) [47]:
                           
                              (6)
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             λ
                                             ,
                                             β
                                          
                                       
                                    
                                 
                                 =
                                 (
                                 V
                                 ;
                                 
                                    
                                       (
                                       {
                                       v
                                       }
                                       ∪
                                       
                                          
                                             Γ
                                          
                                          
                                             λ
                                             ,
                                             β
                                          
                                       
                                       (
                                       v
                                       )
                                       )
                                    
                                    
                                       v
                                       ∈
                                       V
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

Each pixel v in the image generates a distinct hyperedge 
                           
                              e
                              (
                              v
                              )
                           
                        , and v is called the center of 
                           
                              e
                              (
                              v
                              )
                           
                        . In this work, the feature distance between two pixels will be computed as 
                           
                              
                                 
                                    d
                                 
                                 
                                    ′
                                 
                              
                              (
                              F
                              (
                              v
                              )
                              ,
                              F
                              (
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              )
                              )
                              =
                              |
                              I
                              (
                              v
                              )
                              -
                              I
                              (
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              )
                              |
                           
                        , where 
                           
                              I
                              (
                              v
                              )
                           
                         denotes the gray level of pixel v. The choice of the thresholds 
                           
                              β
                           
                         and 
                           
                              λ
                           
                         will be discussed in Section 6.

In directed graphs (digraphs) for image representation, two neighboring pixels x and y in the image are linked by two distinct directed edges (arcs) 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              (
                              y
                              ,
                              x
                              )
                           
                        . If the same weight is assigned to both arcs than the digraph reduces to an undirected graph. It was then suggested [27,28] to use two different weighting functions 
                           
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                           
                         such that the penalty assigned to an arc 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         should be equal to 
                           
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              (
                              (
                              x
                              ,
                              y
                              )
                              )
                           
                         if 
                           
                              I
                              (
                              x
                              )
                              <
                              I
                              (
                              y
                              )
                           
                        , and to 
                           
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              (
                              (
                              x
                              ,
                              y
                              )
                              )
                           
                         if 
                           
                              I
                              (
                              x
                              )
                              ⩾
                              I
                              (
                              y
                              )
                           
                        , leading to an asymmetric adjacency matrix. We will follow that concept by building two different sets of hyperarcs in our following Directed Image Neighborhood Hypergraph (DINH) model. For an image I with set of pixels V, each pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ∈
                              V
                           
                         will generate two distinct hyperarcs 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                        :
                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   →
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ;
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      }
                                                      ∪
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            λ
                                                            ,
                                                            β
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      |
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      <
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      }
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            λ
                                                            ,
                                                            β
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      |
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      ⩾
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      }
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   →
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      ;
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   2
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      }
                                                      ∪
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            λ
                                                            ,
                                                            β
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      |
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      >
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      }
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   2
                                                
                                                
                                                   -
                                                
                                             
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            λ
                                                            ,
                                                            β
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      |
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      ⩽
                                                      I
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      }
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since the center pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         is in each tail of both hyperarcs, it will exist a nonzero transition probability between 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         and every pixel in its 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    λ
                                    ,
                                    β
                                 
                              
                           
                         neighborhood. The presence of the two types of hyperarc is necessary to allow a transition from regions of low intensity to regions of high intensity (this transition is represented by the hyperarc 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                        ), and also a transition from regions of high intensity to regions of low intensity (represented by the hyperarc 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                        ). Finally, the Directed Image Neighborhood Hypergraph (DINH) associated to an image can be computed as:
                           
                              (9)
                              
                                 
                                    
                                       H
                                    
                                    
                                       →
                                    
                                 
                                 (
                                 V
                                 )
                                 =
                                 
                                    
                                       
                                          V
                                          ;
                                          
                                             
                                                E
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      →
                                                   
                                                
                                                (
                                                v
                                                )
                                                )
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                          ∪
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      →
                                                   
                                                
                                                (
                                                v
                                                )
                                                )
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

With the definition of the hyperarcs of the DINH model given by Eqs. (7) and (8), assigning the same weights to 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                         will lead to a symmetric transition matrix associated to the random walk formulation (2), equivalent to a transition matrix obtained from an INH model, up to a factor 2. Consequently, a hyperarc 
                           
                              
                                 
                                    e
                                 
                                 
                                    →
                                 
                              
                              (
                              v
                              )
                           
                         centered at a pixel v will be weighted by the following weighting function w:
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             w
                                             :
                                             
                                                
                                                   E
                                                
                                                
                                                   →
                                                
                                             
                                             
                                             ⟶
                                             
                                                
                                                   R
                                                
                                                
                                                   +
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   →
                                                
                                             
                                             (
                                             v
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      v
                                                      )
                                                      ;
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      v
                                                      )
                                                   
                                                
                                             
                                             
                                             ↦
                                             exp
                                             (
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         v
                                                         ,
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In other words, each hyperarc will be weighted by the exponential of the average value of the feature distance (defined in Section 4.1) between the center pixel v (in the tail) and every pixel in the head of the hyperarc. We should note that this definition favors transitions between pixels that are close according to the given feature distance. By definition, the tails of 
                           
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                           
                         centered at a pixel v are different, and so are the weights associated to them. Consequently, the transition matrix of the directed random walk will be asymmetric.

We consider the image segmentation problem in a transductive setting, in which a set of known labels of some pixels (called seeds) are used to predict the labels for all other pixels. More mathematically, let us reorganize the image pixels as 
                        
                           V
                           =
                           {
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 L
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 N
                              
                           
                           }
                        
                     , such that 
                        
                           
                              
                                 V
                              
                              
                                 L
                              
                           
                           =
                           
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 L
                              
                           
                        
                      is the labeled pixels set and 
                        
                           
                              
                                 V
                              
                              
                                 U
                              
                           
                           =
                           
                              
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 L
                                 +
                                 1
                              
                              
                                 N
                              
                           
                        
                      is the unlabeled pixels set. Note 
                        
                           L
                           =
                           {
                           1
                           ,
                           …
                           ,
                           l
                           }
                        
                      (with 
                        
                           l
                           ⩽
                           L
                        
                     ) the set containing the labels, and 
                        
                           y
                           :
                           V
                           →
                           L
                        
                      the function associating to each pixel 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ∈
                           V
                        
                      its label 
                        
                           y
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      in the final segmentation. Our goal is to estimate 
                        
                           y
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      for each unlabeled pixel 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                     .

In our framework, the pixels set is taken as the vertex set of the directed hypergraph defined by Eq. (9), and let P be the transition matrix of the random walk defined on this dirhypergraph by Eq. (3). Let 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           :
                           V
                           →
                           [
                           0
                           ,
                           1
                           ]
                        
                      be the function associating to each pixel 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                      its membership 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      to the label k, i.e. the probability for the pixel 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                      to belong to label k in the final segmentation. If 
                        
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 V
                              
                              
                                 L
                              
                           
                        
                      is a labeled pixel, we set 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           )
                           =
                           1
                        
                      if the (known) label of 
                        
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                        
                      is k, and 0 otherwise. We want to estimate the value of 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        
                      for each unlabeled pixel 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                     , so its label 
                        
                           y
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      will be taken as the k which maximizes 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                     .

With our random walk interpretation of this learning process, 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           )
                        
                      will be calculated as the probability that a random walk, given by the transition matrix P and starting at location 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        
                     , will first reach a labeled location belonging to the label k, before hitting a seed location with a different label. It is not difficult to see that simulating such a random walk and see what seeded point it reaches first may be impractical, because the number of unlabeled pixels is in practice considerably higher than the number of seed pixels. In addition, it is subject to random biases, since it is possible for a random walk to take a direction it has a small probability to take, and then be trapped in a sub-optimal solution. This section presents two ways of resolving this problem by estimating the probabilities 
                        
                           
                              
                                 f
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        
                     , one theoretical and one more practical, and the summary of the segmentation algorithm.

The solution of the learning process in terms of random walk is to consider the latter as an absorbing Markov chain. More details about the absorbing Markov chains theory can be found in [41]. In an absorbing Markov chain (given by its transition matrix 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                        ), some of the locations are absorbing states that can be considered as traps, where the random walk ends when it reaches one of those absorbing states. More formally, 
                           
                              
                                 
                                    P
                                 
                                 
                                    ii
                                 
                                 
                                    ′
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                              ∀
                              j
                           
                         when 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         is an absorbing state. Then if we pose all the seed labeled locations as absorbing states, and if we assume that every random walk starting at a given unlabeled location (which is called a transient state in terms of Markov random chains) can reach at least one absorbing state (not necessary after just one step), then the random walk is an absorbing Markov chain, with some interesting properties [42]. Thanks to the reorganization of the pixels set by grouping seed and unlabeled pixels together, we can split the transition matrix P of the Markov chain in the following canonical form:
                           
                              
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         LL
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         LU
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UL
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UU
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    UL
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    UU
                                 
                              
                           
                         represent the submatrices of P restricted to the probabilities between respectively the unlabeled and seed locations, and between all the unlabeled locations. 
                           
                              
                                 
                                    P
                                 
                                 
                                    LL
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    LU
                                 
                              
                           
                         are the submatrices corresponding to the transition probabilities between, respectively, all the seed locations, and the seed and unlabeled locations. Since the seed pixels are considered as absorbing states, 
                           
                              
                                 
                                    P
                                 
                                 
                                    LL
                                 
                              
                           
                         must reduce to the 
                           
                              L
                              ×
                              L
                           
                         identity matrix 
                           
                              
                                 
                                    I
                                 
                                 
                                    L
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    LU
                                 
                              
                           
                         to 
                           
                              0
                           
                        , a matrix with all entries equal to 0. It is not difficult to see that this is not the case with our formulation of the transition matrix P of a random walk in a directed hypergraph (see Eq. (3)). In fact, this formulation does not depend on the seeds, which will be placed after the construction of P. It is not a problem, because the submatrices 
                           
                              
                                 
                                    P
                                 
                                 
                                    LL
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    LU
                                 
                              
                           
                         are not useful for the learning process (since we do not have to start a random walk from already labeled locations) and do not intervene in the following. Therefore, 
                           
                              
                                 
                                    P
                                 
                                 
                                    LL
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    LU
                                 
                              
                           
                         can easily be fixed to, respectively, 
                           
                              
                                 
                                    I
                                 
                                 
                                    L
                                 
                              
                           
                         and 
                           
                              0
                           
                         after placing the seeds.

The matrix 
                           
                              N
                              =
                              
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          U
                                       
                                    
                                    -
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         is called the fundamental matrix for the absorbing chain given by P (in this case 
                           
                              
                                 
                                    I
                                 
                                 
                                    U
                                 
                              
                           
                         denotes the identity matrix of size 
                           
                              N
                              -
                              L
                              ×
                              N
                              -
                              L
                           
                        ). It can be found in [41] that the matrix 
                           
                              (
                              
                                 
                                    I
                                 
                                 
                                    U
                                 
                              
                              -
                              
                                 
                                    P
                                 
                                 
                                    UU
                                 
                              
                              )
                           
                         is invertible and thus the matrix N exists. The entry 
                           
                              
                                 
                                    N
                                 
                                 
                                    ij
                                 
                              
                           
                         can be interpreted as the expected number of times that a random walk starting at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         will pass through 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         before being absorbed by a seed location. Then the vector 
                           
                              t
                              =
                              N
                              1
                           
                         (where 
                           
                              1
                           
                         is a column vector of all 1’s) gives the expected number of steps before absorption for each starting state. Consequently, let B be the 
                           
                              N
                              ×
                              L
                           
                         matrix which entry 
                           
                              
                                 
                                    B
                                 
                                 
                                    ij
                                 
                              
                           
                         gives the probability that a random walk starting at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         will be absorbed by the absorbing state 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                        . Then B is calculated by:
                           
                              (11)
                              
                                 B
                                 =
                                 
                                    
                                       NP
                                    
                                    
                                       UL
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             U
                                          
                                       
                                       -
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                       
                                       )
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       UL
                                    
                                 
                                 .
                              
                           
                        
                     

This can be interpreted as follows: to get the probability of starting at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         and ending up a given absorbing state 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                        , we add up the probabilities of going to 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         from all the transient states, weighted by the number of times we expect to be in those transient states starting from 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                        .

Now that we have the absorption probabilities from each starting state, we have to estimate the label probabilities 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          L
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          N
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         be the vector containing the label memberships of all pixels for the label k. As well as the matrix P, we can split 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         as:
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         L
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         U
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

In full generality, the probability 
                           
                              
                                 
                                    U
                                 
                                 
                                    im
                                 
                              
                           
                         that a random walk P starting at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         will reach the absorbing state 
                           
                              
                                 
                                    v
                                 
                                 
                                    m
                                 
                              
                           
                         is given by the solution to the system of equations [41]
                        
                           
                              (12)
                              
                                 
                                    
                                       U
                                    
                                    
                                       im
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       jm
                                    
                                 
                                 .
                              
                           
                        
                     

Since the value 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is interpreted as the probability that a random walk starting at 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         will first reach the location belonging to the label k, it can be calculated as the sum of the probabilities of reaching each absorbing state labeled with k. If we note 
                           
                              
                                 
                                    V
                                 
                                 
                                    k
                                 
                              
                           
                         the set of all labeled pixels of label k, thus we have:
                           
                              (13)
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                m
                                             
                                          
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       im
                                    
                                 
                                 ,
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                m
                                             
                                          
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       jm
                                    
                                 
                                 ,
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                m
                                             
                                          
                                          ∈
                                          
                                             
                                                V
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       jm
                                    
                                 
                                 ,
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

We can clearly see that 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the harmonic average between all the values of 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         among the neighborhood of 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                        , because 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                              
                              =
                              1
                           
                        . Consequently, 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is a harmonic function with domain the state space of the absorbing Markov chain P. If we consider the absorbing states (i.e. the seed locations) of P as the boundaries of the harmonic function 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , then the solution to the learning process is the same as the one to the combinatorial Dirichlet problem 
                        [42,44], which is to find a harmonic function subject to its boundary values. Those values are known, because obviously we set 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              1
                           
                         if the label of the seed pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         is k, and 0 otherwise. The solution to the Dirichlet problem can be expressed in terms of absorbing Markov chains [42], since 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is harmonic for P means that 
                           
                              P
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , which implies that
                           
                              (14)
                              
                                 ∀
                                 n
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           
                         is the nth power of matrix P. It has been shown [41] that the nth power of P will approach a matrix of the form
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ∞
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        so we can rewrite Eq. (14) as follows:
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         L
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         U
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         L
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         U
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   U
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             =
                                             B
                                             
                                                
                                                   f
                                                
                                                
                                                   L
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   U
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UU
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   P
                                                
                                                
                                                   UL
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   L
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The last equation is fundamental, because it allows us to compute the value of each function 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         at each unlabeled pixel. The final labeling of a given pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         can be obtained by taking the highest probabilities among all the labels, i.e.
                           
                              (16)
                              
                                 y
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       argmax
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

A practical means to estimate the theoretical solution of the learning process given by Eq. (15) (since its direct computation is difficult due to the size of the matrices in use) is to adopt an iterative label propagation behavior [34,48], that has been chosen in this paper for its computational feasibility and quickness of convergence. It is based on the assumption that at each iteration of the algorithm, each unlabeled pixel will update its label membership by ”absorbing” the label information given by the pixels in its spatial neighborhood. Intuitively, the pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         should learn more information from a pixel which is more likely to belong to the same semantically meaningful object. Note 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                           
                         the likelihood that 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    j
                                 
                              
                           
                         share the same label in the final segmentation, then the k label membership of an unlabeled pixel 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                         at iteration step t will be computed by
                           
                              (17)
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                       (
                                       t
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                       (
                                       t
                                       -
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

As that notation suggests, the likelihood 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                           
                         will be taken from the transition matrix P defined by Eq. (3), with 
                           
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    ij
                                 
                              
                           
                        . Since the labels of the seed pixels are user-defined labels, they should not be updated and can be clamped at each iteration. Consequently, we can split 
                           
                              
                                 
                                    f
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         and P as
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       k
                                       )
                                       (
                                       t
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               L
                                                            
                                                            
                                                               (
                                                               k
                                                               )
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               U
                                                            
                                                            
                                                               (
                                                               k
                                                               )
                                                               (
                                                               t
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         LL
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         LU
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UL
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UU
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    (
                                    k
                                    )
                                    (
                                    t
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    U
                                 
                                 
                                    (
                                    k
                                    )
                                    (
                                    t
                                    )
                                 
                              
                           
                         correspond to the predicted label memberships for label k of the labeled and unlabeled labels respectively. 
                           
                              
                                 
                                    P
                                 
                                 
                                    LU
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    UU
                                 
                              
                           
                         represent the submatrices of P restricted to the transition probabilities between respectively the labeled and unlabeled locations, and between all the unlabeled locations. Then the update rule given by Eq. (17) can be rewritten as [34,48]:
                           
                              (18)
                              
                                 
                                    
                                       f
                                    
                                    
                                       U
                                    
                                    
                                       (
                                       k
                                       )
                                       (
                                       t
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       UL
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       L
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       UU
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       U
                                    
                                    
                                       (
                                       k
                                       )
                                       (
                                       t
                                       -
                                       1
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

Here the iteration step of 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         has been omitted since it remains the same in all iteration steps. Therefore, the labels of the unlabeled pixels can be predicted using Eq. (18) until a convergence is achieved. The final labeling after the learning process at a pixel v is then given by 
                           
                              y
                              (
                              v
                              )
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    U
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              v
                              )
                           
                        . We will now show that the label memberships given by this iterative procedure converge to a solution that is equivalent to the theoretical solution found by considering the random walk as an absorbing Markov chain.
                           Proposition 2
                           
                              The iterative update rule from Eq. 
                              
                                 (18)
                               
                              converges to 
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          U
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          I
                                          -
                                          
                                             
                                                P
                                             
                                             
                                                UU
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          UL
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          L
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                              
                              .
                           

When the number of iterations approaches 
                                 
                                    +
                                    ∞
                                 
                              , the iterative update rule from Eq. (18) leads to
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                lim
                                             
                                             
                                                t
                                                →
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      UU
                                                   
                                                   
                                                      i
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             UL
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             L
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             k
                                             )
                                             (
                                             0
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          U
                                       
                                       
                                          (
                                          k
                                          )
                                          (
                                          0
                                          )
                                       
                                    
                                 
                               denotes the initial configuration of the label membership of the unlabeled pixels, and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                       
                                          t
                                       
                                    
                                 
                               represents the tth power of the matrix 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                              . We now have to show that the second term 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          U
                                       
                                       
                                          (
                                          k
                                          )
                                          (
                                          0
                                          )
                                       
                                    
                                    →
                                    0
                                 
                              . If we assume that P is row-stochastic, i.e. 
                                 
                                    ∀
                                    i
                                    ,
                                    j
                                 
                              , we have 
                                 
                                    0
                                    ⩽
                                    
                                       
                                          P
                                       
                                       
                                          ij
                                       
                                    
                                    ⩽
                                    1
                                 
                               and 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    1
                                 
                              , since 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                               is a sub-matrix of P it follows that (with 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                UU
                                             
                                          
                                          )
                                       
                                       
                                          ij
                                       
                                    
                                 
                               denoting the 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                              th entry of matrix 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                              )
                                 
                                    
                                       ∃
                                       i
                                       ,
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                N
                                                -
                                                l
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   UU
                                                
                                             
                                             )
                                          
                                          
                                             ij
                                          
                                       
                                       <
                                       1
                                       .
                                    
                                 
                              
                           

Since there is N pixels and L labeled points, note 
                                 
                                    n
                                    =
                                    N
                                    -
                                    L
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                               is of size 
                                 
                                    n
                                    ×
                                    n
                                 
                              . Pose 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                 
                               as the sum of the ith row of 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                              , i.e. 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                UU
                                             
                                          
                                          )
                                       
                                       
                                          ij
                                       
                                    
                                 
                              . 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                               is nonnegative, so from Perron-Frobenius theorem [49] we know that the spectral radius 
                                 
                                    ρ
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                    )
                                 
                               (i.e. the maximum eigenvalue of 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                              ) satisfies 
                                 
                                    ρ
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          max
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                 
                              , because 
                                 
                                    ∀
                                    i
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    1
                                 
                               we have 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    1
                                 
                              , so 
                                 
                                    ρ
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                    )
                                    ⩽
                                    1
                                 
                              . Minc theorem [49] also states that
                                 
                                    
                                       ρ
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                       
                                       )
                                       ⩽
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  m
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     UU
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               im
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       .
                                    
                                 
                              Recall that we have 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    1
                                    ∀
                                    i
                                 
                               and that 
                                 
                                    ∃
                                    i
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    <
                                    1
                                 
                              . So it comes that
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            UU
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      im
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  m
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     UU
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               im
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       1
                                       ,
                                    
                                 
                              and consequently
                                 
                                    
                                       ρ
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                       
                                       )
                                       ⩽
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  m
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     P
                                                                  
                                                                  
                                                                     UU
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               im
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       <
                                       1
                                       .
                                    
                                 
                              Because the spectral radius of 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                    
                                 
                               is less than 1, thus
                                 
                                    
                                       
                                          
                                             
                                                lim
                                             
                                             
                                                t
                                                →
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       0
                                       ,
                                       
                                       
                                          
                                             
                                                lim
                                             
                                             
                                                t
                                                →
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             UU
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             I
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   UU
                                                
                                             
                                             )
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       .
                                    
                                 
                              Consequently 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          UU
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          U
                                       
                                       
                                          (
                                          k
                                          )
                                          (
                                          0
                                          )
                                       
                                    
                                    →
                                    0
                                 
                              , and therefore
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         U
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            t
                                                            →
                                                            ∞
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  UU
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UL
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         L
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UU
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         U
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                         (
                                                         0
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      
                                                         (
                                                         I
                                                         -
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               UU
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         UL
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         L
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   .
                                                   
                                                   □
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Another version of the proof can be found in [34]. Since 
                           
                              
                                 
                                    f
                                 
                                 
                                    L
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is immutable, the iterative update rule converges to a unique fixed point and gives us a theoretical guarantee of the feasibility of the algorithm. In addition, this fixed point is equivalent as the theoretical solution given by Eq. (15), which shows that the iterative algorithm is able to solve the labeling problem in terms of random walks.

The proposed semi-supervised segmentation framework can be summarized as follows:
                           
                              1.
                              Obtain a set of labeled pixels, either automatically or interactively.

For each labeled pixel u with label k, set 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             L
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       (
                                       u
                                       )
                                       =
                                       1
                                    
                                 .

For each unlabeled pixel v and for each label k, set 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             k
                                             )
                                             (
                                             0
                                             )
                                          
                                       
                                       (
                                       v
                                       )
                                       =
                                       0
                                    
                                 .

Build 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             →
                                          
                                       
                                    
                                  as the DINH representation of the image following Eq. (9).

Compute the directed transition matrix P following Eq. (3).

Set 
                                    
                                       t
                                       =
                                       1
                                    
                                  and 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             k
                                             )
                                             (
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             k
                                             )
                                             (
                                             0
                                             )
                                          
                                       
                                    
                                 .

While 
                                    
                                       t
                                       <
                                       
                                          
                                             t
                                          
                                          
                                             max
                                          
                                       
                                    
                                  or 
                                    
                                       |
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             t
                                             -
                                             1
                                             )
                                          
                                       
                                       -
                                       
                                          
                                             f
                                          
                                          
                                             U
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       |
                                       >
                                       δ
                                    
                                 ,
                                    
                                       (a)
                                       For each label k, update 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      U
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                           by:


                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      U
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                =
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      UL
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      L
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                                +
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      UU
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      U
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                      (
                                                      t
                                                      -
                                                      1
                                                      )
                                                   
                                                
                                             
                                          .

Set 
                                             
                                                t
                                                =
                                                t
                                                +
                                                1
                                             
                                           and 
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      U
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      U
                                                   
                                                   
                                                      (
                                                      k
                                                      )
                                                      (
                                                      t
                                                      -
                                                      1
                                                      )
                                                   
                                                
                                             
                                          .

For each pixel v, give it label k such that
                                    
                                       
                                          
                                             
                                                argmax
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                f
                                             
                                             
                                                U
                                             
                                             
                                                (
                                                k
                                                )
                                                (
                                                t
                                                )
                                             
                                          
                                          (
                                          v
                                          )
                                          .
                                       
                                    
                                 
                              

The stopping condition of our iterative algorithm is here controlled by the parameter 
                           
                              
                                 
                                    t
                                 
                                 
                                    max
                                 
                              
                              >
                              0
                           
                         if one wants to limit the maximum number of iterations, or the parameter 
                           
                              δ
                              >
                              0
                           
                         if one wants to achieve a convergence over the label memberships.

@&#EXPERIMENTS@&#

In order to evaluate the reliability of our approach and to judge the relevance of our directed hypergraph model, we conducted experiments on the commonly used Microsoft GrabCut dataset [32]. It includes a set of 50 real images, as well as ground-truth segmentations that can be used as a comparison basis. Seed regions are also provided in the form of trimaps, where white, dark gray and light gray areas denote respectively the labeled object, the labeled background and the unlabeled region. Some original images from the GrabCut dataset and their corresponding trimaps can be found in Fig. 1
                     . One may note that this dataset (and particularly the seeds) is of a particular type, where the unlabeled data lies only within a narrow band around the real objects boundaries. Consequently, it is reasonable to think that an algorithm exploiting the particular shape of the seeds could provide a good segmentation. But nevertheless, none of the algorithms compared in this experimental section makes use of a priori information on the nature of the seeds, or involves a particular spatial distance to the labeled pixels in the energy function to minimize. For this reason, the GrabCut dataset remains of a considerable interest in the evaluation of an algorithm that can be used in an interactive framework [35], and some examples are difficult due to the lack of seed pixels in some regions (see for instance the last image of Fig. 1). Furthermore, this dataset (and its original seeds) remains very standard in the supervised segmentation field, as many state-of-the-art algorithms evaluate their performance on this dataset, and thus allows us to quantitatively compare our proposal to these algorithms. One may argue that the seeds can be modified to judge the stability of the algorithm (as in [36]), but we chose to use the original seeds for the sake of consistency, since the evaluation measures reported in many state-of-the-art articles that exploit this dataset are also computed with the original seeds, thus providing a benchmark for this dataset and allowing a direct comparison with our proposal.

For a quantitative comparison, the performance of each semi-supervised segmentation algorithm will be measured by the average error rate over all 50 images in the dataset. The error rate is computed as the ratio of the number of wrongly classified pixels to the total number of pixels to classify [32,50]. The wrongly classified pixels can be directly obtained from the ground truth labeling provided in the dataset (see Fig. 1). Please note that the foreground object is surrounded by a thin band of grey pixels corresponding to an uncertainty about the precise location of the boundaries of the object in the ground truth (since it has been annotated by multiple persons). Consequently, these pixels are not counted in the error rate to ensure its consistency. Again, other performance measures can be computed [51], but the error rate we use here is widely reported in many state-of-the-art papers, thus allowing a direct comparison with our algorithm. Results of our approach using the DINH model have been first compared to those obtained with the same iterative algorithm (see Section 5.3), but with different transition matrices exploiting different representation models (see Section 6.1), to judge the reliability of directed hypergraphs in this context. Second, the performance of our proposed segmentation approach is compared to some state-of-the-art algorithms (see Section 6.2) to judge its efficiency as a standalone segmentation method. And finally, some examples of multi-label segmentation are given (Section 6.3).

To judge the reliability of using directed hypergraphs as a means of image representation (and thus our proposed DINH model) independently from the learning method used, we first compared the results of our approach with those obtained with the same iterative algorithm (see Section 6.1) but with different transition matrices built from:
                           
                              •
                              A typical undirected graph model [34], which connects every pixel with its 8 neighbors in the image. The edge between two pixels x and y is weighted by a standard Gaussian kernel 
                                    
                                       w
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       exp
                                       (
                                       -
                                       α
                                       |
                                       I
                                       (
                                       x
                                       )
                                       -
                                       I
                                       (
                                       y
                                       )
                                       |
                                       )
                                    
                                  exploiting the image intensity, as well as our approach. The standard value 1 has been used for the 
                                    
                                       α
                                    
                                  parameter since it provided the best results. The transition matrix is computed as in [34] and is equivalent as a graph random walk formulation.

A directed graph model obtained from the DINH, generated by converting every hyperarc of the DINH representation by a set of directed graph edges (arcs) starting from the center pixel of the hyperarc. The weights associated to each arc is the same as the hyperarcs weights defined in Section 4.3. The parameters used for the arcs construction are obviously the same as the ones used for the DINH. We can observe that with this definition a directed hypergraph as defined in the first works in this direction [19,20] reduced to the present directed graph model.

An undirected INH model as described in Section 4.1. The INH model have been previously successfully used for image segmentation [11,16], and the transition matrix can be obtained by Zhou’s random walk formulation [8] for undirected hypergraphs, as suggested in [18]. The 
                                    
                                       β
                                    
                                  and 
                                    
                                       λ
                                    
                                  parameters used for this representation are the same as in our DINH model.

The proof of convergence and the theoretical properties of the algorithm with these transition matrices can be found in [34] (for the graph version) and [14] (for the undirected hypergraph version). The remaining parameters used along these experiments have been set as follows:
                           
                              •
                              For the parameters that control the stopping criterion of the iterative algorithm (see Section 5.3), we chose not to limit the number of iterations and fixed the 
                                    
                                       δ
                                    
                                  parameter to 
                                    
                                       0.1
                                    
                                  which is in practice enough to achieve convergence.

The standard value 
                                    
                                       β
                                       =
                                       1
                                    
                                  has been used for the spatial threshold in INH and DINH representations, since it has been shown in many occasions [11,16] that increasing this parameter has a small influence over the segmentation output.

Finally, the 
                                    
                                       λ
                                    
                                  parameter for the feature threshold has been computed in an adaptive way [16] as 
                                    
                                       λ
                                       (
                                       v
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                               (
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                      
                                                         σ
                                                         (
                                                         I
                                                         (
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                             ∈
                                             
                                                
                                                   Γ
                                                
                                                
                                                   β
                                                
                                             
                                             (
                                             v
                                             )
                                          
                                       
                                    
                                 at pixel v, where 
                                    
                                       
                                          
                                             I
                                             (
                                             
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                  and 
                                    
                                       σ
                                       (
                                       I
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       )
                                    
                                  design respectively the mean and the standard deviation of the intensities of each pixel (including v) in the 
                                    
                                       β
                                    
                                 -neighborhood of v.

One should note that with the given INH and DINH definitions (see Section 4), two neighboring pixels in the image can be disconnected in the corresponding hypergraph, which will result in a zero transition probability in the propagation matrix. To overcome this limitation and to guarantee that the random walk will reach at least one seed pixel (see Section 5.1), we chose to compute such a probability as a very small value (typically 
                                    
                                       10
                                       
                                          
                                             e
                                          
                                          
                                             -
                                             4
                                          
                                       
                                    
                                 ). This is equivalent to adding a hyperarc (or hyperedge) of weight 
                                    
                                       10
                                       
                                          
                                             e
                                          
                                          
                                             -
                                             4
                                          
                                       
                                    
                                  between two pixels that are neighbors in the image but not in the DINH (or INH).


                        Table 1
                         compiles the average error rates obtained on the 50 images of the GrabCut [32] dataset with our iterative algorithm with the four different transition matrices described above. When we observe these values we can clearly see that the best results are obtained with our proposed directed hypergraph model compared to the previously cited ones. Consequently, our label propagation behavior has been found more effective when the transition matrix of the associated random walk is built by the means of our proposed directed hypergraph model. Since this model is based on the existing INH model, we can conclude when looking at the results that simply adding a directional information and asymmetric weights to the underlying hypergraph structure provided by the INH can help at improving the segmentation. It is also interesting to observe that the average error rate is higher in the case of a graph structure, which confirms the fact that hypergraph-based model are more accurate than graph-based ones for image content representation. This can be explained by the ability of hypergraphs to take into account multiple relationships between elements, when graphs are only able to maintain pairwise affinities. Consequently, a hypergraph is able to handle relationships that are not only based on pixel-to-pixel comparison, but on the comparison of whole regions of neighboring pixels, and thus allows some pixels to be linked by multiple relationships from different points of view. On the contrary, graphs used in image representation (and particularly their matrix representations) do not allow vertices to be linked by multiple edges. For the same reasons, the results obtained with a DINH model are better than those obtained with a directed graph built from the DINH, showing the reliability of using a hypergraph formulation. However, the performance obtained from the directed graph are close to those from the INH case, which shows that using directional information and asymmetric weighting can improve segmentation results.


                        Fig. 2
                         presents a comparison of qualitative results obtained with our proposed directed hypergraph approach, to those from a typical graph model, a directed graph model and an INH model. The results displayed are close-ups of the foregrounds obtained with the different algorithms corresponding to the images in the first three rows of Fig. 1. Despite the fact that all the segmentation results displayed in this figure can be considered as semantically meaningful, the computed error rates are different, in general due to the boundary placement. In the top row example, the boundaries around the flowers are more precise in the directed hypergraph case. In the middle row, the directed hypergraph is the only model that was able to correctly segment the mushroom foot, and particularly the leaf at the bottom. This result is also partially found in the directed graph case, which suggests that directional information is useful to segment thin elongated objects. The example of the last row is probably the one that shows the best the benefits of the introduction of directional information into the INH model. In fact, the arm of the boy is difficult to segment in an semi-supervised framework due to its color proximity with the background and the lack of seed pixels in this region. However, our approach exploiting the DINH model was the best at segmenting the arm, confirming that directional information can help at detecting elongated objects. The directed graph can also improve the arm segmentation, but we can see that it also shares segmentation errors with the undirected graph structure (the region below the armpit of the boy is not correctly segmented, and the face region is imprecise). This kind of difficulty can easily be tackled with the help of user interaction, by prompting the user to submit seed pixels at critical points. In the last example it will be relevant to mark some pixels of the boy’s arm as object pixels in order to properly guide the segmentation.

These results clearly show that directed hypergraph models can provide a richer model of representation compared to simple undirected hypergraphs and graphs. If the error rate improvement between INH and DINH models can be considered as slight, this can be explained by the fact that the DINH is based on the INH, and further directed hypergraph models (not necessarily based on previously existing hypergraph representations) have to be investigated. In conclusion, our model based on a directed hypergraph outperforms the ones based on a different structure, and particularly the undirected hypergraph case, within our iterative learning setting. Consequently, we showed that the introduction of directed hypergraphs in computer vision and particularly in image representation is relevant, which was the main purpose and contribution of this paper.

Secondly, we compared the performance of our approach with several state-of-the-art supervised segmentation algorithms. These results are compiled in Table 2
                        . The first row refer to an algorithm based on a Gaussian Mixture Markov Random Fields (GM-MRF) interpretation on a graph [50]. The second row is an algorithm that exploits the hypergraph random walk matrix [8] based on a hypergraph representation of an image generated with superpixels [53]. The third one is not based on a global energy minimization method like the others, but on a local filtering of the label space [52]. The fourth row is our proposed approach. The fifth row is Grady’s random walker algorithm [33] also exploiting a random walk interpretation of the learning step, but solved by a set of equations obtained from the Laplacian of the underlying graph. The algorithm on the sixth row also exploits the graph Laplacian, but with a statistical transductive interpretation [35]. It was also shown in [35] that this algorithm reduces to Grady’s random walker if a given parameter is set to a particular value (which explains that the two reported error rates are the same). Finally, the seventh and last row refers to an algorithm again exploiting hypergraphs with a superpixels generation step, but in a much richer manner than in [18], since the given hypergraph uses real-valued incidence matrices. Here the learning step is handled by hypergraph interpolation involving a hypergraph Laplacian computation. All the error rates found in Table 2 are reported on the GrabCut dataset using the original seeds under the same conditions, in [50] for the GM-MRF, in [18] for the superpixels hypergraph, in [52] for the cost volume filtering, in [35] for the Laplacian regularizer and Grady’s random walker, and in [14] for the probabilistic hypergraph.

We can see from these results that the error rates obtained with our approach also compare well to other state-of-the-art image segmentation algorithms, showing the reliability of our global framework. The results obtained by the superpixels hypergraph [18] (despite using a hypergraph representation) can be explained by the fact that computing a superpixels representation of the image helps at reducing the size of the problem, but also introduces a hard labeling constraint between the pixels among the same superpixel. Consequently, the error produced by the segmentation algorithm for a single superpixel affects all the pixels that the superpixel represents, and then the error rate increases. If the method based on probabilistic hypergraph produced way better results, this can be explained by the fact that the hypergraph model used is built in a completely different way and exploits real-valued incidence matrices.

One should note that existing methods such as the Laplacian regularizer [35] and Grady’s random walker [33] can reach more satisfactory results. The main reason for this is that these methods are based on a direct calculation of the labels of the unlabeled pixels (instead of approaching the solution with an iterative setting), generally using powerful tools based on matrix operations and equations solvers, thanks to the good properties displayed by the Laplacian matrix. This is also the case for the algorithm exploiting probabilistic hypergraphs. These methods can provide a solution that satisfies directly the optimization learning problem, which can explain the better results, but generally come along with a heavy computational burden [35]. These difficulties are not present in a label propagation approach. Furthermore, such a Laplacian representation has to be symmetric in order to allow a regularization or an eigen-decomposition. At that time, it does not exist a proper definition of such a Laplacian matrix for directed hypergraphs, which can be the subject of future research in this field. Recall that the primary objective of this work was to judge the reliability of using directed hypergraphs in the computer vision domain, and that we did not intend to design a segmentation algorithm outperforming the actual best methods in this field. Obviously, our method is not able to compete in terms of quality of segmentation with the ones that can directly find a global optimum to the underlying energy minimization problem. Nevertheless, the error rates of our algorithm are reasonably close to the better ones, which shows that our system is reliably efficient, and justifies further research work for improving its quality.

A visual comparison of results obtained with our approach and Grady’s random walker [33] can be found in Fig. 3
                        , which displays close-ups of the segmentation foregrounds for Grady’s random walker and our label propagation approach (both with INH and DINH models) corresponding to the images in the two last rows in Fig. 1. The result from the top row clearly shows the advantage of a direct computation of the label memberships. The boundaries of the foreground object are correctly located in the case of Grady’s random walker, as they are very imprecise with our approach. In fact, the label memberships are slow to converge in these particular regions where the complex texture in the background makes the label diffusion difficult. Consequently, the algorithm will be stopped because it will detect only a slight change in the label memberships between two iterations, even if their optimal value has not been reached. But the result in the bottom row shows the advantage of using our directed hypergraph representation, where the use of directional penalties allows to obtain a better segmentation of the right (in the image) leg of the sheep, whereas the two other approaches are unable to compute a proper segmentation due to the lack of seed pixels in this region.

In addition, our approach has been found to be reasonably efficient in terms of computation time, thanks to the iterative label propagation behavior we adopted. With our C++ implementation on an Intel Xeon 2.67 GHz machine, the algorithm takes between 
                           
                              0.85
                           
                         and 
                           
                              5.35
                           
                         seconds to converge, depending on the image size, with the GrabCut [32] dataset. The algorithm is slightly faster in the graph case, because by construction the number of neighbors to consider at each iteration for each pixel is higher in the hypergraph case. The computation times are way better than those reported for the Laplacian regularizer in [35] and the hypergraph interpolation in [14], which confirms the fact that powerful learning tools based on matrix operations or equations solving are computationally intensive. However, these methods can rely on many optimization solutions [54].

Our segmentation approach has also two practical advantages. First, it computes real-valued label memberships for every pixel (on the contrary of some algorithms like graph cuts [38] that only provides labels), that can serve as confidence scores or for alpha matting. And second, the mathematical formulation of the segmentation method and the development of its update rule (see Section 5) has been done by considering the possibility of having more than two labels (background/foreground), as some algorithms only consider the two-labels case. Consequently, our algorithm is directly applicable to multi-label segmentation.


                        Fig. 4
                         presents some examples of such multi-label segmentation obtained with our label propagation approach and our DINH model. One can see that with a small amount of user-supplied seeds, our algorithm is able to achieve perceptually acceptable results, even if some defects can be observed, especially when looking at the foreground region of the image at the bottom row, which are essentially due to the complex texture present in the background around the statues’ boundaries.

@&#CONCLUSIONS@&#

In this paper, we investigated the utilization of directed hypergraphs in the computer vision domain. We proposed a generalization of undirected hypergraphs into directed hypergraphs, and defined a formulation of a random walk in a directed hypergraph. We proposed a DINH (Directed Image Neighborhood Hypergraph) model as a directed hypergraph representation of the image content, and adapted it to a semi-supervised image segmentation problem using a transition matrix computed from our random walk formulation. Experiments on the standard Microsoft GrabCut [32] datasets showed encouraging results in comparison with algorithms using undirected and directed graphs and undirected hypergraph-based image representation. In particular, results show that the introduction of directional information unto a hypergraph model can help at improving the segmentation results due to an asymmetric weighting of the hyperarcs. Consequently, we introduced the directed hypergraph concept in the computer vision domain and showed its relevance within this context.

Our image segmentation application is the first attempt of using directed hypergraphs in image analysis problems. If the results converge to an improvement of the performance compared to algorithms using traditional undirected hypergraphs, our proposition is an open system and several ways can be imagined to get more satisfying results. The comparison with several state-of-the-art supervised segmentation algorithms showed that our iterative approach cannot compete in terms of quality with methods that are able to directly compute an optimal solution to the energy minimization framework, using powerful graph-based tools such as Laplacian regularization [33,35]. The translation of such tools to the undirected hypergraph case is difficult at the moment, due to the asymmetric nature of directed hypergraphs and the lack of prior theoretical work in this field. Proposing coherent definitions of matrix-based representation of directed hypergraphs such as Laplacian matrices can be a direction to explore. Furthermore, different directed hypergraph models for image representation have to be investigated, and particularly for the case of color images. An interesting idea can be to model a video (or an image sequence) by the means of directed hypergraphs, since directional features such as the optical flow can easily be computed directly from the data.

Long-term further work in this direction will include the application of directed image hypergraph models in an unsupervised segmentation framework, for example by adapting existing hypergraph-based algorithms like spectral clustering [8] or reductive clustering methods [15] to the directed case.

@&#REFERENCES@&#

