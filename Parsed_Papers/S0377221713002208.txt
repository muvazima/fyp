@&#MAIN-TITLE@&#A dynamic inventory model with supplier selection in a serial supply chain structure

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This article provides an inventory model for a serial supply chain with multiple suppliers and time varying demand.


                        
                        
                           
                           The model minimizes the total cost of purchasing, production, inventory setup and holding, and transportation.


                        
                        
                           
                           Considering lead times, necessary feasibility conditions regarding the demand at the last stage are established.


                        
                        
                           
                           Actual transportation costs are modeled by exact piecewise linear functions.


                        
                        
                           
                           Our results show that inventory setup and holding costs can affect supplier selection and order lot sizing decisions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Serial supply chain

Supplier selection

Dynamic inventory model

Transportation cost

@&#ABSTRACT@&#


               
               
                  Considering the inherent connection between supplier selection and inventory management in supply chain networks, this article presents a multi-period inventory lot-sizing model for a single product in a serial supply chain, where raw materials are purchased from multiple suppliers at the first stage and external demand occurs at the last stage. The demand is known and may change from period to period. The stages of this production–distribution serial structure correspond to inventory locations. The first two stages stand for storage areas for raw materials and finished products in a manufacturing facility, and the remaining stages symbolize distribution centers or warehouses that take the product closer to customers. The problem is modeled as a time-expanded transshipment network, which is defined by the nodes and arcs that can be reached by feasible material flows. A mixed integer nonlinear programming model is developed to determine an optimal inventory policy that coordinates the transfer of materials between consecutive stages of the supply chain from period to period while properly placing purchasing orders to selected suppliers and satisfying customer demand on time. The proposed model minimizes the total variable cost, including purchasing, production, inventory, and transportation costs. The model can be linearized for certain types of cost structures. In addition, two continuous and concave approximations of the transportation cost function are provided to simplify the model and reduce its computational time.
               
            

@&#INTRODUCTION@&#

Manufacturing and distribution systems in today’s competitive markets face a myriad of dynamic challenges that require not only exceptional planning capacity, but also robust supply chain networks with communication and coordination mechanisms that allow the parties involved in such networks to address changes in a short notice. From radical volume changes in customer demand, to variations in prices of raw material and finished products due to currency fluctuations in the global marketplace, to increases in transportation costs due to speculation in the price of crude oil, any number of factors can have a serious effect on corporate revenue projections. In particular, when inventory is stuck in the various stages of the supply chain, the company may be forced to operate at critical cash flow levels. As such, the ability to intelligently address inbound and outbound issues through effective supply chain inventory and distribution strategies not only keeps the wheels of business turning, but it also gives the company a relative advantage over its competitors in being able to address supplier concerns and consumer needs in a way that slower, less agile manufacturers are unable to do.

Of the various activities involved in supply chain logistics, purchasing is one of the most strategic because it provides opportunities to reduce costs across the entire supply chain. An essential task within the purchasing process is supplier selection, given that the cost of raw materials and component parts represents the largest percentage of the total product cost in most industries. For instance, in high technology firms, purchased materials and services account for up to 80% of the total product cost (Weber et al., 1991). In contemporary supply chain management, companies maintain long term partnership with suppliers, and use fewer, but more reliable suppliers. The performance of potential suppliers is evaluated against multiple criteria rather than considering a single factor (Ho et al., 2010).

Inventory is recognized as one of the major drivers of a supply chain (Ravindran and Warsing, 2013). High inventory levels increase the responsiveness of the supply chain but decrease its cost efficiency because of the cost of holding inventory. Hence, a relevant problem in supply chain logistics is to determine the appropriate levels of inventory at the various stages involved in a supply chain. Given the prevalence of both supplier selection and inventory management decisions in a supply chain, this article addresses both problems simultaneously by studying the production and distribution of a single product or an aggregated unit representing a family of products with similar process plans in a serial supply chain structure. An example of this situation is a manufacturer that purchases raw parts from various preferred suppliers. These raw parts are stored at the manufacturing facility or processed into final products. These products are either stored at the manufacturer level or transported to a warehouse. At the warehouse stage, either products are stored there or transported to a distribution center (DC). In general, the DC may serve products to an entire market area or a set of retailers. Given the possible impact of transportation costs in both supplier selection and inventory replenishment at each stage of the supply chain in today’s enterprises, the proposed mixed integer nonlinear programming (MINLP) model considers purchasing, production, inventory, and transportation costs over a planning horizon with time varying demand considering quality constraints for the suppliers, capacity constraints for suppliers and the manufacturer, and inventory capacity constraints at all the stages.

The scenario described above can be viewed as a generalization of one of the most studied problems in production and inventory planning for a single facility, called the dynamic inventory lot-size problem. This basic problem is to determine the production quantities for each period so that all demands are satisfied on time at minimal production and inventory cost. Wagner and Whitin (1958) use dynamic programming to find an exact solution for the uncapacitated version of the problem in polynomial time. Florian and Klein (1971) show how to handle the case of time-independent production capacity. Florian et al. (1980) show that, when the capacity limitation is time-dependent, even for the single item case, the problem is NP-hard.

Several authors have considered multi-stage supply chain models under deterministic constant demand. Muckstadt and Roundy (1993) survey and summarize these results. In particular, the sequential structure has been the most common mechanism used to implement optimization on supply chain logistics. In this case, the optimal results obtained for a particular process are used as input to optimize interrelated processes in the supply chain that are considered independent from a modeling point of view. An integrated optimization approach has shown to produce superior solutions for many of the applications. This is the case of supplier selection and lot sizing production in a supply chain. In fact, the literature shows substantial research of these two topics when they are analyzed independently. However, research that covers both topics simultaneously is limited and recent. Basnet and Leung (2005) present one of the first studies where inventory lot sizing is analyzed simultaneously with supplier selection under a dynamic demand environment. They propose an enumerative search algorithm and also a heuristic approach to solve the mixed integer linear programming (MILP) formulation developed for the single stage uncapacitated multiproduct problem. Ustun and Demirtas (2007) propose a mixed integer goal programming model for the single stage lot sizing and supplier selection problem. Additional work has also been performed for the static demand case using some extensions of the economic order quantity (EOQ) model. Mendoza and Ventura (2010) study a serial inventory system with supplier selection and order quantity allocation, where some of the properties of the EOQ model are used to derive a simplified MINLP model for the problem.

This article extends previous research developed in inventory lot sizing and supplier selection for a serial supply chain. In particular, the proposed MINLP model solves a dynamic multi-stage single-product capacitated problem. Even though Hoesel et al. (2005) suggest a dynamic programming approach for the multi-stage lot sizing problem in a serial supply chain with production capacities, they neither integrate supplier selection nor consider quality and capacity constrains in their model. Thus, this work intends to cover a novel area of research that has not been studied extensively and, consequently, could allow further research. Our results show that switching suppliers over a predefined planning horizon according to costumer demand may reduce the total cost. These results are consistent with a novel methodology developed by Moalem et al. (2010) for the healthcare industry where the selection of suppliers is affected by the business environment forecast.

The remainder of this article is organized as follows. In Section 2, the development of the proposed dynamic inventory model with supplier selection for a serial supply chain is presented. Section 3 gives a general characterization of the transportation freight rates for the less-than-truck load (LTL) mode. Section 4 provides a description of the two freight rate estimate functions considered in this research. In Section 5, a rather simpler MILP version of the proposed model is formulated, where transportation costs are represented by piecewise linear functions. Section 6 describes the illustrative example used in this article, while Section 7 presents the results obtained from the sensitivity analysis performed over some relevant model parameters. Finally, Section 8 provides the conclusions of this research and several new opportunities that have been identified as potential extensions of this work.

A dynamic lot-sizing model with supplier selection in a serial supply chain structure is presented in this section. Let J
                     ={1,2,…,
                     n
                     
                        J
                     } be the set of suppliers, K
                     ={1,2,…,
                     n
                     
                        K
                     } the set of supply chain stages, S
                     ={1,2,…,
                     n
                     
                        S
                     } the set of customers, and T
                     ={1,2,…,
                     n
                     
                        T
                     } the set of planning periods. Let l
                     0j
                      be the number of delivery lead time periods from supplier j
                     ∈
                     J to stage 1, and l
                     
                        k
                      the number of delivery lead time periods from stage k
                     ∈
                     K⧹{n
                     
                        K
                     } to stage k
                     +1. Finally, let 
                        
                           
                              
                                 d
                              
                              
                                 s
                              
                              
                                 t
                              
                           
                        
                      be the external demand in units of customer s
                     ∈
                     S at time t
                     ∈
                     T. Let J
                     
                        t
                     
                     ={j
                     ∈
                     J:t
                     −
                     l
                     0,j
                     
                     ⩾0} be the subset of suppliers that can provide raw materials at period t. Note that at time t only a supplier with a lead time less than t can supply raw material to stage 1.

The dynamic serial supply chain with multiple suppliers and customers can be modeled as a general transshipment network G
                     
                        D
                     
                     =(N
                     
                        D
                     ,
                     A
                     
                        D
                     ), where the set of nodes N
                     
                        D
                      and the set of arcs A
                     
                        D
                      are defined as follows (see Fig. 1
                     ):
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    D
                                 
                              
                              =
                              J
                              ∪
                              K
                              ∪
                              S
                              ,
                           
                        
                     and
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    D
                                 
                              
                              =
                              {
                              (
                              j
                              ,
                              1
                              )
                              :
                              j
                              ∈
                              J
                              }
                              ∪
                              {
                              (
                              k
                              ,
                              k
                              +
                              1
                              )
                              :
                              k
                              ∈
                              K
                              /
                              {
                              
                                 
                                    n
                                 
                                 
                                    K
                                 
                              
                              }
                              }
                              ∪
                              {
                              (
                              
                                 
                                    n
                                 
                                 
                                    K
                                 
                              
                              ,
                              s
                              )
                              :
                              s
                              ∈
                              S
                              }
                              .
                           
                        
                     
                  

As shown in Fig. 1, stages 1 and 2 represent the raw material and finished product warehouses at the manufacturing facility. K
                     
                        D
                     
                     ={2,3,4,…,
                     n
                     
                        K
                     
                     −1} is the set of intermediate warehousing/distribution stages that hold finished products, including the warehouse at stage 2, and n
                     
                        K
                      is the last distribution stage that ships products to customers. Notice that the external demand can be aggregated by consolidating the set of customers into a single demand node n
                     
                        K+1, where 
                        
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 s
                                 ∈
                                 S
                              
                           
                           
                              
                                 d
                              
                              
                                 s
                              
                              
                                 t
                              
                           
                        
                      represents the external demand in units for all customers at time t
                     ∈
                     T. In this case, the distribution process from stage n
                     
                        K
                      to customers for each period t
                     ∈
                     T can be treated as a separate problem that can be independently solved.

Considering that the dynamic supply chain represented by network G
                     
                        D
                      does not show the effect of changes in demand between consecutive time periods, a (time-expanded) static supply chain network is defined and represented by the general transshipment network G
                     
                        S
                     
                     =(N
                     
                        S
                     ,
                     A
                     
                        S
                     ). In this network, the set of nodes N
                     
                        S
                      and the set of arcs A
                     
                        S
                      are defined as follows:
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    S
                                 
                              
                              =
                              {
                              (
                              0
                              ,
                              j
                              ,
                              t
                              )
                              :
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              T
                              }
                              ∪
                              {
                              (
                              k
                              ,
                              t
                              )
                              :
                              k
                              ∈
                              K
                              ,
                              t
                              ∈
                              T
                              }
                              ,
                           
                        
                     and
                        
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             S
                                          
                                       
                                       =
                                       {
                                       (
                                       (
                                       0
                                       ,
                                       j
                                       ,
                                       t
                                       )
                                       ,
                                       (
                                       1
                                       ,
                                       t
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             0
                                             j
                                          
                                       
                                       )
                                       )
                                       :
                                       j
                                       ∈
                                       J
                                       ,
                                       t
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             0
                                             j
                                          
                                       
                                       }
                                       }
                                    
                                 
                                 
                                    
                                       
                                       ∪
                                       {
                                       (
                                       (
                                       k
                                       ,
                                       t
                                       )
                                       ,
                                       (
                                       k
                                       +
                                       1
                                       ,
                                       t
                                       +
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       :
                                       k
                                       ∈
                                       K
                                       ⧹
                                       {
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       }
                                       ,
                                       t
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             k
                                          
                                       
                                       }
                                       }
                                       .
                                    
                                 
                              
                           
                        
                     Note that neither set S nor its aggregated node n
                     
                        K
                     
                     +1 are used in the definition of N
                     
                        S
                     . Similarly, neither initial nor ending inventories are included in the definition of A
                     
                        S
                     . The raw material flow from supplier j in period t is represented as a directed arc connecting nodes (0,
                     j,
                     t) and (1,
                     t
                     +
                     l
                     0j
                     ). Likewise, the inventory flow between consecutive time periods t and t
                     +1 at stage k is represented as a directed arc connecting nodes (k,
                     t) and (k,
                     t
                     +1), while the product flow between consecutive stages k and k
                     +1 is represented by a directed arc that connects nodes (k,
                     t) and (k
                     +1,
                     t
                     +
                     l
                     
                        k
                     ). In this setting, all initial inventories, raw material and finished product pending orders at every stage k are assumed to be available at the beginning of the first period, and respectively represented by 
                        
                           
                              
                                 i
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 0
                                 j
                              
                              
                                 0
                              
                           
                        
                      , and 
                        
                           
                              
                                 y
                              
                              
                                 k
                                 -
                                 1
                              
                              
                                 0
                              
                           
                        
                     . In the same way, ending inventories at each stage k are assumed to be available at the end of the last period and are represented by 
                        
                           
                              
                                 i
                              
                              
                                 k
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                     .

Considering that the MINLP model will associate a continuous flow variable to each arc in network G
                     
                        S
                     
                     =(N
                     
                        S
                     ,
                     A
                     
                        S
                     ), a promising approach for reducing the problem size consists of eliminating from the analysis all the arcs and nodes that cannot be used or reached by any feasible raw material or product flow due to the positive lead times and finite planning horizon. Notice that since only unreachable arcs and nodes are eliminated, the original problem can be formulated in a reduced transshipment network 
                        
                           
                              
                                 G
                              
                              
                                 s
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                     , where 
                        
                           
                              
                                 N
                              
                              
                                 s
                              
                              
                                 ′
                              
                           
                           ⊆
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                        
                      and 
                        
                           
                              
                                 A
                              
                              
                                 s
                              
                              
                                 ′
                              
                           
                           ⊆
                           
                              
                                 A
                              
                              
                                 S
                              
                           
                        
                     . After the elimination, the original and reduced problems will have the same optimal solution, but the reduced problem will have fewer variables and be faster to solve than the original problem.

In the following theorem, a set of feasible time periods T
                     
                        k
                      is defined for each stage k
                     ∈
                     K, so that a node (k,
                     t) will be considered feasible if and only if k
                     ∈
                     K and t
                     ∈
                     T
                     
                        k
                     .
                        Theorem 1
                        
                           For a given stage k
                           ∈
                           K, let m
                           
                              k
                            
                           be either zero or the closest preceding stage with positive initial inventory or pending order, i.e.,
                        


                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 max
                                 {
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 k
                                 }
                                 }
                              
                           . Let 
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                              
                            be either n
                           
                              K
                            
                           or the closest succeeding stage from stage k with positive ending inventory, i.e.,
                        


                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 min
                                 {
                                 
                                    
                                       n
                                    
                                    
                                       K
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       i
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 {
                                 k
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       K
                                    
                                 
                                 -
                                 1
                                 }
                                 }
                              
                           . In addition, let l
                           0
                           =
                           min{l
                           0j
                           :j
                           ∈
                           J}.


                           Finally, let 
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           . Then, node (k,
                           
                           t) is a feasible node in the (time-expanded) static network if and only if t
                           ∈
                           T
                           
                              k
                           
                           , where
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             t
                                             :
                                             1
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             t
                                             ⩽
                                             
                                                
                                                   n
                                                
                                                
                                                   T
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   l
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Considering that the total lead time between stages m
                           
                              k
                            and k is given by 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , the earliest time t that a flow generated at stage m
                           
                              k
                            can reach stage k is 
                              
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           . In addition, given that the lead time between stages k and 
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       k
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , the latest time t
                           ∈
                           T
                           
                              k
                            in which a flow sent from stage k can arrive at stage 
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                              
                            by time n
                           
                              T
                            is 
                              
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       k
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           . On the other hand, given that node 
                              
                                 
                                    
                                       
                                          k
                                          ,
                                          1
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            can always send a product flow to any node (k,
                           t), where 
                              
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 <
                                 t
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       k
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , then any intermediate node between nodes 
                              
                                 
                                    
                                       
                                          k
                                          ,
                                          1
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                k
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          k
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                T
                                             
                                          
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                k
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            will also be feasible. Therefore, at any stage k
                           ∈
                           K, a node (k,
                           t) is a feasible node if t
                           ∈
                           T
                           
                              k
                           .

On the other hand, since the lead time from stage m
                           
                              k
                            to stage k is 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , it is straightforward to show that a node (k,
                           t) with 
                              
                                 1
                                 ⩽
                                 t
                                 <
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            will not be feasible. Similarly, since the lead time between stages k and 
                              
                                 
                                    
                                       m
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       k
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , a flow generated in stage k at time t, 
                              
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       k
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 <
                                 t
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       T
                                    
                                 
                              
                            , will always be received at stage n
                           
                              K
                            after period n
                           
                              T
                           .□

Based on Theorem 1, the following corollary states a similar result that identifies the sets of feasible time periods for raw material orders submitted by the suppliers.
                        Corollary 1.1
                        
                           A raw material order submitted by the manufacturing stage (stage 1) to a given supplier j
                           ∈
                           J at time t will be feasible if and only if t
                           ∈
                           T
                           
                              0j
                           
                           , where
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                          j
                                       
                                    
                                    =
                                    {
                                    t
                                    :
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    max
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    -
                                    
                                       
                                          l
                                       
                                       
                                          0
                                          j
                                       
                                    
                                    }
                                    .
                                 
                              
                           
                        

Even though a raw material order from supplier j
                           ∈
                           J to the manufacturer stage (stage 1) can always be shipped in period 1, considering that the delivery lead time defined for supplier j is l
                           0j
                           , the latest time that an order from supplier j can be shipped is max{t′∈
                           T
                           1}−
                           l
                           0j
                           ; otherwise, it would be received during an infeasible time period.□

Considering the lead times at the different stages of the supply chain network, necessary feasibility conditions regarding the demand at stage n
                     
                        K
                      can be established for the dynamic supplier selection and inventory planning problem. These conditions are stated in the following lemma and theorem.
                        Lemma 1
                        
                           For a given stage k
                           ∈
                           K, if node (k,
                           
                           1) is connected to node (n
                           
                              K
                           
                           ,
                           
                           t) at the demand stage n
                           
                              K
                            
                           in period t
                           ∈
                           T
                           
                              k
                           
                           , then every node 
                           
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 1
                                 )
                              
                           
                           , such that 
                           
                              
                                 k
                                 ⩽
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ⩽
                                 
                                    
                                       n
                                    
                                    
                                       K
                                    
                                 
                              
                            
                           , is also connected to node (n
                           
                              K
                           
                           ,
                           
                           t).
                        

Since the total lead time between stages 
                              
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            and n
                           
                              K
                            is given by 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             k
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , node 
                              
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          t
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            is connected to node (n
                           
                              K
                           ,
                           t). However, since a product flow can be sent from node 
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 1
                                 )
                              
                            to node 
                              
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          t
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           , node 
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 1
                                 )
                              
                            is always connected to node 
                              
                                 
                                    
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ˆ
                                             
                                          
                                          ,
                                          t
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           . Consequently, through this node, node 
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 1
                                 )
                              
                            is also connected to the demand node (n
                           
                              K
                           ,
                           t).□


                           The supply chain inventory problem with supplier selection can only be feasible if for every demand node (n
                           
                              K
                           
                           ,
                           
                           t), 
                           
                              
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   K
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 t
                                 <
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                           , the following condition holds:
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   K
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                 
                              
                           
                           where, 
                              
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 min
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                K
                                             
                                          
                                          ,
                                          k
                                          ∈
                                          K
                                          :
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                k
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          <
                                          t
                                       
                                    
                                 
                              
                           .

Based on Theorem 1, the first feasible node at stage n
                           
                              K
                            is given by 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                K
                                             
                                          
                                          ,
                                          1
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            K
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           .In addition, considering that the total lead time from stage 0 to stage n
                           
                              K
                            is 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , the first node at stage n
                           
                              K
                            that can be directly supplied with finished products produced by new raw material orders is given by 
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                K
                                             
                                          
                                          ,
                                          1
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                =
                                                0
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      K
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           .Consequently, any demand node (n
                           
                              K
                           ,
                           t), with 
                              
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   K
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 t
                                 <
                                 1
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           , can only be supplied from initial inventory or pending orders. Given that node (k
                           
                              t
                           ,1) is connected to node (n
                           
                              K
                           ,
                           t), by Lemma 1, node
                              
                                 (
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 1
                                 )
                              
                           , for 
                              
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       k
                                    
                                    
                                       ˆ
                                    
                                 
                                 ⩽
                                 
                                    
                                       n
                                    
                                    
                                       K
                                    
                                 
                              
                           , is also connected to node (n
                           
                              K
                           ,
                           t).Thus, the accumulated initial inventory and pending orders accessible to node (n
                           
                              K
                           ,
                           t) can be calculated as 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           .Moreover, the cumulative demand prior to time t can be calculated as 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           .Therefore, the maximum possible available inventory before attempting to satisfy demand at stage n
                           
                              K
                           in period t is given by 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           .Consequently, to achieve feasibility at node (n
                           
                              K
                           ,
                           t), it is necessary to satisfy the demandrequirement:
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                              
                           .Otherwise, the problem is infeasible.□

An illustration of a static supply chain network with three suppliers (n
                     
                        J
                     
                     =3), five stages (n
                     
                        K
                     
                     =5), and a planning horizon of six periods (n
                     
                        T
                     
                     =6) is presented on Fig. 2
                     . As shown in the figure, the lead times are positive for suppliers 2 and 3, and stages 3 and 4, where orders are delivered one time unit (period) after they are submitted, i.e., l
                     02
                     =
                     l
                     03
                     =
                     l
                     3
                     =
                     l
                     4
                     =1. In this problem, assuming zero initial and ending inventories, and no pending orders, m
                     
                        k
                     
                     =0 and 
                        
                           
                              
                                 m
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           =
                           6
                        
                      for each stage k
                     ∈
                     K. Thus, the feasible sets of time periods T
                     
                        k
                      for each stage k
                     ∈
                     K can be determined by applying Theorem 1. In this illustration, T
                     1
                     =
                     T
                     2
                     =
                     T
                     3
                     ={1,…,
                     n
                     
                        T
                     
                     −
                     l
                     3
                     −
                     l
                     4}={1,2,3,4}, T
                     4
                     ={1+
                     l
                     3,…,
                     n
                     
                        T
                     
                     −
                     l
                     3}={2,3,4,5}, and T
                     5
                     ={1+
                     l
                     3
                     +
                     l
                     4,…,
                     n
                     
                        T
                     }={3,4,5,6}. Similarly, applying Corollary 1, sets T
                     0j
                     , j
                     ∈
                     J, are defined as T
                     01
                     ={1,…,
                     n
                     
                        T
                     
                     −
                     l
                     3
                     −
                     l
                     4}={1,2,3,4} and 
                        
                           
                              
                                 T
                              
                              
                                 02
                              
                           
                           =
                           {
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 T
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 02
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 3
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 4
                              
                           
                           }
                           =
                           {
                           1
                           ,
                           2
                           ,
                           3
                           }
                        
                     , and 
                        
                           
                              
                                 T
                              
                              
                                 03
                              
                           
                           =
                           {
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 T
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 03
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 3
                              
                           
                           -
                           
                              
                                 l
                              
                              
                                 4
                              
                           
                           }
                           =
                           {
                           1
                           ,
                           2
                           ,
                           3
                           }
                        
                     . Consequently the reduced network 
                        
                           
                              
                                 G
                              
                              
                                 s
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          A
                                       
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                      can be defined as follows:
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                              =
                              {
                              (
                              0
                              ,
                              j
                              ,
                              t
                              )
                              :
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              }
                              ∪
                              {
                              (
                              k
                              ,
                              t
                              )
                              :
                              k
                              ∈
                              K
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              }
                              ,
                           
                        
                     and
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                              =
                              {
                              (
                              (
                              0
                              ,
                              j
                              ,
                              t
                              )
                              ,
                              (
                              1
                              ,
                              t
                              +
                              
                                 
                                    l
                                 
                                 
                                    0
                                    j
                                 
                              
                              )
                              )
                              :
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              }
                              ∪
                              {
                              (
                              (
                              k
                              ,
                              t
                              )
                              ,
                              (
                              k
                              +
                              1
                              ,
                              t
                              +
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                              )
                              )
                              :
                              k
                              ∈
                              K
                              ⧹
                              {
                              
                                 
                                    n
                                 
                                 
                                    K
                                 
                              
                              }
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              }
                              .
                           
                        
                     
                  

The lists of remaining parameters, decision variables, and cost function components for the dynamic production planning problem are provided below.
                        
                           
                              
                              
                              
                                 
                                    
                                       Remaining parameters
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    unit holding cost at stage k from period t to period t
                                       +1, k
                                       ∈
                                       K, t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    capacity (in units) of supplier j at time t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    production capacity (in units) at stage 1 in period t, t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    distribution capacity at stage k in period t (in units), k
                                       ∈
                                       K, t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       r
                                       
                                          k
                                       
                                    
                                    inventory capacity (in units) at stage k, k
                                       ∈
                                       K.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    unit price of raw material for supplier j in period t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    unit production cost in period t, t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    setup cost for an order submitted to supplier j in period t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    setup cost for production at stage 1 in period t, t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    setup cost at stage k in period t, k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈ 
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       a
                                       
                                          j
                                       
                                    
                                    perfect rate of supplier j (probability that a unit is acceptable), j
                                       ∈
                                       J.
                                 
                                 
                                    
                                       a
                                    
                                    minimum acceptable perfect rate.
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       Decision variables
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    replenishment order quantity (in raw material units) shipped from supplier j to stage 1 in period t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    production lot size (in units of finished product) at the manufacturing stage (stage 1) at the beginning of period t, t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    replenishment order quantity (in units of finished product) shipped from stage k to stage k
                                       +1 in period t, k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    inventory level (in units) held at stage k from period t to period t
                                       +1, k
                                       ∈
                                       K, t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    1 if supplier j receives a replenishment order at time t; 0 otherwise; j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    1 if a production order is submitted at time t; 0 otherwise; t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    1 if a replenishment order is shipped from stage k to stage k
                                       +1 at time t; 0 otherwise; k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       Cost Function components
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            0
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    purchasing cost of 
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units purchased from supplier j in period t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    production cost of 
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units at stage 1 in period t
                                       ∈
                                       T
                                       1.
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    inventory holding cost of 
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units stored at stage k from period t to period t
                                       +1, k
                                       ∈
                                       K, t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            0
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    holding cost for in-transit inventory of 
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units shipped from supplier j (stage 0) to stage 1 for periods t to t+l
                                       0j
                                       
                                       −1, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       . It is calculated as 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   t
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         0
                                                         j
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            0
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    holding cost for in-transit inventory of 
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units shipped from stage k to stage k
                                       +1 for periods t to t
                                       +
                                       l
                                       
                                          k
                                       
                                       −1, k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈
                                       T
                                       
                                          k
                                       . It is calculated as 
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   t
                                                
                                                
                                                   t
                                                   +
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            0
                                                            j
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    transportation cost of 
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units of row material shipped from supplier j to stage 1in period t, j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    transportation cost of 
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        units of product shipped from stage k to stage k
                                       +1 in period t, k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈
                                       T
                                       
                                          k
                                       .
                                 
                              
                           
                        
                     
                  

Given that purchasing, production, inventory, and transportation cost functions are defined as general expressions, the problem can be formulated as an MINLP, where the objective is to minimize the total cost over n
                        
                           T
                         planning periods:

(P1)
                           
                              (1)
                              
                                 Minimize
                                 
                                 Z
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                0
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                0
                                                j
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                0
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                0
                                                j
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                0
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                0
                                                j
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                T
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        **** subject to
                           
                              (2)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       y
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       D
                                    
                                 
                                 ⧹
                                 {
                                 2
                                 }
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   K
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       i
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                                 ⩾
                                 a
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                J
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                       -
                                       
                                          
                                             l
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 J
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 K
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 k
                                 ∈
                                 K
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 j
                                 ∈
                                 J
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                        This formulation has been written with respect to the reduced static network 
                           
                              
                                 
                                    G
                                 
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                           
                        . The total cost for all n
                        
                           T
                         periods is minimized while satisfying all the demand on time. Eq. (1) represents the total variable cost function, which includes raw material purchasing, production, inventory, and transportation costs for n
                        
                           T
                         periods. Notice that no transportation cost is considered between stages 1 and 2, since all these flows occur internally in the manufacturing facility. Set of Eq. (2) guarantees flow balance between raw material and finished product at the manufacturing level. Note that when 1∈
                        T
                        1 then 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    ∈
                                    J
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              >
                              0
                           
                        , otherwise 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    ∈
                                    J
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                        . For simplicity of exposition and without loss of generality, a bill of materials (BOM) ratio equal to one is assumed at the manufacturing stage. Consequently one unit of raw material is required for each unit of finished product. Sets of Eqs. (3)–(5) assure that the balance of finished products between consecutive stages of the supply chain is satisfied, ensuring that customer demand is completely satisfied in each period of the planning horizon. Observe in Eq. (3), when 1∈
                        T
                        2 then 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              >
                              0
                           
                        ; otherwise, 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                        . Similarly, in Eqs. (4) and (5), when 1∈
                        T
                        
                           k
                         then 
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                    -
                                    1
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                                 
                                    0
                                 
                              
                              >
                              0
                           
                        ; otherwise, 
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                    -
                                    1
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                        . Set of constraints (6) guarantees that, at each period, the average rate of raw material units of acceptable quality received from the suppliers is greater than or equal to the minimum acceptable perfect rate set by the manufacturer. Sets of bounds (7)–(9) represent the capacity constraints for suppliers, manufacturing, and transportation, respectively. Set of constraints (10) defines the inventory capacity at each stage in the supply chain. Finally, sets of constraints (11)–(14) describe the nature of the variables considered in the model.

Notice that purchasing and production costs usually have a setup component and a linear component, which can be respectively expressed as follows:
                           
                              (15)
                              
                                 
                                    
                                       s
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                0
                                                j
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        and
                           
                              (16)
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        On the other hand, inventory holding cost functions are frequently assumed to be linear, and can be represented in this manner:
                           
                              (17)
                              
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        Consequently, in-transit holding cost functions can be expressed as follows:
                           
                              (18)
                              
                                 
                                    
                                       u
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          t
                                       
                                       
                                          t
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                0
                                                j
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       0
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        and
                           
                              (19)
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          t
                                       
                                       
                                          t
                                          +
                                          
                                             
                                                l
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    t
                                 
                                 
                                    t
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          0
                                          j
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    t
                                 
                                 
                                    t
                                    +
                                    
                                       
                                          l
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                    +
                                    1
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         represent unit holding costs for in-transit inventory from supplier j to stage 1 and from stage k to stage k
                        +1, respectively.

Most manufacturing companies rely on third-party providers for the transportation of products through their supply chain (Chan et al., 2002). Assuming trucks as the common means of transportation, freight can be transported using full-truck-load (TL) or less-than-truckload (LTL) options. Even though, TL is frequently the less expensive transportation option, when other supply chain costs are simultaneously considered in the analysis, the LTL option can provide more flexibility in the definition of the optimal order size to allow reduction of the overall supply chain cost. This situation is especially true, when the shipment sizes are relatively small. According to Swenseth and Godfrey (2002), TL rates are usually expressed on a per-mile basis, while LTL rates are commonly expressed per hundredweight (CWT), defined for a given origin and destination. Justifiably, LTL transportation cost functions are similar to ordering cost functions for inventory replenishment with quantity discounts. The two most commonly used order quantity discount structures are the incremental and all-unit discounts. In both cases quantity discounts are obtained as a result of economies of scale. Although both quantity discount structures result in ordering cost functions that are piecewise linear, only incremental quantity discount functions are concave.

Today’s market is characterized by small shipment sizes, which can be modeled using the LTL transportation option. In fact, as a result of increasing product customization, the number of stock-keeping units has dramatically increased during the last two decades, pushing for more frequent shipments. Customer service considerations have also played an important role, promoting decentralized distribution networks, where fewer customers are served per DC (Spiegel, 2002). Considering that the all-unit discount transportation cost strategy is widely used to stimulate demand for larger and more profitable shipments in the LTL transportation mode, this strategy has been selected to incorporate the transportation costs in Model (P1) and can be described as follows:
                        
                           (20)
                           
                              
                                 
                                    g
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              q
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                q
                                                =
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                0
                                                <
                                                q
                                                <
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                q
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩽
                                                q
                                                <
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      3
                                                   
                                                
                                                q
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩽
                                                q
                                                <
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      n
                                                   
                                                
                                                q
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      n
                                                      -
                                                      1
                                                   
                                                
                                                ⩽
                                                q
                                                <
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ⩽
                                                q
                                                ⩽
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where q is the shipment size, β
                     0
                     =0<
                     β
                     1
                     <
                     β
                     2
                     <⋯<
                     β
                     
                        n
                     
                     <
                     β
                     
                        n+1are the breakpoints, α
                     1 is the fixed shipment cost for 0<
                     q
                     <
                     β
                     1, α
                     
                        i
                      is the unit shipping cost for the order quantity q, when if β
                     
                        i−1
                     ⩽
                     q
                     <
                     β
                     
                        i
                     , for i
                     =2,⋯,
                     n, and α
                     
                        n+1 is the fixed shipment cost for β
                     
                        n
                     
                     ⩽
                     q
                     ⩽
                     β
                     
                        n+1. Notice that α
                     2
                     >
                     α
                     3
                     >⋯>
                     α
                     
                        n
                     
                     >0, α
                     2
                     β
                     1
                     =
                     α
                     1, and α
                     
                        n
                     
                     β
                     
                        n
                     
                     ⩾
                     α
                     
                        n+1. Thus, the total transportation cost for q units is calculated as:
                        
                           (21)
                           
                              g
                              (
                              q
                              )
                              =
                              min
                              {
                              
                                 
                                    g
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              q
                              )
                              ,
                              
                                 
                                    g
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                              }
                              ,
                              
                              where
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              ⩽
                              q
                              <
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                     This function considers the situation where it may be advantageous to declare β
                     
                        i
                      units, even though only q units are effectively transported. This concept, commonly known as over-declaring, is frequently used in practice to take advantage of cost reductions obtained by shipping larger sizes. In this case, cost functions are characterized by indifference points, where any number of shipping units beyond these points pays an LTL freight rate corresponding to next range by over-declaring the shipment size. Thus, shipments are artificially increased to the next higher shipment breakpoint, resulting in a lower total cost (Swenseth and Godfrey, 1996). As an illustration, Table 1
                      presents the LTL freight rates defined for a specific origin and destination. These rates could represent the transportation cost between a specific supplier and the manufacturing facility. Nominal freight rates represent the rates as stated by the LTL carrier, while actual freight rates represent the transportation costs obtained after the concept of over-declaring has been applied. Notice that even though LTL rates are usually expressed in CWT (Swenseth and Godfrey, 2002), for simplification of this illustration, freight rates are expressed in per unit of raw material or finished product. Nominal and actual freight rates are characterized by a minimum and maximum number of units. Subsequent freight ranges are defined by a progressive reduction of the variable rates. As an example of the actual freight rates calculation, let us consider the first three nominal rates given by ranges [1,31], [32,62], and [63,124] in units. Using the graphical representation provided in Fig. 3
                     , it is possible to notice that the total transportation cost given for the range [49,62] is higher than the total cost obtained when 63 units are declared. Therefore, any shipping size between 49 and 62 units can be over-declared to 63 units to obtain a reduced total transportation cost.

Once all the indifference points are found, actual freight rates are calculated as they are presented in Table 1. These rates alternate between ranges of a constant charge per unit followed by a fixed charge. The fixed charge is the result of over-declaring a LTL shipment to the next LTL transportation range. A graphical representation of actual freight rates is presented in Fig. 4
                     . Notice that although this function is continuous, it is non-differentiable due to the break and indifference points. Natarajan (2007) states that, when actual freight rates are incorporated into analytical models, two problems may arise. First, the determination of the exact rates between every origin and destination can become time consuming and expensive. Second, given that freight rates are function of the volume shipped, transportation cost functions are generally step functions. For similar reasons, several researchers have proposed the use of continuous functions to estimate actual freight rates that are also differentiable. In this direction, Section 4 presents two continuous functions that can be used to incorporate transportation costs in model (P1).

Since the actual LTL transportation cost functions are piecewise linear and non-concave, power and quadratic functions are used to estimate the transportation costs. Both approximation functions are concave and differentiable.


                        Tyworth and Ruiz-Torres (2000) recommend the use of a power approximation function to model the LTL transportation mode. In this case, the unit shipment cost is approximated as a function of the order quantity q:
                           
                              (22)
                              
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 q
                                 )
                                 =
                                 a
                                 (
                                 q
                                 
                                    
                                       )
                                    
                                    
                                       b
                                    
                                 
                                 ,
                              
                           
                        where a
                        >0 and −1<
                        b
                        <0 correspond to the coefficients of the nonlinear regression function. However, as indicated by Ventura and Mendoza (2008), given that Eq. (22) can also be represented by Eq. (23), the coefficients a and b can be easily found by fitting a simple linear regression model.
                           
                              (23)
                              
                                 ln
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 q
                                 )
                                 )
                                 =
                                 ln
                                 (
                                 a
                                 )
                                 +
                                 b
                                 
                                 ln
                                 (
                                 q
                                 )
                                 .
                              
                           
                        Notice that in the all-unit discount strategy, the unit transportation cost decreases as the number of units increases. Thus, F
                        
                           p
                        (q) is a strictly decreasing function for q
                        ⩾0. Furthermore, since the transportation cost can be calculated by multiplying the number of transported units by the corresponding unit cost, the resulting transportation cost function, q
                        ·
                        F
                        
                           p
                        (q), will be concave.

As an alternative method, our experimental results have shown that a simple quadratic approximation function can also be used to estimate the freight rates for the LTL transportation mode as a function of the order quantity q:
                           
                              (24)
                              
                                 
                                    
                                       F
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 q
                                 )
                                 =
                                 a
                                 +
                                 bq
                                 +
                                 
                                    
                                       cq
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where a
                        >0, b
                        >0, and c
                        ⩾0 correspond to the coefficients of the linear regression function. Using the actual freight rates presented in Table 1, the total transportation cost functions generated from the unit cost power and quadratic approximation functions are plotted in Fig. 5
                        . Both functions are simultaneously plotted to allow a graphical comparison with the actual freight cost. A simple inspection of Fig. 5 clearly shows that the quadratic function provides a better approximation of the actual freight costs than the traditional power function.

Considering the nonlinear characteristics of the power and quadratic approximation functions, modeling transportation costs through any of these two alternatives makes Model (P1) nonlinear. In addition, since economies of scale are assumed for transportations costs, both approximation functions are concave. Thus, when the remaining components of the objective function are represented by linear functions, as shown by sets of Eqs. (15)–(19), Model (P1) consists of a concave objective function and linear constraints, which is a well known NP-hard problem (Benson, 1995; Pardalos and Schnitger, 1988). In this type of problems, even in seemly simple cases, there can be an exponential number of local minima, making the problem computationally difficult to solve to optimality (Horst et al., 2000). Moreover, given that transportation costs are estimates of the actual costs, it cannot be guaranteed that the optimal solution of Model (P1) will be the same than the optimal solution for the original problem. Thus, in this section, an MILP version of Model (P1) is presented, where purchasing, production, inventory holding, in-transit inventory are assumed to be linear and represented by Eqs. (15)–(19). In addition, transportation costs are represented by exact piecewise linear functions, as shown in Fig. 6
                     .

Let 
                        
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                           
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       0
                                       j
                                    
                                 
                              
                           
                           }
                        
                      be the set of freight ranges of the transportation cost function from supplier j to stage 1. Similarly, let 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           }
                        
                      be the set of freight ranges for the transportation cost between stages k and k
                     +1. Notice that in both cases, freight rates alternate between ranges of a fixed charge followed by a constant charge per unit. Thus, both sets R
                     0j
                      and R
                     
                        k
                      can be partitioned in the respective freight range sets of fixed charge (
                        
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                              
                                 f
                              
                           
                        
                      and 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                              
                                 f
                              
                           
                        
                     ) and constant charge per unit (
                        
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                              
                                 c
                              
                           
                        
                      and 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                              
                                 c
                              
                           
                        
                     ), such that 
                        
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                              
                                 f
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 0
                                 j
                              
                              
                                 c
                              
                           
                        
                      and 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 k
                              
                              
                                 f
                              
                           
                           ∪
                           
                              
                                 R
                              
                              
                                 k
                              
                              
                                 c
                              
                           
                        
                     . Let q
                     
                        r
                      be a flow variable, which assumes the value of the respective replenishment order quantity q, when it falls in transportation range r, and is 0 otherwise. Let β
                     
                        r−1 and β
                     
                        r
                      be the respective lower and upper bounds for range r, and φ
                     
                        r
                      a binary variable denoting whether (φ
                     
                        r
                     
                     =1) or not (φ
                     
                        r
                     
                     =0) the transported volume falls in range r. Notice that β
                     0
                     =0 and 
                        
                           
                              
                                 β
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                      can be set to the maximum shipping capacity. As an illustration, let us consider the transportation cost function in Fig. 6, where β
                     3
                     ⩽
                     q
                     4
                     <
                     β
                     4. In this case φ
                     4
                     =1, and φ
                     
                        r
                     
                     =0 for r
                     =1, 2, 3 and 5. Similarly, q
                     4
                     =
                     q and q
                     
                        r
                     
                     =0, for r
                     =1, 2, 3 and 5.

In order to redefine Model (P1), let 
                        
                           
                              
                                 β
                              
                              
                                 0
                                 j
                              
                              
                                 r
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 0
                                 j
                              
                              
                                 r
                              
                           
                        
                      denote the lower and upper limits for range r on the transportation cost function associated with supplier j. Similarly, let 
                        
                           
                              
                                 β
                              
                              
                                 k
                              
                              
                                 r
                                 -
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 k
                              
                              
                                 r
                              
                           
                        
                      denote the respective lower and upper limits for range r on the cost function associated with transportation from stage k to stage k
                     +1. Thus, following an approach similar to the one developed by Balarkrishnan and Graves (1989), and Simchi-Levi et al. (2005), Model (P1) can be rewritten as an MILP model, according to the following formulation:
                        
                           
                              
                              
                              
                                 
                                    
                                       Additional parameters
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    Fixed charge for the actual freight rate for supplier j when order quantity falls in range r, 
                                          
                                             j
                                             ∈
                                             J
                                             ,
                                             r
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   k
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    Fixed charge for the actual freight rate from stage k to stage k
                                       +1 if order quantity falls in range r, 
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                             r
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    Constant charge per unit for the actual freight rate for supplier j when order quantity falls in range r, 
                                          
                                             j
                                             ∈
                                             J
                                             ,
                                             r
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    Constant charge per unit for the actual freight rate from stage k to stage k
                                       +1 if order quantity falls in range r,
                                          
                                             k
                                             ∈
                                             
                                                
                                                   K
                                                
                                                
                                                   D
                                                
                                             
                                             ,
                                             r
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                                
                                                   c
                                                
                                             
                                          
                                       .
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    
                                       Additional variables
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    1 if the replenishment order quantity (in units of raw material) sent from supplier j to stage 1 in period t falls in transportation range r; 0 otherwise; j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       , r
                                       ∈
                                       R
                                       0j
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    1 if the order quantity (in units) sent from stage k to stage k
                                       +1 in period t falls in transportation range r; 0 otherwise;k
                                       ∈
                                       K
                                       
                                          D
                                       
                                       ∪{n
                                       
                                          K
                                       }, t
                                       ∈
                                       T
                                       
                                          k
                                       , r
                                       ∈
                                       R
                                       
                                          k
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    defined as 
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        when replenishment order quantity (in units of raw material) shipped from supplier j in period t falls in transportation range r; 0 otherwise; j
                                       ∈
                                       J, t
                                       ∈
                                       T
                                       0j
                                       , r
                                       ∈
                                       R
                                       0j
                                       . Notice that 
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   r
                                                   ∈
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         0
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   0
                                                   j
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    defined as 
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                        when replenishment order quantity (in units of finished product) shipped from stage k to stage k
                                       +1 in period t falls in transportation range r; 0 otherwise; k
                                       ∈
                                       K
                                       
                                          D
                                       , t
                                       ∈
                                       T
                                       
                                          k
                                       , r
                                       ∈
                                       R
                                       
                                          k
                                       . Notice that 
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   r
                                                   ∈
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   k
                                                
                                                
                                                   t
                                                   ,
                                                   r
                                                
                                             
                                          
                                       .
                                 
                              
                           
                        
                     
                  

(P2)
                        
                           (25)
                           
                              Minimize
                              
                              Z
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                R
                                             
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             t
                                             ,
                                             r
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             oj
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             K
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    k
                                    +
                                    1
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             0
                                             j
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             K
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    k
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             K
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                           
                        
                     subject to
                        
                           (2-14)
                           
                              Sets of constraints
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩽
                              0
                              ,
                              
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (27)
                           
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    r
                                    -
                                    1
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩾
                              0
                              ,
                              
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (28)
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩽
                              0
                              ,
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (29)
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              -
                              
                                 
                                    β
                                 
                                 
                                    k
                                 
                                 
                                    r
                                    -
                                    1
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩾
                              0
                              ,
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (30)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             0
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩽
                              1
                              ,
                              
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩽
                              1
                              ,
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (32)
                           
                              
                                 
                                    q
                                 
                                 
                                    0
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              j
                              ∈
                              J
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    0
                                    j
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (33)
                           
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    ,
                                    r
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              k
                              ∈
                              
                                 
                                    K
                                 
                                 
                                    D
                                 
                              
                              ,
                              t
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                              ,
                              r
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    k
                                 
                              
                              ,
                           
                        
                     The objective function in Eq. (25) represents the total variable cost function which includes purchasing, production, inventory holding, in-transit inventory and transportation costs. Replenishment order quantity variables are disaggregated according to the freight ranges. Transportation cost functions are represented by piecewise linear functions, where freight rates alternate between ranges of constant charge per unit, followed by a fixed charge. Notice that sets of Eqs. (15)–(19) are used to define purchasing, production, inventory holding and in-transit inventory cost functions in the objective function. Sets of constraints (2)–(14) are defined as in Model (P1), except that order quantities are disaggregated: 
                        
                           
                              
                                 q
                              
                              
                                 0
                                 j
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       0
                                       j
                                    
                                 
                              
                           
                           
                              
                                 q
                              
                              
                                 1
                                 j
                              
                              
                                 t
                                 ,
                                 r
                              
                           
                        
                      and 
                        
                           
                              
                                 y
                              
                              
                                 k
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           
                              
                                 y
                              
                              
                                 k
                              
                              
                                 t
                                 ,
                                 r
                              
                           
                        
                     . Sets of constraints (26)–(29) guarantee that the order quantities fall in the corresponding freight range. Sets of constraints (30) and (31) assure that at most one freight range is active for each order quantity. Finally, sets of constraints (32) and (33) describe the nature of the variables considered in the model.

In this section, a three stage serial supply chain example with three suppliers and six time periods is presented and analyzed. Similar to Ghodsypour and O’Brien (2001), and Mendoza and Ventura (2010), linear functions are defined for purchasing, production, and holding costs. Three alternative functions are considered to model the LTL transportation costs. In the first case, transportation costs are modeled with a piecewise linear function, which enables an exact representation of the actual costs in the MILP model. In the other two cases, transportation costs are modeled using power and quadratic approximation functions, which are estimates of the actual transportation costs. Thus, Model (P2) is used as benchmark to measure the performance of the transportation cost approximations in Model (P1).

The illustrative example includes three potential suppliers, one manufacturer and one DC. While raw materials can only be stocked at the manufacturing stage, finished products can be stored at both the manufacturing and distribution stages. Zero delivery lead times are assumed for all stages and suppliers. Consequently, products arrive in the same time period in which they are ordered. No initial and ending inventories are considered for the problem, and neither pending orders. The minimum acceptable perfect rate for raw materials is assumed to be a
                     =0.95. Thus, 95% of the mix of raw materials purchased at each period need to be of acceptable quality.

At the supplier level, it is assumed that the three suppliers have been already screened from a larger set of potential suppliers. This selection could have been done using the Analytical Hierarchy Process, as suggested by Mendoza et al. (2008), or following any other suitable method. The transportation costs structures used in this example are similar to those considered by Swenseth and Godfrey (2002), Natarajan (2007), and Ventura and Mendoza (2008). Nominal and actual freight rates for suppliers 1, 2 and 3 are provided in Tables 1, 7 and 8, respectively (see Section 3 and Appendix A). Similarly, freight information is also provided for interplant transportation (manufacturing facility to DC) in Table 9. From the graphical representation of the respective LTL cost functions (see Fig. 7
                     ), it is possible to observe that while supplier 2 has the most expensive transportation cost, interplant shipments happen to use the less expensive route.

Even though it is assumed that all the suppliers may be potentially selected to procure raw materials, they do not necessarily have the same characteristics in terms of ordering costs, perfect rate, and capacity (see Table 2
                     ). For instance, note that although supplier 1 has the lowest setup and variable costs, considering that its perfect rate is below the minimum acceptable rate, it can only be selected as part of a mix with the other two suppliers. In contrast, even if supplier 2 has lower fixed and variable ordering costs than supplier 3, in an optimal solution this advantage could be offset by higher transportation costs associated with the other two alternatives (see Fig. 7).

The analysis was performed over a 6 period planning horizon with time varying customer demand (see Table 3
                     ). Capacity constraints were only considered at the production stage, where the capacity was assumed to be fixed for the entire planning horizon. Given the anticipated inflation expected in the second half of the planning horizon, production and DC setup costs were accordingly increased. Furthermore, as a result of seasonality factors, variable production costs were increased for periods 3 and 4. Inventory holding costs were considered constant throughout the entire planning horizon, only depending on the stage and product characteristic (raw material or finished product).

Based on the information about actual freight rates for suppliers and interplant transportation, power and quadratic freight approximation functions were fitted using Minitab version 15 (MINITAB, 2009). The results are provided in Table 4
                     . Notice that most of the coefficients of determination (R
                     2) are greater than 0.94, with the only exception of the power estimate function for supplier 2. Considering the values of R2, the quadratic function always provides the best fit for the actual freight rates.

Similar to the display of transportation cost functions for supplier 1 presented in Fig. 7, graphical comparisons of power and quadratic estimate functions against the actual freight rates for suppliers 2 and 3, and interplant transportation are provided in Fig. 8 (see Appendix B). Even though both estimate functions show to be good approximations of the actual freight rates, the power function appears to be less accurate than the quadratic function. That observation is particularly apparent for shipment sizes above 2000 units, where the power function overestimates the actual freight rates. In both cases, the major estimation errors are produced for shipment sizes between 400 and 2000 units.

The illustrative example was implemented on GAMS 21.7 (Rosenthal, 2007) on a Pentium 4 with 3.40gigahertz and 1gigabytes of RAM. The MILP model was solved using CPLEX 11.0 provided by GAMS. A maximum allowed gap of 0.001% between the LP relaxation and the optimal integer solution was defined as stopping criteria for the branch and bound algorithm. The MINLP models generated by the power and quadratic approximation functions were solved using the DICOPT algorithm also provided by GAMS. The maximum CPU time to solve all the instances of the illustrative example was less than 5seconds.

Fourteen different cost scenarios were analyzed, in order to capture the effect of holding and production/distribution setup costs over raw material supply decisions. A summary of the results for the different scenarios is shown in Table 5
                     , where changes in cost parameters are expressed as percentage of their respective original values. Considering the inverse effect of setup and inventory holding costs on order quantities, in order to avoid the neutralization result of these two parameters, when holding costs were increased, setup costs were either maintained or decreased. Similarly, when holding costs were decreased, setup costs were maintained or increased.

The illustrative example was solved using three alternative formulations, two MINLP models, where transportation cost were approximated through power and quadratic transportation cost functions, and an MILP model, where transportation costs were represented by an exact piecewise linear function. After the three alternative model formulations were solved for each instance of the problem, transportation costs were recalculated for the two optimal MINLP solutions using the actual freight rates defined for the problem. The optimal solutions for the MILP model and the two updated solutions for the MINLP models are provided in columns 5–7 of Table 5. In addition, transportation cost errors for the power and quadratic functions were calculated as the percentage deviation from the actual transportation costs for the fourteen cost scenarios. These results, given in the last two columns of the table, indicate that the power estimate function systematically underestimates the actual transportation cost, and the quadratic estimate function overestimates the actual freight costs. The averages of the absolute transportation cost errors for the power and quadratic estimate functions are respectively 3.1% and 2.2%. Consequently, the apparently better fitting shown by the quadratic estimate function over the power estimate function (see R
                     2 in Table 4) was ratified when the functions were implemented into the MINLP model.

Given that the optimal solution of the MILP model is the benchmark solution for the problem, the gap of a solution obtained from the MINLP model using a transportation cost approximation function is equal to the difference between the optimal objective function values of the MINLP and MILP models. The gaps for the power and quadratic estimate functions for the fourteen cost scenarios, written as a percentage of the optimal MILP solutions, are given in columns 8 and 9 of Table 5. Note that, in almost all the cases, the gap observed with the quadratic approximation model is substantially lower than the gap obtained with the power approximation model. In fact, the average gap obtained with the power function is more than twice larger than the average gap observed with the quadratic approximation model (1.2% vs. 0.5%). As it was expected, both alternatives models did not reach the global optimal solutions as a consequence of the inaccuracy associated with the estimation of the actual freight costs.

Under the original cost structure (scenario 1, Table 6
                     ), the optimal solution for the MILP model allocated approximately 42% of the total purchased raw material (3200 of 7500 units) to supplier 3. This situation can be explained by the relative low transportation cost of this supplier for medium lot size orders (see Fig. 7), which compensates its relatively high ordering cost. It was also ratified that changes on holding and setup costs may affect the optimal sourcing strategy for the problem. In fact, that situation was observed for all three models, where the optimal raw material order policy changed depending of the inventory holding and setup cost scenario. Even though, the MILP model solution provided the most stable raw material sourcing strategy (among the fourteen scenarios), the original solution was also affected when holding and set up costs were changed (see Table 6). In the optimal solution for the MILP model, when holding costs were reduced (scenarios 2, 5, 6, 8 and 13), the total number of orders was decreased and consequently the average raw material lot size was increased (see Table 6, column b). In this case, the reduction in holding costs triggered a reduction of the number of orders and as a result a decrease in total raw material set up cost. In contrast, changes in production and distribution set up cost affected the decisions related with order allocation by supplier. In particular, when setup costs were reduced (scenarios 10, 11, 12 and 14), the volume allocated to supplier 3 was increased in the optimal solution for the MILP model. In addition, raw material was ordered in every period under consideration (see Table 6, column a), enabling the reduction production and distribution lot sizes, and consequently the respective holding costs. Even though it may appear that production and distribution lot sizing decisions are unrelated to the raw material ordering policy, the selection of suppliers was affected by changes in production/distribution lot size orders. In fact, given the acceptable perfect rate and low transportation cost of supplier 3, this supplier was preferred under a scenario of small production/distribution lot sizes. On the other hand, due to the relative high transportation cost of supplier 2, this supplier was not a competitive alternative when lot sizes were reduced. Finally, given that the perfect rate of supplier 1 is lower than the minimum acceptable rate for the problem, this supplier could only be selected in combination with any of the other two suppliers; however, this strategy was competitive under a scenario of reduced production/distribution lot size orders.

@&#CONCLUSIONS@&#

In this research work, alternative mathematical programming formulations have been developed for the dynamic inventory problem with supplier selection in a serial supply chain. Particular attention has been given to the analysis of the characteristic of the (time-expanded) static network to identify unreachable arcs and nodes that can be eliminated from the network in order to reduce the size of the problem.

Considering the all-units quantity discount structure of the actual transportation costs, power and quadratic functions have been used to approximate the actual costs in the proposed MINLP model. These approximations have been used because the actual costs are piecewise linear and non-concave. However, given the inaccuracies and increased complexities that these estimate functions introduce into the model, an exact piecewise linear formulation has also been developed and incorporated into an MILP model. Our results show that the transportation cost approximations may lead to suboptimal solutions for the problem. In particular, power and quadratic functions produced average transportation cost errors of 3.1% and 2.2% in relation to the actual transportation costs for their respective optimal solutions. Similarly, when the optimal solutions for the power and quadratic functions are compared with the optimal solution obtained with the MILP model (piecewise linear approximation), average solution gaps of 1.2% and 0.5% are obtained. Consequently, when the estimated functions are used for the transportation costs under an all-unit discount structure, the analyst needs to be aware of potential solution gaps that cannot be easily detected without an alternative exact model formulation.

According to our results, inventory holding and production/distribution setup costs seem to have a significant impact on raw material supplier selection and order lot sizing decisions. Even though these parameters may not appear directly related with raw material supplier decisions, the analysis of fourteen different cost scenarios show that they play an important role in the optimal sourcing policy. These results demonstrate the need to develop integrated models to correctly minimize the total cost of the entire supply chain network.

Considering that the current analysis has been performed for a single product problem, a natural extension of the current research is to extend the proposed models to a multi-product setting. In particular, it could be important to consider additional economies of scale provided by joint replenishment and transportation costs. Finally, considering that uncertainty is a common factor in most of the actual production environments, it could be highly useful to evaluate the impact of uncertainty in some of the relevant parameters of the model.

@&#ACKNOWLEDGEMENTS@&#

This research has been partially funded by a grant from the Penn State/Technion Marcus Funds. The authors are grateful to the two anonymous referees for their useful and constructive comments and suggestions.

See Tables 7–9
                     
                     
                     .

See Fig. 8
                     .

@&#REFERENCES@&#

