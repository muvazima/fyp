@&#MAIN-TITLE@&#Spline-based meshfree method with extended basis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Extension is performed to stabilize the basis of spline-based meshfree method.


                        
                        
                           
                           Nitsche's method was employed to impose essential boundary conditions.


                        
                        
                           
                           The validity of the proposed method was proved by error analysis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spline-based meshfree method

WEB-spline

Extended B-spline

Isogeometric analysis

NURBS

@&#ABSTRACT@&#


               
               
                  In this work, an extension has been performed on the analysis basis of spline-based meshfree method (SBMFM) to stabilize its solution. The potential weakness of the SBMFM is its numerical instability from using regular grid background mesh. That is, if an extremely small trimmed element is produced by the trimming curves that represent boundaries of the analysis domain, it can induce an excessively large condition number in global system matrix. To resolve the instability problem, the extension technique of the weighted extended B-spline (WEB-spline) is implemented in the SBMFM. The basis functions with very small trimmed supports are extrapolated by neighboring basis functions with some special scheme so that those basis functions can be condensed in the solution process. In order to impose essential boundary conditions in the SBMFM with extended basis, Nitsche's method is implemented. Using numerical examples, the presented SBMFM with extended basis is shown to be valid and effective. Moreover, the condition number of the system is well-managed guaranteeing the stability of the numerical analysis.
               
            

@&#INTRODUCTION@&#

Many researchers have exercised a great deal of effort towards reducing the computational costs of creating analysis models from Computer Aided Design (CAD) models. Some researchers focused on achieving an efficient framework for computational simulation by unifying the basis functions involved through the simulation. Kagan et al. proposed an integrated mechanically-based CAE system (Kagan et al., 1998, 2003; Kagan and Fischer, 2000). Natekar et al. (2004) introduced constructive solid analysis based on the Constructive Solid Geometry (CSG) technique. They employed the partition of unity-based approximation to deal with the overlapping regions. Recently, Hughes et al. (2005), Cottrell et al. (2009) proposed an isogeometric analysis framework that integrates CAD and Finite Element (FE) analysis. So far, Non-Uniform Rational B-spline (NURBS) is mainly employed in isogeometric analysis since NURBS has been widely used as the basis function in CAD (Hughes et al., 2005; Cottrell et al., 2009). Using the same basis function of NURBS in FE analysis, the mesh generated in the CAD system can be used directly, and geometries are exactly preserved throughout the analysis. Moreover, the NURBS basis function has a controllable high continuity (higher than 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     ) across element boundaries (Cottrell et al., 2007), and is more robust regarding mesh distortion (Lipton et al., 2010). Due to the various advantages that NURBS provides, isogeometric analysis is implemented in various fields of computational mechanics, including structural vibration (Cottrell et al., 2006), fluid–structure interaction (Bazilevs et al., 2008), shape and topology optimization (Seo et al., 2010a, 2010b; Ha et al., 2010; Wall et al., 2008), shell structure analysis (Uhm and Youn, 2009; Kiendl et al., 2009; Nguyen-Thanh et al., 2011; Benson et al., 2010), and contacts (Temizer et al., 2011, 2012; J.-Y. Kim and S.-K. Youn, 2012; Lu, 2011).

For the seamless integration of CAD systems and NURBS-based isogeometric analysis, Kim et al. introduced trimmed surface analysis (Kim et al., 2009, 2010). The trimmed surface analysis in an isogeometric analysis framework, directly utilized trimming information imported from the CAD system, and has been successfully applied to problems involving complex topologies. Exploiting the concept of trimmed surface analysis, Kim and Youn introduced the spline-based meshfree method (SBMFM) (H.-J. Kim and S.-K. Youn, 2012). The point of this method was to build an analysis domain by trimming operations so that the boundaries are represented by trimming curves only in a single NURBS patch (in two-dimensional cases). By doing so, the NURBS patch is employed as a background mesh. Unlike conventional meshfree methods, the SBMFM has no ambiguity for constructing basis functions and for describing domain boundaries. The basis function for analysis is readily constructed using the NURBS background mesh. Above all, domain boundaries are easily constructed using the trimming operations. The SBMFM has been applied to geometrically nonlinear problems and demonstrated its effectiveness.

There is a numerical method that similarly employs a spline background mesh: weighted extended B-splines (WEB-splines) proposed by Höllig et al. (2001, 2005), Höllig and Reif (2003), Höllig (2003). The good characteristic of the WEB-splines is its well-conditioned system matrix. In Fig. 1
                     , the box indicates one of the elements with a very small area. This element can cause numerical instability due to the large condition number of the global system matrix. That is, a relatively small contribution to the global system matrix amplifies the condition number of the system. This is a chronic problem of methods with a structured background mesh, such as immersed (or embedded) boundary method (Peskin, 1972, 2002), fictitious domain method (Glowinski et al., 1994) and immersed B-spline techniques (Embar et al., 2010; Schillinger and Rank, 2011; Sanches et al., 2011; Rank et al., 2012; Rüberg and Cirak, 2012); that have becoming popular recently in conjunction with isogeometric analysis. Generally, a large condition number is to be avoided since this induces a highly sensitive numerical solution. Also, when iterative solvers are used, a numerical solution can be inaccurate showing a slow convergence. To resolve this problem, in the WEB-splines, the basis function whose contribution is relatively small is merged with neighboring basis functions, i.e., the neighboring basis functions are extended. As a consequence, a solution field is represented by extended basis functions whose contribution is not so small, and the condition number of the global system matrix is stabilized; preserving an optimal approximation order when smooth weight function is used (Höllig et al., 2001, 2005; Höllig and Reif, 2003; Höllig, 2003).

In the SBMFM, it is highly probable that trimmed elements with very small areas can exist as WEB-splines. Thus, if we can extend the basis function in the SBMFM, the analysis will be more robust numerically. In this work, the extension of WEB-splines was adopted to stabilize the SBMFM. The proposed approach will be named ‘extended SBMFM’ which is SBMFM with extended analysis basis.

The difference between the WEB-splines and extended SBMFM is that extended SBMFM does not employ weight functions to describe the analysis domain boundary; whereas the extended SBMFM employs trimming information imported from the CAD system to describe the analysis domain boundary. As a consequence, a different scheme for imposing essential boundary conditions should be considered for the extended SBMFM, where basis functions do not vanish outside the analysis domain due to a non-weighted spline space of the extended SBMFM. In this work, Nitsche's method is employed and it will be discussed in Section 3.2.

The remainder of this paper is organized as follows. In Section 2, the basics of B-splines and NURBS will be briefly reviewed and trimmed surface analysis will be introduced. In Section 3, the extension process will be introduced and the essential boundary condition imposition scheme, which is appropriate for extended SBMFM, will be discussed. In Section 4, the validity of the extended SBMFM will be illustrated using verification examples. Finally, conclusions and future work will be discussed in Section 5.

In this work, a recurrence formula will be employed to construct the B-spline basis functions (Piegl and Tiller, 1997). A non-decreasing sequence of real numbers U is the only information we need in order to construct B-spline basis functions.
                           
                              (1)
                              
                                 U
                                 =
                                 {
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 
                                 ⋯
                                 
                                 
                                    
                                       u
                                    
                                    
                                       n
                                       +
                                       p
                                    
                                 
                                 }
                                 .
                              
                           
                         In Eq. (1), U is the knot vector, and each component of U is called a knot. The number of control points is n; while p is the degree of B-spline basis functions. If the intervals between knots are equal, the knot vector is labeled uniform. If the intervals are not equal, it is a non-uniform knot vector. Moreover, the knot vector is said to be open if its first and last knots have multiplicities of 
                           p
                           +
                           1
                        ; in all other cases, it is said to be closed.

The 
                           i
                           th
                         B-spline basis function of the 
                           p
                           th
                        -degree, denoted as 
                           
                              
                                 N
                              
                              
                                 i
                                 ,
                                 p
                              
                           
                           (
                           u
                           )
                        , is defined as
                           
                              (2)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if 
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             ⩽
                                             u
                                             <
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       p
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       p
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             p
                                             +
                                             1
                                          
                                       
                                       −
                                       u
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             p
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       p
                                       −
                                       1
                                    
                                 
                                 (
                                 u
                                 )
                                 .
                              
                           
                         The characteristics of the B-spline basis functions are:
                           
                              (1)
                              
                                 Partition of unity: 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    1
                                 .


                                 Non-negative basis functions: 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    (
                                    u
                                    )
                                    ⩾
                                    0
                                 .


                                 Local support in the interval: 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    (
                                    u
                                    )
                                    =
                                    0
                                 , if u is not in the interval [
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          i
                                          +
                                          p
                                          +
                                          1
                                       
                                    
                                 ).


                                 Higher order continuity: 
                                    
                                       
                                          C
                                       
                                       
                                          p
                                          −
                                          k
                                       
                                    
                                  continuous, where k is the multiplicity of the knot.

B-spline curves are defined as linear combinations of coordinates of control points and their basis functions,
                           
                              (4)
                              
                                 C
                                 (
                                 u
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       p
                                    
                                 
                                 (
                                 u
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                         is the coordinate of the control point and 
                           
                              
                                 N
                              
                              
                                 i
                                 ,
                                 p
                              
                           
                           (
                           u
                           )
                         the corresponding B-spline basis function.

Similarly, B-spline surfaces are defined as follows,
                           
                              (5)
                              
                                 S
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    n
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    m
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                       ,
                                       p
                                    
                                 
                                 (
                                 s
                                 )
                                 
                                    
                                       N
                                    
                                    
                                       j
                                       ,
                                       q
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 .
                              
                           
                         
                        NURBS is a generalized form of B-spline. Its knot vector is non-uniform, and the basis function is a rational form that can be controlled by the weight of each control point. Therefore, shape control can be done with both control point coordinates and weight values. NURBS basis function, denoted as 
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 p
                              
                           
                           (
                           u
                           )
                        , is defined as:
                           
                              (6)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       ,
                                       p
                                    
                                 
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                             ,
                                             p
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             j
                                             ,
                                             p
                                          
                                       
                                       (
                                       u
                                       )
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         is the weight of each control point. NURBS curves and surfaces are constructed in the same way; the only difference is that B-spline basis functions are replaced by rational B-spline basis functions.

Due to the tensor product nature of NURBS, multiple patches are needed to model the body of arbitrary topologies and this is a very cumbersome task. In the CAD system, a simple and convenient modeling scheme, the trimming technique, has been widely used to model bodies with complex topologies. The trimming technique requires a minimum number of patches, and represents complex topologies by cutting-off unnecessary regions from existing patches. Since the conventional NURBS-based isogeometric analysis could not handle the trimming information created in the CAD system, the remodeling process should be accompanied going against to the spirit of isogeometric analysis. In Fig. 2
                        , an example of the inefficient remodeling process for NURBS-based isogeometric analysis is shown. When we model the geometry in Fig. 2, it is more natural to perform the modeling by employing the trimming technique as in Fig. 2(a). However, in the conventional NURBS-based isogeometric analysis, the inefficient remodeling process (the conversion process into multiple patches) should be done to eliminate the trimming information as in Fig. 2(b).

To remedy the inefficiency of the conventional NURBS-based isogeometric analysis, the trimmed surface analysis (Kim et al., 2009, 2010) is proposed. In this method, the trimmed surface information created in the CAD software is directly imported and utilized in a numerical analysis. A brief introduction to trimmed surface analysis is presented here with a simple example. More details are available in Kim et al. (2009, 2010).

For the analysis domain shown in Fig. 3
                        , the trimmed elements, marked with shading, are searched first. After that, the trimmed elements are classified into three groups by checking the number of their vertices included in the void region. Various trimmed elements can be decomposed into triangular cells and triangular cells with one NURBS curve, as shown in Fig. 4
                        . For the integration of triangular cells with one NURBS curve, the numerical integration can be done exactly by employing a NURBS-enhanced integration scheme (Sevilla et al., 2008). For normal triangular cells, and non-trimmed elements, numerical integration can be done with the conventional NURBS-based isogeometric analysis scheme that employs general Gaussian quadrature rules. If the trimmed element does not belong to the types illustrated in Fig. 4, a quad-tree refinement is carried out until all the sub-cells belong to the types in Fig. 4. Consequently, the numerical integration of the whole analysis domain is possible.

Based on the trimmed surface analysis, H.-J. Kim and S.-K.Youn (2012) introduced the spline-based meshfree method (SBMFM). In the SBMFM, the domain boundaries are represented by trimming curves only. The main concepts of SBMFM, as shown in Fig. 5
                        , are that the NURBS surface is employed as a background mesh, and the trimming curves can move freely with complete independence from the background mesh (NURBS surface). If the described concept is implemented as a solution strategy for nonlinear problems which require iterative analysis with consecutive geometry update, mesh distortion problems can be effectively circumvented due to the independent behavior of the boundary trimming curves.

The SBMFM inherits the advantages of isogeometric analysis and meshfree method. The aspects of SBMFM can be summarized as follows:
                           
                              •
                              No ambiguity in representation of geometry: The geometry of the analysis domain is explicitly represented by the trimming curves while the conventional NURBS-based isogeometric analysis describes an analysis domain by the patch boundaries of NURBS surface. Moreover, in contrast to classical meshfree methods, smooth or sharp geometries can be exactly represented and DOFs are not to be aligned along the analysis domain boundaries.

No ambiguity in basis function construction: The basis functions of SBMFM are readily constructed by spline basis functions. No additional stabilization parameters or schemes are required due to the properties of the spline basis functions.

CAD friendly format: The analysis model in SBMFM is created in the CAD system by trimming operations and directly imported to SBMFM. Therefore, SBMFM is compatible with CAD systems.

In this section, the formulation of SBMFM with extended basis will be described by employing the extension concept of non-uniform WEB-splines (Höllig and Reif, 2003). Throughout the formulation, the following Poisson problem will be considered.
                           
                              (7)
                              
                                 
                                    
                                       
                                          −
                                          Δ
                                          u
                                          =
                                          f
                                       
                                       
                                          in 
                                          Ω
                                       
                                    
                                    
                                       
                                          u
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          on 
                                          
                                             
                                                Γ
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∇
                                          u
                                          ⋅
                                          n
                                          =
                                          
                                             
                                                g
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          on 
                                          
                                             
                                                Γ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where Ω is the analysis domain, 
                           
                              
                                 Γ
                              
                              
                                 d
                              
                           
                         the domain boundary with the Dirichlet boundary condition and 
                           
                              
                                 Γ
                              
                              
                                 n
                              
                           
                         the domain boundary with the Neumann boundary condition. The solution for the problem in Eq. (7) is approximated as Eq. (8).
                           
                              (8)
                              
                                 u
                                 (
                                 x
                                 )
                                 ≈
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         In Eq. (8), 
                           u
                           (
                           x
                           )
                         refers to the field that we want to approximate, while 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           (
                           x
                           )
                         refers to the numerical solution field approximated with linear combination of basis functions and its coefficients. For example, a displacement field will be approximated with spline basis functions and displacements of control points. The subscript k means whole the basis functions used in the numerical solution. Next, for the basis extension process, the basis functions of k will be classified into inner basis functions (
                           i
                           ∈
                           I
                        ) and outer basis functions (
                           j
                           ∈
                           J
                        ). Therefore, the union of inner basis functions and outer basis functions is the whole basis function set.
                           
                              (9)
                              
                                 K
                                 ≡
                                 I
                                 ∪
                                 J
                                 .
                              
                           
                         The classification criterion is simple. If only trimmed elements are contained in local support of a basis function, it is an outer basis function; otherwise it is an inner basis function.

In Fig. 6
                        , the classification of inner and outer basis functions is illustrated. For the conceptual explanation, the lower left corners of the local support of basis functions are marked with dots and circles and they represent the basis functions. The local supports of some basis functions are illustrated as a shaded region (quadratic basis functions have 3-by-3 knot spans as local support). As shown in Fig. 6, all the basis functions are classified into inner and outer basis functions. As a consequence, Eq. (8) can be rewritten as:
                           
                              (10)
                              
                                 u
                                 (
                                 x
                                 )
                                 ≈
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                         In Eq. (10), the numerical solution field is now separated by inner basis functions parts and outer basis function parts. The concept of the extension in WEB-spline is to merge the basis function of small support (outer basis functions) with neighboring basis functions (inner basis functions). Therefore, the extension process is to relate the outer basis functions parts to inner basis functions parts with some representation process of the outer basis function part. After the extension, the numerical solution field (Eq. (10)) can be expressed with the inner basis function parts only as Eq. (11).
                           
                              (11)
                              
                                 u
                                 (
                                 x
                                 )
                                 ≈
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    [
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    x
                                    )
                                    ]
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 x
                                 )
                                 .
                              
                           
                        
                     

The extended basis function (
                           
                              
                                 R
                              
                              
                                 i
                              
                              
                                 e
                              
                           
                        ) is now defined in Eq. (12). Therefore, if we can compute appropriate extension coefficients (
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        ), the numerical solution field can be expressed with extended inner basis function parts, so that we can acquire a stabilized, well-conditioned analysis basis.


                        Höllig et al. (2001, 2003) introduced a method to compute the extension coefficient for uniform spline basis functions as well as non-uniform spline basis functions (Höllig and Reif, 2003). Since the CAD system exports the trimmed surface information in non-uniform spline basis functions, employing the extension process for non-uniform extension is a more appropriate approach. For the computation of the extension coefficient, we follow the procedures introduced in Höllig and Reif (2003).

Let $ denote a spline space spanned by spline basis functions (
                           span
                           (
                           R
                           )
                        ). The dual functional for the spline basis function, known as de Boor–Fix functional (de Boor and Fix, 1973; de Boor, 2001), is defined as follows, for any 
                           f
                           ∈
                           $
                        ,
                           
                              (13)
                              
                                 f
                                 =
                                 
                                    ∑
                                    k
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 f
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         Where,
                           
                              (14)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 f
                                 ≡
                                 
                                    ∑
                                    
                                       l
                                       =
                                       0
                                    
                                    p
                                 
                                 
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    
                                       p
                                       −
                                       l
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                    
                                       (
                                       p
                                       −
                                       l
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ≡
                                 
                                    1
                                    
                                       p
                                       !
                                    
                                 
                                 
                                    ∏
                                    
                                       l
                                       =
                                       1
                                    
                                    p
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       l
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       p
                                       +
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                         In Eq. (14), 
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                         is the arbitrary point in the local support of the k-th spline basis function as in Eq. (15), 
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                         denotes the k-th component of the knot vector and p is the order of the spline basis function (as in Section 2.1). The superscripts in parentheses denote the degree of differentiation (order of derivatives). Using the information in Eq. (15), we can explicitly compute the value of the functional in Eq. (13). The defined dual functional satisfies a bi-orthogonality property with spline basis functions (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           
                              
                                 R
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        ) (de Boor and Fix, 1973; de Boor, 2001). Therefore, the meaning of Eq. (13) can be interpreted as a reproduction of f with a dual basis, and the bi-orthogonality property of the defined dual functional is still valid for extended basis functions (
                           
                              
                                 R
                              
                              
                                 i
                              
                              
                                 e
                              
                           
                        ) as in Eq. (16) since 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                           =
                           0
                        .
                           
                              (16)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                        
                     

The existence of the dual functional implies linear independence, i.e., extended basis functions form a basis for the spline space $.

Consequently, we can rewrite Eq. (13) with extended basis functions as:
                           
                              (17)
                              
                                 f
                                 =
                                 
                                    ∑
                                    i
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 f
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 f
                                 .
                              
                           
                         Substituting Eq. (11) and interchanging sums, we obtain the following:
                           
                              (18)
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    [
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    [
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 .
                              
                           
                         The outer basis function part of Eq. (18) is equal to 
                           
                              
                                 ∑
                              
                              
                                 j
                                 ∈
                                 J
                              
                           
                           (
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           )
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                        . Therefore,
                           
                              (19)
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

However, in the extension process, the function we want to represent is the outer spline basis function by using the combination of inner basis functions. So, we substitute 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           ⇒
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , where 
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         denotes the inner spline basis function evaluated at the local support of the outer spline basis function. By the bi-orthogonality of the dual functional, the left hand side component of Eq. (19) becomes 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           
                              
                                 R
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           
                              
                                 R
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 i
                                 ,
                                 i
                              
                           
                        . Finally we can acquire the extension coefficient as follows,
                           
                              (20)
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ≡
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 .
                              
                           
                         For multivariate cases, such as surfaces or volumes, extension coefficients can be conveniently computed as products of univariate ones. In Eq. (21), m is ‘2’ for surfaces and m is ‘3’ for volumes.
                           
                              (21)
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    ∏
                                    
                                       ν
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             ν
                                          
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ν
                                          
                                       
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             ν
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In the WEB-splines, essential boundary conditions are automatically satisfied due to weight functions. That is, all the basis functions vanish outside the analysis domain due to its weighted spline space. In the SBMFM; however, the NURBS curves imported from the CAD system describe the analysis domain. Generally, the basis function employed in the extended SBMFM is non-interpolating, i.e., the extended basis functions do not satisfy the Kronecker delta property. Therefore, imposing an essential boundary condition on a trimming curve is not a straightforward process as in conventional FEM. This kind of problem is commonly encountered in meshfree methods that employ non-interpolating basis functions. To impose essential boundary conditions in this situation, there exist two classes of approaches (Fernández-Méndez and Huerta, 2004).
                           
                              1.
                              Modify the basis functions related to essential boundary conditions.

Modify the weak form of the system to satisfy essential boundary conditions.

The first approach modifies the basis functions, i.e., the basis functions related to essential boundary conditions are modified locally to satisfy the Kronecker delta property (Rüberg and Cirak, 2012; Kang and Youn, 2001); or the FEM meshes are coupled at the analysis boundary to impose essential boundary conditions (Krongauz and Belytschko, 1996). Using this approach, essential boundary conditions can be imposed successfully, but consistency of the analysis can be destroyed. Furthermore, this approach goes against the spirit of isogeometric analysis, which is the use of the same basis function in both modeling and analysis. Since the SBMFM inherits the concept of isogeometric analysis, the first approach is not an acceptable choice for a scheme to impose essential boundary conditions.

The second approach modifies the weak form of system. Examples of the second approach are the Lagrange multiplier method, penalty method and Nitsche's method. The Lagrange multiplier method is the most widely used since its implementation is not so complicated and converges well with the optimal rates. In the previous version of SBMFM (H.-J. Kim and S.-K. Youn, 2012) and trimmed surface analysis (Kim et al., 2010), the Lagrange multiplier method was employed to impose essential boundary conditions. There, trimming curve basis functions (univariate NURBS basis functions) were used as the interpolation spaces for the Lagrange multipliers, and the Lagrange multipliers were defined at control points of the trimming curves. The discrete equations of the weak form with Lagrange multiplier can be written as:
                           
                              (22)
                              
                                 
                                    (
                                    
                                       
                                          
                                             K
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          
                                             λ
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          
                                             b
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Matrix K denotes the stiffness matrix, and matrix A denotes the relation between displacement field interpolation space and Lagrange multiplier interpolation space. In the present work, the basis functions are extended, which leads that the basis of the displacement field interpolation space and associated stiffness matrix (K) are extended. For the consistency of the system in Eq. (22), matrix A also shall be extended. Unfortunately, the Lagrange multiplier interpolation space is not extended. Thus, applying the Lagrange multiplier method in the present work is not possible due to the undesirable relation between matrices K and A.

The other choices are the penalty method and Nitsche's method. Both methods are adequate to impose essential boundary conditions in the present method, since they do not introduce new variables to system. The well-known problem of the penalty method is that it uses a large penalization parameter to impose essential boundary conditions, and this magnifies the condition number of the stiffness matrix. That is exactly the opposite effect from the basis function extension process we perform here. Thus, the penalty method is excluded from the candidates for an essential boundary condition imposition method. In the present work, Nitsche's method is employed to impose the essential boundary condition. This method (Nitsche, 1970) is formulated as follows:
                           
                              (23)
                              
                                 
                                    ∫
                                    Ω
                                 
                                 ∇
                                 v
                                 ⋅
                                 ∇
                                 u
                                 
                                 d
                                 Ω
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 v
                                 ∇
                                 u
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 v
                                 f
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          n
                                       
                                    
                                 
                                 v
                                 
                                    
                                       g
                                    
                                    
                                       n
                                    
                                 
                                 n
                                 
                                 d
                                 Γ
                                 .
                              
                           
                         Eq. (23) is the weak form of the model problem Eq. (7), where v is a test function. Note that the second term in LHS is not ignored in Nitsche's method since the test function v does not vanish at the analysis domain boundary. To have a symmetric bi-linear form, we add the term 
                           −
                           
                              
                                 ∫
                              
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       d
                                    
                                 
                              
                           
                           u
                           ∇
                           v
                           ⋅
                           n
                           
                           d
                           Γ
                         in the LHS of Eq. (23):
                           
                              (24)
                              
                                 
                                    ∫
                                    Ω
                                 
                                 ∇
                                 v
                                 ⋅
                                 ∇
                                 u
                                 
                                 d
                                 Ω
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 v
                                 ∇
                                 u
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 u
                                 ∇
                                 v
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 v
                                 f
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          n
                                       
                                    
                                 
                                 v
                                 
                                    
                                       g
                                    
                                    
                                       n
                                    
                                 
                                 n
                                 
                                 d
                                 Γ
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 ∇
                                 v
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 .
                              
                           
                         Now, the bilinear form Eq. (23) becomes symmetric as in Eq. (24). Note that the corresponding term is added to RHS for equilibrium. Next, to make Eq. (24) a symmetric positive-definite bilinear form, the stabilizing (penalizing) term is added to both sides,
                           
                              (25)
                              
                                 
                                    ∫
                                    Ω
                                 
                                 ∇
                                 v
                                 ⋅
                                 ∇
                                 u
                                 
                                 d
                                 Ω
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 v
                                 ∇
                                 u
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 u
                                 ∇
                                 v
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 +
                                 β
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 v
                                 u
                                 
                                 d
                                 Γ
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 v
                                 f
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          n
                                       
                                    
                                 
                                 v
                                 
                                    
                                       g
                                    
                                    
                                       n
                                    
                                 
                                 n
                                 
                                 d
                                 Γ
                                 −
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 ∇
                                 v
                                 ⋅
                                 n
                                 
                                 d
                                 Γ
                                 +
                                 β
                                 
                                    ∫
                                    
                                       
                                          Γ
                                       
                                       
                                          d
                                       
                                    
                                 
                                 v
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 
                                 d
                                 Γ
                                 ,
                              
                           
                         where the β in Eq. (25) is a positive scalar parameter. As in the case of penalty method, the condition number of the system increases with parameter β. However, it is known that not so large a parameter is needed to impose the essential boundary condition in practice (Fernández-Méndez and Huerta, 2004). For the estimation of the minimum value of parameter β, from the work of Gribel et al. (2002), the maximum eigenvalue of the following generalized eigenvalue problem is used.
                           
                              (26)
                              
                                 X
                                 v
                                 =
                                 λ
                                 Y
                                 v
                                 ,
                              
                           
                         where,
                           
                              (27)
                              
                                 
                                    X
                                    =
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                T
                                             
                                          
                                          
                                             DB
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       
                                          DB
                                       
                                       )
                                    
                                    
                                    d
                                    Γ
                                 
                              
                              
                                 
                                    Y
                                    =
                                    
                                       ∫
                                       Ω
                                    
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    
                                       DB
                                    
                                    
                                    d
                                    Ω
                                    .
                                 
                              
                           
                        
                     

The n denotes the normal vector at the analysis domain boundary, B the strain-displacement matrix and D the constitutive matrix. In this work, the generalized problem above is solved element-by-element during the assembly process of global stiffness matrix (Embar et al., 2010). This approach reduces the matrix size of the generalized eigenvalue problem (Eq. (26)) and the parameter can be estimated adaptively at an element level. Therefore, the computation time can be reduced and the condition number of the global stiffness matrix can be minimized. In this work, 3 times the maximum eigenvalue from the generalized eigenvalue problem is used as parameter β.

For natural boundary conditions, they are automatically satisfied by weak solutions, i.e., the trial functions do not have to satisfy any constraints in (25). The imposition of the natural boundary condition only needs multiplication with a test function.

@&#IMPLEMENTATION@&#

For simplicity, the extension process is performed after all the numerical integration is finished. In this regard, the extension process can be considered a condensation and preconditioning procedure (Höllig, 2003). This can be formulated by the following process. We rewrite the extended basis function in Eq. (12) as follows:
                              
                                 (28)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    +
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∑
                                       k
                                    
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                 
                              
                            where,
                              
                                 (29)
                                 
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                for 
                                                k
                                                =
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                             
                                             
                                                for 
                                                k
                                                =
                                                j
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            Let 
                              a
                              (
                              ⋅
                              ,
                              ⋅
                              )
                            be the bilinear form identical to the LHS of Eq. (25), and the subscripts 
                              i
                              ,
                              j
                            and k are defined in Section 3.1. By employing the extended basis function (Eq. (28)) as a test function and trial function respectively, the bilinear form can be rewritten as follows:
                              
                                 (30)
                                 
                                    a
                                    
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             e
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                          
                                             e
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ∑
                                       k
                                    
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    a
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    
                                       
                                          e
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    .
                                 
                              
                           
                        

The extension process can be done with matrix multiplication of the stiffness matrix before extension, and with the extension coefficients matrix.

The weak form of the system (Eq. (25)) can be discretized as follows,
                              
                                 (31)
                                 
                                    
                                       ∫
                                       Ω
                                    
                                    
                                       
                                          B
                                       
                                       
                                          T
                                       
                                    
                                    
                                       DB
                                    
                                    
                                    d
                                    Ω
                                    −
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             T
                                          
                                       
                                       
                                          DB
                                       
                                       )
                                    
                                    
                                    d
                                    Γ
                                    −
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                T
                                             
                                          
                                          
                                             DB
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    R
                                    
                                    d
                                    Γ
                                    +
                                    β
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    R
                                    
                                    d
                                    Γ
                                    =
                                    
                                       ∫
                                       Ω
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    f
                                    
                                    d
                                    Ω
                                    −
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    
                                    d
                                    Γ
                                    −
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                T
                                             
                                          
                                          
                                             DB
                                          
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    
                                    d
                                    Γ
                                    +
                                    β
                                    
                                       ∫
                                       
                                          
                                             Γ
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    
                                    d
                                    Γ
                                    ,
                                 
                              
                            where R is the value of the corresponding basis functions in matrix form.

The following procedure outlines the implementation of the extended SBMFM:
                              
                                 1.
                                 Import the geometry information from the CAD system such as NURBS surfaces and trimming curves.

Perform the global refinement for the background mesh, if necessary.

Classify inner and outer basis functions and compute the extension coefficient matrix.

Perform the domain integration to construct the stiffness matrix. If the element is related to an essential boundary condition, the element stiffness matrix is stored for the generalized eigenvalue problem (Eq. (26)).

Perform the boundary integration to impose essential and natural boundary conditions. If the element is related to the essential boundary condition, the generalized eigenvalue problem in Eq. (26) is solved, and the estimated β is used to compute related matrices.

Construct the global stiffness matrix after the whole domain and boundary integration with the assembly process. The condensation process is performed using the extension coefficient matrix calculated in step 3. The condensation process is also performed on a load vector (RHS of Eq. (31)).

Solve the condensed problem, and post-processing is carried out using the extended basis functions.

The validity of the present method will be examined with verification examples. The convergence behavior will be tested using a numerical example with an exact solution. The present method also will be applied to an example with a little bit complicated topology imported from the CAD system, and the condition number of the stiffness matrix will be compared with that of conventional SBMFM.

The exact solution for an infinite plate with a hole is given as,
                           
                              (32)
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          r
                                          r
                                       
                                    
                                    (
                                    r
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       T
                                       2
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             T
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       1
                                       −
                                       4
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                       +
                                       3
                                       
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                4
                                             
                                          
                                       
                                       )
                                    
                                    cos
                                    2
                                    θ
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          θ
                                          θ
                                       
                                    
                                    (
                                    r
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       T
                                       2
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          
                                             T
                                          
                                          
                                             x
                                          
                                       
                                       2
                                    
                                    
                                       (
                                       1
                                       +
                                       3
                                       
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                4
                                             
                                          
                                       
                                       )
                                    
                                    cos
                                    2
                                    θ
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          r
                                          θ
                                       
                                    
                                    (
                                    r
                                    ,
                                    θ
                                    )
                                    =
                                    −
                                    
                                       T
                                       2
                                    
                                    
                                       (
                                       1
                                       +
                                       2
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                       −
                                       3
                                       
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                4
                                             
                                          
                                       
                                       )
                                    
                                    sin
                                    2
                                    θ
                                    ,
                                 
                              
                           
                         where, a denotes the radius of a hole centered at origin, and T the magnitude of a constant tension imposed at infinity as in Fig. 7
                        . In this work, the dimensions of the model problem were 
                           0
                           ⩽
                           x
                           ⩽
                           5
                        , 
                           0
                           ⩽
                           y
                           ⩽
                           5
                         and 
                           a
                           =
                           1
                         as shown in Fig. 7(b). The material properties for this problem were 
                           E
                           =
                           
                              
                                 10
                              
                              
                                 5
                              
                           
                         and 
                           v
                           =
                           0.3
                        . In Fig. 7(b), the natural boundary conditions from the exact solution (Eq. (32)) were imposed and the essential boundary conditions are imposed to the quadrant model. To measure the error of the analysis, the following relative error was employed.
                           
                              (33)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                (
                                                ε
                                                −
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      h
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                          ⋅
                                          (
                                          σ
                                          −
                                          
                                             
                                                σ
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          
                                          d
                                          Ω
                                          )
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                ε
                                             
                                             
                                                T
                                             
                                          
                                          ⋅
                                          σ
                                          
                                          d
                                          Ω
                                          )
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                         In this work, the error convergence behavior of the present method was compared with previous conventional trimmed surface analysis results (Kim et al., 2009).

It is noteworthy that conventional trimmed surface analysis (Kim et al., 2009) and the present method have different modeling strategies. In Fig. 8
                        , the dots indicate the active control points (∈K) and the circles indicate inactive control points (∉K) excluded from the analysis. Note that the control points in Fig. 8 have the same meaning as the basis function marks in Fig. 6 because each control point has its unique basis function. Conventional trimmed surface analysis models the problem with one trimming curve and a background mesh as shown in Fig. 8(a). In the present method, all the analysis domain boundaries are represented by trimming curves only. Five trimming curves and one background mesh are used to model the body, as shown in Fig. 8(b). The active control points are classified into inner spline basis functions and outer spline basis functions. The red dots are outer spline basis functions (∈J) and the green dots are inner spline basis functions (∈I).

In conventional trimmed surface analysis, the boundary conditions described in Fig. 7(b) are imposed on the patch boundaries. Since the Kronecker delta property is automatically satisfied on the NURBS patch boundaries, no specific scheme for imposing boundary conditions was used. In the present work, the essential boundary conditions are imposed using Nitsche's method inside the patches, where the Kronecker delta property is not satisfied. Figs. 9 and 10
                        
                         compare the relative errors of conventional trimmed surface analysis and the present method when quadratic and cubic basis functions are used. As shown in the figures, although the errors are increased a little bit due to the extension process and the weak imposition of essential boundary conditions, the global trend in the convergence behaviors match up well with conventional trimmed surface analysis. Considering that, the approximation order of conventional trimmed surface analysis is preserved in the present method, which leads us to conclude that the validity of the proposed extended SBMFM has been demonstrated.

An example with a complex topology inspired by a wheel is solved. The problem is modeled using Rhinoceros CAD software. The model consists of five trimming curves and background mesh. In Fig. 11
                        , the modeling in the CAD software is illustrated. The model is imported from Rhinoceros by IGES file. As shown in Fig. 12
                        , 35-by-35 quadratic background mesh, 405 inner spline basis functions and 162 outer spline basis function were used. The boundary conditions for the problem are specified in Fig. 13
                        . The essential boundary condition (
                           
                              
                                 u
                              
                              
                                 d
                              
                           
                           =
                           0
                        ) is imposed on the inner circle, and the tangential load of 1 N/mm is imposed on the outer circle. The analyses were performed with two-dimensional plane stress formulation with quadratic basis functions. Aluminum was used as the material (
                           E
                           =
                           70.4
                            GPa
                        , 
                           v
                           =
                           0.35
                        ). For the comparison, the problem was solved with ABAQUS, in which 9276 DOFs (4638 nodes, 1112 elements, quadratic, reduced integration, plane stress element) were used. The present method shows good agreement with ABAQUS for both the displacement field (Fig. 14
                        ) and the von-Mises stress (Fig. 15
                        ). Moreover, the key advantage of the present method is the stabilization and minimization of the condition number of the global stiffness matrix. From Fig. 16
                        , we can confirm the effect of the extension process. The condition number is stabilized and decreased, compared with conventional SBMFM. In Fig. 16 the element characteristic length h refers to the 1/(number of elements per side in the background mesh).

@&#CONCLUSIONS AND FUTURE WORK@&#

In this work, the extended SBMFM is presented. We focused on the potential instability of conventional SBMFM due to extremely small trimmed basis functions. To get rid of the instability, the extension of the basis function was performed. Through the extension process, the basis functions with small remaining support were merged with neighboring basis functions, so that the instability could be eliminated. In order to impose essential boundary conditions, Nitsche's method was employed. Nitsche's method imposes essential boundary conditions properly, and the condition number of the global system matrix is managed as well. From the verification examples, it is shown that the present method has the same approximation order as conventional SBMFM. The validity of the present method was proved by error analysis, and the comparison was made with solutions from commercial software. Also, the CAD friendly property of SBMFM was shown by importing a model in the CAD system directly using IGES files. In this paper, the extended SBMFM was applied to linear two-dimensional elastic problems. The application of the presented method in nonlinear analysis; with consecutive trimming curve evolution, will be essential to clearly demonstrate its usefulness. Therefore, one of our further research directions will be the implementation of a pure Eulerian formulation for the extended SBMFM. In the analysis with Eulerian formulation, some special and expensive schemes were employed to capture and track the free surface of the analysis domain such as pseudo-concentrations (Thompson, 1986), volume of fluid or volume of solid methods (Hirt and Nichols, 1981; Al-Athel and Gadala, 2011), and level set methods (Chang et al., 1996). Besides the methods, we believe that the trimming curves employed in this work, are candidates for capturing the free surface in the Eulerian formulation.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MEST) (No. 2011-0015469).

@&#REFERENCES@&#

