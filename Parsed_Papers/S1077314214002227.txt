@&#MAIN-TITLE@&#Matching-constrained active contours with affine-invariant shape prior

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Object matching and active contour is combined for achieving automatic object segmentation.


                        
                        
                           
                           The key technique is a novel affine-invariant interior-points-to-shape relation.


                        
                        
                           
                           A constrained optimization model is proposed to unify the computational framework.


                        
                        
                           
                           A projected-gradient decent algorithm is derived to solve the proposed model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Automatic object segmentation

Active contour

Object matching

Affine invariance

Matching-constrained active contour

Interior-points-to-shape relation

@&#ABSTRACT@&#


               
               
                  In the object segmentation by active contours, an initial contour provided by user is often required. This paper extends the conventional active contour model by incorporating feature matching in the formulation for automatic object segmentation, yielding a novel matching-constrained active contour. The key to our formulation is a mathematical model of the relationship between interior feature points and object shape, called the interior-points-to-shape relation. According to this interior-points-to-shape relation, we are able to achieve the automatic object segmentation in two steps. Specifically, we are able to estimate the object boundary position given the matched interior feature points. Afterwards, we are able to further optimize the boundary position in the active contour framework. To obtain a unified optimization model for this task, we additionally formulate the matching score as a constraint to active contour model, resulting in our matching-constrained active contour. We also derive the projected-gradient descent equations to solve the constrained optimization. In the experiments, we show that our method achieves automatic object segmentation, and it clearly outperforms the related methods.
               
            

@&#INTRODUCTION@&#

Automatic object segmentation is desirable in many higher level computer vision tasks. Active contour model is one of the most well-known models for object segmentation. However, it generally requires the user to provide a contour curve sufficiently close to the object boundary to initiate the segmentation. Hence, the existing segmentation frameworks of active contours are generally semi-automatic. In Fig. 1
                     , we show how the initialization affects the result of conventional affine shape prior based active contour [6,40].

@&#RELATED WORKS@&#


                        Relaxation of initialization for active contours. Relaxation of the user initialization in active contours for object segmentation is an emergent research topic [43,33,25,42,41]. Previous work, e.g. [23], for automatic initialization of the edge-based active contours selects the initial contours that gives approximately the minimum energy. In other words, it is assumed that most of the edges in the image are of interest so that all of those should be considered in the optimization. This assumption is valid for the images studied in [23] but it cannot be generalized.


                        Global optimization of active contour with shape priors for automatic object segmentation. Recently, active contour with shape priors have been popularized due to a series ground-breaking works, e.g. [8,22,35] to list a few. The global optimization techniques for some region-based and edge-based active contour models have been proposed in [7,37]. In [7], Cremers et al. proposed a branch-and-bound method for approximating the exhaustive search in a region-based active contour with shape prior modeling. Schoenemann and Cremers in [36,37] proposed a functional ratio energy for characterizing the object boundaries. The optimization is achieved via minimum ratio cycle algorithm by Lawler [21]. These global optimization methods do not require initial contour. Hence, these methods achieve automatic object segmentation. The idea behind these methods is to approximate the exhaustive search of the globally optimal contour curve over the entire image domain. These methods provide efficacious numerical solutions to global optimization of many active contour models. However, it can be observed that sometimes the object of interest is one of the suboptimal solutions to the active contour models, as shown in the experiment section of this paper.


                        Prior works on constrained implicit curve evolution. A pioneering work on incorporating constraints in the level set based segmentation framework was [34], in which Paragios proposed the first effective way for leveraging sparse control points as user input in level set based segmentation framework. In his paper, control points, a.k.a. landmarks, were chosen by the user, and an implicit shape prior model was constructed from the control points. Our work differs from his in several aspects. First, Paragiosâ€™ work provides a natural model of the relationship between the implicit contour and the points near it, whereas we model the relationship between implicit contour and the points inside the contour. Second, Paragios considered the user-input control points as a soft constraint formulated in the objective function. In contrast, we consider matching as a hard constraint because of the useful concept of initial feasible solution in constraint optimization which allows us to unify the two-step matching and segmentation framework into one single optimization model. Lastly, our framework requires an implicit shape representation other than the conventional level set representation, and the derivation of the gradient descent algorithm has to be different.


                        Affine invariance in active contours. Imposing affine invariance in active contour is an active research topic in recent years. Foulonneau et al. [12] proposed the first affine invariant active contour based on shape moments. It is a marvellous idea to measure affine invariance of any implicit contour using moments. Bryner et al. [2] also proposed to impose affine invariance in the shape analysis based on elastic Riemannian metric. More recently, and Bryner and Srivastava [1] proposed to further impose the affine invariance in the Bayesian active contour formulation. In this work, we adopt a different and simpler approach.


                        Relations between object matching and segmentation. Object matching based on locally discriminative feature matching automatically finds a set of points on the object of interest in the image [27,26,15] achieving coarse object localization. Nevertheless, the matching correspondences established by object matching does not necessarily defines the object boundary precisely.

@&#METHODOLOGY@&#

We address the automatic object segmentation by active contour following a divide-and-conquer strategy. We consider the problem of automatic object segmentation as a unity of two subproblems: the object detection and the boundary locating. Unlike the global search methodology in [7,37], the object detection can automatically provide the coarse localization of the object with a relatively high confidence. We expect to obtain the segmentation with the initialization provided by the object detector. The philosophy is that if the object detection cannot be done properly, then the object segmentation is also hopeless. We aim at extending the formulation of active contour models by using object detection. There exist many effective object detectors based on classification, e.g. the Haar-like feature based detectors [39] and the HOG descriptor based detectors [9] as well as object matching [27]. We consider object matching specifically for our task, since it can offer richer descriptions of the object, including its size and orientation.

Our contributions of this paper mainly lie in three aspects.
                           
                              1.
                              We obtain a mathematical model of the relationship between the interior points and the shape contour. This model immediately gives rise to a two-step computational framework for automatic object segmentation. Based on this model, we are able to estimate the boundary contour given the matched interior points. Afterwards, the generated contour can be further optimized in the active contour framework because of it is in the form of implicit surface.

In addition, we formulate the automatic object segmentation with object matching and active contour as a novel constrained optimization model, which is called the matching-constrained active contour model. The initial contour generated by using the feature matching is the initial feasible solution to the constrained optimization.

We derive the projected-gradient descent equations for solving the constrained optimization.

Our approach may be considered conceptually similar to the frameworks of face feature detection [10]. In these frameworks, an initial guess of the face feature points is generated according to the face detection. Afterwards, the face feature points will be aligned to the face in the image. These frameworks were developed for faces rather than general objects. Besides, the integration of the matching and active contour to form one unified optimization model is numerically advantageous, while being rarely explored.

The rest of the paper is organized as follows. In Section 2, we describe the computational framework for automatic object segmentation based on object matching and active contour. In Section 3, we introduce our mathematical model of the affine-invariant interior-points-to-shape relation. In Section 4, we present our unified constrained optimization model of the framework, namely the matching-constrained active contour, and the projected gradient descent algorithm. In Section 5, we evaluate our method for automatic object segmentation on real images of cluttered scenes, we also compare our method with the state-of-the-art methods on example based object segmentation and we present the associated quantitative analysis with discussions. We conclude the paper with discussions in Section 6.

In this section, we describe a computational framework for automatic object segmentation based on object matching and active contour.

In object matching, the feature point matching often begins with an interest point detection on a pair of images as in [27]. Then the similarity between all possible pairs of matches are calculated. Finally, the matching algorithm will assign a set of feature points in one image, possibly a subset of the entire feature set, to a set of feature points in the other image according to the point-wise similarity. A correspondence is often represented by using binary variable, i.e. 1 means matched 0 means unmatched. In our paper, we will consider one image as an object template, and the task is known as object matching. The principle of the object matching is illustrated in Fig. 2
                     , where the dots in two images are the feature points, and the lines across the images visualize the matching correspondences.

With the point correspondences established by the matching, we are able to solve the parameters of the transformation from the template object to the object in the image, and we are able to generate a contour in the image by, for example, applying the same transformation to the boundary contour of the object in the template. Ideally, we may use this contour to initialize the active contour. An example of the active contour given such a contour is shown in Fig. 3
                     .

To construct this straightforward framework, we will have to overcome a major technical difficulty in this work, i.e. finding a contour representation, such that
                        
                           1.
                           the initial contour provided by matching is sufficiently close to the object boundary in the image, in order to facilitate the object segmentation by active contour, and

the contour provided by matching can be further optimized in the active contour framework.

To meet the former requirement, a contour representation which can be transformed according to the transformation of interior feature points will be needed. We call such contour representation as a transformation-invariant contour representation. Regarding the latter requirement, the implicit surface, which is known as a geometric (implicit) contour representation, is often adopted in the active contour framework. The argument on the geometric representation against the parametric representation can be found in the literature of active contours [4,5]. To summarize, we require an implicit contour representation which can be transformed according to the transformation on the interior feature points.

In this section, we deal with the aforementioned major technical difficulty. Specifically, we will propose an implicit contour representation which is determined by the positions of interior points. In addition, we impose affine-invariance on the proposed implicit contour representation to fulfill our requirements.

In this subsection, we propose an implicit contour representation determined by the positions of interior points, such that the contour representation can be sufficiently accurate and it changes according to the positions of interior points.

The shape of the template object can be represented by its silhouette. The shape silhouette of an object can be defined as a binary function 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                           
                         as follows:
                           
                              (1)
                              
                                 
                                    
                                       H
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   [
                                                   x
                                                   ,
                                                   y
                                                   ]
                                                   âˆˆ
                                                   Î©
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   [
                                                   x
                                                   ,
                                                   y
                                                   ]
                                                   âˆˆ
                                                   
                                                      
                                                         Î©
                                                      
                                                      
                                                         â€¾
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Î©
                           
                         is the object region and 
                           
                              
                                 
                                    Î©
                                 
                                 
                                    â€¾
                                 
                              
                           
                         is the non-object region. This definition can be used to define the object boundary contour of the object shape, denoted as C, which is written as follows:
                           
                              (2)
                              
                                 C
                                 =
                                 
                                    
                                       
                                          x
                                          ,
                                          y
                                          |
                                          â€–
                                          âˆ‡
                                          
                                             
                                                H
                                             
                                             
                                                o
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          â€–
                                          
                                          â‰ 
                                          
                                          0
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

At the first glance of the above formulation, we would expect various ways for constructing this object region indication function 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                           
                        . For example, we can define 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                              =
                              H
                              (
                              Ï•
                              (
                              x
                              ,
                              y
                              )
                              )
                           
                        , where H is a Heaviside function and 
                           
                              Ï•
                           
                         is a signed distance function, and it is therefore closely related to the so-called implicit contour representation popularized in the last decade in the literature of level set method based segmentation [31,5,32].

To find the optimal contour representation we propose to adopt the following functional optimization problem:
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   e
                                                
                                                
                                                   âˆ—
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      argmin
                                                   
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      âˆˆ
                                                      S
                                                   
                                                
                                             
                                             
                                             E
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   e
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             E
                                             (
                                             
                                                
                                                   H
                                                
                                                
                                                   e
                                                
                                             
                                             )
                                             =
                                             
                                                âˆ«
                                                
                                                   D
                                                
                                             
                                             |
                                             
                                                
                                                   H
                                                
                                                
                                                   o
                                                
                                             
                                             -
                                             
                                                
                                                   H
                                                
                                                
                                                   e
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             
                                             dx
                                             
                                             dy
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              D
                           
                         is the entire image domain, 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                         is the approximate of 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                           
                         is the black-white object shape silhouette in the template, and 
                           
                              S
                           
                         denotes the solution space of 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                        .

In our context, we require 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                         to be determined by the set of the position vectors of feature points 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    â†’
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              â€¦
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    N
                                 
                              
                              }
                           
                        , i.e. 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                              (
                              {
                              
                                 
                                    p
                                 
                                 
                                    â†’
                                 
                              
                              }
                              )
                           
                        . This 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                         represents the interior-points-to-shape relation.

If we consider the feature points 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    â†’
                                 
                              
                              }
                           
                         as randomly distributed points, we may adopt the radial basis functions (RBF) to construct 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                        :
                           
                              (4)
                              
                                 
                                    
                                       H
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 )
                                 =
                                 H
                                 
                                    
                                       
                                          
                                             
                                                
                                                   âˆ‘
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                Î±
                                             
                                             
                                                i
                                             
                                          
                                          Ïˆ
                                          (
                                          â€–
                                          
                                             
                                                z
                                             
                                             
                                                â†’
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          â€–
                                          )
                                          +
                                          Î²
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    z
                                 
                                 
                                    â†’
                                 
                              
                              =
                              
                                 
                                    [
                                    x
                                    ,
                                    y
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                              H
                           
                         is still the Heaviside function, and we may call
                           
                              (5)
                              
                                 Ï•
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Î±
                                    
                                    
                                       i
                                    
                                 
                                 Ïˆ
                                 (
                                 â€–
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 â€–
                                 )
                                 +
                                 Î²
                              
                           
                        the shape decision function in which 
                           
                              Ïˆ
                              (
                              Â·
                              )
                           
                         is a kernel function, 
                           
                              {
                              
                                 
                                    Î±
                                 
                                 
                                    i
                                 
                              
                              }
                              ,
                              
                              Î²
                           
                         are the weights and bias to be determined. The points 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    â†’
                                 
                              
                              }
                           
                         are the center points of the kernel functions. The sign of shape decision function determines whether a point belongs to the shape. An example of such interior-points-to-shape relation is shown in Fig. 4
                        .

The usefulness of the formulation of contour representation in the above form has been explored in the literature of active contour, such as [13,29,38,30] to list a few. This formulation has been used to cope with noisy data [13], it can also be used to adapt to topology changes in a pure parametric active contour framework [29], and it can lead to efficient implementations [38] and even more flexible formulations of the segmentation [38]. In this work, we revisit the same formulation for the new problem of relating interior feature points to the contour shape.

Combining the previous formulations in Eqs. (1), (3) and (4), we obtain a binary classification problem based on RBF neural network in which the decision function is formed by only some of the positive samples, i.e. the feature points, but the training is accomplished by using both positive and negative samples over the entire image domain. We consider that the training is done by direct minimization of the fitting error in (3) with respect to the parameters 
                           
                              {
                              
                                 
                                    Î±
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         and 
                           
                              Î²
                           
                        . The gradient descent equations for learning the parameters are given in Appendix A. The detailed learning strategy is presented in the section of experiment.

The model defined in Eqs. (1), (3) and (4) gives us an implicit contour representation determined by the positions of interior points, which can also be sufficiently accurate. In addition, in our problem, the interior points will likely be transformed across the template and the image. Therefore, we require the interior points and the implicit contour to undergo the same transformation, i.e. being transformation-invariant.


                        The need for affine invariance in interior-points-to-shape relation. In this work, we consider a specific yet common type of transformation, i.e. the affine transformation, and the affine invariance property is also illustrated in Fig. 5
                        . In the following, we first verify if the interior-points-to-shape relation obtained in the last subsection possesses the transformation invariance property.

Let us consider the model proposed in last subsection in Eq. (4). We choose the Gaussian function as the RBF kernel. Thus, the shape decision function can be written as follows.
                           
                              (6)
                              
                                 Ï•
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Î±
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                â€–
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      â€–
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Ïƒ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 Î²
                                 ,
                              
                           
                        where 
                           
                              Ïƒ
                           
                         is to be determined beforehand.

The contour curves can be defined by the shape decision function according to 
                           
                              C
                              =
                              {
                              x
                              ,
                              y
                              |
                              Ï•
                              (
                              x
                              ,
                              y
                              )
                              =
                              0
                              }
                           
                        , which is equivalent to Eq. (2) where 
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                 
                              
                           
                         is replaced by 
                           
                              
                                 
                                    H
                                 
                                 
                                    e
                                 
                              
                           
                        .

Let us consider the affine transformation of the kernel centers 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         as follows:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 A
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 ,
                                 
                                 for all
                                 
                                 i
                                 ,
                              
                           
                        where 
                           
                              A
                           
                         is an invertible matrix, 
                           
                              
                                 
                                    b
                                 
                                 
                                    â†’
                                 
                              
                           
                         is a translation vector. The corresponding shape decision function in terms of the transformed kernel centers can be written as follows:
                           
                              (8)
                              
                                 Ï•
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 ,
                                 {
                                 A
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 }
                                 )
                                 =
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Î±
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                â€–
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                -
                                                A
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                
                                                   
                                                      â€–
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Ïƒ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 Î²
                                 .
                              
                           
                        
                     

The affine transformation of the contour points can be represented by 
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                              =
                              A
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    â†’
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              âˆˆ
                              C
                           
                        , such that 
                           
                              Ï•
                              (
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              0
                           
                         in (6). By substituting 
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                           
                         into Eq. (8), we obtain the following:
                           
                              
                                 Ï•
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 {
                                 A
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 }
                                 )
                                 =
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Î±
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                â€–
                                                A
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                   
                                                
                                                -
                                                A
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      â€–
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Ïƒ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 Î²
                                 .
                              
                           
                        
                     

Regarding the affine invariance property, the above leads to the following.
                           PropositionÂ 3.1
                           
                              There exists infinitely many 
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              , such that for each i, we have 
                              
                                 
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   â€–
                                                   A
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   -
                                                   A
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         â€–
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ïƒ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    â‰ 
                                    
                                    exp
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   â€–
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         â€–
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ïƒ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              , if 
                              
                                 
                                    A
                                 
                               
                              is not an orthogonal matrix.
                           

The proof is deferred to Appendix B.

This means that the affine transformation of the contour curve defined by the trained shape decision function, 
                           
                              Ï•
                              (
                              
                                 
                                    z
                                 
                                 
                                    â†’
                                 
                              
                              )
                           
                        , may not be the contour curve defined by the transformed shape decision function 
                           
                              Ï•
                              (
                              
                                 
                                    z
                                 
                                 
                                    â†’
                                 
                              
                              ,
                              {
                              A
                              ,
                              
                                 
                                    b
                                 
                                 
                                    â†’
                                 
                              
                              }
                              )
                           
                        , which is an violation of the aforementioned affine invariance property.


                        Affine invariant interior-points-to-shape relation. To address the aforementioned problem, we propose a revised shape representation 
                           
                              
                                 
                                    Ï•
                                 
                                 
                                    S
                                 
                              
                           
                         as follows.
                           
                              (9)
                              
                                 
                                    
                                       Ï•
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                                 ,
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 }
                                 )
                                 =
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Î±
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                -
                                                â€–
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                -
                                                A
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                )
                                                
                                                   
                                                      â€–
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Ïƒ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 Î²
                                 .
                              
                           
                        Substituting 
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                           
                         into (9), we can verify that for general 
                           
                              A
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    â†’
                                 
                              
                           
                        , we have the following affine invariance.
                           
                              
                                 
                                    
                                       Ï•
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 }
                                 )
                                 =
                                 
                                    
                                       Ï•
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 ,
                                 {
                                 
                                    
                                       I
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       0
                                    
                                    
                                       â†’
                                    
                                 
                                 }
                                 )
                                 =
                                 Ï•
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        where 
                           
                              I
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    0
                                 
                                 
                                    â†’
                                 
                              
                           
                         defines an identity transformation. We consider that 
                           
                              
                                 
                                    Ï•
                                 
                                 
                                    S
                                 
                              
                           
                         is parameterized by 
                           
                              
                                 
                                    A
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         rather than 
                           
                              A
                           
                         to simplify the later derivation for optimizing 
                           
                              A
                           
                        .

We may further appreciate the significance of the affine invariance property by the example shown in Fig. 6
                        . Suppose we are given the pair of initial points and shape in Fig. 4, the interior feature points of the leaf are then transformed by a predetermined affine transformation. The implicit contour curve defined by Eq. (8) is shown in Fig. 6(a). Note that Eq. (8) does not have the affine invariance property. The resultant shape, which tends to be a circle, differs significantly from a shape of a leaf. With the same transformation of the feature points, the implicit contour curves defined by the affine invariant shape decision function in Eq. (9) is shown in Fig. 6(b). Obviously, the affine-invariant implicit contour in Fig. 6(b) is like a leaf transformed resulting from the same transformation applied to the feature points, which is the affine-invariance property. With such an affine invariant interior-points-to-shape relation in Eq. (9), we can achieve the affine points-to-shape alignment. A result of the points-to-shape alignment is shown in Fig. 7
                         based on the feature matching presented in Fig. 2.

The established affine-invariant interior-points-to-shape relation completes our computational framework for automatic object segmentation. It also enables us to unify the framework into an optimization model. In this section, we propose our unified optimization model for automatic object segmentation.

In this subsection, we propose a constrained optimization model to unify the object matching and active contour. The motivation of our constrained optimization model lies in the notion of initial feasible solution. Specifically, the contour curve given by the feature point matching provides the initial feasible solution to the constrained optimization model of active contour. The model is as follows:
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   âˆ—
                                                
                                             
                                             =
                                             
                                                
                                                   argmin
                                                
                                                
                                                   C
                                                
                                             
                                             
                                             J
                                             (
                                             C
                                             (
                                             {
                                             
                                                
                                                   q
                                                
                                                
                                                   â†’
                                                
                                             
                                             }
                                             )
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             :
                                             
                                             E
                                             (
                                             {
                                             
                                                
                                                   q
                                                
                                                
                                                   â†’
                                                
                                             
                                             }
                                             )
                                             â©½
                                             Ï„
                                             ,
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             A
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    â†’
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              â€¦
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    N
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    q
                                 
                                 
                                    â†’
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              â€¦
                              ,
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    N
                                 
                              
                              }
                           
                         are the feature points on the template and the transformed sets of these feature points, 
                           
                              C
                              (
                              {
                              
                                 
                                    q
                                 
                                 
                                    â†’
                                 
                              
                              }
                              )
                           
                         denotes the implicit relation between the interior points and the contour shape defined by (9). 
                           
                              J
                              (
                              C
                              )
                           
                         is the abstract form of the active contour energy, 
                           
                              E
                              (
                              Â·
                              )
                           
                         is the abstract form of the cost of joint matching and alignment, and 
                           
                              Ï„
                           
                         is a tolerance level.

Note that the explicit contour optimization form of active contour model, as in Eq. (10), can often be written w.r.t. implicit contour representations [5,24,20]. In most of the cases, the two types of active contour models are equivalent. Without loss of generality, we choose to complete the paper with the explicit contour optimization form.

This formulation also ensures that the solved contour is close to the initial feasible contour. To find the initial feasible solution, it suffices to minimize 
                           
                              E
                              (
                              
                              )
                           
                         w.r.t. 
                           
                              {
                              
                                 
                                    q
                                 
                                 
                                    â†’
                                 
                              
                              }
                           
                        , since the set of 
                           
                              {
                              
                                 
                                    q
                                 
                                 
                                    â†’
                                 
                              
                              }
                           
                         that corresponds to the minimal value of 
                           
                              E
                              (
                              Â·
                              )
                           
                         must be feasible to the inequality constraint if there exists at least one feasible solution.

In this subsection, we establish the explicit form of E in the constraint. Our formulation is a variant of the simplest form of the linear model of feature matching [14]. It can be written as follows:
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  âˆ—
                                                               
                                                            
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      argmin
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                             E
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   â†’
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   Î´
                                                
                                                
                                                   âˆŠ
                                                
                                             
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             âˆ€
                                             i
                                             ,
                                             
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   Î´
                                                
                                                
                                                   âˆŠ
                                                
                                             
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                           
                         is the so-called matching cost measuring the distance between all pairs of features across the two images. We use the SIFT interest point detector and the SIFT feature [27]. 
                           
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                           
                         is the approximation of the Dirac delta with a parameter 
                           
                              âˆŠ
                              ,
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              =
                              â€–
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    â€¾
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    â€¾
                                 
                              
                              â€–
                           
                         and 
                           
                              {
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                              }
                           
                         is the set of target feature points in the target image, 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                           
                         is the cost of the matching between 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    â€¾
                                 
                              
                           
                        . 
                           
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              )
                           
                         is the relaxed matching indicator. 
                           
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              )
                           
                         has the following property:
                           
                              
                                 
                                    
                                       Î´
                                    
                                    
                                       âˆŠ
                                    
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 â‰ˆ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   
                                                   â‰ 
                                                   
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where M is a constant. In this model, the optimal 
                           
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                           
                         is determined by the closeness between 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                           
                        . Thus, by aligning 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                           
                         toward a proper 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    â†’
                                 
                              
                           
                        , the matching cost can be minimized. However, the above model is easily trapped by degenerate solutions where 
                           
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              )
                              =
                              0
                           
                        . To avoid such degeneration, we have the following reformulation:
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  âˆ—
                                                               
                                                            
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      argmax
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                             E
                                             (
                                             {
                                             
                                                
                                                   q
                                                
                                                
                                                   â†’
                                                
                                             
                                             }
                                             )
                                             =
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Î´
                                                
                                                
                                                   âˆŠ
                                                
                                             
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             âˆ€
                                             i
                                             ,
                                             
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   Î´
                                                
                                                
                                                   âˆŠ
                                                
                                             
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             =
                                             1
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Note that 
                           
                              E
                              â©¾
                              0
                           
                        . The constraint is therefore 
                           
                              -
                              E
                              â©½
                              Ï„
                           
                        , where 
                           
                              E
                              =
                              -
                              E
                           
                        .

We are now able to derive the solution to the constrained optimization problem based on the idea of projected gradient descent method [28]. Projected gradient method tries to find the update direction of the current solution along which the cost function can be decreased and the constraints will not be violated. Since the constraints can often be expressed or transformed into equality constraints, the update direction is also required to lie within the NULL space of the constraints. While the notion of NULL space is mainly meant for linear equations, the nonlinear equality constraints can also be linearized, by e.g. Taylor expansion.

Our projected-gradient descent equations are as follows:
                           
                              (13)
                              
                                 
                                    
                                       d
                                       A
                                    
                                    
                                       dt
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       A
                                    
                                 
                                 J
                                 +
                                 
                                    
                                       
                                          
                                             
                                                âˆ‡
                                             
                                             
                                                A
                                             
                                          
                                          J
                                          ,
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      A
                                                   
                                                
                                                E
                                             
                                             
                                                â€–
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      A
                                                   
                                                
                                                E
                                                â€–
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             A
                                          
                                       
                                       E
                                    
                                    
                                       â€–
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             A
                                          
                                       
                                       E
                                       â€–
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       d
                                       
                                          
                                             b
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       dt
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                 
                                 J
                                 +
                                 
                                    
                                       
                                          
                                             
                                                âˆ‡
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                             
                                          
                                          J
                                          ,
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                E
                                             
                                             
                                                â€–
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                E
                                                â€–
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                          
                                       
                                       E
                                    
                                    
                                       â€–
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                          
                                       
                                       E
                                       â€–
                                    
                                 
                                 .
                              
                           
                        Note that these equations are not exactly the same as the ones in conventional projected gradient descent method in which inversion of a large matrix is needed. The rationale of Eqs. (13) and (14) lies in the following property.
                           
                              (15)
                              
                                 
                                    
                                       dE
                                    
                                    
                                       dt
                                    
                                 
                                 =
                                 0
                                 
                                 and
                                 
                                 
                                    
                                       dJ
                                    
                                    
                                       dt
                                    
                                 
                                 â©½
                                 0
                                 .
                              
                           
                        The derivation of this property is deferred to Appendix C. The above indicates that the projected gradient descent algorithm governed by Eqs. (13) and (14) can reduce J while leaving E unchanged. This might be too strong for the inequality constrained optimization. In fact, we only require E to be smaller than a predefined tolerance 
                           
                              Ï„
                           
                        . Therefore, we implement the original gradient descent if 
                           
                              E
                              <
                              Ï„
                           
                        , and we implement the full projected gradient algorithm, if 
                           
                              E
                              â‰ˆ
                              Ï„
                           
                        .

To implement the projected gradient descent algorithm, we require the explicit form of the gradients 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              J
                           
                        . 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              E
                              ,
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                           
                         and 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              E
                           
                        . The derivation of the explicit form of 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              J
                           
                         is complex. Alternatively, we can obtain 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              J
                           
                         numerically by using 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                              J
                           
                        . The explicit form of 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          -
                                       
                                    
                                    1
                                 
                              
                              J
                           
                         and 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                           
                         can be written as follows:
                           
                              (16)
                              
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             -
                                          
                                       
                                       1
                                    
                                 
                                 J
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             âˆ‡
                                             
                                                
                                                   J
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   â†’
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         D
                                                         
                                                            
                                                               Ï•
                                                            
                                                            
                                                               S
                                                            
                                                         
                                                      
                                                      
                                                         D
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ã€ˆ
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         âˆ‡
                                                      
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Ï•
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   ã€‰
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                 
                                 J
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             âˆ‡
                                             
                                                
                                                   J
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   â†’
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         D
                                                         
                                                            
                                                               Ï•
                                                            
                                                            
                                                               S
                                                            
                                                         
                                                      
                                                      
                                                         D
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ã€ˆ
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         âˆ‡
                                                      
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Ï•
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   ã€‰
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 ,
                              
                           
                        in which 
                           
                              
                                 
                                    N
                                 
                                 
                                    â†’
                                 
                              
                           
                         is the normal of the contour and 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              
                                 
                                    Ï•
                                 
                                 
                                    S
                                 
                              
                           
                         can be computed either numerically or exactly. The closed form expressions of 
                           
                              
                                 
                                    D
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    D
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    D
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                           
                         are needed for the computation, which are as follows:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      
                                                         Ï•
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             2
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   â†’
                                                
                                             
                                             )
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ïƒ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      
                                                         Ï•
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                                
                                                   D
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   
                                                      âˆ‘
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             2
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   â†’
                                                
                                             
                                             )
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         Ïƒ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   â†’
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   Î±
                                                
                                                
                                                   i
                                                
                                             
                                             exp
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            â€–
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        â†’
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                            
                                                               
                                                                  â€–
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  Ïƒ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   â†’
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   â†’
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The derivation is deferred to Appendix D. Our derivation is not restricted to any specific active contour model. For the Geodesic Active Contour (GAC) [3], which is a well-known edge-based active contour and can locate the object boundary accurately given a good initialization, the functional gradient, 
                           
                              âˆ‡
                              J
                           
                        , is the following:
                           
                              
                                 âˆ‡
                                 
                                    
                                       J
                                    
                                    
                                       GAC
                                    
                                 
                                 =
                                 ã€ˆ
                                 âˆ‡
                                 g
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       â†’
                                    
                                 
                                 ã€‰
                                 
                                    
                                       N
                                    
                                    
                                       â†’
                                    
                                 
                                 -
                                 g
                                 Îº
                                 
                                    
                                       N
                                    
                                    
                                       â†’
                                    
                                 
                                 ,
                              
                           
                        where g is an edge indicator function in which the stronger edge corresponds to smaller value, 
                           
                              
                                 
                                    N
                                 
                                 
                                    â†’
                                 
                              
                           
                         is the normal of the contour, 
                           
                              Îº
                           
                         is the contour curvature.

The projected gradient algorithm also requires 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              E
                           
                         and 
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              E
                           
                         which can be written as
                           
                              (18)
                              
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       A
                                    
                                 
                                 E
                                 
                                    
                                       
                                          A
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             Ë†
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       
                                          A
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                â†’
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       âˆ‡
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                 
                                 E
                                 
                                    
                                       
                                          A
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       
                                          âˆ‘
                                       
                                       
                                          ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             Ë†
                                          
                                       
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       
                                          A
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                â†’
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          Ë†
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    e
                                 
                                 
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                           
                        . We adopt the Gaussian function to approximate the Dirac delta. Thus, 
                           
                              
                                 
                                    g
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              )
                           
                        . We also normalize the Gaussian functions according to the constraint 
                           
                              
                                 
                                    âˆ‘
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Î´
                                 
                                 
                                    âˆŠ
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                              )
                              =
                              1
                           
                        . These gradients may also be used for producing a local optimal solution to Eq. (12).

Given the above detailed formulations, we are able to derive our algorithm for the matching-constrained active contour. The pseudo code of our algorithm is presented in Algorithm 1. We also visualize the algorithm in a diagram in Fig. 8
                        .
                           AlgorithmÂ 1
                           Projected gradient descent active contour.
                                 
                                    
                                 
                              
                           

We adopt the locally affine matching [26] to provide the initial point correspondences in this work.

@&#EXPERIMENTS@&#

In our implementation, we use the SIFT interest point detector and the SIFT feature [27]. The SIFT features are computed from the interest points detected in the image. On the template image, the SIFT points are extracted before the shape is cut out. We also used a distance map to select the feature points far enough from the boundary such that the feature values will not be dependent on the content outside the object region. To produce the initial matching, we adopt the locally affine matching for producing the initial point correspondences [26]. We are not confined to this choice of feature representation and matching algorithm. The 
                        
                           Ï„
                        
                      in (10) is set in relation to the matching score E from initial object matching. More detailed discussions on the selection of 
                        
                           Ï„
                        
                      are presented in Section 5.8.

We mainly experiment on the real images taken from Mikolajczykâ€™s homepage,
                        1
                        
                           http://lear.inrialpes.fr/people/mikolajczyk/.
                     
                     
                        1
                      Caltech computer vision archive
                        2
                        
                           http://www.vision.caltech.edu/html-files/archive.html.
                     
                     
                        2
                      and the ETHZ Toys dataset to evaluate our method for automatic object segmentation.

Following the shape training process presented in Section 3, we can obtain the affine invariant points-to-shape model. We present the template objects and the trained shape contours in Fig. 9
                        . We also present the fitting errors during the training of the RBF for the shapes in Fig. 9. The training of the shape models converges stably (see Fig. 10
                        ).

There is a parameter 
                           
                              Ïƒ
                           
                         in the RBF based shape representation. We may use the fitting errors with fixed initial weights 
                           
                              
                                 
                                    Î±
                                 
                                 
                                    i
                                 
                              
                           
                         and threshold value 
                           
                              Î²
                           
                         for selecting 
                           
                              Ïƒ
                           
                        . Specifically, we select 
                           
                              Ïƒ
                           
                         which corresponds to the highest fitting score (
                           
                              1
                              -
                              normalized
                              
                              error
                           
                        ) from a set of 
                           
                              {
                              1
                              ,
                              1.1
                              ,
                              â€¦
                              ,
                              19.9
                              ,
                              20
                              }
                           
                         containing 191 candidates. Fig. 11
                        (a) shows the fitting scores w.r.t. 
                           
                              Ïƒ
                           
                         for the three shapes. We also randomly select 50 values of 
                           
                              Ïƒ
                           
                         from 
                           
                              [
                              1
                              ,
                              20
                              ]
                           
                         and we implement the gradient descent learning to get the convergent shape models of the leaf shape corresponding to the 50 random values of 
                           
                              Ïƒ
                           
                        . The scores of the optimal fitting, in terms of the Jaccard shape similarity, given the 50 random values of 
                           
                              Ïƒ
                           
                         are shown in Fig. 11(b). We may observe that the peaks of the two curves are quite close, which means that the criteria for selecting 
                           
                              Ïƒ
                           
                         with fixed weights and threshold is effective. The major benefit of the selection of 
                           
                              Ïƒ
                           
                         before the shape model fitting is the computational efficiency.

Upon the accomplishment of the shape model training, we then validate the claimed affine invariance of the shape model defined in Eq. (9). We take the trained leaf shape model for evaluation. The principle is to compare the contour shape implicitly defined by the transformed interior points with the explicitly transformed contour shape, which could be considered as the ground truth shapes. We choose the normalized Hausdorff distance, i.e. the Hausdorff distance normalized by the maximum distance between the two point sets, as the shape distance. We randomly generate the 100 sets of parameters for the affine transformation without translation, leading up to 100 randomly generated leaves. Some examples of the implicit contours overlaying with the explicitly transformed contour points are shown in the top row of Fig. 12
                        . We can observe that the proposed interior-points-to-shape relation defined in Eq. (9) is affine invariant. In the bottom row of Fig. 12 we also present the implicit contours due to the shape model without affine invariance, i.e. Eq. (8). In Fig. 13
                        , we plot the shape distances corresponding to the two shape models for all the 100 examples. We observe that even if the shape transformation is large, the distance between the explicitly and implicitly transformed contour shapes is still small for the affine-invariant shape model, whereas the shape model without the affine invariance deviates from the explicitly transformed shapes a lot. The explicitly transformed shapes can be considered as the ground-truth shapes.

There could be various global optimization strategies for active contours such as those reported in [7,37]. In this subsection, we show that the global optimal solution to improper active contour energies may not correspond to the target object. This claim should not depend on the choice of the optimization method. Hence, we adopt the exhaustive search for the optimization. To examine the global optimality of object shape in image for a given active contour energy, we ensure that the object shape in the image has been included in the search space.

In this experiment, we perform exhaustive search for both the Chanâ€“Vese model and the GAC model with hard but correct shape priors. In the implementation, we search over 8 orientations of the given shape, i.e. 
                           
                              
                                 
                                    
                                       0
                                       ,
                                       
                                          
                                             Ï€
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             Ï€
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             3
                                             Ï€
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       Ï€
                                       ,
                                       
                                          
                                             5
                                             Ï€
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             3
                                             Ï€
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             7
                                             Ï€
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                              
                           
                        , at all possible locations within the image domain. We make sure that this relatively small shape space covers roughly the correct object shape. A result is shown in Fig. 14
                        . In this experiment, we have fixed the size of the shapes.

We also show that given the correct fixed size, the global search also may not provide a reliable result of object segmentation in Fig. 15
                        . We can observe that the global optimal solution to the Chanâ€“Vese model (at the top-left corner) provides the region in which the image values contrast the outer region most, and the GAC model locates the group of the strongest edges that fit the shape prior best while not necessarily being the target object. Neither of the results are satisfactory. This is because we are not able to ensure the object of interest to correspond to the globally optimal solution of the formulated energy minimization problem.

There definitely exist cases that the global search can output satisfactory segmentation in relatively complex images given the correct size of the object. An example is shown in Fig. 16
                        (b), which is a result of the global optimization for the GAC model. However, the global optimization of the Chanâ€“Vese model is unsatisfactory, since the object of interest does not have significant contrast against the background. If we allow the size to vary in the search space, the results are often undesirable, such as in Fig. 17
                        . In this experiment, we include the correct size with additionally one smaller and one larger sizes in the search space. The boundary of the template deviates a bit from the object boundary in the result of global optimization for GAC in Fig. 17(b), since the gradients on the object boundary are small while the gradients inside the object are significant. The result of segmentation by Chanâ€“Vese model is in Fig. 17(a).

The experimental results in this subsection show that if the energy measure is improper, the global optimal solution of the active contour does not necessarily correspond to the desired object boundary.

In this subsection, we evaluate the matching-constrained active contour. The centroids of the template objects are set to be the origin 
                           
                              (
                              0
                              ,
                              0
                              )
                           
                        . This position can be anywhere, and it does not affect the feature point matching since the formulation of feature point matching does not involve the absolute position.

From the point correspondences (obtained from SIFT matching) as shown in the left-most columns of Figs. 18â€“20
                        
                        
                        , we obtain the initial contours shown in the middle columns of the figures and we finally obtain the segmentation results shown in the right-most columns of the figures. We can observe that the initial contours produced by our interior-points-to-shape relation are close to the object boundaries, and the active contour further improves the boundary location. Our method is capable of achieving the desirable segmentation results. We also compare the initial and final segmentation results with manually labeled ground truth shapes by Jaccard similarity measure to validate our visual observations quantitatively. We summarize the results in Table 1
                        . We can see the improvement of the initial contour and the region enclosed by the final contour overlaps well with the ground truth. We also present the computational cost of the entire framework on the images in Table 2
                         for reference (Note that the entire process is run in MATLAB on a PC with IntelÂ®Coreâ„¢ i5-450M Processor and 4GB memory).

We have implicitly assumed that a better shape model leads to a better result of segmentation throughout the paper. We ascertain this by experiments. We use the 50 shape models due to the 50 random 
                           
                              Ïƒ
                           
                         generated previously for extraction of the leaf in the top image in Fig. 19. In Fig. 21
                        , we show the strong correlation between the quality of shape modeling, in terms of fitting score, and the quality of segmentation, in terms of Jaccard similarity between the result and the ground truth.

We also evaluate our method under different noise level. We use the image in Fig. 19(a). We add Gaussian noise to the image. The means of the Gaussian noise are set to be zero and the standard deviations are varied from 1 to 20. For each noise level, we create 30 images and we apply our method to the images. The boxplot of the results of segmentation are shown in Fig. 22
                        . We can observe that when the standard deviation of the noise is below 5, our method is robust. However, the decay of accuracy is sharp when the standard deviation is larger than 5. Hence, the proposed method may be sensitive to noise. This is because we adopt the SIFT feature for matching. This problem of sensitivity to noise in object matching have been addressed by robust feature representations such as the PCA-SIFT [18].

We also study the performance of our method under occlusion. We create several cases of black box occlusions on the leaf of the leaf image. As shown in Fig. 23
                        , while the initial solutions by matching are affected greatly by the occlusion, our method is still able to drive the contour to the correct boundary positions. However, this also means the matching algorithm that we adopted for producing the initial feasible solution is vulnerable to occlusion. A robust formulation of the matching constraint for handling partially observed objects is desirable. For the sake of clarity, we also present the shape evolution results in Fig. 24
                        . We can observe that the affine-invariance also functions as a shape prior during the process.

In this subsection, we conduct experiments for comparing our method with other related methods, including global optimization of the GAC model (global search, or GS), co-segmentation based on discriminative clustering (DCCoSeg) [17] and co-segmentation based on submodular optimization (SOCoSeg) [19]. We use eight orientations and 3 scales in the global search. The implementations of the co-segmentation algorithms are taken from the authorsâ€™ websites. All the methods in the comparison require an object example. The task is also the same, namely to outline the same or similar object in the image of interest.

We conduct a quantitative experimental comparison. To eliminate miscellaneous factors in the experiment as many as possible, we use images generated by randomly transformation of the same image which is the leaf image shown in Fig. 14. We use 50 random affine transformation matrices to generate 50 random images. The object example has been shown in Fig. 9. The quantitative results are shown in Fig. 25
                        . We can observe that our method, matching-constrained active contour (MCAC), significantly outperforms the others. Some visual results are also shown in Fig. 26
                        . We can observe that our method can locate the object boundary satisfactorily. However, the results of global search may deviate from the object of interest because of insufficient information on the object. The co-segmentation methods may produce a lot of spurious contours and some times they may also miss the object. This is because the formulation of co-segmentation generally does not include a sensible object model. Our model integrates feature matching, shape prior modeling and object boundary modeling, all of which are practically useful object models.

In this experiment, we perform our method on an image sequence for capturing the same static object. Since we have not considered the temporal information in our model, we consider this experiment as an experiment for object extraction from image batch. The shape model is trained on one template image. We used dense interior point in this experiment for training the shape decision function while we use only the SIFT points among them to form the matching constraint. As shown in Fig. 27
                        , the initial feature matching can give reasonably good results while the boundary location was not precise, and our proposed projected gradient algorithm generally can further improve the segmentation. We can observe the result in the second row was not satisfactory. This is because the object does not undergoes the assumed affine transformation, but it undergoes a three dimensional perspective transformation. A 3D shape representation can be useful for handling this problem.

@&#DISCUSSIONS@&#

There is a tolerance level 
                           
                              Ï„
                           
                         in the formulation of the matching-constrained active contour to be determined by the user. We provide some observations to help the users to select their appropriate 
                           
                              Ï„
                           
                        . Since the small 
                           
                              Ï„
                           
                         may only allow small deviation from the initial solution even if the boundary is not very close to the initial contour. Hence, we may not need to constrain the optimization strictly. In the images for evaluation, the boundary of the objects of interest corresponds to the local optimal solutions to the active contour energy. Hence, we only need the gradient descent given the initial feasible solution produced by optimal matching without compromising to the constraint. The constraint should be more useful during the search for the optimal solution if the boundary is actually not a local optimal solution to the active contour model.

Objects may deform both rigidly and non-rigidly. In this paper, we have considered a general type of deformation, i.e. the affine transformation. The more general non-rigid deformations can be estimated by following the nonrigid shape prior modeling, e.g. [11,40,16], once the affine shape transformation is known.

Robust detection of the convergence of the gradient descent based method is a research problem in many areas such as optimization, machine learning. In our experiments, we terminate the algorithm if the average change of the affine parameters is less than a threshold or the maximum iteration is reached.

The computational cost depends on the number of selected feature points on the template object. A careful selection of the feature points can reduce the computational cost drastically while preserving the segmentation accuracy.

In this paper, we proposed a novel constrained optimization formulation of active contours. The numerical optimization of this new active contour model leads to an automatic object segmentation algorithm. This work expands the capacity of the conventional active contour approach for object segmentation, and the extension has practical significance in that the conventional semi-automatic framework has been automated.

There are several possible future directions. (1) The shape modeling in our affine-invariant interior-point-to-shape relation can be improved, and the computations can be accelerated by cleverly selecting the feature points. (2) The object matching is based on single template. However, the appearance of the object of interest could vary significantly in different images. Robust object matching is crucial to our method. (3) There could be interesting applications of this method, such as in the training phase of general object recognition tasks. (4) We have not developed advanced shape prior model for this framework, and this is out of the scope of this work. We would like to consider the advanced shape prior modeling as a future work. (5) We have not considered inverse consistency which is known to be critical in many matching scenarios [44,45]. The inverse consistency and other matching priors can be incorporated in our model as additional constraints to achieve more accurate and robust segmentation.

@&#ACKNOWLEDGMENTS@&#

Junyan Wang is supported by SUTD-ZJU Collaboration Research Grant 2012 SUTD-ZJU/RES/03/2012. Sai-Kit Yeung is supported by SUTD Start-Up Grant ISTD 2011 016, SUTD-MIT International Design Center Grant IDG31300106, and Singapore MOE Academic Research Fund MOE2013-T2-1-159.

The gradient descent equations for learning the parameters 
                        
                           {
                           
                              
                                 Î±
                              
                              
                                 i
                              
                           
                           }
                        
                      and 
                        
                           Î²
                        
                      in the shape decision function in Eq. (4) are as follows:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                âˆ‚
                                                
                                                   
                                                      Î±
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                âˆ‚
                                                t
                                             
                                          
                                          =
                                          -
                                          
                                             âˆ«
                                             
                                                D
                                             
                                          
                                          2
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                e
                                             
                                          
                                          -
                                          
                                             
                                                H
                                             
                                             
                                                o
                                             
                                          
                                          )
                                          Ïˆ
                                          (
                                          â€–
                                          
                                             
                                                z
                                             
                                             
                                                â†’
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          â€–
                                          )
                                          
                                             
                                                H
                                             
                                             
                                                â€²
                                             
                                          
                                          
                                          dx
                                          
                                          dy
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          â€¦
                                          ,
                                          N
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                âˆ‚
                                                Î²
                                             
                                             
                                                âˆ‚
                                                t
                                             
                                          
                                          =
                                          -
                                          
                                             âˆ«
                                             
                                                D
                                             
                                          
                                          2
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                e
                                             
                                          
                                          -
                                          
                                             
                                                H
                                             
                                             
                                                o
                                             
                                          
                                          )
                                          
                                             
                                                H
                                             
                                             
                                                â€²
                                             
                                          
                                          
                                          dx
                                          
                                          dy
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 H
                              
                              
                                 â€²
                              
                           
                        
                      is the first order derivative of H. The trained contour curve is defined by Eq. (2) in which 
                        
                           
                              
                                 H
                              
                              
                                 o
                              
                           
                        
                      is replaced by the trained 
                        
                           
                              
                                 H
                              
                              
                                 e
                              
                           
                        
                     .


                     
                        Proof
                        Let 
                              
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           , we have that 
                              
                                 A
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 =
                                 A
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       c
                                    
                                 
                                 -
                                 A
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           . Our objective is to show 
                              
                                 â€–
                                 A
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 
                                    
                                       â€–
                                    
                                    
                                       2
                                    
                                 
                                 
                                 â‰ 
                                 
                                 â€–
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 
                                    
                                       â€–
                                    
                                    
                                       2
                                    
                                 
                              
                            in general. Since 
                              
                                 â€–
                                 A
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 
                                    
                                       â€–
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 â€–
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                                 
                                    
                                       â€–
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             â†’
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 -
                                 I
                                 )
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 -
                                 I
                              
                            is a nonzero symmetric matrix. We can write
                              
                                 
                                    â€–
                                    A
                                    
                                       
                                          a
                                       
                                       
                                          â†’
                                       
                                    
                                    
                                       
                                          â€–
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    â€–
                                    
                                       
                                          a
                                       
                                       
                                          â†’
                                       
                                    
                                    
                                       
                                          â€–
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    D
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 -
                                 I
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       T
                                    
                                 
                                 DU
                              
                            and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                                 =
                                 U
                                 
                                    
                                       a
                                    
                                    
                                       â†’
                                    
                                 
                              
                           . This is a result of eigen-decomposition.

Obviously, there exists one vector 
                              
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                              
                            such that the above does not equal 0 for any nonzero 
                              
                                 D
                              
                           . By almost arbitrary scaling of 
                              
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                              
                           , we obtain infinitely many such vectors, which completes the proof.â–¡

In the following, we present the derivations of Eq. (15).
                        
                           
                              
                                 
                                    dE
                                 
                                 
                                    dt
                                 
                              
                              =
                              -
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              
                                 
                                    E
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             A
                                          
                                       
                                       J
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      A
                                                   
                                                
                                                J
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      E
                                                   
                                                   
                                                      â€–
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      E
                                                      â€–
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   A
                                                
                                             
                                             E
                                          
                                          
                                             â€–
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   A
                                                
                                             
                                             E
                                             â€–
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              
                                 
                                    E
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                          
                                       
                                       J
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                J
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                         
                                                      
                                                      E
                                                   
                                                   
                                                      â€–
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                         
                                                      
                                                      E
                                                      â€–
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                             
                                             E
                                          
                                          
                                             â€–
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                             
                                             E
                                             â€–
                                          
                                       
                                    
                                 
                              
                              =
                              -
                              ã€ˆ
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              J
                              ,
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              E
                              ã€‰
                              +
                              ã€ˆ
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              J
                              ,
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              E
                              ã€‰
                              -
                              ã€ˆ
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                              ,
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              E
                              ã€‰
                              +
                              ã€ˆ
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                              ,
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              E
                              ã€‰
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    dJ
                                 
                                 
                                    dt
                                 
                              
                              =
                              -
                              
                                 
                                    âˆ‡
                                 
                                 
                                    A
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             A
                                          
                                       
                                       J
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      A
                                                   
                                                
                                                J
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      E
                                                   
                                                   
                                                      â€–
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      E
                                                      â€–
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   A
                                                
                                             
                                             E
                                          
                                          
                                             â€–
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   A
                                                
                                             
                                             E
                                             â€–
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                          
                                       
                                       J
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                J
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                         
                                                      
                                                      E
                                                   
                                                   
                                                      â€–
                                                      
                                                         
                                                            âˆ‡
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  â†’
                                                               
                                                            
                                                         
                                                      
                                                      E
                                                      â€–
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                             
                                             E
                                          
                                          
                                             â€–
                                             
                                                
                                                   âˆ‡
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         â†’
                                                      
                                                   
                                                
                                             
                                             E
                                             â€–
                                          
                                       
                                    
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       â€–
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             A
                                          
                                       
                                       J
                                       
                                          
                                             â€–
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         âˆ‡
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                   J
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               âˆ‡
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                         E
                                                      
                                                      
                                                         â€–
                                                         
                                                            
                                                               âˆ‡
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                         E
                                                         â€–
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       â€–
                                       
                                          
                                             âˆ‡
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   â†’
                                                
                                             
                                          
                                       
                                       J
                                       
                                          
                                             â€–
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         âˆ‡
                                                      
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               â†’
                                                            
                                                         
                                                      
                                                   
                                                   J
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               âˆ‡
                                                            
                                                            
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     â†’
                                                                  
                                                               
                                                            
                                                         
                                                         E
                                                      
                                                      
                                                         â€–
                                                         
                                                            
                                                               âˆ‡
                                                            
                                                            
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     â†’
                                                                  
                                                               
                                                            
                                                         
                                                         E
                                                         â€–
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              â‰¤
                              0
                              .
                           
                        
                     
                  

Our derivation is based on the following equality for minimizing general active contour energy.
                        
                           (D-1)
                           
                              
                                 
                                    âˆ‚
                                    C
                                 
                                 
                                    âˆ‚
                                    t
                                 
                              
                              =
                              -
                              âˆ‡
                              J
                              =
                              Î±
                              (
                              p
                              )
                              
                                 
                                    N
                                 
                                 
                                    â†’
                                 
                              
                              .
                           
                        
                     Note that the equality holds true for geometric active contours.

The differential of the shape decision function 
                        
                           
                              
                                 Ï•
                              
                              
                                 S
                              
                           
                        
                      at the implicit contour leads to the following.
                        
                           (D-2)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                âˆ‚
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                (
                                                t
                                                )
                                                ,
                                                {
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                (
                                                t
                                                )
                                                }
                                                )
                                             
                                             
                                                âˆ‚
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                    âˆˆ
                                    {
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                    |
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                    =
                                    0
                                    }
                                 
                              
                              =
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              
                                 
                                    Ï•
                                 
                                 
                                    S
                                 
                              
                              Â·
                              
                                 
                                    âˆ‚
                                    C
                                 
                                 
                                    âˆ‚
                                    t
                                 
                              
                              +
                              
                                 
                                    D
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    D
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              +
                              
                                 
                                    D
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    D
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              =
                              0
                              ,
                           
                        
                     where 
                        
                           
                              
                                 âˆ‚
                                 
                                    
                                       Ï•
                                    
                                    
                                       S
                                    
                                 
                              
                              
                                 âˆ‚
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                              
                           
                           =
                           
                              
                                 âˆ‡
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                              
                           
                           
                              
                                 Ï•
                              
                              
                                 S
                              
                           
                        
                     , and 
                        
                           
                              
                                 âˆ‚
                                 C
                              
                              
                                 âˆ‚
                                 t
                              
                           
                           =
                           
                              
                                 âˆ‚
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                              
                              
                                 âˆ‚
                                 t
                              
                           
                        
                     . Note that C denotes the contour, and 
                        
                           
                              
                                 z
                              
                              
                                 â†’
                              
                           
                        
                      is the point on the contour. In addition, the dot product above denotes elementwise inner product for both vectors and matrices.

Substituting Eq. (D-1) into the above, we obtain the expression for 
                        
                           Î±
                        
                     .
                        
                           (D-3)
                           
                              Î±
                              =
                              -
                              
                                 
                                    
                                       
                                          D
                                          
                                             
                                                Ï•
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                          D
                                          
                                             
                                                A
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    Â·
                                    
                                       
                                          d
                                          
                                             
                                                A
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          dt
                                       
                                    
                                    +
                                    
                                       
                                          D
                                          
                                             
                                                Ï•
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                          D
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                    Â·
                                    
                                       
                                          d
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                       
                                          dt
                                       
                                    
                                 
                                 
                                    ã€ˆ
                                    
                                       
                                          N
                                       
                                       
                                          â†’
                                       
                                    
                                    ,
                                    
                                       
                                          âˆ‡
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                    ã€‰
                                 
                              
                              .
                           
                        
                     Substituting the (D-3) into (D-1) we obtain the curve evolution as follows.
                        
                           (D-4)
                           
                              
                                 
                                    âˆ‚
                                    C
                                 
                                 
                                    âˆ‚
                                    t
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       
                                          D
                                          
                                             
                                                Ï•
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                          D
                                          
                                             
                                                A
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    Â·
                                    
                                       
                                          d
                                          
                                             
                                                A
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                       
                                          dt
                                       
                                    
                                    +
                                    
                                       
                                          D
                                          
                                             
                                                Ï•
                                             
                                             
                                                S
                                             
                                          
                                       
                                       
                                          D
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                    Â·
                                    
                                       
                                          d
                                          
                                             
                                                b
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                       
                                          dt
                                       
                                    
                                 
                                 
                                    ã€ˆ
                                    
                                       
                                          N
                                       
                                       
                                          â†’
                                       
                                    
                                    ,
                                    
                                       
                                          âˆ‡
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                    
                                       
                                          Ï•
                                       
                                       
                                          S
                                       
                                    
                                    ã€‰
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    â†’
                                 
                              
                              .
                           
                        
                     
                  

To minimize a general active contour energy 
                        
                           J
                           (
                           C
                           )
                        
                     , we require the derivative of 
                        
                           J
                           (
                           C
                           )
                        
                      to be non-positive as
                        
                           (D-5)
                           
                              
                                 
                                    dJ
                                 
                                 
                                    dt
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          âˆ‡
                                          J
                                          ,
                                          
                                             
                                                âˆ‚
                                                C
                                             
                                             
                                                âˆ‚
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              â©½
                              0
                              ,
                           
                        
                     where 
                        
                           ã€ˆ
                           f
                           ,
                           g
                           
                              
                                 ã€‰
                              
                              
                                 p
                              
                           
                           =
                           âˆ«
                           ã€ˆ
                           f
                           (
                           p
                           )
                           ,
                           g
                           (
                           p
                           )
                           ã€‰
                           dp
                        
                      is the inner product of two vector functions in which 
                        
                           ã€ˆ
                           ,
                           ã€‰
                        
                      is the vector inner product. Substituting (D-4) into (D-5), considering 
                        
                           
                              
                                 N
                              
                              
                                 â†’
                              
                           
                           =
                           
                              
                                 âˆ‡
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       â†’
                                    
                                 
                              
                           
                           
                              
                                 Ï•
                              
                              
                                 S
                              
                           
                        
                     , we obtain the following:
                        
                           (D-6)
                           
                              
                                 
                                    dJ
                                 
                                 
                                    dt
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          âˆ‡
                                          J
                                          ,
                                          -
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                                Â·
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      dt
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                Â·
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      dt
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                                Â·
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      dt
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                Â·
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                   
                                                      dt
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              =
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                              J
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          A
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              +
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                              Â·
                              
                                 
                                    d
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                                 
                                    dt
                                 
                              
                              ,
                           
                        
                     where
                        
                           (D-7)
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          -
                                       
                                    
                                    1
                                 
                              
                              J
                              =
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (D-8)
                           
                              
                                 
                                    âˆ‡
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          â†’
                                       
                                    
                                 
                              
                              J
                              =
                              -
                              
                                 
                                    
                                       
                                          âˆ‡
                                          
                                             
                                                J
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                â†’
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         
                                                            Ï•
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ã€ˆ
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      â†’
                                                   
                                                
                                                ,
                                                
                                                   
                                                      âˆ‡
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            â†’
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ï•
                                                   
                                                   
                                                      S
                                                   
                                                
                                                ã€‰
                                             
                                          
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              ,
                           
                        
                     which gives Eqs. (16) and (17). In the gradient descent process, we can set 
                        
                           
                              
                                 d
                                 
                                    
                                       A
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                              
                                 dt
                              
                           
                           =
                           -
                           
                              
                                 âˆ‡
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                           J
                        
                      and 
                        
                           
                              
                                 d
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                              
                              
                                 dt
                              
                           
                           =
                           -
                           
                              
                                 âˆ‡
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       â†’
                                    
                                 
                              
                           
                           J
                        
                     .

@&#REFERENCES@&#

