@&#MAIN-TITLE@&#Can long-run dynamic optimal strategies outperform fixed-mix portfolios? Evidence from multiple data sets

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Analyze performance of optimal portfolios under predictability for HARA investors.


                        
                        
                           
                           The portfolio problem solved using dynamic programming and Monte Carlo methods.


                        
                        
                           
                           Benchmarks are fixed-mix strategies: equal-weight and a myopic Markowitz strategy.


                        
                        
                           
                           There are strong differences between mean–variance and optimal dynamic weights.


                        
                        
                           
                           No out-of-sample evidence that dynamic strategies outperform naive portfolios.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finance

Investment analysis

Portfolio choice

Predictability

@&#ABSTRACT@&#


               
               
                  Using five alternative data sets and a range of specifications concerning the underlying linear predictability models, we study whether long-run dynamic optimizing portfolio strategies may actually outperform simpler benchmarks in out-of-sample tests. The dynamic portfolio problems are solved using a combination of dynamic programming and Monte Carlo methods. The benchmarks are represented by two typical fixed mix strategies: the celebrated equally-weighted portfolio and a myopic, Markowitz-style strategy that fails to account for any predictability in asset returns. Within a framework in which the investor maximizes expected HARA (constant relative risk aversion) utility in a frictionless market, our key finding is that there are enormous difference in optimal long-horizon (in-sample) weights between the mean–variance benchmark and the optimal dynamic weights. In out-of-sample comparisons, there is however no clear-cut, systematic, evidence that long-horizon dynamic strategies outperform naively diversified portfolios.
               
            

@&#INTRODUCTION@&#

One of the most important problems faced by investors involves the allocation of wealth among risky assets. The task of determining optimal portfolios is a complex problem that depends on the objective of the investor, her horizon, any constraints, as well as the dynamic properties (forecasts) of the set of investment opportunities. In this setting, the objective of the investor has typically (but not exclusively, see e.g., Liu, 1999) been the maximization of the expected value of a utility function depending on either terminal wealth or, more realistically, on the flow of consumption that a portfolio may finance over time.

A rich literature straddling the empirical finance and operations research fields (see Section 2) has investigated applications of stochastic programming approaches to dynamic portfolio problems. Such methods become of particular interest when asset returns are predictable, i.e., when the investment opportunity set is time-varying, as in Barberis (2000) or Campbell, Chan, and Viceira (2003). Using a number of recursive, out-of-sample (OOS) experiments applied to five different data sets, in our paper we document whether, how, and when long-term strategies based on dynamic optimal portfolios (DOPs) that exploit predictability may outperform simple—one may argue, naive—fixed mix strategies in which an investor may either ignore predictability, holding constant weights over her investment horizon, or even disregard the properties of asset returns altogether and assign equal weights (EW) to each of the assets in a menu. In our paper we capture a wide range of linear predictability patterns from past asset returns and a set of predictors that the finance literature has shown to forecast economic conditions (such as the dividend yield, the riskless term spread, and the default spread between Baa- and Aaa-rated bonds, see Fama & French, 1989).

In the empirical finance literature, it is has been long known that portfolios selected according to the mean–variance (MV) criterion are unlikely to perform as well as equally weighted portfolios in OOS tests (see e.g., DeMiguel, Garlappi, & Uppal, 2009; Duchin & Levy, 2009). In this paper, we recast the key question in this literature—i.e., “If we have at least some information on the expected returns, riskiness, and diversification properties of the assets, limited though it may be, why should we not expect optimization to improve on a naively diversified portfolio?” (see Kritzman, Page, & Turkington, 2010, p. 31)—with reference not to simple MV strategies, but to stochastic programming approaches to long-horizon DOPs that exploit predictability. Notice that from an ex-ante perspective, the odds that the answer to this question may be positive are not easily guessed. On the one hand, full DOPs are based on large-scale econometric models that are exposed to both the risks of model misspecification and to the problems caused by estimation uncertainty concerning a large number of parameters. This would make one think that DOPs may not stand a chance to out-perform the naive fixed mix EW strategy. On the other hand, if investment opportunities are truly time-varying and statistically predictable, then the entire literature that has claimed the failure of optimizing models over EW may simply derive from the fact that important features of the actual set of investment opportunities have been ignored, so that the Markowitz-style MV strategies would be biased for the true but unknown portfolio weights. Our paper sheds light on these important issues.

As in Moreno and Olmeda (2007), we follow a quite simple but extremely computationally intensive approach: we build a variety of linear models estimated using several alternative information sets and use them to obtain forecasts of a significant number of return series, along an extensive time span. Subsequently we employ test procedures to detect any differences among models, information sets as well as specifications. Within a framework in which the investor maximizes expected HARA (constant relative risk aversion) utility in a frictionless market, our key finding is that there are enormous differences in optimal long-horizon (in-sample) weights between the Markowitz MV benchmark and DOPs. While all fixed mix strategies imply zero hedging demands by construction, in the case of long-run DOPs, the dividend yield causes rather large hedging demands to be optimal in most applications. In OOS comparisons, there is however no clear-cut, systematic (i.e., common to all the data sets investigated) evidence that long-horizon (60-month) dynamic strategies that take linear predictability into consideration may outperform—according to a simple Sharpe ratio metric—naive strategies such as a myopic MV and EW portfolios.

However, Sharpe ratios are, by construction, suitable risk-adjusted measures only for mean–variance investors and/or in the presence of normally distributed returns. Therefore the Certainty Equivalent Return (CER) represents, a more reliable OOS metric to rank competing strategies. Using a CER metric, we obtain a slightly more negative view of the actual chances of dynamic strategies that exploit linear predictability to outperform the benchmarks. Only in one of our five applications, there was evidence of DOP that exploit predictability within VAR frameworks producing useful portfolio signals, in terms of realized utilities. In three other applications it was instead the fixed mix strategy that outperformed all other models. However, only for one data set, the DOPs were systematically ranked below all benchmarks.

The structure of the paper is as follows. In Section 2 we review the literature, also to emphasize our contributions. In Section 3 we describe our research design and the structure of the statistical models that capture predictability, the dynamic portfolio problem, the solution methods, and the criteria used to test whether DOPs outperform the benchmarks. Section 4 describes the asset allocation strategies, with special emphasis on the conditions under which DOPs simplify to myopic, Markowitz-style ones. Section 5 describes our data sets. Section 6 compares ex-ante, recursive in-sample portfolio weights and hedging demands. Section 7 is the core of the paper as it documents realized OOS performances. Section 8 discusses our key results, a few additional robustness tests, and concludes.

@&#LITERATURE REVIEW@&#

A rich literature straddling the empirical finance (see e.g., Campbell & Viceira, 2002, and references therein) and operations research fields (see, among many others, Barro & Canestrelli, 2005; Buckley, Saunders, & Seco, 2008; Çanakoğlu & Özekici, 2010; Consigli & Dempster, 1998; Dantzig & Infanger, 1993) has investigated the applications of stochastic programming approaches to dynamic portfolio problems, with recent forays into applications in which asset returns are forecastable and the investment opportunity set is time-varying. In particular, finance scholars have long established a number of unsettling and thought-provoking results concerning the comparison of the realized OOS performance of myopic optimizing portfolios—often of a simple MV, Markowitz-style type—vs. simple, fixed mix strategies, such as the equally weighted (EW, also called 
                        
                           1
                           /
                           N
                        
                     ) one. For instance, since Frankfurter, Phillips, and Seagle (1971) it has been known that portfolios selected according to a MV criterion are unlikely to be as effective as EW. DeMiguel et al. (2009) and Duchin and Levy (2009) have recently reported evidence on this point with reference to a large array of alternative data sets, and provided intuition on what the determinants of this troubling result may be.


                     Kritzman et al. (2010) have re-examined this evidence and argued that poor optimization results may arise from reliance on rolling 60- and 120-month historical windows fed in the estimation algorithms supporting asset allocation. Without assuming the existence of any predictability, but using 13 alternative data sets, they find that in a 1-month ahead portfolio framework, investors may benefit from optimizing strategies provided they use sufficiently long-time series to estimate the MV inputs. We extend these systematic OOS comparisons to examine whether DOPs may outperform MV and EW strategies, especially over long horizons. Because under predictability, a full DOP may imply a component of portfolio weights that represents a hedging demand that provides investors with (self-) insurance against adverse dynamics in investment opportunities, such a comparison boils down to asking whether hedging may actually improve ex-post, realized performance.

The problem of comparing the realized performance of alternative portfolio strategies requiring different degrees of computational effort is of course not new to operational researchers. For instance, Fleten, Høyland, and Wallace (2002) have examined the relative performance of dynamic stochastic vs. naive, fixed mix approaches in a portfolio (strategic asset and liability) framework, finding that the former approach dominates a fixed mix approach, but that the degree of outperformance is much smaller when the models are compared in OOS tests than when they are assessed in-sample. They attribute this modest differences in OOS performance to the fact that in a forecasting context, it is often the case that the random input data may be structurally different from the in-sample scenarios, i.e., optimizing methods may incorrectly but forcefully rely on the assumption that the underlying data generating process is correctly specified. Interestingly, their fixed mix approach encompasses both benchmark strategies used in our paper.
                        2
                        In Fleten et al. (2002), fixed mix models consists of decision rules in which at every period, the portfolio is rebalanced to fixed proportions. In our paper we focus on EW strategies as these have been recently rediscovered by the empirical finance literature because of their strong realized OOS performance.
                     
                     
                        2
                      
                     Fleten et al. (2002) correctly emphasize the need for the comparison between optimizing and fixed mix portfolio strategies to be “(…) done in a fair and realistic way. Realistic here means a situation that is close to the practical use of the models, where the models are rerun at regular intervals.” Although highly realistic, their focus is on a multi-period, stochastic asset liability management model developed for a Norwegian life insurance company. We devote our attention, instead, to a large family of long-run DOPs that have been popular in the finance literature at least since the late 1990s (see, e.g., Campbell & Viceira, 2002) and that exploit rich patterns of linear predictability relating asset returns to well-known state variables.


                     Moreno and Olmeda (2007) have compared the realized OOS forecasting performance of a range of both linear (including vector autoregressive) and nonlinear (artificial neural networks) models for one data set composed of daily and weekly international stock returns. They use several types of rolling window estimation and prediction schemes, to find that nonlinear models do not provide superior predictions or portfolio weights. Although in our paper we follow the same general principle that carefully crafted OOS exercises may shed light on the underlying economic value of DOPs, our focus is on a linear models only, on a spread of five different data sets, and on long-horizon performance. Another, related paper is Fugazza, Guidolin, and Nicodano (2010) who have investigated the realized performance of linear predictability-based DOPs in a strategic asset allocation problem in which a power utility investor recursively selects the weights from an asset menu that includes stocks, bonds, publicly tradeable real estate, and cash. They do not focus, however, on truly stochastic programs with dynamic rebalancing. Moreover, their data represent just one of the five applications investigated in our paper.

Finally, let us emphasize that although our paper computes the realized OOS performance of a simple Markowitz-style portfolio, our goal is to use such a strategy only as a case of a fixed-mixed algorithm. We are aware of the fact that a vast literature has questioned the usefulness of simple MV strategies. For instance, Michaud (1989) has blamed MV optimizers for turning into simple “estimation-error maximizers.” Jorion (1985) and others have argued that the difficulty may stem from the extreme weights that often arise when constructing efficient portfolios that are extremely sensitive to changes in asset means. A literature has therefore developed that, besides investigating the reasons for MV dismal performance, have offered ways to either improve the quality of the inputs of the classical mean–variance problem or to constrain the problem to improve the effectiveness of the output (see, e.g., Leung, Ng, & Wong, 2012). Although some of our empirical results may bear evidence also on the debate on the true economic value of MV strategies, our main concern is on the realized performance of truly long-run DOPs that exploit predictability.

We perform recursive estimation, calculation of portfolio weights, and OOS performance evaluation for a large, encompassing family of vector autoregressive (VAR) models. This class of multivariate linear models represents the standard in the finance literature (see, e.g., Campbell et al., 2003; Moreno & Olmeda, 2007) to model time-varying investment opportunities (see Campbell & Viceira, 2002). The underlying assumption is that there exists a linear relationship between current returns on risky assets and their lagged values, as well as lagged values of a number of predictors that capture the time-varying nature of the opportunity set. A shock to any of the predictors at time t is linearly reflected in the (future) conditional distribution of risky returns at time 
                           
                              t
                              +
                              1
                           
                        . In particular, if the asset menu is represented as an 
                           
                              N
                              ×
                              1
                           
                         vector 
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                        , while the 
                           
                              M
                              ×
                              1
                           
                         dimensional vector of predictive variables is labeled as 
                           
                              
                                 
                                    y
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                        , a VAR (L) model may be written as
                           
                              (3.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 μ
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                         -
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                         -
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 Σ
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∼
                                       
                                       
                                          iid
                                       
                                    
                                 
                                 
                                 N
                                 (
                                 0
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       N
                                       +
                                       M
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              μ
                           
                         is a 
                           
                              (
                              N
                              +
                              M
                              )
                              ×
                              1
                           
                         vector of constants, the 
                           
                              (
                              N
                              +
                              M
                              )
                              ×
                              (
                              N
                              +
                              M
                              )
                           
                         coefficient matrices are 
                           
                              
                                 
                                    {
                                    
                                       
                                          A
                                       
                                       
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                         is a 
                           
                              (
                              N
                              +
                              M
                              )
                              ×
                              1
                           
                         vector of IID, Gaussian shocks, and 
                           
                              Σ
                           
                         is the Choleski factorization of the covariance matrix 
                           
                              Ω
                           
                        , i.e., 
                           
                              Ω
                              =
                              Σ
                              
                                 
                                    Σ
                                 
                                 
                                    ′
                                 
                              
                           
                         such that
                           
                              (3.2)
                              
                                 Ω
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         r
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         r
                                                         ,
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         y
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         y
                                                         ,
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    r
                                    ,
                                    r
                                 
                              
                           
                         is the covariance sub-matrix of asset returns only, while 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    y
                                    ,
                                    y
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    r
                                    ,
                                    y
                                 
                              
                              =
                              
                                 
                                    Ω
                                 
                                 
                                    y
                                    ,
                                    r
                                 
                              
                           
                         are the covariance sub-matrices of predictors and between assets and predictors, respectively. In this paper we consider different lags in the VAR (L) specification, i.e. 
                           
                              L
                              =
                              1
                              ,
                              2
                              ,
                              
                              and
                              
                              4
                           
                        . In practice, (3.1) has direct implications for the conditional dynamics of asset returns. For instance, assuming that a VAR (1) structure holds (as in most of the empirical finance literature, see e.g., Campbell et al., 2003), i.e., that 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              ≡
                              
                                 
                                    [
                                    
                                       
                                          r
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                    
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              L
                              =
                              1
                           
                        , the H-step ahead expected cumulative returns for the jth asset can be easily obtained from (3.1) as (
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                        )
                           
                              (3.3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   t
                                                
                                             
                                             [
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                   ,
                                                   t
                                                   +
                                                   2
                                                
                                             
                                             +
                                             ⋯
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                   ,
                                                   t
                                                   +
                                                   H
                                                
                                             
                                             ]
                                             =
                                             H
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             μ
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               h
                                                               =
                                                               1
                                                            
                                                            
                                                               H
                                                            
                                                         
                                                      
                                                      (
                                                      H
                                                      -
                                                      h
                                                      )
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                
                                             
                                             μ
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               h
                                                               =
                                                               1
                                                            
                                                            
                                                               H
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Cov
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      ⋯
                                                      +
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                            +
                                                            H
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            ,
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      ⋯
                                                      +
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            ,
                                                            t
                                                            +
                                                            H
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             H
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             Ω
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               h
                                                               =
                                                               1
                                                            
                                                            
                                                               H
                                                            
                                                         
                                                      
                                                      (
                                                      H
                                                      -
                                                      h
                                                      )
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      Ω
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    [
                                    0
                                    
                                    0
                                    
                                    1
                                    
                                    ⋯
                                    
                                    0
                                    
                                    0
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                         is a selection vector with one in the lth position, and 
                           
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    N
                                    +
                                    M
                                 
                              
                           
                        . In this paper we mostly focus on two alternative horizons, i.e., 
                           
                              H
                              =
                              1
                           
                         and 60, as short- and long-term investment horizon respectively. In order to increase the robustness of the model estimates, we used two different estimation approaches, namely, both rolling and expanding window methods.
                           3
                           The expanding approach entails to expand the sample size as more information, i.e. data, becomes recursively available over time. The coefficients estimated by expanding the sample size are more informative but less sensible to new information, since new information receives a lower weight. The rolling window method keeps fixed the length of the estimation sample. The parameter estimates are much more sensible to new information but estimates are less informative, being more unstable by construction.
                        
                        
                           3
                         A variety of Authors have argued in favor of the capability of rolling window estimation methods to protect users of econometric estimates against potential instability and parameter variation due to either omitted variables or to genuine breaks in model coefficients, (see e.g., Bhattacharyya, Chaudhary, & Yadav, 2008 and Laws & Thompson, 2008).

A popular benchmark to assess the marginal benefits of predictability in a dynamic portfolio context is the classical IID model. The underlying assumption is that there is no predictability in conditional risk premia, as well as homoskedasticity in the covariance structure. The VAR (L) model in (3.1) boils down to a Gaussian IID framework by setting 
                           
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              =
                              ⋯
                              =
                              
                                 
                                    A
                                 
                                 
                                    L
                                 
                              
                              =
                              O
                           
                        , 
                           
                              
                                 
                                    μ
                                 
                                 
                                    y
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    y
                                    ,
                                    r
                                 
                              
                              =
                              O
                           
                        , with 
                           
                              
                                 
                                    μ
                                 
                                 
                                    y
                                 
                              
                           
                         the subset of the vector of constants 
                           
                              μ
                           
                         that refers to predictors:
                           
                              (3.4)
                              
                                 
                                    
                                       r
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 μ
                                 +
                                 
                                    
                                       Σ
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                    
                                       r
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       ∊
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                    
                                       r
                                    
                                 
                                 ∼
                                 N
                                 (
                                 0
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       N
                                    
                                 
                                 )
                              
                           
                        and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    r
                                 
                              
                           
                         the first 
                           
                              N
                              ×
                              N
                           
                         block of 
                           
                              Σ
                           
                         in (3.1) such that 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    r
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    Σ
                                 
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                           
                        . Of course, the econometric model in (3.4) is routinely rejected by the data (see, e.g., Buckley et al., 2008; Liu, 1999) and yet it represents an important yardstick for reasons discussed in Section 4.1.

Consider the portfolio and consumption decisions of a finite horizon investor who maximizes expected, time-separable, constant relative risk aversion (CRRA) utility of his lifetime consumption,
                           
                              (3.5)
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            +
                                                            h
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            t
                                                            +
                                                            h
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                h
                                                =
                                                0
                                             
                                             
                                                H
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          0
                                       
                                       
                                          H
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 [
                                 U
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 ]
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            t
                                                            +
                                                            h
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            t
                                                            +
                                                            h
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                h
                                                =
                                                0
                                             
                                             
                                                H
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          0
                                       
                                       
                                          H
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      t
                                                      +
                                                      h
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with 
                           
                              γ
                              >
                              1
                           
                         and 
                           
                              δ
                              ∈
                              (
                              0
                              ,
                              1
                              )
                           
                         respectively, the relative risk aversion coefficient and subjective time discount factor, and 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                           
                         consumption at time t, and 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                           
                         the 
                           
                              N
                              ×
                              1
                           
                         vector of portfolio weights in the risky assets such that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    it
                                 
                              
                              =
                              1
                           
                        .
                           4
                           Notice the optimal consumption 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                    
                                 
                               is tightly linked to the optimal portfolio weights 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          t
                                       
                                    
                                 
                               (see Ingersoll, 1987 for more details). Direct dependence is not explicitly defined for the sake of clarity.
                        
                        
                           4
                         Clearly, the utility function featured in (3.5) belongs to the hyperbolic absolute risk aversion (HARA, linear risk-tolerance) class discussed by Çanakoğlu and Özekici (2010) and others.
                           5
                           The image of the utility function is bounded at 0 from above and unbounded from below. As pointed out in Geweke (2001) however, as far as the moment generating function (MGF) of consumption growth exists the expected utility is properly defined. Here, consumption is (conditionally) normally distributed, therefore the MGF exists and the expected utility can be characterized.
                        
                        
                           5
                         The expectation in (3.5) is conditional to the information set, that is, the state variables, available at time 
                           
                              t
                              ,
                              
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                           
                        , i.e., 
                           
                              
                                 
                                    E
                                 
                                 
                                    t
                                 
                              
                              [
                              ·
                              ]
                              =
                              E
                              [
                              ·
                              |
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              ]
                           
                        . In the case of a VAR (L), the vector of state variables is defined as 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              ≡
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                t
                                                -
                                                L
                                                +
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                t
                                                -
                                                L
                                                +
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                        . Note that the control variables 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                t
                                                +
                                                h
                                             
                                             
                                                H
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                t
                                                +
                                                h
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                 
                                 
                                    h
                                    =
                                    0
                                 
                                 
                                    H
                                    -
                                    1
                                 
                              
                           
                         are indexed by the overall investment horizon of the problem, H. Importantly, even though the investor in (3.5) derives utility from consumption flows, in this paper we are concerned with the certainty equivalent return of the stream of consumption flows that a given investment strategy supports, and not with consumption per se. However, (3.5) generates portfolios that differ from simple MV, Markowitz-style weights even when asset returns are conditionally normal. To see this, note that if one can assume that the utility function 
                           
                              U
                              (
                              
                                 
                                    C
                                 
                                 
                                    t
                                    +
                                    h
                                 
                              
                              ;
                              γ
                              )
                           
                         is continuously differentiable with 
                           
                              
                                 
                                    U
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              
                                 
                                    C
                                 
                                 
                                    t
                                    +
                                    h
                                 
                              
                              ;
                              γ
                              )
                              >
                              0
                           
                         (positive marginal utility), 
                           
                              
                                 
                                    U
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              (
                              
                                 
                                    C
                                 
                                 
                                    t
                                    +
                                    h
                                 
                              
                              ;
                              γ
                              )
                              <
                              0
                           
                         (strict risk aversion), for all 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                    +
                                    h
                                 
                              
                           
                        , and that for all 
                           
                              k
                              ⩾
                              3
                           
                         the following conditions hold
                           6
                           Assumption ((3.6)) is what Scott and Horvath (1980) call strict consistency for moment preference: the nth order derivative is either always negative, always positive, or everywhere zero for all possible wealth levels.
                        
                        
                           6
                        
                        
                           
                              (3.6)
                              
                                 sign
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 )
                                 
                                 is
                                 
                                 the
                                 
                                 same
                                 
                                 ∀
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                              
                           
                        then Scott and Horvath (1980) show that the following restrictions follow (see Joro & Na, 2006 & Menegatti, 2001 for discussion and references):
                           
                              
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 >
                                 0
                                 
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       4
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 <
                                 0
                                 
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       k
                                       
                                       odd
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 >
                                 0
                                 
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       k
                                       
                                       even
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       t
                                       +
                                       h
                                    
                                 
                                 ;
                                 γ
                                 )
                                 <
                                 0
                              
                           
                        This shows that in spite of any conditional normality in consumption flow, the investor described by (3.5) will for instance dislike kurtosis and like positive skewness, differently from a MV investor.

The gross portfolio return is a linear combination of the log-returns on each invested asset, with 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                    ,
                                    t
                                    +
                                    1
                                 
                              
                              ≡
                              (
                              1
                              +
                              
                                 
                                    r
                                 
                                 
                                    i
                                    ,
                                    t
                                    +
                                    1
                                 
                              
                              )
                           
                         the gross return at time 
                           
                              t
                              +
                              1
                           
                         on the ith asset. The joint dynamics of returns and state variables is described as in (3.1), (see Kandel & Stambaugh, 1987; Hodrick, 1992; and Barberis, 2000). The vector of state variables 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                           
                         is under the VAR (L) an 
                           
                              (
                              L
                              (
                              N
                              +
                              M
                              )
                              ×
                              1
                              )
                           
                        -dimensional vector. Conditional on the information available at time t the investor maximizes (3.5) under the intertemporal budget constraint
                           
                              (3.7)
                              
                                 
                                    
                                       W
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                    
                                       H
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                C
                                             
                                             
                                                t
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                r
                                             
                                             
                                                p
                                                ,
                                                t
                                                +
                                                1
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       κ
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 
                                    
                                       R
                                    
                                    
                                       p
                                       ,
                                       t
                                       +
                                       1
                                    
                                    
                                       H
                                    
                                 
                                 
                                 where
                                 
                                 
                                    
                                       R
                                    
                                    
                                       p
                                       ,
                                       t
                                       +
                                       1
                                    
                                    
                                       H
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       ,
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                        and consumes a fraction 
                           
                              
                                 
                                    κ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 
                                    t
                                 
                              
                              /
                              
                                 
                                    W
                                 
                                 
                                    t
                                 
                              
                           
                         of final wealth 
                           
                              
                                 
                                    W
                                 
                                 
                                    t
                                 
                              
                           
                        , then allocating the residual portion to a portfolio invested in the N risky assets. Here 
                           
                              
                                 
                                    R
                                 
                                 
                                    p
                                    ,
                                    t
                                    +
                                    1
                                 
                                 
                                    H
                                 
                              
                           
                         denotes the total, gross, portfolio returns computed for an investor with horizon H, adopting the optimal policies defined by the controls 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                                +
                                                h
                                             
                                             
                                                H
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                t
                                                +
                                                h
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                 
                                 
                                    h
                                    =
                                    0
                                 
                                 
                                    H
                                    -
                                    1
                                 
                              
                           
                        . Following the literature (see e.g., Çanakoğlu & Özekici, 2010), short selling is allowed for all assets in all periods, and transaction costs and fees are be zero, the outcome of the maximization of (3.5) subject to (3.7) is the DOP at investment horizon H.
                           7
                           In Section 8 and in Appendix C we comment on the effects of imposing short selling constraints. If there are short sale constraints on portfolio weights, then the portfolio problem needs to be explicitly modified to include the Kuhn-Tucker conditions. As discussed in Ingersoll (1987), the analysis underlying the envelope condition that supports our numerical approach to solve DOPs is still valid.
                        
                        
                           7
                         For 
                           
                              H
                              >
                              1
                           
                        , the problem in (3.5) is solved under continuous, dynamic rebalancing, to imply that an investor at time t solves the portfolio problem taking into account that at times 
                           
                              t
                              +
                              1
                              ,
                              t
                              +
                              2
                              ,
                              …
                              ,
                              t
                              +
                              H
                              -
                              1
                           
                         she will be allowed to re-shuffle her portfolio dynamically to take into account the updated information set composed of the state vector 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    H
                                    -
                                    1
                                 
                              
                           
                         (see Barro & Canestrelli, 2005).
                           8
                           However, in our recursive portfolio evaluation, for consistency we assess the actual, realized portfolio performance of the controls 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          H
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          H
                                       
                                    
                                 
                               over the sample period 
                                 
                                    [
                                    t
                                    +
                                    1
                                    ,
                                    t
                                    +
                                    H
                                    ]
                                 
                              , i.e., we record how the time t optimal portfolio would have performed if actually held over the investment horizon defined by the choice of H. Note that 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                       
                                          H
                                       
                                    
                                 
                               may replace optimal consumption 
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                       
                                          H
                                       
                                    
                                    
                                    (
                                    h
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    H
                                    -
                                    1
                                    )
                                 
                               because once 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                    
                                 
                               is known, a choice of 
                                 
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                       
                                          H
                                       
                                    
                                 
                               uniquely defines 
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          +
                                          h
                                       
                                       
                                          H
                                       
                                    
                                 
                              .
                        
                        
                           8
                        
                        The multiperiod optimal allocation can be represented as a sequential decision problem as given by an H-stage decision tree in (3.8).
                           
                              (3.8)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        The decision nodes at time periods 
                           
                              t
                              +
                              1
                              ,
                              t
                              +
                              2
                              ,
                              …
                              ,
                              t
                              +
                              H
                              -
                              1
                           
                         are denoted by 
                           
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    D
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    D
                                 
                                 
                                    t
                                    +
                                    H
                                    -
                                    1
                                 
                              
                           
                         and the random observation nodes are denoted by 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    O
                                 
                                 
                                    t
                                    +
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    O
                                 
                                 
                                    t
                                    +
                                    H
                                 
                              
                           
                        . At time t and decision node 
                           
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                           
                        , given the initial wealth 
                           
                              
                                 
                                    W
                                 
                                 
                                    t
                                 
                              
                           
                        , the investor chooses 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         with 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                          ,
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                          ,
                                          t
                                       
                                    
                                    ⋯
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          N
                                          ,
                                          t
                                       
                                    
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                        . At time 
                           
                              t
                              +
                              1
                           
                         the state variables 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                         are observed, i.e. the random node 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                         is reached. Next, given 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                        , at decision node 
                           
                              
                                 
                                    D
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                        , the investor chooses 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              }
                           
                        . This process is then repeated until 
                           
                              t
                              +
                              H
                              -
                              1
                           
                        . The solution of this problem involves dynamic programming and proceeds by maximizing the expected utility at each decision node (see Section 3.3 for a detailed explanation).

As discussed in Ingersoll (1987), among others, for 
                           
                              H
                              >
                              1
                           
                         the DOP problem in (3.5) and (3.7) yields a component of portfolio weights that can be characterized as a hedging demand (in addition to a static, myopic Markowitz-style demand), which is the component of the optimal weight that an investor obtains because of her desire to optimize the exposure of her welfare to future, adverse dynamics in investment opportunities as captured by the process of the state vector 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    H
                                    -
                                    1
                                 
                              
                           
                        .

The DOP problem (3.5)–(3.7) is solved using numerical methods applied within a dynamic programming approach (see e.g., Soyer & Tanyeri, 2006). The Bellman equation faced by the investor for a CRRA utility function derived from (3.5)–(3.7) is
                           
                              
                                 
                                    
                                       ϕ
                                       (
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       t
                                       )
                                       
                                          
                                             W
                                          
                                          
                                             t
                                          
                                          
                                             1
                                             -
                                             γ
                                          
                                       
                                    
                                    
                                       1
                                       -
                                       γ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          +
                                          
                                             
                                                δ
                                                
                                                   
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            κ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          E
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   t
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         p
                                                         ,
                                                         t
                                                         +
                                                         1
                                                      
                                                      
                                                         1
                                                         -
                                                         γ
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ϕ
                              (
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              ,
                              t
                              )
                           
                         is a function that can be computed numerically. Given that this optimization problem is homogeneous of degree 
                           
                              (
                              1
                              -
                              γ
                              )
                           
                         in wealth, the solution is invariant in wealth (see Çanakoğlu & Özekici, 2010).
                           9
                           Notice both the fraction of wealth consumed 
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          t
                                       
                                    
                                    /
                                    
                                       
                                          W
                                       
                                       
                                          t
                                       
                                    
                                 
                              , and the wealth, directly depends on the optimal portfolio 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          t
                                       
                                    
                                 
                              .
                        
                        
                           9
                         Hence the Bellman equation can be simplified to:
                           
                              (3.9)
                              
                                 
                                    
                                       ϕ
                                       (
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       t
                                       )
                                    
                                    
                                       1
                                       -
                                       γ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          +
                                          
                                             
                                                δ
                                                
                                                   
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            κ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          E
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   t
                                                   +
                                                   1
                                                   )
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         p
                                                         ,
                                                         t
                                                         +
                                                         1
                                                      
                                                      
                                                         1
                                                         -
                                                         γ
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Eq. (3.9) can be solved by backward iteration, starting with 
                           
                              t
                              =
                              H
                              -
                              1
                           
                         and setting 
                           
                              ϕ
                              (
                              
                                 
                                    Z
                                 
                                 
                                    H
                                 
                              
                              ,
                              H
                              )
                              =
                              1
                           
                         (or to any constant) and then computing 
                           
                              ϕ
                              (
                              
                                 
                                    Z
                                 
                                 
                                    H
                                 
                              
                              ,
                              t
                              )
                           
                         by solving the optimization problem in (3.9) using 
                           
                              ϕ
                              (
                              
                                 
                                    Z
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              ,
                              t
                              +
                              1
                              )
                           
                         from the previous iteration (see e.g., Çanakoğlu & Özekici, 2010, for details on this dynamic programming approach and conditions for the existence of an internal solution). The backward, recursive structure of the solution reflects the fact that the investor incorporates in the optimal weights computed at time t the fact that they will be revised in the future at times 
                           
                              t
                              +
                              1
                              ,
                              t
                              +
                              2
                              ,
                              …
                              ,
                              t
                              +
                              H
                              -
                              1
                           
                        , as new information becomes available through the vector of state variables 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                           
                        .

A variety of solution methods have been proposed in the literature. We employ Monte Carlo methods for integral (expected utility) approximation. The optimization problem is solved backwards at each time t (since the portfolio can be rebalanced every month), such that 
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                          
                                             q
                                          
                                       
                                       ,
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                         is known for all values of 
                           
                              q
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              Q
                           
                         on a discretization grid. Computing a Monte Carlo approximation of the expectation
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          ϕ
                                          
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        requires drawing G random samples of the state variables 
                           
                              
                                 
                                    {
                                    
                                       
                                          Z
                                       
                                       
                                          t
                                          +
                                          1
                                          ,
                                          g
                                       
                                    
                                    }
                                 
                                 
                                    g
                                    =
                                    1
                                 
                                 
                                    G
                                 
                              
                           
                         from the 
                           
                              t
                              +
                              1
                           
                         one-step joint density conditional on the period-t parameter estimates 
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    (
                                    μ
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    L
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                        , from the estimated VAR (L) model.
                           10
                           Differently from some earlier literature (see e.g., Barro & Canestrelli, 2005; Fleten et al., 2002), we do not assume that the uncertainty faced by the investor can be modeled or approximated using discrete probability distributions, via a scenario approach. It is well known that in discrete-time dynamic portfolio models, the backward solution requires to calculate the conditional densities at each step, see e.g., Dokuchaev (2007).
                        
                        
                           10
                         At this point, we solve the program
                           
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                             
                                                H
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          =
                                          1
                                       
                                       
                                          G
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                            ,
                                                            g
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                          ϕ
                                          
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                      
                                                         (
                                                         q
                                                         ,
                                                         g
                                                         )
                                                      
                                                   
                                                   ,
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                                 
                                    H
                                 
                              
                              ≡
                              
                                 
                                    [
                                    
                                       
                                          w
                                       
                                       
                                          1
                                          ,
                                          t
                                       
                                       
                                          H
                                       
                                    
                                    
                                    
                                       
                                          w
                                       
                                       
                                          2
                                          ,
                                          t
                                       
                                       
                                          H
                                       
                                    
                                    
                                    ⋯
                                    
                                    
                                       
                                          w
                                       
                                       
                                          N
                                          ,
                                          t
                                       
                                       
                                          H
                                       
                                    
                                    ]
                                 
                                 
                                    ′
                                 
                              
                           
                        . As 
                           
                              G
                              →
                              ∞
                           
                        , this provides an arbitrarily precise Monte Carlo approximation to 
                           
                              E
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1
                                             -
                                             γ
                                          
                                       
                                       ϕ
                                       
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                   
                                                      (
                                                      q
                                                      )
                                                   
                                                
                                                ,
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        . The value function evaluated at the optimal portfolio weights 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    H
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                          
                                             q
                                          
                                       
                                    
                                 
                              
                           
                         gives 
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                          
                                             q
                                          
                                       
                                       ,
                                       t
                                    
                                 
                              
                           
                         for the qth point on the grid. The algorithm is applied to all possible values 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                                 
                                    q
                                 
                              
                           
                         on the discretization grid until all values of 
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                          
                                             q
                                          
                                       
                                       ,
                                       t
                                    
                                 
                              
                           
                         are obtained for 
                           
                              q
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              Q
                           
                        . It is then iterated backwards. We take 
                           
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                          
                                             q
                                          
                                       
                                       ,
                                       t
                                    
                                 
                              
                           
                         as given and use the actual vector of state variables, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                           
                        . The corresponding vector 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    H
                                 
                              
                           
                         gives the optimal portfolio allocation at time t, while 
                           
                              ϕ
                              (
                              
                                 
                                    Z
                                 
                                 
                                    t
                                 
                              
                              ,
                              t
                              )
                           
                         is the optimal value function. In this case, our experience shows that 
                           
                              Q
                              =
                              36
                           
                         delivers quite accurate results (because of the linearity of the prediction framework) and we set 
                           
                              G
                              =
                              30
                              ,
                              000
                           
                        .

Our (pseudo) out-of-sample (OOS) experiment is performed by using a recursive sampling structure, since the investor is assumed to solve sequentially the portfolio problem. Each statistical model underlying our portfolio strategies (see Section 4) is recursively estimated over an overall 1975:01–2009:12 sample. The recursive scheme is updated at a monthly frequency using an initial, in-sample estimation period that spans the period 1975:01–1985:01 then updated by using either a rolling or an expanding window approach:
                           
                              •
                              Under an expanding window scheme, the estimation sample is simply extended by one month, to the period 1975:01–1985:02, producing again parameter estimates and portfolio weights; the scheme is recursively applied over time, until the last data point in the sample has been reached. For instance, the last in-sample period for the one-month horizon becomes 1975:01–2009:11
                                    11
                                    The loss of the last month in the overall sample is due to our need to assess the realized, OOS performance of the alternative strategies. More generally, given an investment horizon of 
                                          
                                             H
                                             ⩾
                                             1
                                          
                                        months, the recursive assessment extends until 2009:12-H months.
                                 
                                 
                                    11
                                 ; for the five-year horizon, the estimation sample at the end of the recursion is 1975:01–2004:12.

Under the rolling approach, the sample length is fixed (to 10years) and the scheme is rolled forward sequentially over time, until the last 10-year estimation window has been formed and used. For example, for the one-month horizon allocations, the last estimation period is 1999:12–2009:11; for the five-year horizon, it is 1995:01–2004:12.

For each investment horizon, H, we then solve for optimal portfolio weights at each time t. For, instance, under a 5-year horizon, the portfolio weights computed at the first iteration will be the optimal ones with reference to the period 1985:02–1990:01, then extended to 1985:03–1990:02, etc., until 2005:01–2009:12 is reached.
                           12
                           As we shall describe below, our paper employs 5 different but popular data sets. However, to ensure results are comparable across different data sets, OOS performance assessment has concerned the same 1985:02–2009:12 for all the data sets under investigation.
                        
                        
                           12
                         Portfolio rebalancing is allowed at the same frequency as the data, i.e. monthly, even under a long-run investment horizon, reflecting the forward-looking nature of portfolio decisions. In other words the optimal portfolio weights are computed every month, optimizing over a 5-years horizon under the long-run investment setting. What changes, then, is not the frequency of the data with which the dynamics of the state variable is estimated, but only the forecasting horizon. As in Fleten et al. (2002) and Kritzman et al. (2010), our recursive back-testing strategy ensures that we never use information on future realized returns when we allow our investor to optimize to take decisions concerning her portfolio.

Let us define the realized returns from model i when portfolios are computed at time 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                         with horizon H and risk aversion 
                           
                              γ
                           
                         as
                           
                              (3.10)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 (
                                 γ
                                 ,
                                 H
                                 )
                                 ≡
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       H
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       R
                                    
                                    
                                       t
                                       ,
                                       j
                                    
                                    
                                       H
                                    
                                 
                                 ≡
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          H
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                r
                                             
                                             
                                                t
                                                +
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                    +
                                    τ
                                 
                                 
                                    j
                                 
                              
                           
                         is the (nominal) realized return on the jth asset at time 
                           
                              t
                              +
                              τ
                           
                        . The first OOS performance measure adopted is the well known Sharpe ratio (SR). Given the definition of realized returns in (3.10), the SR has a standard definition
                           
                              (3.11)
                              
                                 
                                    
                                       SR
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 γ
                                 ,
                                 H
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             T
                                             -
                                             H
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             -
                                             H
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      i
                                                      ,
                                                      t
                                                   
                                                
                                                (
                                                γ
                                                ,
                                                H
                                                )
                                                -
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   T
                                                   -
                                                   H
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                   -
                                                   H
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        i
                                                                        ,
                                                                        t
                                                                     
                                                                  
                                                                  (
                                                                  γ
                                                                  ,
                                                                  H
                                                                  )
                                                                  -
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        f
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               T
                                                               -
                                                               H
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                            
                                                               T
                                                               -
                                                               H
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        i
                                                                        ,
                                                                        t
                                                                     
                                                                  
                                                                  (
                                                                  γ
                                                                  ,
                                                                  H
                                                                  )
                                                                  -
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        f
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                                 
                                    f
                                 
                              
                              ≡
                              
                                 
                                    ∏
                                 
                                 
                                    h
                                    =
                                    1
                                 
                                 
                                    H
                                 
                              
                              
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             r
                                          
                                          
                                             t
                                             +
                                             h
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                           
                         is the total gross return on the riskless asset over the interval 
                           
                              [
                              t
                              +
                              1
                              ,
                              t
                              +
                              H
                              ]
                           
                        . Following Ledoit and Wolf (2008), the null hypothesis 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    SR
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    SR
                                 
                                 
                                    EW
                                 
                              
                              =
                              0
                           
                        , namely, that the Sharpe Ratio under the ith strategy is not statistically different than the EW benchmark, is tested using a block bootstrap for the distribution of 
                           
                              
                                 
                                    
                                       
                                          SR
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          SR
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    EW
                                 
                              
                           
                        .

Although it is a popular measure, SR is appropriate only for a truly mean–variance individual investor. While suitable for the Gaussian IID framework, the SR may generate misleading conclusions when applied to predictability-based strategies that exploit time variation in investment opportunities (see Farinelli & Tibiletti, 2008). Under predictable asset returns and power utility, preference can in generally not be approximated as mean–variance objectives and as such an increase in the SR yielded by any given strategy does not necessarily imply an increase in the individual’s welfare, especially if this is achieved by altering the higher-order moments of portfolio returns away from what they should be under multivariate Gaussian returns.
                           13
                           For instance, let us consider an investor averse to negative skewness and to high kurtosis. Notice that under power utility, this is always the case. Suppose now that realized portfolio returns under the ith strategy display negative skewness and high kurtosis, along with a fairly high SR. However, the rank of different portfolio strategies exclusively based on the SR will not capture any preferences for higher moments.
                        
                        
                           13
                         Therefore, as a measure complementary to the Sharpe ratio we adopt the Certainty Equivalent Return (CER), which is defined as the riskless return an investor is willing to accept in order to avoid the lottery-like uncertainty on realized consumption flows financed by the portfolio generated by the ith strategy. When alternative strategies are ranked on the basis of their CERs, the assumption is that a rational, expected utility maximizing investor should also ex-post rank alternative asset allocation rules based on their ability to support welfare maximizing consumption flows. The OOS CER is computed as
                           
                              (3.12)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          0
                                       
                                       
                                          H
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      +
                                                      h
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                            
                                                               H
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          0
                                       
                                       
                                          H
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                      +
                                                      h
                                                   
                                                   
                                                      1
                                                      -
                                                      γ
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                γ
                                             
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       -
                                       δ
                                       
                                          
                                             CER
                                          
                                          
                                             i
                                          
                                          
                                             1
                                             -
                                             γ
                                          
                                       
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         CER
                                                      
                                                      
                                                         1
                                                         -
                                                         γ
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             H
                                             -
                                             1
                                             )
                                             /
                                             γ
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         is the monthly consumption flow an investor receives under a constant investment opportunity set simply composed of a riskless real asset that yields a monthly certainty equivalent of 
                           
                              
                                 
                                    CER
                                 
                                 
                                    i
                                 
                              
                           
                         (see Ingersoll, 1987, Ch. 11). In order to test for the statistical difference in the CERs between the ith strategy and the EW benchmark, we used a non-parametric bootstrap approach. The bootstrapped p-value (
                           
                              α
                           
                        ) under the null hypothesis 
                           
                              
                                 
                                    H
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    CER
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    CER
                                 
                                 
                                    EW
                                 
                              
                              =
                              0
                           
                         is computed as
                           
                              (3.13)
                              
                                 α
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         boot
                                                      
                                                   
                                                   >
                                                   d
                                                
                                             
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       K
                                       +
                                       1
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                                
                                                   boot
                                                
                                             
                                             >
                                             d
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         boot
                                                      
                                                   
                                                   >
                                                   d
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    boot
                                 
                              
                           
                         denotes the difference, in absolute value, between the ith strategy and the EW benchmark in the kth bootstrap, d is the observed difference, and K is the number of bootstrap iterations.

Given our key research question—whether predictability in dynamic portfolio problems may be exploited to outperform either simple mean–variance, Markowitz-style strategies and/or simple fixed mix strategies (such as the equally-weighted strategy)—in this paper we solve the expected utility maximization of (3.5) and (3.7) subject to a number of alternative restrictions concerning either the problem itself and/or the underlying econometric framework to deliver three sets of alternative asset allocation strategies:
                        
                           1.
                           A rich set of predictability-based asset allocation strategies, i.e. DOPs from (3.5)–(3.7) when the assumed econometric model is (3.1); the set of strategies is obtained by considering all possible combinations of 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          M
                                       
                                    
                                    -
                                    1
                                 
                               predictors that may enter the multivariate transfer model (3.1) and alternative values of L, the number of lags considered in the model.
                                 14
                                 The total number of model considered is 
                                       
                                          
                                             
                                                2
                                             
                                             
                                                M
                                             
                                          
                                          -
                                          1
                                       
                                     and not simply 
                                       
                                          
                                             
                                                2
                                             
                                             
                                                M
                                             
                                          
                                       
                                     because we do not entertain the case in which none of the predictors is included in the model, but only lags of asset returns are used to forecast subsequent returns.
                              
                              
                                 14
                              
                           

A benchmark Gaussian IID model, also called no-predictability mean–variance (MV) strategy, that corresponds to the case in which optimal policies are computed from (3.5)–(3.7) but assuming the simple econometric benchmark in (3.4); of course, in this case, both the choice of predictors and the number of lags become irrelevant to the strategy.


                              Fixed mix portfolio strategies, in particular the equally-weighted (EW), 
                                 
                                    1
                                    /
                                    N
                                 
                               strategy of Frankfurter et al. (1971), DeMiguel et al. (2009) and Kritzman et al. (2010); these correspond to case in which the investor is restricted to select her optimal policies disregarding expected utility maximization, so that the specific econometric framework used to forecast conditional means and (co)variances of asset returns become irrelevant.

Importantly, when (3.5)–(3.7) was solved, this has been further parametrized by:
                        
                           (i) The coefficient of constant relative risk aversion, 
                                 
                                    γ
                                 
                              ; in this paper we use 3 alternative coefficients, 
                                 
                                    γ
                                    =
                                    2
                                 
                              , 5, and 10.
                                 15
                                 Although the choice of 
                                       
                                          γ
                                          =
                                          5
                                       
                                     is typical as a baseline parametrization, it is of some importance to check the robustness of our empirical results to changes in the coefficient of relative risk aversion imputed to the investor. 
                                       
                                          γ
                                          =
                                          2
                                       
                                     is a relatively low degree of risk aversion destined to make an investor aggressive in exploiting any signal she may believe to forecast subsequent asset returns; 
                                       
                                          γ
                                          =
                                          10
                                       
                                     corresponds instead to a high degree of caution.
                              
                              
                                 15
                              
                           

(ii) The investment horizon, H; in this paper we experiment (where relevant) with 
                                 
                                    H
                                    =
                                    1
                                 
                               (short-term) and 60months (long-run asset allocation).

(iii) The expanding or rolling estimation scheme.

Because in this paper we use three standard predictors that are typical in the empirical finance literature—the dividend yield, the term spread, and the default spread—while all possible 
                        
                           
                              
                                 2
                              
                              
                                 3
                              
                           
                           -
                           1
                           =
                           7
                        
                      combinations of the predictors are considered, and analyze 5 different data sets (further described below in Section 5), the total number of alternative optimizing portfolio strategies is 1,077. Table 1
                      gives a summary of models and strategies and explains how these depend on the different parameters introduced above.

Sections 4.1 and 4.2 illustrate in detail the properties of the no-predictability MV and of the EW fixed mix strategies.

Under the Gaussian IID, no predictability model in (3.1), the investment opportunity set does not vary over time, so that the value function does not depend on any state variable and hedging demands are nil. Indeed, in the IID setting the portfolio choice is myopic, namely, long- and short-term optimal portfolios coincide (see Dokuchaev, 2007; Samuelson, 1969). As pointed out in Ingersoll (1987), the scale independence of the power utility function in (3.5) implies that consumption is a constant fraction of wealth. Yet, by considering IID returns, there can be no changes in consumption which are led by changes in the investment opportunity set, which is restricted to be stable over time. Therefore, under Gaussian IID returns the consumption-wealth ratio is constant and the optimal demand for the risky asset boils down to the myopic portfolio allocation from a standard Markowitz mean–variance allocation,
                           16
                           Another, alternative interpretation of this finding comes from a second order Taylor expansion of the power utility function. In this case, at least in the continuous time limit (or under equivalent technical assumptions detailed in Samuelson (1969)), only the first two moments of the returns distribution matter.
                        
                        
                           16
                        
                        
                           
                              (4.1)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       IID
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       γ
                                    
                                 
                                 
                                    
                                       Ω
                                    
                                    
                                       r
                                       ,
                                       r
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                 with
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 diag
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       r
                                       ,
                                       r
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   σ
                                                
                                                
                                                   N
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        where 
                           
                              γ
                           
                         is the relative risk aversion coefficient and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    r
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         is the expected excess asset return under a log-normal distribution. Crucially, 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    IID
                                 
                              
                           
                         stops depending on the horizon H, which is consistent with the idea that under (3.4) investment opportunities are constant so there is no rationale for changing 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    IID
                                 
                              
                           
                         when H changes. The structure of 
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    IID
                                 
                              
                           
                         in (4.1) makes it also clear that, apart for the log-normal 
                           
                              
                                 
                                    σ
                                 
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         correction, optimal weights in the absence of predictability acquire a typical, myopic MV flavor, in which only static estimates of the covariance matrix and of expected returns matter.
                           17
                           As shown in Ingersoll (1987), (4.1) also represents the first, baseline component of optimal portfolio weights under dynamic predictability as characterized by 3.5–3.7 when the assumed econometric model is (3.1), the difference between 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          H
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          t
                                       
                                       
                                          IID
                                       
                                    
                                 
                               being an investor’s hedging demand.
                        
                        
                           17
                        
                     

The traditional single-period MV model developed by Markowitz (1952) has been the basis of portfolio theory. As it is well known, despite its wide-ranging success, this static framework suffers from an important deficiency: It is difficult to apply to long-term investors for whom investment decisions should be evaluated taking into account investment opportunity predictions that go beyond static risk-reward trade-offs. Moreover, it is well-known (see e.g., Liu, 1999) that the MV model does not approximate very well its claimed normative foundation, the von Neumann-Morgenstern (vNM) expected utility theory.
                           18
                           In the absence of restrictions on the statistical distribution of asset returns (such as normality in (3.1)), the MV model is inconsistent with dominance and vNM rationality; the MV model is consistent with the vNM theory if the value function is quadratic, returns are bounded, and unlimited short selling is not allowed.
                        
                        
                           18
                        
                     

Our second benchmark strategy is the well-known equally-weighted portfolio. This naively-diversified portfolio allocation strategy implies the investor allocates her initial wealth evenly within the asset menu, holding equally weighted shares over the relevant investment horizon. As emphasized by Kritzman et al. (2010) there are a number of reasons for why the EW strategy may easily outperform more complex, optimizing strategies: it avoids concentrated positions; on rebalancing dates, it sells (buys) assets that have grown more (less) than other assets in relative terms and therefore exploits any mean-reversion effects; it never under-performs the worst performing asset and always assigns positive weight to the best performing asset; it may capture a small capitalization premium because it overweights small-cap stocks and under-weights large-cap stocks. Note however that this static strategy is far from being a zero-cost one, as in order to keep the wealth equally allocated across the N assets in the menu, an investor should re-shuffle the amount invested in each of the assets as their prices fail to change generating identical returns.

Even though easy to implement, the EW strategy is sub-optimal, not only in a decision-theoretic perspective, but also in a purely financial perspective, because it ignores the risk-return profile of assets when choosing the optimal allocation. Therefore, from a theoretical, ex-ante standpoint, naively-diversified portfolios should under-perform more structured strategies. However, the practical implementation of naively-diversified portfolios avoids both estimation and optimization errors, minimizing the effects of estimation errors, of potential biases in the selected estimators, as well as model misspecification. This of course derives from the fact that EW does not involve the need to estimate any parameters or return moments. As already mentioned in the introduction, a literature has developed that emphasizes the good, realized out-of-sample performance of EW portfolios, e.g., DeMiguel et al. (2009) and Kritzman et al. (2010), compared to simple, MV strategies. In this paper, we extend this literature by comparing the EW benchmark with predictability-based allocation strategies in a dynamic portfolio context.

Each data set consists of an asset menu along with a list of predictors. The five data sets employed in this paper use alternative asset menus: (i) the three Fama and French (1992) factor portfolios (i.e., the market (MKT), SMB and HML); (ii) 10 industry-sorted portfolios (plus the market): (iii) 8 MSCI international equity portfolios (plus the MSCI world market portfolio) that also include 3 emerging market indices (see Moreno & Olmeda, 2007); (iv) six size- and book-to-market sorted portfolios; (v) a strategic asset allocation data set that includes data on U.S. stock, bond, real estate (in the form of publicly traded investment vehicles, REITs), and 1-month T-bill returns. As typical in applied finance and given our comparative reliance on homoskedastic models, we focus in this paper on monthly data. The five data sets are listed in Table 2
                      and described in Appendix A.

The set of predictive variables consists of: the dividend yield (DY) on equities, the term spread (TS) (yield curve slope) on government bonds, and the default (credit quality) spread (DS), measured as the difference between the Baa and Aaa corporate bonds yields. These predictors all relate to the state of the U.S. economy (or, better, they are predictors of the future state of the U.S. economy, see e.g., Fama & French, 1989) but even which reference to asset menu that include foreign stocks (as in one of our applications) they are commonly believed to also display some forecasting power (see e.g., Ang & Bekaert, 2007; Moreno & Olmeda, 2007). Details on the construction methodology of the three predictors are provided in Appendix A. Our choice of predictive variables is governed by the existing literature on return predictability which provides evidence on the forecasting ability of the dividend yield, default spread and the term spread as leading indicators of future asset returns (see Welch & Goyal (2008), for discussion and references to the literature). We do not extend the set of predictors beyond these three variables on purpose to keep the multivariate VAR (L) model as parsimonious as possible without losing coherence with the empirical finance predictability literature. Indeed, note that three predictors and three alternative lag settings in (3.1) generate already 21 different VAR models. Adding many more predictors than 3, would generate a a high and soon difficult-to-control number of VAR models. However, in Appendix C we report selected results for the case in which the set of predictors is expanded, to guard against the possibility that our empirical findings may be mostly driven by our choice of DY, TS, and DS as the three key predictors in the analysis.

Before proceeding to the recursive computation of optimal portfolio weights and the comparative assessment of OOS portfolio performances, it is useful to briefly examine the forecasting performance of the models by using standard statistical criteria. The idea is that it may be ill-advised to engage in extensive recursive portfolio calculations opposing a rich set of VARs to fixed mix portfolios and Markowitz-style myopic strategies when the former were unable to produce more accurate forecasts than the benchmarks do.
                           19
                           A Gaussian IID model yields forecasts that simply correspond to the sample mean, while fixed mix strategies rely on inconsistent forecasts that assume all assets have identical expected returns. Because calculations concern the flow of consumption that portfolio positions may support, these are actually more related to cumulative asset returns than to point, H-step ahead forecasts of asset returns, where 
                                 
                                    H
                                    =
                                    1
                                 
                               and 60months. Therefore in Appendix D we report forecast measures that refer to cumulative returns, 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          H
                                       
                                    
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   t
                                                   +
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              .
                        
                        
                           19
                         In order to measure the accuracy of the asset returns forecasts we use two standard criteria, namely, the Mean Absolute Forecast Error (MAFE) and Forecast Error Variance (FEV), defined in Appendix D. The Appendix shows that there is at least some weak evidence that already in a purely forecasting perspective, exploiting predictability may provide a moderate edge over simpler models that do not do so. However, for a few of our data sets, the poor predictability performance for cumulative returns may already anticipate some potential weakness of predictability-based dynamic portfolio strategies. Yet, because the loss functions underlying the comparisons to be performed in Section 7—based on the expected utility maximization in (3.5)–(3.7)—are considerably different to the typical statistical indicators MAFE and FVE of predictive performance, it remains to be seen whether such less than convincing forecasting scores may indeed translate in sub-optimal portfolio decisions.

One of the key objectives of our paper is to investigate whether the often stated outperformance of EW, fixed mix portfolios may survive the comparison to strategies that are based on exploiting dynamic predictability to find optimizing long-term asset allocations in which there are non-zero hedging demands. As it is obvious, it is possible for dynamic portfolio decisions to outperform OOS EW or Markowitz-style strategies if and only if the former produced recursive portfolio weights that are structurally and systematically different from the latter, or, equivalently, when the recursive solution of the problem (3.5)–(3.7) under VAR predictability models:
                           
                              •
                              Fails to yield constant portfolio weights (as opposed to the EW benchmark);

Gives non-negligible long-horizon hedging demands (as oppose to the Markowitz, myopic IID benchmark).

We therefore start our treatment by plotting recursive portfolio decisions—both for the cases of 
                           
                              H
                              =
                              1
                           
                         and 
                           
                              H
                              =
                              60
                           
                        —for a few illustrative strategies. Here, we avoid anticipating results on the best performing VAR strategies in OOS terms by simply plotting optimal recursive weights for the OOS period 1985–2009 for a VAR (1) model that includes all the predictors (
                           
                              M
                              =
                              3
                           
                        ), obtained assuming 
                           
                              γ
                              =
                              5
                           
                        . For instance and to save space by focussing on one application with a small 
                           
                              N
                              =
                              3
                           
                         asset menu, Fig. 1
                         reports long-horizon DOP weights for the MKT/SMB/HML data set, computed under both expanding and rolling estimation schemes.
                           20
                           Complete results for all data sets and choices of 
                                 
                                    γ
                                 
                               are available from the Authors upon request.
                        
                        
                           20
                        
                     

The optimal weights under the expanding window approach appear to be more stable over time as opposed to higher instability under the rolling estimation scheme. The different level of variability in optimal weights across the alternative estimation schemes is obviously due to the accumulation of information that affects the recursive estimates under the expanding scheme: the increasing sample size under the expanding scheme reduces, from a frequentist point of view, the estimation uncertainty around the moment estimates. This evidence on the differential volatility of optimal weights is robust across models and data sets. The bold (dashed) black (green
                           21
                           For interpretation of color in Fig. 1, the reader is referred to the web version of this article.
                        
                        
                           21
                        ) line in Fig. 1 represents the myopic, Gaussian IID weights under an expanding (rolling) approach. Yet, a simple, visual comparison reveals the deep differences in optimal long-horizon weights between the Markowitz mean–variance style benchmark and DOP weights, which is what one would expect in the light of the portfolio theory as well as of the earlier empirical literature.

Tabulated results in Appendix E translate the visual impression in Fig. 1 into a complete set of summary statistics for the overall sample. As one would expect, OOS standard deviation of the optimal recursive weights is consistently lower under the expanding window than under the rolling window scheme. Moreover, at least for intermediate and high relative risk aversion levels (
                           
                              γ
                              =
                              5
                           
                        , 10), long-term weights are more stable than short-term ones. Similarly, dynamic weights are considerably less volatile—and this applies also in a comparison with 
                           
                              H
                              =
                              1
                           
                         weights—than the Gaussian IID ones. The overall role of risk aversion is easily detected in terms of aggressiveness of the investor: as 
                           
                              γ
                           
                         grows, and under all the models under examination, the standard deviation of recursive weights declines as more risk averse investors tend to keep stable portfolio weights rather than re-shuffle them widely over time.

The differences between myopic and long-run DOP demands, that take predictability into account, are equivalently seen through the lenses of hedging demands: whenever these are non-zero and large in absolute value, this is an indication that a dynamic portfolio optimizer that solves (3.5)–(3.7) under a VAR model will hold portfolios that are different from Markowitz-style ones. Of course, also all fixed mix strategies—when applied to long-horizon problems—do imply zero hedging demands by construction. To this purpose, Appendix E computes the recursive hedging demands implied by DOP weights. We find that DY implies large hedging demands across all assets in the MKT/SMB/ HML data set, positive for SMB and the MKT a negative but declining in absolute value for the HML portfolio. The large hedging demands induced by DY confirm the results in Campbell et al. (2003), who showed that hedging demands increase when DY is included in the set of regressors of a linear model. The increasing hedging demand from DY is due to its high persistence and a strong negative correlation (−0.68) between unexpected portfolio returns in the MKT/SMB/HML data set and shocks to DY itself, which is largely persistent in levels.
                           22
                           Here the mechanism is rather simple: as explained in Campbell and Viceira (2002), the persistence of a predictor makes it capable to forecast the future dynamics in investment opportunties; however, also a large (in absolute value) magnitude of the correlation between shocks to the predictor and asset returns is crucial because this measures the strength of the connection between future changes in investment opportunities and asset performance, i.e., how much each portfolio is exposed to the general state of the market.
                        
                        
                           22
                         TS has instead a lower effect on the optimal hedging demands, which is still consistent with the empirical findings reported by Campbell et al. (2003). Finally, the DS turns out to yield a negative hedging demand of the MKT portfolio, while the opposite holds for SMB.

As a further assessment of the importance of hedging demands, in Appendix E we also investigate the effect of the sample size on the optimal hedging demand. The relative stability of DOP weights under the expanding vs. the rolling window estimation approach is confirmed by the plots of hedging demands. Moreover, while under the rolling scheme, hedging demands change sign rather frequently over time, which corresponds to a very different perception of long- vs. short-run risks, this does not happen for hedging components computed under expanding window schemes, which are at most trending over time.

Our findings in Section 6 show that VAR models typically deliver short- and long-run optimal, recursive, portfolio weights which depart from a benchmark Gaussian IID model (and of course, simpler, ad hoc fixed mix strategies). However, these findings are suggestive, at best, from an investors’ perspective, because they simply correspond to ex-ante assessments. An investor will indeed care for investigating the actual, realized, OOS performances of the alternative strategies examined in Section 4. Therefore in this section we proceed to compute—for all the data sets listed in Table 2 and for alternative preferences as parametrized by 
                        
                           γ
                        
                     —the performance measures introduced in Section 3.4, i.e., SR and CER, over our OOS period, 1985–2009. Tables 3
                      through 7 report the realized OOS rankings of the strategies listed in Table 1, with special emphasis on long investment horizons.
                        23
                        The realized OOS short-term performances of the DOPs, which are of minor importance for our goals, are reported in Appendix B.
                     
                     
                        23
                     
                  


                        Tables 3 and 4
                         report some of the key results of the paper concerning realized, annualized Sharpe ratios.
                           24
                           The reported 95% confidence intervals for SR have been computed by applying a block bootstrap to each of the recursive realized portfolio performance time series.
                        
                        
                           24
                         We start from SR because it represents a commonly reported performance index in the practitioners’ literature, even though it is not completely consistent with the objective in (3.5)–(3.7) that has been maximized in the presence of predictability (see Moreno & Olmeda, 2007, for discussion of a related point). Besides ranking strategies according to their realized SR, the tables also report a few additional sample statistics concerning realized portfolio returns, such as their means, volatility, skewness and excess kurtosis (i.e., in difference vs. the Gaussian benchmark of 3). In particular, the tables are structured in the following way: we always report the performance of the myopic no predictability strategies and EW, indicating on the left their comparative ranking; we also report the performance of the two best VAR-based strategies
                           25
                           Because the Gaussian IID strategy may be implemented under both the expanding and rolling window estimation schemes, we limit ourselves to report the best performing between these two.
                        
                        
                           25
                        ; this is performed for 
                           
                              γ
                              =
                              2
                           
                        , 5, and 10, to provide a reasonable span over commonly used values of the risk aversion coefficient. Table 3 starts by detailing results for the MKT/SMB/HML and the International data sets.

The table shows that on the one hand, DOPs, that exploit predictability, cannot be easily dismissed on the basis of their realized OOS SRs: in the case of MKT/SMB/HML, VAR-based strategies consistently yield two of the top three SRs and always outperform simple Markowitz-style myopic strategies, which always feature at least a dozen dynamic strategies implying a higher SR; in the case of the International data set, the dynamic strategies also yield two of the top three SRs and always outperform the EW strategies, even though in this case a myopic strategy always gives either the best or the second best performance. On the other hand, the table also shows that for these two data sets, one dynamic strategy turns out to be best only in 2 cases out of 6, in the sense that at least one of the two other benchmarks always leads to higher realized SRs. However, the differences between SR are generally modest, and in fact we can only conclude that the EW strategy outperforms the Markowitz-style myopic portfolio for 
                           
                              γ
                              =
                              2
                           
                         and 5, and in the case of the MKT/SMB/HML application, where for instance a Gaussian IID model estimated under an expanding scheme leads to a SR of 0.56 vs. 0.73 for the EW case, and the difference has a bootstrapped p-value below 0.05, similarly to what reported by DeMiguel et al. (2009). In particular, in the case of the International data set there is no evidence that either dynamic or myopic long-run strategies outperform the fixed mix portfolios applying tests with standard size of 5%.


                        Table 4 reports results concerning the U.S. Industry and Size- and Value-sorted data sets. Here we have two persistent findings. First, a number of long-run DOPs, based on VAR models, perform better than myopic Gaussian IID strategies that ignore predictability by construction. In this case, especially for 
                           
                              γ
                              =
                              5
                           
                         and 10 we notice that the difference in SR between predictability-based and myopic strategies is often far from negligible. For instance, in the case of the size- and value-sorted data, for 
                           
                              γ
                              =
                              5
                           
                         we find that the SR for the best-performing rolling window VAR (4) that employs the DY as a predictor leads to an annualized SR of 0.40 against a 0.14 from the expanding window Gaussian IID model. Importantly, the Markowitz-style strategies generally rank rather poorly. For the data sets in Table 4 the best ranking (27th) is attained by an expanding window implementation of the Gaussian IID model. Second, however the DOPs are systematically inferior to simpler, fixed mix EW strategies for both data sets. The differences tend to be rather large, comparable for instance to those reported by DeMiguel et al. (2009), and are commonly statistically significant. For instance, in the case of the U.S. Industry data set and 
                           
                              γ
                              =
                              5
                           
                        , while the best performing expanding window VAR (2) based on the DY leads to a SR of 0.20, 
                           
                              1
                              /
                              N
                           
                         returns a SR of 0.62. The tendency for DOPs to yield realized portfolio performances characterized by negative skewness and positive excess kurtosis persists, as in Table 3. Finally, while in Table 3 there was no clear pattern as to the order of the VAR dominating in SR rankings, in Table 4 we notice that it is VAR (2) and VAR (4) that tends to do better in OOS performance comparisons.


                        Table 5
                         concerns instead the SAA data set. Interestingly, these results are directly comparable to those obtained for the International data set in Table 3: the EW benchmark goes back to being dominated by at least a few (as EW tends to rank between 7th and 9th) dynamic strategies and especially by simple myopic portfolios that always rank first. Moreover, the differences in SRs between both the best ranking VAR expanding window models as well as Markowitz strategies and the fixed mix strategy are systematically statistically significant. These results are consistent with those reported in similar OOS experiments by Fugazza et al., 2010. It remains the case that the strategies that exploit predictability tend to produce positive skewness, although for this fifth data set, it is also the case that this likeable positive asymmetries are compensated by thick tails.

In unreported tables (available in Appendix B), we have also investigated the realized SR performance of short-term strategies, obtained by solving the optimization problem in (3.5)–(3.7) assuming 
                           
                              H
                              =
                              1
                           
                        . We find results that are qualitatively in line with those in Tables 3–5 with reference to 
                           
                              H
                              =
                              60
                           
                        : just as in DeMiguel et al. (2009), the naively-diversified portfolios represent tough benchmarks to outperform, even though there are data sets in which also myopic, mean–variance type strategies seem to nicely hold their grounds against DOPs. This is true across models, risk aversions, data sets and investment horizons.

Our conclusion is that there is no clear-cut, systematic evidence that 60-month horizon dynamic strategies that take linear predictability into consideration may outperform in a SR metrics simpler, possibly even naive strategies such as a myopic mean–variance style portfolio à la Markowitz (this is the case of the International and SAA applications) and fixed mix strategies (EW in the case of the U.S. Industry and size- and value-sorted applications). Only in one case—the Fama–French factor-based data set with 
                           
                              N
                              =
                              3
                           
                        —we obtained evidence that for some levels of the parameter 
                           
                              γ
                           
                         it is possible for a few small-scale, rolling window VAR to induce better portfolio choices than under simpler benchmarks. Interestingly, most of the best performing dynamic strategies under the SR measure imply negative skewness (i.e., realized performances are asymmetric to the left, which should be welfare-decreasing to a HARA investor) and high excess kurtosis (i.e., realized performances have tails fatter than a Gaussian distribution, which should be welfare-decreasing to a HARA investor). By construction, these features of realized portfolio returns are not reflected in a SR ranking that ignores the actual realized utility of consumption flows. Higher-order moments (positive skewness and low excess kurtosis), indeed, are bound to increase the realized utility of a CRRA investor as in (3.5). Section 7.2 examines this conjecture by ranking strategies on the basis of their realized CER.

The Sharpe ratios show that naive strategies, such as the Gaussian IID and EW, represent relevant benchmarks to test the ability of long-term DOPs under CRRA preferences to perform well in OOS exercises. However, SRs are, by construction, suitable risk-adjusted measures only for mean–variance investors and/or in the presence of normally distributed realized portfolio outcomes (here, consumption streams, given the structure of (3.5), see Buckley et al., 2008). Therefore the CER in (3.12) represents, both economically and statistically, a more reliable OOS metric for us to rank the competing strategies. Table 6
                         starts by reporting the results concerning the MKT/SMB/HML and the International data sets. Also in this case, we focus on 60-month strategies and report results for the case of 
                           
                              H
                              =
                              1
                           
                         in Appendix B. Note that the CER are reported as annualized figures, i.e., 0.082 means 8.2% per annum.


                        Table 6 only partially confirms the results in Table 3 for the same data sets. In panel A, with reference to MKT/SMB/HML data, we have strong evidence of the ability of DOPs to perform better than any of the benchmarks. For instance, for 
                           
                              γ
                              =
                              5
                           
                         we find that best performing VAR (4) that includes all predictors yields a CER of 7.3% per year, to be compared to 4.8% in the case of the Markowitz-type myopic strategy and 4.5% for the fixed mix EW portfolio. For 
                           
                              γ
                              =
                              2
                           
                         and 5, block-bootstrapped tests indicate that the VAR-based strategies significantly outperform the EW benchmark (i.e. boldfaced numbers). Panel B, concerning the International data set, shows instead that also in a CER rank, the dynamic VAR-based portfolios have problems outperforming other models; however, and differently from Table 3, the best performance is now guaranteed by the fixed mix EW strategy, which is the only strategy able to lead to positive realized OOS CERs.

The results in Table 7
                         confirm the findings in panel B of 6: the EW strategy outperforms all other strategies and the distances are rather large. For instance, for the size- and value-sorted data set with 
                           
                              γ
                              =
                              5
                           
                         leads to a CER of 8.3% from the 
                           
                              1
                              /
                              N
                           
                         strategy vs. −1.6% (hence, inferior to the certain riskless rate for our sample) from the best VAR (2) model based on the dividend yield. Interestingly—and in spite of the good higher-moment properties of the dynamic strategies—such a good realized utility performance comes from the high mean return guaranteed by the EW benchmark. On the opposite, simple myopic strategies perform now very poorly, as the Gaussian IID model never ranks above the 21st position in the CER-based ranking. Interestingly, the rolling window strategies disappear from the table, an indication that a rolling window estimation scheme creates enough instability in the optimal weights (as observed in Section 7) to eventually hurt the realized welfare of an optimizing investor.

Finally, Table 8
                         presents CER-sorted results for the SAA data set. In this case, the indications as to the realized OOS performance are consistent with those in Table 5: the myopic strategy yields the highest realized CER (e.g., 15.1% per year in the case of 
                           
                              γ
                              =
                              5
                           
                        ) followed in this case by the EW benchmark (e.g., 8.8%). In this application, the dynamic VAR-based strategies are outperformed by both benchmarks also because they lead to negative, disappointing CERs. Further inspection of the time series of realized utilities reveals that this occurs because—in the absence of short-sale restrictions—DOP weights become often extreme to the point of occasionally leading to close-to-zero realized wealth in (3.7); when this occurs, a rational investor cannot finance any or little consumption and the features of power utility as such that as 
                           
                              
                                 
                                    C
                                 
                                 
                                    t
                                    +
                                    h
                                 
                              
                              →
                              
                                 
                                    0
                                 
                                 
                                    +
                                 
                              
                           
                         for 
                           
                              h
                              ⩾
                              1
                           
                        , realized utility goes to 
                           
                              -
                              ∞
                           
                        . Although this occurs rarely, one of few such occurrences over our OOS back-testing periods are normally sufficient to lead to a very low or even negative CER, as found in Table 8.
                           26
                           We have replicated these OOS CER comparisons for the case of 
                                 
                                    H
                                    =
                                    1
                                 
                               strategies finding qualitatively similar results. Detailed results are reported in Appendix B which is part of the additional material.
                        
                        
                           26
                        
                     

All in all, Tables 6–8 lead to a slightly more nuanced and negative view on the actual chances of DOPs, that exploit linear predictability, to outperform the benchmarks that we have adopted in this paper. Only in one application, to the Fama–French factor portfolios in Table 6, there was evidence of VAR models producing useful trading signals within the framework 3.5, 3.6 and 3.7, in terms of realized utilities. In three other applications it was instead the EW fixed mix strategy that outperformed all other models. However, only for one data set, the DOPs were systematically ranked last among all models. Interestingly, one may argue that it may be the choice of resorting to econometric models per se that may lead to this striking result in favor of fixed mix strategies. The impact of estimation error on long-term strategies is twofold because any parameter uncertainty will affect both the myopic component as well as hedging demands, leading to largely incorrect optimal allocations. Of course, our OOS performance results concerning DOP strategies are conditional on the choice of a VAR setting to capture time-varying investment opportunities, as typical in both the finance (see e.g., Campbell et al., 2003) and operations research literatures (see e.g., Moreno & Olmeda, 2007).

@&#DISCUSSION AND CONCLUSIONS@&#

Should long-run investors flock to implement DOP methods that take into full account any statistical evidence of predictable returns in the available data? As far as the widely used and investigated linear predictability models—of the vector autoregressive type and under standard choices of predictors—are concerned, our paper has provided a moderately negative answer: especially when criteria that take directly into account the realized utility of investors (such as CER) are used to rank the portfolio strategies, our evidence from five alternative data sets and a rather comprehensive range of 1,077 alternative optimizing strategies is that only occasionally the best performing (as opposed to average, randomly chosen dynamic strategy) VAR-based portfolios have systematically outperformed the simple benchmarks entertained in this paper. This result does not depend from the assumed coefficient of risk aversion of the investor. Even though the evidence is slightly more favorable to dynamic optimizing strategies under a simpler Sharpe ratio criterion and it was observed that hardly ever both benchmark fixed mix strategies (MV and EW) outperformed the best VAR-based portfolios, the finding casts doubts on how useful and economically valuable simple off-the-shelf optimizing methods may actually be.

In unreported robustness checks (see Appendix C), we find that these empirical results are remarkably resilient to several alternative experiments. For instance, we have divided our overall back-testing sample in four sub-samples containing each approximately five years of monthly data, (i.e., 1985:01–1990:06, 1990:07–1995:12, 1996:01–2001:06, 2001:07–2006:12). The OOS performances measured in terms of both SRs and CERs are then re-computed across the different sub-samples. In overall terms, even though some instability has been occasionally observed, the results in Section 7 hold in each of the sub-samples. Given that the presence of regimes in financial data has been widely documented, we have also computed realized OOS performances comparing periods of bear and bull markets, as classified by standard multivariate Markov switching models. Also in this case, there is some evidence that only the best VAR-based portfolio strategies may compete with simple benchmarks in all regimes. We have also performed calculations subject to short sale constraints, 
                        
                           
                              
                                 w
                              
                              
                                 i
                                 ,
                                 t
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                      for the SAA data set. We find that imposing constraints improves the comparative—relative to the EW strategy and the classical MV strategy—performance of DOPs. As one would expect, the constraints considerably reduce the realized OOS Sharpe ratios and, although to a lesser extent, also realized OOS CERs. However imposing short-sale constraints does not radically alter our conclusion that outperforming fixed-mix strategies in recursive OOS experiments using DOP strategies is difficult. We have shrunk the amount of estimation error affecting our OOS performance measures by performing afresh calculations for the MKT/SMB/HML data set, when the exercise is initialized to an in-sample estimation period 1975:01–1994:12 to include from the very start 240 observations per series. This set up implies around 23 data points per parameter or parameter at each point in time. Increasing the amount of information fed into DOP asset allocation strategies does not seem to produce statistically different performances across models and relative to either fixed-mix or MV-type strategies. Finally, we have also entertained expanding the set of predictors employed in our OOS tests.
                        27
                        The benefit of including additional predictors is investigated by considering, in addition to DY, TS, and DS: (1) the rate of growth in the M2 monetary aggregate; (2) the CPI inflation rate; (3) the change in the unemployment rate; (4) the rate of growth in industrial production; (5) the personal consumption expenditure growth rate; (6) the 30-year mortgage rate; (7) the rate of growth in housing starts.
                     
                     
                        27
                      We conclude that adding or changing predictors, even though this often slightly improves the OOS performances of the different strategies considered, does not generate a sensible effect on the qualitative nature of the results.

However, it must be observed that the problem may lie as much with dynamic optimizing portfolios as with our specific implementation of these methods in this paper. Even though the spirit of our research design has consisted in adopting the most popular choices that have appeared in the finance literature, a number of details of the research design might be subject to deeper scrutiny so that it cannot be ruled out that our empirical findings may consequently be affected. For instance, in this paper we have only entertained the case in which asset returns are linearly predictable using simple vector autoregressions. However, the applied statistics literature contains massive evidence that asset returns contain nonlinear, regime switching patterns that may describe the predictability in financial returns as well as or better than vector autoregressions do (see e.g., Guidolin & Hyde, 2012). In practice, our finding that dynamic optimizing strategies fail to generate adequate economic value may be the result of a difference between the information that affects our in-sample VAR estimates and the data generating process from which the realized asset returns are subsequently drawn (see Fleten et al., 2002). It is possible that DOPs may exploit in-sample information in the data sets better than the fixed mix portfolios do, and yet implementing such strategies in practice may prove misleading to the point of destroying portfolio value (in risk-adjusted terms) because of the presence of parameter uncertainty and misspecification. It would be interesting to investigate whether the empirical results in our paper as to the problems that VARs encounter in out-performing fixed mix strategies extend to the case of, for instance, asset returns governed by modulating Markov chains that represents the economic and political factors that affect markets (see e.g., Çanakoğlu & Özekici, 2010; Moreno & Olmeda, 2007). If these more complex predictability models were better specified and/or less subject to the effects of estimation uncertainty, then they may lead to better OOS performance.

Additionally, we have evaluated competing portfolio strategies on the basis of their realized, back-tested CER as well as of their realized Sharpe ratio. While the former measure was selected because entirely consistent with the way dynamic portfolio problems have been formulated and appears to be an increasingly dominant criterion in financial economics (see Gollier, 2004, and references therein), the Sharpe ratio has been reported only because it tends to populate the practitioners’ literature. It would be therefore interesting to supplement CERs and SRs as tools to rank strategies. For instance, Farinelli and Tibiletti (2008) have emphasized the explicit importance of skewness with respect to a benchmark. Joro and Na (2006) have argued in favor of a new paradigm in portfolio performance measurement which is based on mean–variance-skewness framework.

Finally, our dynamic optimizing strategies have not taken transaction costs into account. Yet, especially in the presence of multivariate linear predictability, such costs are likely to be very important and to possibly further worsen the relative performance of long-run optimizing vs. benchmark strategies. Because both the empirical finance (see e.g., Guidolin & Hyde, 2012) and the operations research literatures (see e.g., Barro & Canestrelli, 2005) have paid attention to transaction costs in dynamic optimization, it would be important to extend our research design to this important case. We leave this and related extensions to future research.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.01.030.


                     
                        
                           Supplementary material
                           
                        
                     
                  

@&#REFERENCES@&#

