@&#MAIN-TITLE@&#Improving reliability of live/dead cell counting through automated image mosaicing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a new two-stage image-based approach to perform cell counting.


                        
                        
                           
                           Counting is performed on big high-resolution images of the whole hemocytometer's grid.


                        
                        
                           
                           Counting the cells by also tagging the big image improves counting reliability.


                        
                        
                           
                           Big images are built using GridMos, our fully-automated mosaicing software.


                        
                        
                           
                           Both GridMos source code and a standalone executable version are freely available.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Widefield microscopy

Image processing

Oncology

Cell counting

Hemocytometer

Cancer treatments

@&#ABSTRACT@&#


               
               
                  Cell counting is one of the basic needs of most biological experiments. Numerous methods and systems have been studied to improve the reliability of counting. However, at present, manual cell counting performed with a hemocytometer still represents the gold standard, despite several problems limiting reproducibility and repeatability of the counts and, at the end, jeopardizing their reliability in general. We present our own approach based on image processing techniques to improve counting reliability. It works in two stages: first building a high-resolution image of the hemocytometer's grid, then counting the live and dead cells by tagging the image with flags of different colours. In particular, we introduce GridMos (http://sourceforge.net/p/gridmos), a fully-automated mosaicing method to obtain a mosaic representing the whole hemocytometer's grid. In addition to offering more significant statistics, the mosaic “freezes” the culture status, thus permitting analysis by more than one operator. Finally, the mosaic achieved can thus be tagged by using an image editor, thus markedly improving counting reliability. The experiments performed confirm the improvements brought about by the proposed counting approach in terms of both reproducibility and repeatability, also suggesting the use of a mosaic of an entire hemocytometer's grid, then labelled trough an image editor, as the best likely candidate for the new gold standard method in cell counting.
               
            

@&#INTRODUCTION@&#

Since the invention of the hemocytometer (attributed to Louis-Charles Malassez, 1842–1909), cell counting has become a common procedure performed routinely in thousands of laboratories all over the world. Furthermore, at the beginning of the 20th century, with the introduction of the cell staining in standard analyses, e.g. Trypan Blue to assess cell viability [1], live and dead cell counting became one of the most common biological procedures [2]. Nowadays, obtaining accurate counts of cells still is a crucial issue for many applications in different fields [3], such as industrial manufacturing [4], botany [5], biology [6], veterinary medicine [7], and human medicine [8]. In oncology, for example, live and dead cell counting is typically performed to monitor the viability of cancer cells after different chemical [9] or radiobiological treatments [10]. Count accuracy can strongly influence the choice of treatment [11] and also lead to adjustments in the chemotherapeutic protocol [12] and in the drugs dosage administered to the patient [13].

At present, a wide number of methods and systems are available for cell counting [14] ranging from fully automated commercial instruments [15] and flow cytometry systems [16], to image processing methods [17] also embedded in software provided in bundle with automated microscope or image acquisition systems [18]. New approaches are constantly being developed [19]. However, the original method of manual cell counting using a hemocytometer and a manual tally counter together with a light widefield microscope, the most widely used approach over the last three decades [4], still represents the gold standard [20] as well as the predominant method [21]. A recent study reports that more than 70% of operators use a hemocytometer each day for counting cells [22]. Nonetheless, the use of a hemocytometer and a tally counter leads to subjectivity [21] and, if more operators are used to improve accuracy, overall reliability may be jeopardized by cell conditions changing between counts.

In this work we present a computer vision-based approach to improve reproducibility (inter-rater reliability) and repeatability (intra-rater reliability) of the gold standard counting method. In particular, we propose a non-invasive method to “freeze” the status of the cells in the hemocytometer that can then be used for repeated counting by one or more operators, independently of each other. This is achieved through GridMos (http://sourceforge.net/p/gridmos), a multi-image based method written in MATLAB (©, The MathWorks, Inc., MA, USA), that yields one high resolution mosaic [23] from several images depicting overlapping parts of the whole hemocytometer's grid. The procedure of “fusing” several images into only one has various names, e.g. image registration, aligning, or, more generically, mosaicing [24]. In particular, the mosaicing methods permit to overcome the trade-off between pixel resolution and width of sensor's Field Of View (FOV, area of the sample represented into the image [25]) obtaining one final large image. Furthermore, counting cells using a single mosaic rather than a set of images, provides a more robust approach to solve the problem of establishing a priori a representative field of the whole sample [26] and preventing double counts, for instance in case of same cells repeated between images or at the edge of the different FOVs [27].

Images in histology and cytology are normally obtained by using a light widefield microscope [28], which is not typically endowed with motorized stage [29]. Accordingly, several mosaicing software tools are typically used to obtain a mosaic of a set of overlapping images manually acquired. The first solution is offered by tools needing a manual outline of the images layout to achieve the final mosaic, such as MosaicJ 
                     [30]. Alternatively, in other tools such as Hugin panorama stitching software (http://sourceforge.net/p/hugin), the registration scheme is defined by selecting one of the available models, that however are not suitable for the hemocytometer's grid. Finally, several fully-automatic solutions have been then proposed to obtain mosaics without requiring any prior information [31,32]. However, these tools typically fail when used to registered images with highly repeated patterns only, such as the squared blocks of an empty hemocytometer's grid. In general, very few stitching tools can be used with effectiveness also to obtain a mosaic of microscopy images [33], Microsoft Image Composite Editor (http://research.microsoft.com/en-us/um/redmond/groups/ivm/ICE/) and Autostich 
                     [34] among them, originally proposed for outdoor image mosaics. Nevertheless, registration and image blending are not fully described in Microsoft Image Composite Editor 
                     [35] and Autostich forces on adopting a homographic registration model, often degenerating in a distorted mosaic when used with hemocytometer's images. Furthermore, some of these methods fail to define the correct shift between the images to be stitched when reference features are not marked, as in the case of images characterized by a very low contrast (e.g., brightfield images of cells [36]).


                     GridMos has been designed specifically to automatically obtain mosaics of hemocytometer's images acquired by manually moving the sample holder of the microscope. In practice, it is an extension of the mosaicing method presented in one of our previous studies [31] as regards the spatial registration strategy that we implemented from scratch to correctly stitch images with repeated patterns. In particular, to determine where the images must be stitched, the overlapping region between each pair of subsequent images is analyzed to detect meaningful correspondences and, consequently, the right spatial shift considering the first image acquired as the reference one. In practice, in order to accurately register the images of the hemocytometer's grid, we devised and implemented a proper frequency domain approach based on the analysis of the peaks of phase correlation. Furthermore, we developed an effective “blending” technique to make the final mosaic seamless and consistent so as to fix the problem of visible seams in the stitching zones (i.e., colours inhomogeneity and vignetting [37]), which could lead to incorrect cell counting, above all in automatic methods [38]. As a matter of fact, manual counting is a very tedious task and often operators when possible try exploiting, in the very early stage, automatic software to assist them in tagging what, at a first sight, appear to be single cells.

In our counting approach, once achieved the mosaic of the whole hemocytometer's grid (obtained with GridMos or, in principle, with other software tools considered accurate enough for one's own purposes), an image editor software is used to count the cells by manually adding flags of different colours [39]. The idea to count the cells by tagging an image is not new [40]. Many works report comparisons of automatic image processing methods with or the manual cell counting performed by looking to the microscope's oculars [41], or by tagging an image [42]. It is worth mentioning the work of Drury et al. 
                     [43], where counts performed by using labelled images where compared to counts obtained by looking at the same images and counting visually trough a manual tally counter (i.e., without adding flags). Nevertheless, two operators only were enrolled to count, and they did not even analyzed live and dead cells separately. Recently, Young et al. 
                     [44] improved the statistics by asking four operators to count, but they did not report results regarding either inter-observer variability or dead cells. In conclusion, no statistical analyses have been reported in literature to extensively compare the gold standard method with an approach based on a labelled mosaic. Neither, live and dead cells have been ever considered separately.

In this work, we compared the outcome of the proposed mosaic-based approach and of the gold standard method, by separately considering live and dead cells, also reporting reproducibility and repeatability statistical analysis. In particular, in order to assess the effectiveness of the proposed counting approach we performed two sets of experiments by counting cells of different cancer lines. In the first experiment, seven expert operators counted sequentially in blind the live and dead cells in two samples, the first time according to the gold standard method and then using the mosaic. In the second experiment, three operators counted the cells of their own grid three times. Finally, we asked one expert operator to count five times the same sample, also acquiring a new image set between each manual counting step. The obtained results prove that the reliability markedly improves when counting is performed using our proposed approach. Accordingly, the proposed approach may be suggested as the best likely candidate for the new gold standard method in cell counting.

The next sections are organized as follows. Section 2 presents a short overview of the most widely used counting devices and methods. Section 3 provides a detailed description of the proposed counting approach is reported. Section 4 describes the materials used in the experiments, whose results are presented in Section 5 and amply discussed in Section 6.

A revolutionary breakthrough in cell counting was provided by the Coulter system, developed more than 50 years ago by Wallace Coulter (1913–1998) [45]. The technique involves the application of an electric field across a micron-sized aperture and a hydrodynamic system to guide single particles through the aperture. The occlusion of the aperture yields a measurable change in the electric impedance that can be directly correlated to the size and, indirectly, to the presence of a cell. The Coulter system opened the doors to the derived technology, the flow cytometry [46], where the cell suspension is convolved into a stream of fluid passing through a very sensitive laser-based detection apparatus [20]. Cytometry represents the most versatile solution to analyze a wide range of cell characteristics: fluorescence dyes are typically added to the culture to highlight live and dead cells [47] as well as to study different chemical–biological features [48]. Several problems limit the usage of a flow cytometer. First and foremost, not all the laboratories can afford a flow cytometry system: in addition to be fairly expensive [49], it requires an expert technician for both usage and maintenance [50]. Furthermore, the sample analyzed must be a suspension of single cells [16], since aggregates can damage the system and compromise the analysis. Furthermore, thousands of cells are required for each analysis in order to obtain reliable data [22]. In practice, flow cytometry is not used routinely when the main purpose is limited to counting live and dead cells.

A further method for counting cells is represented by dedicated devices designed specifically for this purpose [51], i.e., the so-called “cell counters” available from different companies (e.g., we normally use NucleoCounter® 
                     [52], ChemoMetec, Allerod, Denmark). Although these instruments exploit different technologies and physical properties, all of them were conceived to count multiple single-cell samples [21]. They are also a very rapid way of counting cells. However, many laboratories do not use these devices because of their accuracy is limited to a specific range of cells. Currently, the most widely used approach to cell counting is still manual counting performed using a hemocytometer.

Different types of commercial hemocytometer chambers are available, e.g. Burker (Rogo-Sampaic, Wissous, France), Newbauer (Rogo-Sampaic), Nageotte (Hausser Scientific Company, Horsham, Pennsylvania, USA) and Fuch-Rosenthal (Electron Microscopy Sciences, Hatfield, Pennsylvania, USA) [53]. These devices basically differ in terms of material, type of ruled area and cover slip. However, they all work in the same way: the counting chamber is delineated by a grid (impressed or painted) containing a fixed sample volume. The operator counts the cells inside the grid where the dead ones are typically highlighted using Trypan Blue [54]. The number of live and dead cells present in the whole culture is finally obtained by multiplying the number of counted cells by the dilution factor used. Despite its simplicity, several problems affect the manual counting procedure [55]. First of all, these counts are performed manually and are thus they are labour intensive [56] and operator dependent [57]. Some authors report that manual counting produces standard deviations of 5–10% by skilled operators [58]. Furthermore, when both live and dead cell analyses are performed, keeping the sample reading time to a minimum is crucial. In fact, during the analysis the sample dries out, the cells die and the Trypan Blue diffuses into the culture medium. In addition to being time-consuming in itself (approximately 20min are needed to count 2000 cells [44]), manual counting is also a tedious task [59], which slows down the entire process. Often, it is possible to count only once before the sample starts changing and the counts are not repeatable, accordingly. In addition, if several samples need to be counted, the microscope position is kept busy, preventing other operators from using it.

Several image processing methods have been developed to count cells in on assisted [60] or automatic way [26] using hemocytometer [61] or multi-well plate images [62]. For example, Mahmood and co-workers [63] exploit the Hough transform [64] to extract circular objects considered to be the cells. Other commonly used processing techniques involve watershed segmentation [65], image thresholding [66] and morphological operators [67]. Although all of these methods are appealing, they fail to discriminate accurately between cells of different shapes, live and dead cells and small aggregates. For example, the algorithm proposed in [52], albeit capable of automatically detecting, counting and tracking cells, may fail in the presence of cell aggregates. Numerous other solutions have also been proposed to better classify the different cells, but all of them are characterized by constraints that limit their applicability. For instance, Allalou and co-workers [68] proposed a user-friendly software for counting cells, which, however, works for fluorescence images only. More recently, Huth and co-workers [36] proposed a very interesting MATLAB tool to count cells also in phase-contrast and DIC images. However, the accuracy of the methods to automatically separate live and dead cells, debris and impurities or dust on the lens requires more in-depth analysis. Finally, Geissmann [17] proposed OpenCFU, a robust software able to count cells also in brightfield images containing grids and debris. Nevertheless, OpenCFU does not differentiate live and dead cells. Furthermore, the count accuracy is affected by colour inhomogeneity of the image, and problems such as vignetting could mislead the entire analysis. In conclusion, the approaches based on image processing methods typically provide rapid solutions for counting cells [69]. Nevertheless, there is still no general image-based method capable of accurately counting both live and dead cells, of all possible cell typologies (i.e., cells with different size and different morphologies of dead cells), in a typical situation where the images present debris and colour inhomogeneity. Thus, for the above reasons, manual counting using a hemocytometer still represents the gold standard.

@&#METHODS@&#


                     Fig. 1
                      schematizes the approach we suggest for counting live and dead cells. It is composed of four main stages: sample preparation, hemocytometer image acquisition, mosaic building, assisted image tagging of live and dead cells.

Our approach is based on the analysis of a sample using a hemocytometer after a staining stage of the dead cells to be recognized. In particular, our approach works with any hemocytometer and in this study, a commercial KOVA glasstic slide with grids was used as the counting chamber. Each KOVA slide is composed of 10 different counting chambers to count the cells of 10 samples. To make the count easier, each chamber is then subdivided into small blocks (9×9) by a painted grid (Fig. 2
                        ). In particular, each grid is of 3mm×3mm×0.1mm, containing a sample volume of 0.9μL. Samples were prepared by staining the cells with Trypan Blue (a detailed description is provided in Section 4) and the cell suspension was then placed on the KOVA slide using a standard pipette.

Low magnification objectives are normally used to count cells [70]. In this way, combined with the fact that the KOVA counting chambers are really shallow (i.e., 0.1mm), the problem of out-of-focus cells [71] is practically negligible. Nevertheless, the very low contrast of the cells [72], especially when they are visualized in brightfield [36], often makes them not easily detectable (Fig. 3
                        ). In our approach the microscope is used for few minutes only, just the time needed to acquire the images. In practice, in order to obtain a mosaic representative of the whole hemocytometer's grid, for each sample to be counted, 11 overlapping images were needed and acquired using a 4× magnification factor, according to the scheme reported in Fig. 4
                        . Using different standard microscopes and digital cameras we proved that in practice a dozen of images adequately cover the whole grid. However, since the FOVs of different digital cameras have a different extent, we suggest the acquisition of an appropriate number of images to cover the hemocytometer grid by keeping about 75% overlap between pairs of subsequent images.

Despite the various mosaicing methods proposed in the literature [73], there are no general solutions suitable to build accurate mosaics of images characterized by a low contrast and highly repeated structures. The method we propose is based on a “Frame-To-Frame” registration strategy [29] and it is able to register image at pixel accuracy, yielding a seamless mosaic thanks to compensation of colours inhomogeneities in the stitching regions. GridMos is conceived to work off-line with phase-contrast or brightfield images, also acquired with no motorized widefield microscopes. The method exploits visual information only and it does not rely on either automated equipment or prior information.

To manage registering the images containing highly repeated patterns we modified the standard Phase Correlation (PC) algorithm [74], a well-established frequency-domain approach (based on Fast Fourier Transform, FFT) widely employed to estimate the translational shift between a pair of partially overlapped images. In order to help the reader appreciate the changes we brought to the standard PC algorithm, we briefly resume its main stages. First of all, each image I
                           
                              i
                            to be registered is transformed into the matrix G
                           
                              i
                            using the 2D FFT. The cross-power spectrum R
                           (i,i+1) between a pair of subsequent images (I
                           
                              i
                           , I
                           
                              i+1) is then computed according to Eq. (1):
                              
                                 (1)
                                 
                                    
                                       
                                          R
                                          
                                             (
                                             i
                                             ,
                                             i
                                             +
                                             1
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                G
                                                i
                                             
                                             ⋅
                                             
                                                G
                                                
                                                   i
                                                   +
                                                   1
                                                
                                                *
                                             
                                          
                                          
                                             |
                                             
                                                G
                                                i
                                             
                                             ⋅
                                             
                                                G
                                                
                                                   i
                                                   +
                                                   1
                                                
                                                *
                                             
                                             |
                                          
                                       
                                    
                                 
                              
                           where G
                           
                              i+1* is the complex conjugate of G
                           
                              i+1. Finally, the normalized cross-correlation r
                           (i,i+1) is obtained by applying the 2D inverse FFT. If the input images are characterized by a high contrast, well-defined and no-repeated structures, the r
                           (i,i+1) surfaces have a very sharp peak (see Fig. 2a reported by Kuglin and Hinesin [74]), whose wrap around coordinates points out the final x–y translational shift between images. On the contrary, in case of low contrast images also containing repeated structures, such as the ones analyzed in our study (Fig. 5a), r
                           (i,i+1) is characterized by a set of low amplitude peaks, rather than by a single peak only (Fig. 5b). Accordingly, to define the correct translational shift between I
                           
                              i
                            and I
                           
                              i+1, we performed a denoising stage, excluding the values r
                           (i,i+1)
                           <
                           μ
                           −3σ, where μ and σ are mean and standard deviation. Then, by analysing the maximum regions of r
                           (0.1), we extracted the coordinates of the highest peaks. To detect which peak represents the right x–y translational shift between I
                           
                              i
                            and I
                           
                              i+1, we first warped I
                           
                              i+1 according to the current shift to be checked, then we computed the local mean values by subdividing the overlapping region in small blocks. Finally, we computed the error metric E as the Mean Squared Error (MSE) of the highest local mean values and we considered the peak (or its wrap around coordinates) achieving the lower E as the one corresponding to the right x–y translational shift. The translational registration matrix 
                              
                                 
                                    H
                                    
                                       i
                                       +
                                       1
                                    
                                    i
                                 
                              
                           , between I
                           
                              i
                            and I
                           
                              i+1, is then defined as reported in Eq. (2):
                              
                                 (2)
                                 
                                    
                                       
                                          H
                                          
                                             i
                                             +
                                             1
                                          
                                          i
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         y
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where Δx and Δy are the horizontal and vertical translational shifts between I
                           
                              i
                            and I
                           
                              i+1, respectively. To register the i-th image I
                           
                              i
                            with respect to I
                           0 (the first image acquired, used as reference for the mosaic), we computed the registration matrix 
                              
                                 
                                    H
                                    i
                                    0
                                 
                              
                            defined according to the “Frame-To-Frame” registration strategy as reported in Eq. (3):
                              
                                 (3)
                                 
                                    
                                       
                                          H
                                          i
                                          0
                                       
                                       =
                                       
                                          ∏
                                          
                                             n
                                             =
                                             1
                                          
                                          i
                                       
                                       
                                          
                                             H
                                             n
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          =
                                          
                                             H
                                             1
                                             0
                                          
                                          ⋅
                                          …
                                          ⋅
                                          
                                             H
                                             i
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Finally, the mosaic was obtained by warping each image I
                           
                              i
                            according to the correspondent registration matrix 
                              
                                 
                                    H
                                    i
                                    0
                                 
                              
                           . This brought to obtain a robust mosaicing strategy useful to register also images containing highly repeated patterns only, such as the squared blocks of an empty hemocytometer's grid (Fig. 6
                           ).

When more images are stitched together to build a mosaic, seams in the stitching zones could be so perceptible to make visible the single images composing the mosaic (Fig. 7a). Furthermore, if these artefacts are not compensated, they could also mislead the count, yet more markedly in case of assisted counting in the early stage by automatic methods (see Fig. 8
                           ). The seams are produced by colour inhomogeneities, mainly due to the vignetting effect, one of the most common problems that may affect digital imaging [75]. Vignetting is originated from the radial fall-off attenuation of the intensity from the centre of the optical axis to the border of the image [76]. Vignetting is present at a different extent in all the images acquired with a microscope: the perfect Köhler illumination [77] is only theoretical and all the images are characterized by an uneven distribution of the “illumination” signal (evident as intensity's curvature). Many methods have been proposed in the literature to attenuate vignetting [78]. Some of them rely on acquisition of reference images from an empty field [79], while others use directly the acquired images themselves to estimate the vignetting curvature [80]. Nevertheless, so far a general purpose solution for correcting the vignetting does not exist.

To completely correct the seams, we propose a blending solution based on a bilinear interpolation weighting all the intensity values of the overlapping region O between the mosaic and the image to be stitched (i.e., region inside the yellow border in Fig. 9a). In particular, O is defined by computing the coordinates where a new image I will be stitched into the mosaic M being built. A new weighting mask W (Fig. 9b, of the same size as O), computed for each I, is used for the final stitching (Fig. 9c). It is worth noting that in case I is fully included in M (i.e., all corresponding data had been previously acquired), I is not stitched to preserve the early status of the cells. The core of the blending algorithm can be expressed in pseudo-code as follows:
                              
                                 
                                    
                                    
                                       
                                          
                                             for each pixel p of the inner border of W
                                          
                                       
                                       
                                          
                                             
                                             if the first outer neighbour pixel belong to M 
                                             then 
                                             W(p)←0
                                       
                                       
                                          
                                             
                                             else 
                                             W(p)←1
                                       
                                       
                                          
                                             for each remaining pixel p of W
                                          
                                       
                                       
                                          
                                             
                                             compute the Euclidean distances d(p,p
                                             
                                                k
                                             ), k
                                             ∈{0.1}, p
                                             
                                                k
                                              is the nearest pixel with value {0,1}
                                       
                                       
                                          
                                             
                                             
                                                
                                                   W
                                                   (
                                                   p
                                                   )
                                                   =
                                                   
                                                      
                                                         d
                                                         (
                                                         p
                                                         ,
                                                         
                                                            p
                                                            1
                                                         
                                                         )
                                                      
                                                      
                                                         d
                                                         (
                                                         p
                                                         ,
                                                         
                                                            p
                                                            1
                                                         
                                                         )
                                                         +
                                                         d
                                                         (
                                                         p
                                                         ,
                                                         
                                                            p
                                                            0
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             for each pixel p of O
                                          
                                       
                                       
                                          
                                             
                                             O(p)=
                                             W(p)·
                                             I(p)+[1−
                                             W(p)]·
                                             M(p)
                                       
                                    
                                 
                              
                           
                        

Following this blending approach, the seams in the stitching zones completely vanish (Fig. 7b). For RGB images, the values of the three colour channels are weighted separately following the same approach described above. In particular, W(p) remains the same for all the three colour channels, whilst I(p) and M(p) change according to the intensity of the specific colour channel analyzed.

In order to count the cells we used ImageJ 
                        [81], an open source image processing software widely used in microscopy for different purposes [82]. In particular, the ImageJ Cell Counter plug-in [83] is typically used to count the cells in an image [40]. It is pretty user-friendly and allows the user to count separately the live and dead cells by tagging images with markers of different colours. Furthermore, digital counters displayed in a text box automatically, and in real-time, show in real time the number of cells detected by the user (Fig. 10
                        ). Alternatively, the users preferring having a single environment (i.e., MATLAB) to build the mosaic and count the cells might use the Graphical User Interface (GUI) provided by Romesh Abeysuriya (http://www.mathworks.com/matlabcentral/fileexchange/40414-manual-cell-counter) and designed to perform manual cell counting by tagging images with flags of different colours (Fig. 11
                        ). These two counting solutions are comparable, and also both allow exporting the tagged mosaic image in Tagged Image File (TIF) format. This can also be used as a documented report of the count performed, so as to have the chance to compare findings with the ones of other experts [43].

For reader's convenience we report here the definition of the terms reproducibility and repeatability 
                        [84], often also known as inter- and intra-rater reliability or inter- and intra-observer variability [85], respectively. Reproducibility is defined as the closeness of the agreement between measurements of the same “object”, carried out under changed measurement conditions. Repeatability is the closeness of the agreement between successive measurements of the same object, carried out under the same measurement conditions. In our experiments the object is the number of the cells. In particular, to measure the closeness of the agreement (degree of scatter [53]) we computed the Coefficient of Variation (CV) and the range of amplitude of the counts performed. As far as the reproducibility is concerned, in our experiments the only changed condition was the changing observer. Practically speaking, in order to achieve independent counts meanwhile assessing reproducibility, a number of operators counted the cells of the same sample, whilst to assess repeatability the same operators repeatedly counted the same samples, first according to the gold standard method and then using the mosaics according the approach we propose. Two-way ANOVA has been performed for experiments where samples were counted by more operators, on live, dead, and total cells separately, using randomized block and mixed model, with fixed factor represented by the counting method and the random factor is the operators. The tests were carried out by using MATLAB. p values ≤0.05 were considered to be statistically significant.

We employed two different cell lines, named A549 and KKP. The human lung adenocarcinoma cell line A549 was purchased by the American Type Culture Collection (ATCC, Rockville, MD, USA). The cells were grown in F12K medium (ATCC) supplemented with 10% Fetal Bovine Serum (FBS, EuroClone, Milan, Italy). The KKP cells were isolated and established in our laboratory from an ascitic effusion of a patient with an advanced gastric adenocarcinoma, intestinal type [86] and grown in a culture medium composed of DMEM/HAM F12 (1:1) supplemented with FBS (10%), glutamine (2mM), (Mascia Brunelli S.p.A., Milan, Italy), and insulin (10mg/ml) (SigmaAldrich, Milan, Italy). Both cell lines were maintained as a monolayer in a 5% CO2 humidified atmosphere at 37°C, subcultured weekly using trypsin-EDTA solution (EuroClone) and checked periodically for mycoplasma contamination by MycoAlert™ Mycoplasma Detection Kit (Lonza, Basel Switzerland).

The Trypan Blue exclusion test was used to verify the viability status of the cells. Briefly, the cells were detached from the flask by a brief exposure to trypsin/EDTA, washed in their respective complete culture media by centrifugation and then resuspended in 5ml of fresh medium. It is worth noting that in order to obtain a single cell suspension it is important to avoid possible counting errors that could occur when cell aggregates are present [87]. After that, 100μL of cell suspension were added to 400μL of fresh medium and to 100μL of 0.4% Trypan Blue Solution (Sigma, Milan, Italy) to obtain a definite 1:6 dilution factor. Finally, 10μL of this mixture were distributed inside the counting chamber to completely fill the counting grid.

In order to assess reproducibility and repeatability of cell counting, we prepared six different samples. In particular, for the experiment performed to assess the reproducibility of the gold standard method and our approach, we prepared two samples (hereafter, S1 and S2) using A549 cells. In order to have in S1 an approximate number of seeded cells (about 500 cells) twice as big as in S2, we diluted 10μL of the mixture obtained as explained above, by adding 10μL of fresh medium. For the second experiment, conceived to analyze counts repeatability, we prepared three samples (hereafter S3, S4 and S5) using KKP cells and keeping the dilution factor constant (approximately 1000 cells in each sample). Finally, we prepared a last sample (S6) of approximately 350 A549 cells.

To analyze the samples and acquire the images we used an inverted Olympus IX51 microscope, equipped with a Nikon Digital Sight DS-Vi1 (CCD) camera (1/1.8″ CCD vision sensor, square pixels of 4.4μm side, 1600×1200pixel resolution, 3-channel images, 8-bit grey level). The microscope is cleaned after every usage and the illumination alignment is performed periodically, such as the alignment of the sample holder, so as to make it perpendicular to the principal axis. The images were acquired in brightfield, with exposure time set to 30msec, by using an Olympus UPlanFl 4×/0.13 as a standard objective lens. The final spatial resolution was 1.673μm/pixel. For each sample prepared, the operators counted the cells by using the microscope's oculars and a manual tally counter. The images needed in order to build the mosaics were acquired by keeping the microscope settings unchanged.


                        GridMos is written in MATLAB. Both the source code and a standalone executable version (i.e., not requiring MATLAB being installed) are freely available at: http://sourceforge.net/p/gridmos, where all the future releases will be also posted. Few sample sets are already available for download from the same webpage. Furthermore, all the images used in the experiments performed can be provided on demand. In order to improve usability, we implemented a simple GUI (Fig. 12
                        ) that makes GridMos particularly user friendly. The only input parameters required are the image folder and the name and the indices of the images to be stitched into the mosaic. Furthermore, a check button has been added to switch off the tonal image registration (e.g., for testing purposes).

@&#RESULTS@&#

In order to assess reliability of counting live and dead cells with the two approaches described above, we carried out two different sets of experiments where at least three operators counted the cells of different samples first according to the gold standard method and then with our approach. Finally, for testing purposes, we asked a single expert operator to count five times the same sample, also acquiring a new image set between each manual counting step.

In the first experiment, seven expert operators counted the number of live and dead cells of S1 and S2 with a blinded procedure according to the gold standard method. Then, the same operators counted the cells of the same samples by tagging the mosaics. Let OPi, i
                        =1, …, 7, be the operator ID where figures also retain a temporal meaning. The overall time needed by the seven operators to count the cells according to the gold standard method was approximately 40min for S1 and 20min for S2. The time spent to count the cells according to our approach is comparable. Tables 1 and 2
                        
                         reports the amount of live and dead cells counted by OPi in S1 and S2, respectively. First of all, considering that cells die during the counting procedure (common microscopes are usually not endowed with an incubator chamber) we expected an increasing trend for the number of dead cells. Furthermore, it is worth noting that for S1 the operators first counted the cells and the images were acquired, while for S2 we acquired the images in advance and the manual count of the cells was performed afterwards. As expected, in S1 the number of dead cells counted using the mosaic was higher than using the standard method. The opposite happened for S2. Starting from the data reported in Table 1, ANOVA tests report significant differences for live, dead and total cells, with p-values ≤0.02, ≤0.001, ≤0.01, respectively. As for Table 2, results worsen, meaning that the differences between the two methods are not statistically significant for live (p-value=0.9) and total (p-value=0.1) cells, while still remains significant for dead cells. In general, the CV of the counts performed with our approach is at least half than the one of the counts performed with the gold standard method, highlighting a better reproducibility of our approach. Besides the greater difficulty to count cells manually looking through a microscope's ocular, rather than tagging an image, the generally higher variability (i.e., CV) of the gold standard method, also in the presence of not significant differences with ours, may be due to the fact that the cells are not fixed to the chamber, but in suspension in the liquid of counting. Accordingly, few cells could also float in or out from the counting grid as the consequence of the movement of the sample holder generated by the operator to improve the visualization of cells. This cell “migration” does not occur when the operator counts the cells using a mosaic, since the number of cells inside the counting grid is “frozen” at the acquisition stage. Concluding, the lower CV and the smaller amplitude of the range of values reported in Tables 1 and 2, undoubtedly prove that a better reliability is achievable when the cells are counted according to our approach.

In order to compare the repeatability of the two counting methods, the operators OP1, OP2 and OP3 counted three times the samples S3, S4, and S5, respectively. For each sample, the operator first counted according to the standard method, then the images that would be used to build the mosaic were acquired. It is worth noting that using the standard method the operator performed a blind count with “himself”, that is a count without knowledge of the quantity already counted (this can be done without looking at the tally counter during and at the end of counting). In order to improve independency between counts also with our approach, each mosaic was turned by 90° for every single count, so as to present to the same operator different reference points. The time needed by the operators to count once their sample was approximately 10min, on average, for both the methods. Tables 3–5
                        
                        
                         report the amount of cells counted by OP1, OP2 and OP3, respectively. Due to the time required to count sequentially three times each sample, we expected to find a variation in the amount of the dead cells for the different counts when using the gold standard method. The data reported in the second columns of Tables 3–5, confirmed our expectance, showing that the number of dead cells is higher in the third count (third row) than in the first one (first row). In addition, the number of dead cells counted using the mosaic resulted, on average, always higher than the number of cells counted using the standard method (columns two and five). Finally, the values of range amplitude obtained with our approach are always strongly lower, in general halved, than those obtained by the same operator when using the standard method, this proving that our approach improves the repeatability of counting.

In the last experiment we asked a single expert operator to count five times S6, also acquiring a new image set between each manual counting step. This is an improbable scenario because in a practical situation there is not a reason to acquire more mosaics, also by waiting several minutes between different image acquisitions. However, this brought to compute the counts repeatability of our approach by imposing the limitations of the standard approach (i.e., long counting times, instability of the sample). The average time needed by the operator to count the cells according to the gold standard method was 5min on average. The time spent to acquire an image set between each manual counting was approximately 1min. The overall time spent to acquire the image sets and counting five times the sample at the microscope was about 30min. Table 6
                         reports the amount of live, dead, and total number of cells counted by the operator, which started by acquiring a mosaic, and then by counting at the microscope the live and dead cells of the sample. As just said, in this experiment our approach was forced to have comparable defects as the gold standard approach. As expected, the number of the dead cells rises for both the approaches. However, for live, dead, and total number of cells, the CV values of the counts performed with our approach still remains lower than the CV values attained with the gold standard method.

@&#DISCUSSION@&#

This work presents the approach we designed to count live and dead cells simply by using a counting chamber, standard widefield microscope, digital camera, and computer vision techniques. In particular, we propose an open source image-based software tool (GridMos) to build a high resolution mosaic of the whole counting chamber, which can then be used to manually count the cells through an image tagging application. With our method, the microscope is only utilized for a few seconds per sample, which is the time needed to acquire the hemocytometer grid images. GridMos is then used to build the mosaic off-line and the cell counting task can thus be performed even by more operators. The overall reading time is no longer a problem because the viability status of the cells is “frozen” into the images acquired immediately after the sample's preparation. In addition, the time taken to count the cells using our method is comparable with that required by the gold standard method. Moreover, the tagged mosaic can also be used as a documented report of the performed count in order to compare findings with the ones of the other experts.

We compared our results with those obtained from the gold standard method for counting, based on the analysis of the counting chamber using the microscope ocular and a manual tally counter. In order to assess reproducibility and repeatability, we carried out three sets of experiments involving a number of expert biologists who first counted the cells first according to the gold standard method and then according to our new approach. In the first experiment seven operators counted the live and dead cells of the same sample, whereas in the other experiments a single operator repeatedly counted the same sample. The variation in counts performed according to our approach was markedly lower in all the experiments, indicating a generally better reliability compared to the standard counting procedure. This demonstrates that our approach, based on the application of mosaicing techniques, can be used with effectiveness to count live and dead cell, overcoming the gold standard method.

The authors declare that they have no conflict of interest.

@&#ACKNOWLEDGEMENTS@&#

We thank Silvia Carloni, Chiara Arienti, Sara Pignatta, Michele Zanoni, Alice Zamagni, Elisa Gabucci and Federico La Manna of the Laboratory of Biosciences (IRST, Meldola, Italy) for their operational contribution to the experiments; Alessandro Gherardi (Computer Vision Group, University of Bologna) for helping us to test different mosaicing software tools; Gràinne Tierney (IRST, Meldola, Italy) and Panagiota Dimopoulou for editorial assistance and English revision of the manuscript.

@&#REFERENCES@&#

