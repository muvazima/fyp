@&#MAIN-TITLE@&#Modeling and simulation of overtaking behavior involving environment

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Overtaking behavior model based on intelligent vehicles involving environment effect is established.


                        
                        
                           
                           Fuzzy logic based intelligent vehicle controllers adapting to complex environment are designed.


                        
                        
                           
                           Virtual reality combines with Geographic Information System to realize terrain visualization and provide realistic environment information for simulation.


                        
                        
                           
                           Overtaking behavior maneuver considering environment is realized in virtual reality simulation system.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Overtaking behavior

Intelligent vehicle

Fuzzy control

Virtual reality

Traffic simulation

Synthetic natural environment

@&#ABSTRACT@&#


               
               
                  Overtaking is a complex driving behavior for intelligent vehicles. Current research on modeling overtaking behavior pays little attention on the effect of environment. This paper focuses on the modeling and simulation of the overtaking behavior in virtual reality traffic simulation system involving environment information, such as road geometry and wind. First, an intelligent vehicle model is proposed to better understand environment information and traffic situation. Then, overtaking behavior model is introduced in detail, the lane changing feasibility is analyzed and the fuzzy vehicle controllers considering the road and wind effect are researched. Virtual reality traffic simulation system is designed to realize the simulation of overtaking behavior, with realistic road geometry features. Finally, simulation results show the correctness and the effectiveness of our approach.
               
            

@&#INTRODUCTION@&#

Research on developing intelligent vehicles to improve highway safety and efficiency is one of the most extensively studied topics in the field of Intelligent Transportation System (ITS) [1]. The microscopic driving maneuver of intelligent vehicle could be divided into three main maneuvers: car following, lane changing and overtaking. Of all the maneuvers, overtaking is one of the most complex and dangerous driving maneuvers, because it combines both lateral and longitudinal control. Thus the automation of this maneuver has been considered to be one of the toughest challenges in the development of intelligent vehicle [2].

Compared with other intelligent vehicle research, the studies of overtaking models are not very extensive. [1] was based on a stereo vision system responsible for detecting any preceding vehicle and triggering the autonomous overtaking maneuver, and a fuzzy logic based controller was developed to emulate how humans overtake. [3] presented a learning method to solve the vehicle overtaking problem, which demanded a multiple criteria. [4] proposed an overtaking control method based on the estimation of conflict probability. [5,6] proposed a fuzzy control system that essentially changes the driving mode according to the three phases. However, throughout the previous studies concerning overtaking behavior, the influence of natural environment (such as road, wind, and weather) affecting on the vehicle has been ignored in the modeling of overtaking behavior.

Moreover, it is difficult to test the overtaking behavior with real vehicles because the overtaking behavior is complex and dangerous, so traffic simulation with Virtual Reality (VR) plays an important role in this research. VR technology is increasingly being used in traffic simulation systems [7] and driving simulators [8,9]. Nevertheless, most existing research on traffic simulation with VR mainly has been concentrated on the visualization or the real-time traffic simulation in a virtual world [10,11], little work has been done to profit the virtual reality system to provide realistic environment information for simulation. Combining Geographic Information System (GIS) and VR to realize the terrain visualization could enhance the authenticity. Based on this method, the overtaking behavior could be analyzed in the VR simulation system with realistic environment information and the traffic simulation could be much more valid.

Inspired by the existing research mentioned above, modeling and simulation of overtaking behavior involving road and wind effect in virtual reality system is realized in this paper. The purpose is to better understand the road geometry and wind effect in traffic and to assist overtaking behavior analysis in traffic simulation. In previous research [12], we presented modeling overtaking behavior in virtual reality traffic simulation system, this paper focuses on the context of modeling and simulation of overtaking behaviors with the consideration of road and wind effect from the virtual world.

The remaining of this paper is organized as follows: in Section 2, the architecture of intelligent vehicle model is presented in detail, including the vehicle dynamic models considering the road geometry and wind. Section 3 introduces overtaking behavior model, the lane changing behavior model and the car following model are analyzed because they are the base of overtaking, and the fuzzy logic based steering, throttle/brake controllers are designed with the consideration of road and wind effect. Section 4 realizes the overtaking behavior simulation, virtual reality traffic simulation system is described to supply realistic road geometry features. Section 5 shows the simulation maneuver and some simulation results. Finally, the paper is concluded and prospected in Section 6.

The intelligent vehicle is an autonomous virtual vehicle, which is architected as a hierarchical model incorporating perception module, motion module, cognition and behavior module, and internal properties, shown in Fig. 1
                     .

Perception module monitors messages from human and other vehicles, which identifies the relevant events in virtual reality traffic simulation system. A 3D vehicle corresponding to the intelligent vehicle is created in the virtual world. In this way, the perception module can acquire information about its surrounding environment through the interaction among 3D models, such as collision detection. The distance between vehicles could be calculated in real time. With this module, the intelligent vehicle could perceive the traffic information and the environment information, then all these information are sent to the internal properties and the cognition and behavior module for further decision making.

Internal properties reflect the personalities impacting on cognition and behavior module. In real traffic, the reactions of different drivers are not same according to different traffic situation and environment information. Therefore, the drivers’ decisions are different. The internal properties could reflect the characteristics of different drivers’ reaction. The internal properties include driver type and driver state [13,14]. Internal properties receive the information from the perception module. According to different driver type or driver state, the information could affect drivers’ decisions, such as driver’s reaction time, is sent to cognition and behavior module to realize the decision making process.

Cognition and behavior module is the brain of the intelligent vehicle, which could achieve more sophisticated tasks, such as behavior choice, navigation and drivers’ decision making according to the traffic situation and the environment information. The cognition and behavior module is modeled as agent-based multi-controller [15] instead of a single control algorithm, its structure is described precisely by Fig. 2
                        .

The controller agent at top is called the top controller agent. A controller agency consists of a pool of controller agents and a coordination object. A controller agent behaves in two ways: either it behaves as being ’active’ or it behaves as being ’inactive’. The active request signal from the controller agent to the coordination object specifying whether the controller agent wants to become active or not; the acknowledge signal from coordination object decides whether the controller agent to be active or not (shown as the red line in Fig. 2). The input information from other modules could be sent to all the controller agents (shown as the black solid line in Fig. 2). The output information is sent to coordination objects for further decision then sent to other modules (shown as the black dotted line in Fig. 2). The intelligent vehicle is the top controller agent, which contains two subcontrollers agents: longitudinal controller agent and lateral controller agent. The longitudinal controller agent is used for controlling the velocity and the inter-space; while the lateral controller agent is used for controlling the lateral displacement and the yaw angle.

Longitudinal controller agent is designed to consist of three subcontrollers agents: velocity controller agent, following controller agent and emergency controller agent. The coordination of the three controllers makes the model intelligent to distinguish different traffic scenarios and select suitable mode to operate. The input information of longitudinal controller agent includes the speeds of vehicles, the distance between the vehicle and a vehicle in front, the road geometry, et al. The output information is desired velocity, desired distance to front vehicle, et al. The coordination of longitudinal controllers is not discussed in this paper, which could be seen in our previous research [16].

Lateral controller is not active when the car is in the straight road and lane changing does not happen. Lateral controller agent realizes lane keeping and lane changing function of intelligent vehicle. The input information of lateral controller agent includes velocity, acceleration, road geometry features and wind speed, et al. The output information is desired yaw angle, desired lateral displacement, et al.

The overtaking behavior is realized through the coordination of longitudinal controller and lateral controller according to different traffic and environment information. For the longitudinal controller, only the following controller agent is used in overtaking process in this paper.

Motion module receives the desired movement parameters from cognition and behavior module and realizes the movement implementation of the intelligent vehicle. Vehicle dynamic models and vehicle control models are realized in this module, which are decoupled as longitudinal motion model and lateral motion model. The longitudinal motion model consists of coordinated throttle/brake fuzzy controllers and longitudinal vehicle dynamic model; and the lateral motion model consists of steering fuzzy controllers and lateral vehicle dynamic model.

The lateral vehicle dynamic model is:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ¨
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   δ
                                                   -
                                                   
                                                      
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               mV
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               f
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               mV
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  -
                                                                  2
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        α
                                                                        f
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        f
                                                                     
                                                                  
                                                                  +
                                                                  2
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        α
                                                                        r
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                               
                                                                  mVx
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         des
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ρ
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ̇
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               windy
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   gsin
                                                   (
                                                   β
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ¨
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   2
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         α
                                                         f
                                                      
                                                   
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   δ
                                                   +
                                                   
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               f
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   (
                                                   2
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         α
                                                         f
                                                      
                                                   
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                   -
                                                   2
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         α
                                                         r
                                                      
                                                   
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               f
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         -
                                                         2
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               α
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               ̇
                                                            
                                                         
                                                      
                                                      
                                                         des
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ρ
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     ̇
                                                                  
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               windy
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where e
                        1 is the distance of the C.G. (center of gravity) of the vehicle from the center line of the lane; e
                        2 is the orientation error of the vehicle with respect to road; C
                        
                           αf
                        , C
                        
                           αr
                         are called the cornering stiffness of the front tire and rear tire; V
                        
                           x
                         is the longitudinal velocity; m is the mass of the vehicle; ψ
                        
                           des
                         is the desired orientation, and 
                           
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    des
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    x
                                 
                              
                              /
                              R
                              ,
                              
                              1
                              /
                              R
                           
                         is the road curvature; l
                        
                           f
                        /l
                        
                           r
                         is the distance between the C.G. and the front/rear wheels; l
                        
                           c
                         the distance between the C.G. and the center of aerodynamic force; ρ is the mass density of air; C
                        
                           s
                         is the aerodynamic side coefficient; A
                        
                           s
                         is the side area of the vehicle; V
                        
                           windy
                         is the wind velocity along y axes; β is the road bank angle.

The longitudinal vehicle dynamic model is:
                           
                              (2)
                              
                                 m
                                 
                                    
                                       x
                                    
                                    
                                       .
                                       .
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       xf
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       xr
                                    
                                 
                                 -
                                 
                                    
                                       F
                                    
                                    
                                       aerox
                                    
                                 
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       xf
                                    
                                 
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       xr
                                    
                                 
                                 -
                                 mg
                                 sin
                                 (
                                 α
                                 )
                                 ,
                              
                           
                        where F
                        
                           xf
                         is the longitudinal tire force at the front tires; F
                        
                           xr
                         is the longitudinal tire force at the rear tires; R
                        
                           xf
                         is the force due to rolling resistance at the front tires; R
                        
                           xr
                         is the force due to rolling resistance at the rear tires; α is the angle of inclination of the road on which the vehicle is traveling; F
                        
                           areox
                         is the equivalent longitudinal aerodynamic drag force:
                           
                              (3)
                              
                                 
                                    
                                       F
                                    
                                    
                                       aerox
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ρ
                                 
                                    
                                       C
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       F
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             V
                                          
                                          
                                             windx
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where C
                        
                           d
                         is the aerodynamic drag coefficient; A
                        
                           F
                         is the frontal area of the vehicle; V
                        
                           x
                         is the longitudinal vehicle velocity; V
                        
                           windx
                         is the wind velocity along x axes.

The throttle/brake fuzzy controller and the steering fuzzy controller will be explained in Section 3.4. With these models and controllers, the vehicle tries to follow the designed movements by modifying and acting on the control parameters of the vehicle (steering, throttle and brake). Motion module sends the vehicle movement values, such as position, velocity, lateral displacement, and yaw angle, to the virtual world, which could be used in the calculation of traffic information and environment information and also could be used in the visualization.

Overtaking is complex traffic simulation maneuver. An overtaking maneuver consists of three phrases: (1) diverting from the original lane; (2) driving straight in the adjacent lane; (3) returning to the original lane [17]. From the three phrases, the relationship between lane changing and overtaking is obvious, lane changing is an important part of overtaking process, and it is the base of overtaking. The overtaking behavior model based on the intelligent vehicles involving the road geometry and wind effect will be established in this section. First, there is the decision whether to initiate an overtaking behavior, the lane changing feasibility is studied. Then, after deciding that the maneuver is possible and necessary, the lateral controllers and the longitudinal controllers coordinate to realize overtaking. Fuzzy logic based controllers are designed for sending the appropriate output to the vehicle’s actuators (the steering wheel and the throttle/brake pedals). The fuzzy logic controllers are designed to mimic human behavior in different road and wind environment.

Lane changing behavior model is a vital component in microscopic traffic behavior, and the rules describing drivers’ lane changing maneuvers are well described in the literature [18]. The lane changing behavior model in this paper is realized through the coordination of longitudinal controller and lateral controller. In the traffic simulation, the longitudinal controller is active all the time, and the lane changing controller gets active when lane changing feasibility meets. The lane changing process and the lane changing feasibility will be discussed in detail.


                           Fig. 3
                            shows the image of the lane changing process. The controlled vehicle is defined as the subject vehicle; the vehicle running in the front of the subject vehicle on the same lane is defined as leading vehicle; in the adjacent lane, the vehicles running in the front and the rear of the subject vehicle are defined as forward vehicle and backward vehicle. Based on this process, the input information of the subject vehicle that is the intelligent vehicle, includes the velocity of subject vehicle (V
                           
                              s
                           ), the velocity of the vehicle in front (V
                           
                              l
                           ), the distance to the leading vehicle (S(t)) in the original lane, the velocity of the vehicles (V) in the adjacent lane, the distance to the front vehicle (S
                           
                              f
                           (t)) and the distance to the backward vehicle (S
                           
                              b
                           (t)) in the adjacent lane. The output information is desired velocity, lateral position and yaw angle.

During the lane changing process, the longitudinal velocity of the subject vehicle is adjusting with the forwarding vehicle due to the coordination of the longitudinal controller. Based on the judgment of lane changing feasibility, the collisions between the vehicles could be avoided during the lane changing process.

Lane changing is considered feasible if there is a gap of sufficient size in the target lane so that the vehicle can move into the target lane safely. To determine the feasibility of the maneuver, first a search, in the adjacent lane, is conducted to find the vehicle just in front, and the vehicle just behind the subject vehicle. These would become the new leader and the new follower respectively of the subject vehicle if the lane changing could be feasible. According to the lane changing process in Fig. 3, the lane changing feasibility could be divided into two situations:

(1) V
                           
                              s
                           
                           <
                           V, for the forward vehicle, the lane changing happens when:
                              
                                 (4)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    L
                                    ,
                                 
                              
                           for the backward vehicle, the lane changing happens when:
                              
                                 (5)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          S
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                V
                                             
                                             
                                                s
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                j
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                    +
                                    τ
                                    V
                                    +
                                    L
                                    ,
                                 
                              
                           (2) V
                           
                              s
                           
                           >
                           V, for the backward vehicle, the lane changing happens when:
                              
                                 (6)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          S
                                       
                                       
                                          b
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    L
                                    ,
                                 
                              
                           for the forward vehicle, the lane changing happens when:
                              
                                 (7)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          j
                                       
                                    
                                    +
                                    τ
                                    
                                       
                                          V
                                       
                                       
                                          s
                                       
                                    
                                    +
                                    L
                                    ,
                                 
                              
                           where S
                           
                              f
                           (min) is the minimum distance to the forward vehicle to avoid the collision; S
                           
                              b
                           (min) is the minimum distance to the backward vehicle to avoid the collision; j
                           
                              b
                            is the maximum deceleration of the backward vehicle; j is the maximum deceleration of the subject vehicle; τ is the driver’s reaction time; L is a constant distance between two vehicles when they stop.

During the lane changing, the longitudinal controller is used for controlling the longitudinal velocity to maintain a safe distance between the subject vehicle and the immediate preceding vehicle. The desired safety following distance (l
                        
                           FD
                        ) is defined through human range policy, which could be in the form of a quadratic curve [19]:
                           
                              (8)
                              
                                 
                                    
                                       l
                                    
                                    
                                       FD
                                    
                                 
                                 =
                                 D
                                 +
                                 τ
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 κ
                                 γ
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             a
                                          
                                          
                                             imax
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where D is the minimum range when two vehicles stop; τ is driver’s reaction time; a
                        
                           imax is the maximum deceleration of following vehicle; v
                        
                           i
                         is the velocities of following vehicle; γ is the safe coefficient, which is relevant to road conditions; κ is adjustment parameters for different wind speed and road slope.

According to the desired safety following distance (l
                        
                           FD
                        ), the desired acceleration is:
                           
                              (9)
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 -
                                 (
                                 λ
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                                 )
                                 /
                                 (
                                 τ
                                 +
                                 
                                    
                                       κ
                                       γ
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             imax
                                          
                                       
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                              
                           
                        where δ
                        
                           i
                        
                        =
                        x
                        
                           i
                        
                        −
                        x
                        
                           i−1
                        +
                        l
                        
                           FD
                        ;x
                        
                           i
                         and x
                        
                           i−1 the position of subject vehicle and preceding vehicle; v
                        
                           i−1 is velocity of the preceding vehicle; λ is a positive control gain.

Each overtaking maneuver includes two lane changing components and a car following component. Consequently, the speed and the lateral displacement of intelligent vehicle need to be managed. Based on the model in this paper, the controllers are considered to be partially decoupled. According to the lane changing behavior model, the flow chart of the overtaking maneuver is shown as in Fig. 4
                        .

With the proposed agent-based multi-controller intelligent vehicle agent model in Section 2, the lateral controllers and the longitudinal controllers coordinate to realize overtaking maneuver considering road geometry and wind effect. To realize the lateral controllers and the longitudinal controllers, fuzzy logic based steering controllers and throttle/brake controllers are introduced in detail. For the automatic overtaking behavior, there are two driving modes: lane keeping and lane changing. Two different fuzzy controller subsystems are used for these two modes. Both of the two subsystems include steering fuzzy controllers and throttle/brake fuzzy controllers. The throttle/brake fuzzy controllers used in these two modes are same, but the steering fuzzy controllers are different.

Road curvature, rank angle and lateral wind are considered in the design of the three steering fuzzy controllers for lane keeping. Three fuzzy controllers are defined to execute the control layers tasks according to different road curvature, rank angle and lateral wind, and each fuzzy controller is selected from a high-level tactical layer. The basic structure of these fuzzy controllers is same. But the values of the membership function of the input and output variables are not always the same and the fuzzy control rules are different, which could reflect the driving experience considering the road and wind conditions.

The steering fuzzy controller has two input variables: lateral error E1 and orientation angular error E2. The output is the steering angle of the front wheel δ. For each variable, there are 7 fuzzy sets, described as following:
                              
                                 (10)
                                 
                                    {
                                    E
                                    1
                                    ,
                                    E
                                    2
                                    ,
                                    δ
                                    }
                                    =
                                    {
                                    L
                                    3
                                    ,
                                    L
                                    2
                                    ,
                                    L
                                    1
                                    ,
                                    Ce
                                    ,
                                    R
                                    1
                                    ,
                                    R
                                    2
                                    ,
                                    R
                                    3
                                    }
                                    .
                                 
                              
                           
                        

The meanings of each set are: L3: left large; L2: left medium; L1: left small; Ce: center; R1: right small; R2: right medium; R3: right large.

The input and output variables’ membership functions have triangular shapes, [L
                           maxl
                           ,
                           L
                           maxr
                           ] is the range of E1, [A
                           maxl
                           ,
                           A
                           maxr
                           ] is the range of E2, [S
                           maxl
                           ,
                           S
                           maxr
                           ] is the range of δ. The values of range are different in the three steering fuzzy controllers, given in Table 1
                           . These values are given on the basis of expert experiences and extensive simulation experiments.

The fuzzy control rules are in the form of “IF (premise) THEN (consequent)”. Fuzzy rules are supposed to represent the real human driving experience. These rules contain necessary information on how drivers execute their actions to keep the vehicle to the target road. Fig. 5
                            shows the 3D surface plots associate with the three steering fuzzy controllers, considering different road curvature, rank angle and lateral wind. These are representations of the mapping of the input and the output based on the fuzzy rules. The smoothness of the surface is indicative of the reasonableness of the controller. The big steering control surface is highest adapting to the big road curvature, large rank angle and strong lateral wind. The flowchart of switch logic among the three steering fuzzy controllers in the tactical layer is shown in Fig. 6
                           . The thresholds 20, 0.1, 0.003 are defined according to different road geometry and wind conditions for three fuzzy controllers. The bigger value of wind speed has the more influence on the vehicle. The bigger values of rank and curvature have more influence on the lateral vehicle movement. Therefore, the intelligent vehicle needs to steer proper magnitude to control the vehicle. With some experiments in the virtual reality system to research the influence, 20 is chosen to differ the big wind speed and the small wind speed; 0.1 and 0.003 are chosen to stand different road geometry for lateral vehicle movement.

The steering fuzzy controller used in lane changing is a multi-model fuzzy controller, which adapts to different longitudinal velocity of vehicle. The multi-model fuzzy controller includes four local controllers and a fusion block, which could be seen in [20] in detail.

A relationship between environment (slope of terrain, longitudinal wind speed) and vehicle velocity is constructed by fuzzy rules. Like the steering fuzzy controllers for lane keeping, for different wind speed and slope range, three different throttle/brake fuzzy controllers have been defined to describe the behavior of drivers.

The input and output variables are the same with the coordinated throttle and brake fuzzy controller proposed in [21]. The input variable are the acceleration error E
                           
                              a
                            and the speed error E
                           
                              v
                           . The output is the throttle/brake change (%). Five fuzzy sets are designed for both the two inputs, as Nb, Ns, Null, Ps, Pb. Meanwhile, five fuzzy sets are designed for the output, as Dinten, Dsof, Null, Asof, Ainten. The input and output variables’ membership functions have triangular shapes, [−E
                           
                              vmax
                           ,
                           E
                           
                              vmax
                           ] is the range of E
                           
                              v
                           , [−E
                           
                              amax
                           ,
                           E
                           
                              amax
                           ] is the range of E
                           
                              a
                           , [−Th,
                           Th] is the range of throttle/brake change. The range values of the three different throttle/brake fuzzy controllers are given in Table 2
                           . The 3D surface plots in Fig. 7
                            represent the mapping of the input and the output based on the fuzzy rules considering different road slope and longitudinal wind. The flowchart of switch logic among three throttle/brake fuzzy controllers in the tactical layer is shown in Fig. 8
                           . The thresholds 20, 0.4 are defined according to different road geometry and wind conditions for three fuzzy controllers. The choice of 20 is the same with steering fuzzy controller. The bigger value of slope has more influence on the longitudinal vehicle movement. Therefore, the intelligent vehicle needs to throttle/brake proper magnitude to control the vehicle; 0.4 is chosen to stand different road geometry for longitudinal vehicle movement.

The objective of virtual reality traffic simulation is to assist the user to analyze and test overtaking behavior with realistic environment information in virtual world. The virtual world is realized through the 3D modeling tools and the 3D model rendering is used Objective Oriented Graphics Rendering Engine (OGRE). Matlab/Simulink software is used for the vehicle dynamic model and fuzzy controllers. The data change between the virtual world and the models in Matlab/Simulink is through the method of Distributed Component Object Model (DCOM) [22].

GIS combines VR to realize the terrain visualization. Digital Elevation Model (DEM) is the important part of GIS, which is the basic data for the GIS application in terrain analysis. DEM is a digital map of elevation data of an area which helps in better understanding of terrain characteristics and leading to the creation of 3D view of the terrain [23].

DEM is used to develop the terrain model to supply realistic road information in the simulation. The DEM data used in this paper is from PAMAP data that is Light Detection And Ranging (LiDAR) data of Pennsylvania [24]. PAMAP data are organized into blocks, which do not have gaps or overlaps, each block represent 10,000 feet by 10,000 feet on the ground. The 3D terrain model used in this paper is from one block of PAMAP data. Digital Elevation Model of PAMAP data is a 3.2-foot pixel (1-m equivalent) raster GeoTIFF DEM. Each pixel in the DEM has an interpolated elevation value. The 3D terrain model converted from DEM data by the software Terragen and Global Mapper, the sampling spacing is 0.3 feet. By collision detection between 3D models in virtual world, the road slope and rank angle information could be calculated from DEM data, shown as in Fig. 9
                     . The road curvature is obtained from the predefined map in the virtual world.

According to the virtual world structure in Fig. 10
                     , the road altitude information from the DEM data is used to calculate the slope and the rank angle as follows:
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                                =
                                                
                                                   
                                                      sin
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     fl
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     fr
                                                                  
                                                               
                                                               )
                                                               -
                                                               (
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     bl
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     br
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                               (
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     fl
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     bl
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                β
                                                =
                                                
                                                   
                                                      sin
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     fl
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     bl
                                                                  
                                                               
                                                               )
                                                               -
                                                               (
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     fr
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     br
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               2
                                                               (
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     fl
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     fr
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where z
                     
                        fl
                     , z
                     
                        fr
                     , z
                     
                        bl
                     , z
                     
                        br
                      are the altitudes of the front-left wheel, the front-right wheel, the back-left wheel, the back-right wheel which are calculated through DEM data by the collision detection between the wheels and the terrain (shown as the red line in Fig. 10). x
                     
                        fl
                     , x
                     
                        bl
                      are the position of front-left wheel and the position of back-left wheel along x axes. y
                     
                        fl
                     , y
                     
                        fr
                      are the position of front-left wheel and the position of front-right wheel along y axes.

To test the vehicle affected by the different winds, different wind velocities could be set in the simulation system. In the simulation results, the longitudinal wind velocity and the lateral wind velocity are supposed to be same.

Based on the virtual reality traffic simulation system described in Section 4, some results are shown to verify the correctness and effectiveness of our approach. As shown in Fig. 3, five vehicles have been simulated in the overtaking maneuver. Two vehicles run in the original lane and three vehicles run in the adjacent lane. The subject vehicle in the original lane is the intelligent vehicle. The initial speed of the intelligent vehicle is set to 17m/s. The velocity profiles of adjacent vehicles and leading vehicle could be seen in Fig. 11
                     . The desired speed of the vehicles in the adjacent lane run assumed to be 17m/s at beginning, decelerates to 8m/s from t
                     =4s to t
                     =8.5m/s, and then keeps 8m/s. The leading vehicle runs assumed to be 17m/s a few seconds, decelerates to 8m/s from t
                     =2s to t
                     =6.5m/s. After keeping the new velocity a few seconds, it starts to decelerate to 5.75m/s from t
                     =11s to t
                     =15.5m/s, then keeps this speed.

The slope, rank and curvature are obtained by the method mentioned in Section 4 in real time from virtual world, shown in Fig. 12
                     . The wind is set to different speed to test the intelligent vehicle affected by the wind, including 0m/s, 10m/s, 30m/s, −30m/s and −50m/s.


                     Fig. 13(a)
                      shows the velocity of intelligent vehicle during overtaking process, considering the effect of the immediate vehicle, the road geometry and the wind. The steering angle, the lateral displacement and the yaw angle of the subject vehicle could be seen in Fig. 13(b–d). The overtaking maneuver according with the wind speed of 10m/s is as following. From t
                     =0s to t
                     =11s, the subject vehicle follows the leading vehicle. When the leading vehicle starts to decelerate at t
                     =11s, the subject vehicle desires to change lane. The lane changing controller waits to get active until the feasibility of lane change meets. When t
                     =15s, the subject vehicle begins to change lane. After lane change finishes, t
                     =22.5s, the subject vehicle finds it has overtaken the leading vehicle and the feasibility of lane change meets. It changes to the original lane and the overtaking behavior finishes at t
                     =31.5s. From these results, we could find that with the models in this paper, the lane following and the lane changing are realized and coordinated well, the overtaking behavior could perform well involving the road geometry and wind, even the wind speed is big, which illustrates that the fuzzy controllers used in this paper are valid.


                     Fig. 14
                      shows the overtaking behavior visualization scenes when the wind speed is −50m/s. The red car is the subject vehicle. Fig. 14(a) displays that the subject vehicle changes from the original lane to the adjacent lane. In Fig. 14(b–d), the subject vehicle is overtaking the leading vehicle in adjacent lane. Fig. 14(e) presents that the subject vehicle returns to the original lane. The overtaking behavior is finished in Fig. 14(f).

In this paper, overtaking behavior model has been established, taking into the consideration of road geometry and wind effect. A decentralized design paradigm has been used for developing the multi-controller based intelligent vehicle, whereby overtaking behavior has been realized by the coordination of the multi-controller, and vehicle dynamic models involving road and wind have been analyzed. The lane changing behavior model and the car following model have been analyzed in this paper, because they are the base of overtaking behavior. The fuzzy vehicle controllers for overtaking behavior considering the environment have been researched. To realize the simulation of overtaking behavior, virtual reality traffic simulation system has been designed, and GIS has been used to provide realistic road geometry features. With the virtual reality traffic simulation system, the overtaking behavior model could be verified and analyzed. The results show that the overtaking behavior model designed in this paper is proper and reasonable.

In future works, the wind environment modeling could be further studied with the realistic flow database. The rain, snow and other climate conditions could be integrated into the overtaking behavior modeling, because they play an important part in the safety of overtaking behavior. Some realistic climate database should be studied for the verification of the overtaking behavior affected by climate conditions. The overtaking model (including lane changing model, car-following model and steering models, et al.) will be tested by real vehicles in future. Thus it is better to consider the hardware in loop system to expend the system. Firstly, some reduced scale vehicles can be used in system; secondly, the real vehicles could be introduced. After the real vehicle is in the system, the algorithms involving time delay, data loss, et al. should be considered.

@&#REFERENCES@&#

