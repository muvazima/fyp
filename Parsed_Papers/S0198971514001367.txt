@&#MAIN-TITLE@&#Simulating city-level airborne infectious diseases

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel approach to study Urban Airborne Disease spreading.


                        
                        
                           
                           Integrate as much information as possible in a simulation environment.


                        
                        
                           
                           GIS enabled city modeling and travel routing calculation.


                        
                        
                           
                           Synthesizing the population in a city and modeling people’s daily behavior in the presence of epidemics.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geographical Information System (GIS)

Multi-Agent Systems (MAS)

Infectious diseases

Epidemics

@&#ABSTRACT@&#


               
               
                  With the exponential growth in the world population and the constant increase in human mobility, the possible impact of outbreaks of epidemics on cities is increasing, especially in high-density urban areas such as public transportation and transfer points. The volume and proximity of people in these areas can lead to an observed dramatic increase in the transmission of airborne viruses and related pathogens. Due to the critical role these areas play in transmission, it is vital that we have a comprehensive understanding of the ‘transmission highways’ in these areas to predict or prevent the spreading of infectious diseases in general. The principled approach of this paper is to combine and utilize as much information as possible from relevant sources and to integrate these data in a simulated environment that allows for scenario testing and decision support. In this paper, we describe a novel approach to study the spread of airborne diseases in cities by combining traffic information with geo-spatial data, infection dynamics and spreading characteristics. The system is currently being used in an attempt to understand the outbreak of influenza in densely populated cities in China.
               
            

@&#INTRODUCTION@&#

City-level airborne epidemics are constant threats to healthy living. With the fast growth of the world’s population and the constant increase in human mobility, the danger of outbreaks of epidemics is rising. For example, the pandemic influenza A (H1N1), also known as Human Swine Influenza/Swine Flu, caused an international outbreak in Mexico in 2009, and it caused a serious epidemic in China. Indeed, China is highly susceptible to pandemic influenza A (H1N1) due to the large population and high residential density. According to the report by the Ministry of Health of China, the provinces in mainland China had reported 19,589 confirmed cases, 14,348 cured cases, 10 severe cases and several deaths up to 30th September 2009 (Ministry of Health of China, 2009).

In urban areas with high density such as public transportation and transfer points, where people frequently experience close proximity to one another, we observe a striking increase in the transmission of airborne viruses and related pathogens. To correctly model and simulate airborne epidemics, it is critical that the city infrastructure, which causes these hot spots of transmission, be analyzed and captured in detail. We utilized Geographic Information Systems (GIS) to model the infrastructure of a city that is likely to be threatened by epidemic attacks. GIS facilitates storing, querying and visualizing city infrastructure including roads, regions with diverse functionality, public transportation, and other attributes. To model airborne disease spread, it is important to understand how city infrastructure is used by the inhabitants and acts as the container of infection. We addressed path routing based on city transportation to capture mobility of people and transmissions that occur in localities, especially public transit. This approach was used because in many developing countries such as China, the overly crowded public transportation system can greatly exacerbate airborne epidemics.

Based on geo-spatial information, it is essential to model a local population that dwells in a city with their spatio-temporal behavior. “There is growing recognition that the solutions to the most vexing public health problems are likely to be those that embrace the behavioral and social sciences as key players” (Mabry, Olster, Morgan, & Abrams, 2008). “Human behavior plays an important role in the spread of infectious diseases, and understanding the influence of behavior on the spread of diseases can be key to improving control efforts” (Funk, Salathé, & Jansen, 2010). Obtaining a strong understanding of the ‘transmission highways’ in urban areas regarding the transmission locations and relevant behavior of people is vital to predict and prevent the spread of infectious diseases. Therefore, investigating the patterns that are relevant to social contacts, and consequent airborne virus transmissions, is of great importance.

Although the work on social networks and their application in epidemiological research plays an important role, it is almost impossible to directly correlate the transmission between two agents (represented as vertexes or nodes) that occur along network edges (links) to people’s spatio-temporal behavior. This difficulty is because social networks are substantial abstractions of realistic human social contacts, in which spatial information is retracted and replaced by topological information. The reader is referred to literature (Schneeberger et al., 2004; Sloot, Ivanov, Boukhanovsky, Van De Vijver, & Boucher, 2008; Karlsson, Jansson, Normark, & Nilsson, 2008; Mei, Vijver, Xuan, Zhu, & Sloot, 2010b; Mao & Bian, 2010; Mei, Quax, Vijver, Zhu, & Sloot, 2011) for details.

Existing studies, including EpiSimS (Epidemic Simulation System) (Eubank et al., 2004; Barrett, Eubank, & Smith, 2005; Valle et al., 2006; Valle, Hyman, Hethcote, & Eubank, 2007) which is an extraordinary example, grounded this study. EpiSimS is a discrete-event-driven stochastic simulation model used for investigating the spread of diseases in large urban populations. “The original EpiSimS model was based on the city of Portland, Oregon, in which the simulated movement of more than 1.6 million individuals was constructed. Each individual in the simulation was instantiated according to actual demographic distributions drawn from census data, so that the synthetic population had the correct demographics, e.g. age distribution, household statistics, population density, etc.” (Valle et al., 2007) However, EpiSimS does not subtly address how people travel, encounter one another and therefore spread airborne diseases at various spots. This concern is a main focus of this study.

We introduced a novel approach in this paper to study the spread of airborne disease in urban areas by combining traffic information with geo-spatial data, infection dynamics and spread characteristics. We combined and utilized as much information as possible from relevant sources and integrated these data in a simulation environment that allows for scenario testing and decision support.

The remainder of this paper is organized as follows. Section 2 addresses the modeling of a city and the synthesis of the population to support the simulations of airborne disease spread. Section 3 presents the GIS-based implementation and visualization of the simulation environment and performs a tentative experimentation. Last, the paper is summarized, and future directions are outlined.

We discuss city modeling from the aspects of city partitions and traffic (road and public transportation) networks.

To construct a synthetic city, we break down major metropolitan areas into regions and sublocations (SLs) that reside inside each region. Regions, or land uses in some studies, are pieces of city land serving various purposes, such as agriculture, commerce, medication and education. Sublocations, affiliated with a specific region, represent a realistic-room-like space where people conduct their daily activities and have social contacts. The types of regions and sublocations considered in this study are subject to whether infections frequently occur inside particular spaces.

Each region is categorized into types of agriculture, residence, hospital, school, university and recreation, according to the main facilities that it provides to people, which is consistent with existing work (Valle et al., 2006; Valle et al., 2007; Yang, Atkinson, & Ettema, 2008b; Zhang et al., 2012). In this study, we exclusively considered 7 types of regions – housing (HR), office (OR), school (SR), university (UR), medical (MR), recreational (RR) and transportation (TR) according to the general function assignment of city regions. This region partitioning requires GIS files to comprise clearly partitioned land pieces, and these pieces can be mapped to the aforementioned 7 region types, ignoring those regions (e.g., agricultural regions) that contribute less to the spread of diseases. For instance, industrial regions are mapped to ORs. Transportation regions, as special cases, are assumed to consist of only mobile rooms (i.e., compartments of trains, metros and buses).

The union of all regions is not necessarily equal to the entire city area. In other words, ‘holes’ are allowed on the city map. Whether regions completely encompass the city depends on the completeness of the fundamental data partition in GIS files, which have little impact on epidemic simulations. For example, agricultural regions can be ignored, due to the infection-hampering factors of low density of population and outdoor air conditions. Moreover, only human–human specific transmission is considered in this study, whereas animal–human transmission is excluded.

A region contains a set of sublocations of different classes. For example, a university region (UR) contains office sublocations (offices), residential sublocations (student dormitories and faculty members’ homes), classroom sublocations (classrooms, labs and library space), recreation sublocations (cafeteria, clubs, shops, refectories and restaurants) and possibly hospital sublocations. Specifically, the recreational class includes shops, restaurants, cinemas, supermarkets and all other relevant places that provide services for recreation, relaxation or sales of life necessities. In this study, we classified sublocations as housing (HS), office (OS), classroom (CS), patient room (PS), recreational (RS) and transportation (TS). Table 1
                            lists the classifications of regions and secondary sublocations in detail.

Sublocations are virtually created with 2 dimensions inside each region. Because sublocations are usually beyond the resolution of GIS files, we generated sublocations and assigned the length and width to each of them in meters. During the course of simulations, individuals are attached to one sublocation at a time and conduct activities (working, staying at home, entertaining, etc.) inside. Accordingly, people interact with only those who stay inside the same sublocation, although visually sublocations can overlap. Additionally, each sublocation is characterized as being either indoor or outdoor, conveying different transmission probabilities of viruses inside the space. For many airborne viruses, outdoor conditions such as sunshine, heat, wind blowing and air circulation can lower the infection probability between the infected and the susceptible.

City traffic routes are modeled as a road network (RN) and a public transportation network (PTN).

The assemblage of roads in a city can be mapped to a road network (RN). Roads, as the transport infrastructure of a city, are composed of road sections and crossings. We establish the road network, denoting crossings by nodes and sections by edges, as shown in Fig. 1
                           . Edges can be unidirectional or bidirectional, indicating that they correspond to one-way or two-way road sections, respectively. A crossing joins several road sections together. The number of sections (usually 2, 3 or 4) that a crossing links indicates the connectivity of the crossing. Accordingly, the entire city roadway can be mapped to a complex network
                              1
                              In the context of network theory, “a complex network is a network with non-trivial topological features that mostly do not occur in simple networks such as lattices” (Newman, 2003).
                           
                           
                              1
                            of vast nodes and edges. The degree of each node shows the number of neighboring sections that this crossing connects with. Obviously, the degree of nodes in this road network is greater than or equal to 1.

The assemblage of public transportation routes can be mapped to a public transportation network (PTN) in terms of lines and stops. Public transit consists of many bus/tram and metro/train lines along which buses/trams and metros/trains operate frequently during day time. Buses/trams and metros/trains depart every few minutes from the starting stop of a line and move towards the destination stop. People get on or off at each stop along each line. Many lines join at a stop to create a transfer station. Every line is composed of head–tail line sections. Similar to a crossing in the roadway, a line crossing joins several line sections together. We constructed the PTN by denoting crossings by nodes and sections by edges, whereas stops are scattered along both sides of each edge, as shown in Fig. 2
                           . The example in Fig. 2 shows the route of a bus line in one direction that passes 6 bus stops (displayed in square) No. 1–6 along three line sections, and in the other direction, it passes stops No. 7–12 along the same three line sections.

Note that the edges in both the RN and the PTN are unnecessarily associated with the boundary formation of regions. Edges can cross through regions and provide travel entries for nearby people. If an individual needs to travel from one sublocation to another, he/she needs to locate the closest travel point (either a road entry or a bus/train/metro stop) on a nearby edge of the RN or the PTN.

People travel within a city by foot, car, taxi, bike and public transportation. We discuss their travel routes by utilizing the previously constructed RN and PTN. For simplicity, we focused on the mobility of people inside a single city and did not consider the relatively less common commutes between cities.

For travel by means other than public transportation, we considered routing in two ways. First, for computation simplicity, we assumed that people move along a straight line connecting the start-point (
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                           ) and the end-point (
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                           ) for very short distances (for example, when 
                              
                                 Distance
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 ⩽
                                 3
                                 
                                 km
                              
                           ). In this manner, network involvement is avoided to reduce the computation complexity of short-distance routing (
                              
                                 Path
                                 =
                                 L
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                            where L denotes the line between the two points). Second, for cases above the short distance threshold, we assumed people move along the shortest feasible path in the RN. The fundamental theoretical achievements in the field of graph theory can help seek the shortest or feasible paths, such as by using the so-called Dijkstra algorithm for node-to-node shortest path computation. Therefore, if 
                              
                                 Distance
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                                 )
                                 >
                                 3
                                 
                                 km
                              
                           , the travel route result will be the combination of 5 parts (see Fig. 3)
                           , i.e., 
                              
                                 Path
                                 =
                                 L
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       rs
                                    
                                 
                                 )
                                 +
                                 L
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       rs
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       ns
                                    
                                 
                                 )
                                 +
                                 SP
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       ns
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       ne
                                    
                                 
                                 )
                                 +
                                 L
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       ne
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       re
                                    
                                 
                                 )
                                 +
                                 L
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       re
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                           , where 
                              
                                 
                                    
                                       N
                                    
                                    
                                       rs
                                    
                                 
                              
                            is the nearest point on road (edges in RN) to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ns
                                    
                                 
                              
                            is the nearest node (in RN) to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       rs
                                    
                                 
                                 ,
                                 
                                 SP
                              
                            computes the shortest path (plotted in gray) between two points in RN (
                              
                                 
                                    
                                       N
                                    
                                    
                                       ns
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       ne
                                    
                                 
                              
                            in this case), 
                              
                                 
                                    
                                       N
                                    
                                    
                                       re
                                    
                                 
                              
                            is the nearest point on road to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       ne
                                    
                                 
                              
                            is the nearest node to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       re
                                    
                                 
                              
                           . Additionally, the SP result can be substituted by other feasible paths if traffic avoidance needs to be considered.

Traveling by public transit further complicates routing. Looking for the shortest paths in PTN does not necessarily solve the routing problem because buses/metros move along predefined stop-by-stop lines instead of shortest paths. To overcome this obstacle, we designed a breadth-first algorithm as illustrated in Fig. 4
                           . We began with 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                            (i.e., the start-point and the end-point). To compute paths based on public transportation, a set of stops close to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                           , denoted by 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                           , were obtained first. We searched these stops within a given distance of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                           , and the resulting circle with center point 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            and given radius is called the extension area of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                           . We defined the extension operation 
                           
                              
                                 Ex
                                 (
                                 stop
                                 ,
                                 radius
                                 )
                              
                            to get all the stops inside the circle with center point stop and given radius (therefore, 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 Ex
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 radius
                                 )
                              
                           ). In the same way we can get 
                              
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                              
                           , a set of close stops to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                            by utilizing the corresponding extension operation 
                              
                                 Ex
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 radius
                                 )
                              
                           . The two sets of 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                              
                            represent the stops at which people board the transport and the stops from which people alight from for the sake of traveling from location 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                           .

The search operation continues iteratively. We denoted the resulting set of stops from the ith search by 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                              
                            and the radius adopted for the ith search by 
                              
                                 
                                    
                                       radius
                                    
                                    
                                       i
                                    
                                 
                              
                           . To conduct an onward search according to predefined line information, we defined the operation of obtaining directly reachable stops of a given stop as 
                              
                                 DR
                                 (
                                 stop
                                 )
                              
                           , which produces a set of stops immediately next to the given stop in all connecting lines. As shown in Fig. 4, for each stop in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            (three in total except 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                           ), we can get its 
                              
                                 DR
                                 (
                                 stop
                                 )
                              
                            set. As an illustration, in Fig. 4, each stop in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                              
                            is assumed to have only one directly reachable stop. Therefore, the union of the stops inside the three extension areas (three big circles with dashed perimeter) leads to 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∪
                                    
                                    
                                       
                                          
                                             stop
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       DRS
                                    
                                 
                                 Ex
                                 (
                                 
                                    
                                       stop
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       radius
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            where 
                              
                                 DRS
                                 =
                                 
                                    
                                       ∪
                                    
                                    
                                       
                                          
                                             stop
                                          
                                          
                                             1
                                          
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 DR
                                 (
                                 
                                    
                                       stop
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           . Therefore, The search results starting from both 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                            are given in Eqs. 1 and 2, respectively.
                              
                                 (1)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Ex
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            radius
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ⋃
                                                            
                                                            
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ∈
                                                               
                                                                  
                                                                     S
                                                                  
                                                                  
                                                                     i
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ⋃
                                                            
                                                            
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ∈
                                                               DR
                                                               (
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      Ex
                                                      (
                                                      
                                                         
                                                            stop
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            radius
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      i
                                                      ⩾
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Ex
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            radius
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ⋃
                                                            
                                                            
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               ∈
                                                               
                                                                  
                                                                     E
                                                                  
                                                                  
                                                                     i
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ⋃
                                                            
                                                            
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               ∈
                                                               DR
                                                               (
                                                               
                                                                  
                                                                     stop
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      Ex
                                                      (
                                                      
                                                         
                                                            stop
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            radius
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      i
                                                      ⩾
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The termination condition for the search was achieved when 
                              
                                 ∃
                                 i
                                 ,
                                 j
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 
                                    
                                       E
                                    
                                    
                                       j
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           . With minimum transits and less time consumption as two key conditions, the result is the optimal routing from 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                           , involving all the stops on the way and necessary transits. Please note that the radius parameter for each ith search, 
                              
                                 
                                    
                                       radius
                                    
                                    
                                       i
                                    
                                 
                              
                           , is tunable. For example, we can set 
                              
                                 
                                    
                                       radius
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 
                                 km
                              
                            to search for stops within a radius of 1km from 
                              
                                 
                                    
                                       P
                                    
                                    
                                       s
                                    
                                 
                              
                            or 
                              
                                 
                                    
                                       P
                                    
                                    
                                       e
                                    
                                 
                              
                            and 0.05km for the rest, implying that transits between lines can only occur if the distance between 2 nearby stops is <0.05km. If the routing fails, which means that the algorithm results in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 
                                    
                                       E
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 ∅
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 
                                 j
                              
                           , people need to resort to other traveling means (e.g., taxi). Arguably, in a maturely developed city, the possibility of routing failure is low and bearable for our simulations.

In this study, each person is represented as an agent with individual attributes and behavior based on the Multi-Agent Systems theory which has proven to be suitable for modeling epidemics (Epstein & Axtell, 1996; Reynolds & Dixon, 2000; Heylighen, 2001; Koopman, 2006; Auchincloss & Diez Roux, 2008). To synthesize the population in a given city and investigate how people transmit airborne viruses and respond to epidemics, we needed to outline the attributes of people with respect to epidemiological and sociological characteristics and model people’s daily behavior, the occurrence of contacts and subsequent infections.

The selection of attributes of people is determined by the virological, medical, sociological and demographical data that is available to support our models. We considered age, gender, susceptibility to epidemics, immunity to particular viruses, social status, infection status (susceptible, infected, infectious, treated or cured), Housing SL and Office SL. The Housing SL indicates the place where a person rests, especially at night, including homes and dormitories; in contrast, the Office SL indicates the place where a person spends time working (for adults) or studying (for students) during day time. Please note that study activities of students are also regarded as work activities. Initially, assigning values to these attributes for each person depends on the actual statistical distribution or rules deduced from available data. For example, the age distribution can be obtained from national census; the distribution of the distance between one’s Housing SL and Office SL for people living in a given city can be estimated based on questionnaires. Assigning one’s Housing SL and Office SL was performed by the following procedure: (1) each person is initially attached to a Housing SL, considering household formation rules regarding age, gender, and family size; (2) a distance value between the Housing SL and the Office SL is drawn from a particular distribution; (3) an Office SL is randomly selected on the city map at proximately a distance of the above value away from the Housing SL. Once set, some attributes are kept constant throughout simulations, and others can change during the simulation. For instance, the infection status of a person can be set susceptible (healthy) at the beginning and then change in response to particular events such as infections.

All individuals are classified according to their age structure and lifestyles, as given in Table 2
                           . From here onward, the modeling of people’s activities (in Section 2.2.2) is applied to these 5 classifications because it is believed that daily activity patterns are related to individuals’ socioeconomic characteristics such as household role, lifestyle and life cycle (Kulkarni & McNally, 2000; Yang et al., 2008b).

People conduct diverse daily activities in sublocations. The daily activities consist of working, staying at home, relaxing at various recreational places, staying in a hospital after getting infected and traveling between activities, etc. People engage in each activity in a specific class of sublocation (the classification is given in Table 1). Specifically, people work in Office SLs, stay home in Housing SLs, shop/do sport/enjoy entertainment in Recreational SLs, get treatment in Patient Room SLs, study in Classroom SLs and travel in Transportation SLs. The types of activities, the corresponding places where these activities occur and the involved people classes are listed in Table 3
                           , based on research reported in (Valle et al., 2006; Yang et al., 2008b). Additionally, please refer to Table one in (Valle et al., 2007) for the distribution of average duration by activity type. For instance, the average duration of Home activity is 12h 24min with a standard deviation of 5h 8min, and the average duration of work activity is 3h 4min with a standard deviation of 2h 29min.

The generation of the daily agenda for an individual is subject to daily activity patterns, depending on the classification of this individual. As for most people whose main activities are working, we generated their daily agenda according to the research in (Bhat & Singh, 2000; Roorda, Miller, & Habib, 2008; Yang, Chen, Wang, & Wan, 2008a). Six activity patterns are adopted as shown in Table 4
                            where “*” stands for possible activities other than Home, Work and Travel. Please note that “T” (Travel) is skipped between each pair of neighboring activities. For instance, ”HTWTH” stands for the complete form of ”HWH”. The percentages are taken from (Yang et al., 2008a) based on a survey accomplished in a China city Changsha. In simulations, a Recreation or Medical Care activity will be generated to substitute “*”.

After an individual has finished an activity, he/she moves by either public or personal transportation from the current location to another sublocation where the next activity is going to take place. The travel routing, based on either RN or PTN, is computed according to Section 2.1.3. The required travel time is estimated, considering the travel means, the start-point and the end-point. Furthermore, individuals’ knowledge of the global epidemic situation, such as the alert phases issued by WHO, and their own infection status, can influence their behavior which is then reflected in the generation of daily agenda. For example, if a person is aware of the severe prevalence of an epidemic or the diagnosis of his/her own infection, he/she likely prolongs his/her stay at home, decreases work time and avoids crowded places such as recreational SLs. Therefore, the parameters for generating activities can be tuned to adapt to different situations.

People encounter and have contacts with others in conducting activities or traveling; thus, they may become infected with airborne viruses when epidemics are prevalent. “The probability that a susceptible person becomes infected during a visit to a sublocation depends on: how many infectious persons co-occupy the room, how long each contact lasts, the type of activity, and the infectiousness category of the infectious person (Eubank et al., 2004)”. According to (Valle et al., 2007), σ is the mean number of transmission events per hour of contact between fully infectious and fully susceptible people. In this study for simplicity, we assumed that each infectious person has the same infectiousness regardless of age group classification (Table 2). For events that occur randomly in time, the number of occurrences in a period of time of length t obeys a Poisson probability law with parameter 
                              
                                 σ
                                 t
                              
                            (Valle et al., 2007). Then, we obtain the probability of one or more occurrence in time interval t is 
                              
                                 1
                                 -
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       σ
                                       t
                                    
                                 
                              
                           . If an infectious individual i and a susceptible individual j stay within a distance threshold 
                              
                                 
                                    
                                       D
                                    
                                    
                                       ∗
                                    
                                 
                              
                            (tunable for epidemics) from one another in the same sublocation for a particular period of time 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ij
                                    
                                 
                              
                            (recordable in simulations), infection can occur with a probability of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       σ
                                       
                                          
                                             T
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                              
                           . According to (Chowell, Nishiura, & Bettencourt, 2007; Valle et al., 2007), σ can be estimated based on knowledge of past epidemics. For simplicity, each individual is assumed to wander around inside a sublocation during the stay, and his/her accurate coordinates are obtainable. Therefore, the distance between the two individuals who stay in the same sublocation can be measured to assess whether it is less than 
                              
                                 
                                    
                                       D
                                    
                                    
                                       ∗
                                    
                                 
                              
                           .

Disease progression can be simply described by the following stages: (1) incubation with assumed non-infectiousness, (2) symptomatic period with infectiousness and (3) recovery/death (Mei, Sloot, Quax, Zhu, & Wang, 2010a). For airborne diseases such as pandemic influenza A (H1N1), a susceptible individual can avoid getting infected after vaccination. Therefore, individuals can become immunized by either natural immunization (recovery from previous infection) or vaccination. 3 parameters – 
                              
                                 
                                    
                                       D
                                    
                                    
                                       incubation
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       D
                                    
                                    
                                       symptomatic
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       vaccination
                                    
                                 
                              
                            – were introduced to our model, indicating the duration of the incubation stage, the symptomatic stage and the duration that vaccination needs to stimulate immunity, respectively. For example, we can set 
                              
                                 
                                    
                                       D
                                    
                                    
                                       incubation
                                    
                                 
                                 =
                                 1
                                 ∼
                                 2
                                 ,
                                 
                                 
                                    
                                       D
                                    
                                    
                                       symptomatic
                                    
                                 
                                 =
                                 1
                                 ∼
                                 7
                              
                            and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       vaccination
                                    
                                 
                                 =
                                 7
                                 ∼
                                 21
                              
                            days for influenza A (H1N1) (Mei et al., 2010b).

Based on available GIS data from Changsha city (Capital of Hunan Province, in the middle south of China), we implemented the model and described a simulation environment that can further allow for scenario testing and decision support.

Although the pandemic influenza H1N1 has not broken out in Changsha city – a medium-size city in China, it is vital to establish the capability to simulate a hypothetical airborne-disease outbreak in the city and examine the critical role of public transit and transfer points in disease spread. Accordingly, the model could provide a platform to examine various “What-if” scenarios, and the results can give implications to design effective policy interventions.

To simulate the pandemic influenza A (H1N1), a Message Passing Interface (MPI) based parallel simulation was used to implement the computational experiments. As shown in Fig. 5
                     , the regions in the city, such as hospitals and schools, are grouped and then distributed to different computational nodes. With the help of MPI, agents move among regions in various Local Processes (LPs) in the runtime.


                     Fig. 6
                      displays the visualization of the city. Roads are shown as lines, bus/metro stops as squares, buses/metros as stars, and persons as circles. All these objects are stored, queried and manipulated efficiently based on GIS. When simulations are running, stars and circles are moving on the 2-dimensional map, representing that buses/metros operate along lines and people conduct daily activities according to their own agenda.

Based on the aforementioned models and implementation, 6,000,000 agents are simulated in four computational nodes with 48CPU cores and 128G memory, connected by kilomega networks. It costs approximately 4h to simulate a 1-month spread of pandemic influenza A (H1N1), if using timesteps of 10min. We used a baseline infectiousness to depict the probability per hour that a susceptible person will get infected if there is a symptomatic infectious person in the same sublocation at the same time, and we let this baseline infectiousness be 0.00285 transmissions per hour (Valle et al., 2006; Stroud et al., 2006). Therefore, we set 
                        
                           σ
                           =
                           0.00285
                        
                      and the distance threshold 
                        
                           
                              
                                 D
                              
                              
                                 ∗
                              
                           
                           =
                           2
                           
                           m
                        
                      (see Section 2.2.3).

We designed three interventions to control the epidemics: Vaccination Ratio, Isolation and Office Closure. The initial settings of the experiments are listed in Table 5
                     . 10% of the randomly chosen agents are vaccinated and become immune to the disease at particular time points. The duration of Isolation is seven days, which means that the isolated agents will stay at home for seven days if they have had previous contact with any other infected agent. 5% of the Offices were randomly chosen to be closed for the next seven days when the Office Closure intervention is activated, so that agents who are working at these offices will stay home during the closure period. The results of the experiments are shown in Fig. 7
                     . Each simulation result is an average of 30 realizations.

The curves in Fig. 7 show the count of infected and recovered agents changing with simulation time. We performed two sets of experiments with different intervention activation days. The maximum total infected is approximately 6,800 if the interventions are activated on the 5th day. However, if the interventions are activated one day earlier, the maximum total infected is greatly decreased to 3,100 agents. Moreover, approximately 19% patients get infected at public transit and transfer points (data not shown in Fig. 7). The two curves that plot the count of recovered agents go up much faster during the period 15th–25th days because more infected agents generate more recovered agents. Additionally, the epidemic period is shortened if the interventions are activated earlier (e.g., in this case, the end day of the spread (until all agents recover) if the interventions are activated on the 4th day is 4days earlier than if the interventions are activated on the 5th day).

To further validate our model, we compared the simulated results in Changsha with the historical data of the outbreak of the pandemic influenza A (H1N1) in Beijing in 2009, as shown in Fig. 8
                     . The two curves with legends show the simulated daily new infections with different intervention activation days (on the 5th day and the 4th day, respectively). The insert shows the observed new infections since September 22, 2009 in Beijing with data from (Xiao-li et al., 2010). Both the simulated and observed new infections shortly reach a peak value and then go down modestly due to preventions. Specifically, the Changsha simulations reach the peaks of 590 and 1,100 on the 5th and 6th day corresponding to the 4th-day activation and the 5th-day activation experiments, and the peak value of the Beijing case is 1,785 on the 30th day. The implementation of a series of measures to prevent and control the pandemic influenza A (H1N1) reduced the cumulative number of laboratory-confirmed cases of pandemic influenza A (HlN1) (Xiao-li et al., 2010). This finding is also consistent with our simulation results. Although Beijing has approximately three times the population of Changsha and the curves in Fig. 8 are plotted at different time scales, the similarity between the curves of the two cases of Changsha and Beijing reveals that our model can capture the underlying principles of airborne disease spread and help predict the impact of control interventions.

@&#CONCLUSION@&#

We have developed a novel system that integrates the most relevant geo-spatial and dynamic information required to assess the potential outbreak of airborne diseases in an urban environment. We combine GIS data with traffic and mobility patterns as well as knowledge on behavioral aspects. The information is represented in a dynamic multi-agent simulation system. Agents travel and conduct activities according to their assigned daily agenda and therefore interact in different sublocations based on our innovative multi-stop travel routing (mix of pedestrian, car, taxi, bike and public transport modes) between any two points in the city. Our simulation records and analyzes the transmission occurring in transportation sublocations, as well as other places, to better understand how seriously airborne diseases spread at public transport and transfer points. This research is superior to other existing work and can be especially useful to apply to densely populated cities in China.

The system allows for interactively exploring various alternative scenarios to support decision making and prevention, prediction and recovery of an outbreak. In the future, we will focus on calibration and validation of the system based on a more sophisticated empirical study compared to historical epidemiological data.

The authors declare that they have no competing interests.

@&#ACKNOWLEDGMENTS@&#

This work was supported by China National Scientific Fund (No. 71373282 & No. 91324014), ViroLab (Sloot et al., 2009) and the European DynaNets (www.dynanets.org) grant (EU Grant Agreement Number 233847). The Research was also partly sponsored by a grant from the ‘Leading Scientist Program’ of the Government of the Russian Federation, under contract 11.G34.31.0019. Boukhanovski and Sloot acknowledge supported by Russian Scientific Foundation proposal #14-21-00137.

@&#REFERENCES@&#

