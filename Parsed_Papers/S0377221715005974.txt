@&#MAIN-TITLE@&#The inverse convex ordered 1-median problem on trees under Chebyshev norm and Hamming distance

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We investigate in this paper the inverse convex ordered 1-median problem.


                        
                        
                           
                           We consider this problem on trees and under Chebyshev norm and Hamming distance.


                        
                        
                           
                           We develop exact algorithms (with time complexity O(n
                              2log (n)) for both cases.


                        
                        
                           
                           We show that the problem is NP-hard under the weighted sum Hamming distance.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ordered median

Inverse optimization problem

Convex

Tree

Chebyshev norm

Hamming distance

@&#ABSTRACT@&#


               
               
                  We investigate the inverse convex ordered 1-median problem on unweighted trees under the cost functions related to the Chebyshev norm and the Hamming distance. By the special structure of the problem under Chebyshev norm, we deduce the so-called maximum modification to modify the edge lengths of the tree. Additionally, the cost function of the problem receives only finite values under the bottleneck Hamming distance. Therefore, we can find the optimal cost of the problem by applying binary search. It is shown that both of the problems, under Chebyshev norm and under the bottleneck Hamming distance, can be solved in O(n
                     2log n) time in all situations, with or without essential topology changes. Here, n is the number of vertices of the tree. Finally, we prove that the problem under weighted sum Hamming distance is NP-hard.
               
            

@&#INTRODUCTION@&#

In the classical location problems we aim to find optimal locations of new facilities with respect to an objective function. The common objective function may be the median or center function, see Eiselt and Marianov (2011); Kariv and Hakimi (1979a,b). However, in some cases the decision maker would like to choose another class of objective function such as the center-median function Halpern (1976) or the k-centrum function Tamir (2001). Thus, it motivates us to study the universal approach of location problems in which the methods and algorithms can be applied to a wide class of objective functions, see the book of Nickel and Puerto (2005).

In recent years, inverse optimization problems have been investigated. To our best knowledge, the work of Burton (1993) on the inverse shortest path problem was the first paper in the field of inverse optimization problems. For a survey of inverse combinatorial optimization problems and methods, we refer to the paper of Heuberger (2004).

The inverse median problems on the plane and on networks with variable weights were studied by Burkard, Pleschiutschnig, and Zhang (2004). They proved that the inverse 1-median problem on trees can be solved in O(nlog n) time, where n denotes the number of vertices. In a later work Galavii (2008, 2010), improved the complexity to linear time. Burkard, Galavii, and Gassner (2010) solved the inverse Fermat–Weber problem in O(nlog n) time by a greedy algorithm if the prespecified point does not coincide with any given point(s). Otherwise, the problem can be formulated as a convex program and is, therefore, solvable in polynomial time. Based on the concavity of the inverse 1-median problem on a cycle, Burkard, Pleschiutschnig, and Zhang (2008) solved the problem with variable weights in O(n
                     2) time. Bonab, Burkard, and Gassner (2011) investigated the inverse p-median problem on networks with variable edge lengths. They showed that the problem is NP-hard on general networks. Nevertheless, it is solvable in polynomial time if the underlying network is a tree and especially in linear time for the problem on a star graph.

For the inverse 1-center problem on networks, Cai, Yang, and Zhang (1999) first showed that although the 1-center problem on directed networks can be solved in polynomial time, the corresponding inverse version is NP-hard. Thus, it is interesting to study in which cases the inverse 1-center problem can be solved in polynomial time. The inverse 1-center problem on unweighted trees was solved efficiently in polynomial time, see Alizadeh and Burkard (2011a,b); Alizadeh, Burkard, and Pferschy (2009). However, for the inverse 1-center problem on cactus graphs which is a simple generalization of the corresponding problem on tree networks, Nguyen and Chassein (2014) showed the NP-hardness. Furthermore, Nguyen and Anh (2015) investigated and proved that the inverse k-centrum problem on trees with variable vertex weights, a generalization of the inverse 1-median problem for 
                        
                           k
                           =
                           n
                        
                      and the inverse 1-center problem for 
                        
                           k
                           =
                           1
                           ,
                        
                      is NP-hard. They further solved the inverse 1-center problem in quadratic time.

Most of the previous papers studied the problem under rectilinear norm. Furthermore, the consideration of other types of objective functions such as Chebyshev norm or Hamming distance is worthwhile. Guan and Zhang (2012) investigated the inverse 1-median problem on trees under Chebyshev norm and Hamming distance. They solved the problem under Chebyshev norm and bottleneck Hamming distance efficiently in linear time and proved that the problem under weighted sum Hamming distance is NP-hard. In addition, Nguyen and Sepasian (2015) developed efficient algorithms to solve the inverse 1-center problem on trees under Chebyshev norm and Hamming distance in O(nlog n) time, if no topology change occurs during the modification of edge lengths. Otherwise, the problem can be solved in quadratic time. On the other hand, the first who studied the inverse ordered median location problem on trees was Gassner (2012). She proved that the inverse convex ordered median problem on trees with uniform weights is NP-hard, the inverse k-centrum problem on a general weighted tree is also NP-hard. However, the inverse k-centrum problem on uniform weighted trees can be solved in polynomial time by dynamic programming. In this paper, we consider the interconnection between these two papers, i.e. the inverse ordered median location problem under Chebyshev norm and Hamming distance. The problem has not been studied so far to our best knowledge.

This paper is organized as follows. We formulate the problem with general cost function and construct some prerequisites in Section 2. We consider in Section 3 the problem under Chebyshev norm. The problem under Hamming distance is investigated in Section 4.

We first introduce the ordered median function on a given network. Consider a graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      with n vertices. A nonnegative weighted wi
                      is assigned to each vertex vi
                      ∈ V. If 
                        
                           
                              w
                              i
                           
                           =
                           
                              w
                              j
                           
                        
                      for all i ≠ j, we get a uniform weighted or an unweighted graph. In this case, one can always assume that 
                        
                           
                              w
                              i
                           
                           =
                           1
                        
                      for all vi
                      ∈ V. Each edge e ∈ E is associated with a nonnegative length ℓ
                        e
                     . Given u, v ∈ V the distance d(u, v) is the length of the shortest path P(u, v) connecting these two vertices. Denote by A(G) the set of continuum points in G. In other words, we consider an edge 
                        
                           e
                           =
                           [
                           u
                           ,
                           v
                           ]
                        
                      with length ℓ
                        e
                     . A point x ∈ e is identified by 
                        
                           d
                           
                              (
                              u
                              ,
                              x
                              )
                           
                           =
                           t
                           
                              ℓ
                              e
                           
                        
                      for some t ∈ [0, 1]. Obviously, 
                        
                           x
                           =
                           u
                        
                      if 
                        
                           t
                           =
                           0
                        
                      and 
                        
                           x
                           =
                           v
                        
                      if 
                        
                           t
                           =
                           1
                        
                     . Given a vector of multipliers 
                        
                           λ
                           =
                           
                              (
                              
                                 λ
                                 1
                              
                              ,
                              
                                 λ
                                 2
                              
                              ,
                              …
                              ,
                              
                                 λ
                                 n
                              
                              )
                           
                           ∈
                           
                              R
                              +
                              n
                           
                           ,
                        
                      the single facility ordered median function on A(G) is defined as:

                        
                           
                              
                                 
                                    
                                       f
                                       λ
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       λ
                                       i
                                    
                                    
                                       w
                                       
                                          (
                                          i
                                          )
                                       
                                    
                                    d
                                    
                                       (
                                       x
                                       ,
                                       
                                          v
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     Here, the operator (.) is a permutation of 
                        
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                      such that

                        
                           
                              
                                 
                                    w
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 d
                                 
                                    (
                                    x
                                    ,
                                    
                                       v
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    w
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 d
                                 
                                    (
                                    x
                                    ,
                                    
                                       v
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    )
                                 
                                 ≤
                                 …
                                 ≤
                                 
                                    w
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 d
                                 
                                    (
                                    x
                                    ,
                                    
                                       v
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     A permutation with this property is called a feasible permutation. There may exist many feasible permutations with respect to a given point x. Thus, we denote by Π the set of all feasible permutations.

A point x
                     0 ∈ A(G) such that fλ
                     (x
                     0) ≤ fλ
                     (x) for all x ∈ A(G) is called the ordered 1-median of the graph. Especially, if the network 
                        
                           G
                           =
                           T
                        
                      is a tree and the components of λ are nondecreasing, i.e. 
                        
                           
                              λ
                              1
                           
                           ≤
                           
                              λ
                              2
                           
                           ≤
                           …
                           ≤
                           
                              λ
                              n
                           
                        
                      then the ordered median objective function is convex along each path of the tree Nickel and Puerto (2005). In this case the problem of finding an ordered 1-median on a tree T is called the convex ordered 1-median problem. An algorithm to find the convex ordered 1-median of a tree is investigated in Kalcsics, Nickel, Puerto, and Tamir (2002); Nickel and Puerto (2005). In which, the authors try to search in decreasing direction of the objective function until the optimality criterion holds. We look deeply into the optimality criterion of the convex ordered median problem on an unweighted tree T. Given a point x ∈ A(T), denote by 
                        
                           T
                           (
                           x
                           )
                        
                      the set of subtrees induced by deleting all points y ∈ A(G) with 
                        
                           d
                           (
                           x
                           ,
                           y
                           )
                           =
                           0
                        
                      together with the edge(s) which contain y.

                        Theorem 1
                        
                           [Optimality criterion, reformulation of 
                           
                              Kalcsics et al. (2002)]
                            
                           Given a uniform weighted tree
                           
                              
                                 T
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            
                           and
                           
                              
                                 λ
                                 ∈
                                 
                                    R
                                    +
                                    n
                                 
                              
                            
                           so that
                           
                              
                                 
                                    λ
                                    1
                                 
                                 ≤
                                 
                                    λ
                                    2
                                 
                                 ≤
                                 …
                                 ≤
                                 
                                    λ
                                    n
                                 
                              
                           
                           . Then a point x ∈ A(T) is an ordered 1-median of T if and only if for each subtree
                           
                              
                                 
                                    T
                                    
                                       s
                                       u
                                       b
                                    
                                 
                                 ∈
                                 T
                                 
                                    (
                                    x
                                    )
                                 
                              
                            
                           there exists a feasible permutation σsub such that 
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   v
                                                   
                                                      
                                                         σ
                                                         
                                                            s
                                                            u
                                                            b
                                                         
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                
                                                ∈
                                                
                                                   T
                                                   
                                                      s
                                                      u
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                             w
                                             
                                                
                                                   σ
                                                   
                                                      s
                                                      u
                                                      b
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                
                                                   v
                                                   
                                                      
                                                         σ
                                                         
                                                            s
                                                            u
                                                            b
                                                         
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                
                                                ∉
                                                
                                                   T
                                                   
                                                      s
                                                      u
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                             w
                                             
                                                
                                                   σ
                                                   
                                                      s
                                                      u
                                                      b
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        

Observe that, if x is not an ordered 1-median of the tree then there exists exactly one subtree in 
                        
                           T
                           (
                           x
                           )
                        
                      that violates the optimality criterion. If we restrict us to unweighted trees, we can reformulate the optimality criterion in a simplified form.

                        Definition 1
                        A weighted sum of a subtree 
                              
                                 
                                    T
                                    
                                       s
                                       u
                                       b
                                    
                                 
                                 ∈
                                 T
                                 
                                    (
                                    x
                                    )
                                 
                              
                            is defined as:

                              
                                 
                                    
                                       
                                          
                                             Λ
                                             
                                                T
                                                
                                                   s
                                                   u
                                                   b
                                                
                                             
                                          
                                          =
                                          
                                             min
                                             
                                                σ
                                                ∈
                                                Π
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   v
                                                   
                                                      σ
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                                ∈
                                                
                                                   T
                                                   
                                                      s
                                                      u
                                                      b
                                                   
                                                
                                             
                                          
                                          
                                             λ
                                             i
                                          
                                       
                                    
                                 
                              
                           The complementary weighted sum of Tsub
                            is given by:

                              
                                 
                                    
                                       
                                          
                                             Λ
                                             
                                                T
                                                
                                                   s
                                                   u
                                                   b
                                                
                                             
                                             ′
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             λ
                                             i
                                          
                                          −
                                          
                                             Λ
                                             
                                                T
                                                
                                                   s
                                                   u
                                                   b
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        

Note that we can express the complementary weighted sum of T′ in the form

                        
                           
                              
                                 
                                    
                                       Λ
                                       
                                          T
                                          
                                             s
                                             u
                                             b
                                          
                                       
                                       ′
                                    
                                    =
                                    
                                       max
                                       
                                          σ
                                          ∈
                                          Π
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             v
                                             
                                                σ
                                                (
                                                i
                                                )
                                             
                                          
                                          ∉
                                          
                                             T
                                             
                                                s
                                                u
                                                b
                                             
                                          
                                       
                                    
                                    
                                       λ
                                       i
                                    
                                    .
                                 
                              
                           
                        
                     We can find 
                        
                           Λ
                           
                              T
                              
                                 s
                                 u
                                 b
                              
                           
                        
                      in O(nlog n) time by first identifying the feasible permutation 
                        
                           σ
                           =
                           a
                           r
                           g
                           
                              min
                              
                                 σ
                                 ∈
                                 Π
                              
                           
                           
                              ∑
                              
                                 
                                    v
                                    
                                       σ
                                       (
                                       i
                                       )
                                    
                                 
                                 ∈
                                 
                                    T
                                    
                                       s
                                       u
                                       b
                                    
                                 
                              
                           
                           
                              λ
                              i
                           
                        
                     . To do so, we have to sort all vertices vi
                      with respect to d(x, vi
                     ) and break all ties such that all vertices v ∈ Tsub
                      are preferred. This means that, if two vertices v ∈ Tsub
                      and v′ ∉ Tsub
                      have the same distance to x, v gets a smaller index as v′ in the ordering.

By Theorem 1, we can reformulate the optimality criterion as follows.

                        Corollary 1
                        
                           [Ordered median criterion] Given an unweighted tree
                           
                              
                                 T
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            
                           and
                           
                              
                                 λ
                                 ∈
                                 
                                    R
                                    +
                                    n
                                 
                              
                            
                           so that
                           
                              
                                 
                                    λ
                                    1
                                 
                                 ≤
                                 
                                    λ
                                    2
                                 
                                 ≤
                                 …
                                 ≤
                                 
                                    λ
                                    n
                                 
                              
                           
                           . Then, a point x ∈ A(T) is an ordered 1-median of T if and only if
                           
                              
                                 
                                    Λ
                                    
                                       T
                                       
                                          s
                                          u
                                          b
                                       
                                    
                                 
                                 ≤
                                 
                                    Λ
                                    
                                       T
                                       
                                          s
                                          u
                                          b
                                       
                                    
                                    ′
                                 
                              
                            
                           for all
                           
                              
                                 
                                    T
                                    
                                       s
                                       u
                                       b
                                    
                                 
                                 ∈
                                 T
                                 
                                    (
                                    x
                                    )
                                 
                              
                           
                           .
                        

Now we study the inverse ordered 1-median problem on trees under various objective functions. Given an unweighted tree 
                        
                           T
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      and a vector of multipliers λ such that 
                        
                           
                              λ
                              1
                           
                           ≤
                           
                              λ
                              2
                           
                           ≤
                           …
                           ≤
                           
                              λ
                              n
                           
                        
                     . The length of each edge e ∈ E can be increased or decreased by an amount pe
                      or qe
                     , i.e. the new edge length is 
                        
                           
                              
                                 ℓ
                                 ˜
                              
                              e
                           
                           :
                           =
                           
                              ℓ
                              e
                           
                           +
                           
                              p
                              e
                           
                           −
                           
                              q
                              e
                           
                        
                      for e ∈ E. Let v
                     * be a prespecified vertex and (p, q) be the vector of modifications, the inverse ordered 1-median location problem on trees under the objective function F(p, q) can be stated as follows:

                        
                           1.
                           Modify the edge lengths such that the prespecified vertex v
                              * becomes an ordered 1-median of the perturbed tree T.

The cost function F(p, q) is minimized.

The edge length modifications are feasible, i.e. 
                                 
                                    0
                                    ≤
                                    
                                       p
                                       e
                                    
                                    ≤
                                    
                                       
                                          p
                                          ¯
                                       
                                       e
                                    
                                 
                               and 
                                 
                                    0
                                    ≤
                                    
                                       q
                                       e
                                    
                                    ≤
                                    
                                       
                                          q
                                          ¯
                                       
                                       e
                                    
                                 
                              .

Assume that increasing or decreasing one unit length of an edge e ∈ E costs 
                        
                           c
                           e
                           +
                        
                      or 
                        
                           
                              c
                              e
                              −
                           
                           ,
                        
                      respectively. We focus in this paper on the following cost functions.

If we use the Chebyshev norm, then the objective function is written as

                        
                           
                              
                                 
                                    F
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    :
                                    =
                                    
                                       max
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                    
                                       {
                                       
                                          c
                                          e
                                          +
                                       
                                       
                                          p
                                          e
                                       
                                       ,
                                       
                                          c
                                          e
                                          −
                                       
                                       
                                          q
                                          e
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     In case of the bottleneck Hamming objective function, we obtain

                        
                           
                              
                                 
                                    F
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    :
                                    =
                                    
                                       max
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                    
                                       {
                                       
                                          c
                                          e
                                          +
                                       
                                       H
                                       
                                          (
                                          
                                             p
                                             e
                                          
                                          )
                                       
                                       ,
                                       
                                          c
                                          e
                                          −
                                       
                                       H
                                       
                                          (
                                          
                                             q
                                             e
                                          
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                     where H(.) is the Hamming distance; 
                        
                           H
                           (
                           θ
                           )
                           =
                           0
                        
                      if 
                        
                           θ
                           =
                           0
                        
                      and 
                        
                           H
                           (
                           θ
                           )
                           =
                           1
                        
                      otherwise. Furthermore, the cost function under weighted sum Hamming objective is

                        
                           
                              
                                 
                                    F
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    :
                                    =
                                    
                                       ∑
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                    
                                       (
                                       
                                          c
                                          e
                                          +
                                       
                                       H
                                       
                                          (
                                          
                                             p
                                             e
                                          
                                          )
                                       
                                       +
                                       
                                          c
                                          e
                                          −
                                       
                                       H
                                       
                                          (
                                          
                                             q
                                             e
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     
                  

From now on, we concentrate on the inverse convex ordered 1-median problem on unweighted trees under Chebyshev norm or Hamming distance. Instead of the NP-hardness of the inverse convex ordered 1-median problem on unweighted trees under rectilinear norm (Gassner (2012)), we prove that the problem under Chebyshev norm and the bottleneck Hamming objective function is solvable in polynomial time. However, the problem under weighted sum Hamming distance is NP-hard.

This section considers the inverse convex ordered 1-median problem on an unweighted tree T under Chebyshev norm. For a prespecified vertex v
                     * that is not an ordered 1-median of the tree, there exists exactly one subtree, say 
                        
                           
                              T
                              ′
                           
                           ∈
                           T
                           
                              (
                              
                                 v
                                 *
                              
                              )
                           
                           ,
                        
                      such that 
                        
                           
                              Λ
                              
                                 T
                                 ′
                              
                           
                           >
                           
                              Λ
                              
                                 T
                                 ′
                              
                              ′
                           
                        
                     . We denote the optimality gap by

                        
                           
                              
                                 
                                    G
                                    
                                       T
                                       ′
                                    
                                 
                                 :
                                 =
                                 
                                    Λ
                                    
                                       T
                                       ′
                                    
                                 
                                 −
                                 
                                    Λ
                                    
                                       T
                                       ′
                                    
                                    ′
                                 
                                 .
                              
                           
                        
                     We shorten the notation by writing 
                        G
                      if it is clear which tree defines the optimality gap. Let v be the adjacent vertex of v
                     * in T′. If the length of (v
                     *, v) is reduced to 0, the structure of 
                        
                           T
                           (
                           
                              v
                              *
                           
                           )
                        
                      is destroyed, as v coincides with v
                     * and 
                        
                           T
                           (
                           
                              v
                              *
                           
                           )
                        
                      is the set of all subtrees induced by deleting all vertices with distance 0 to v
                     *. An edge length modification leading to a change of 
                        
                           T
                           (
                           
                              v
                              *
                           
                           )
                        
                      is denoted as a topology change, see Alizadeh and Burkard (2011a); Alizadeh et al. (2009). Note that the gap 
                        G
                      has to be reevaluated if a topology change has occurred. Therefore, we consider the following two situations.

We assume in this section that

                           
                              (1)
                              
                                 
                                    
                                       
                                          q
                                          ¯
                                       
                                       
                                          (
                                          
                                             v
                                             *
                                          
                                          ,
                                          v
                                          )
                                       
                                    
                                    <
                                    
                                       ℓ
                                       
                                          (
                                          
                                             v
                                             *
                                          
                                          ,
                                          v
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        Then the set 
                           
                              T
                              (
                              
                                 v
                                 *
                              
                              )
                           
                         does not change throughout the edge length modification. Thus, denote by T′* the subtree of T induced by T′ ∪ {v
                        *}. We consider the following proposition.

                           Proposition 1
                           
                              In an optimal modification, we decrease the length of edges in T′* 
                              and increase the length of edges in T\T′*
                              .
                           

From Proposition 1, we can simplify the cost function to

                           
                              
                                 
                                    
                                       
                                          max
                                          
                                             e
                                             ∈
                                             E
                                          
                                       
                                       
                                          {
                                          
                                             c
                                             e
                                          
                                          
                                             x
                                             e
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        Here, an edge e is modified by an amount xe
                         means that its length is shortened (lengthened) by xe
                         if e ∈ T′* (e ∈ T\T′*). Furthermore, 
                           
                              
                                 c
                                 e
                              
                              =
                              
                                 c
                                 e
                                 +
                              
                           
                         if e ∈ T\T′* and 
                           
                              
                                 c
                                 e
                              
                              =
                              
                                 c
                                 e
                                 −
                              
                           
                         otherwise. The upper bound of modification of an edge e is 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              =
                              
                                 
                                    p
                                    ¯
                                 
                                 e
                              
                           
                         if e ∈ T\T′* and 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              =
                              
                                 
                                    q
                                    ¯
                                 
                                 e
                              
                           
                         if e ∈ T′*. We consider the relation between the optimality of v
                        * and the edge length modification in the following proposition.

                           Proposition 2
                           
                              The optimal modification ensuring that
                              
                                 
                                    
                                       G
                                       
                                          T
                                          ′
                                       
                                    
                                    ≤
                                    0
                                 
                               
                              is also an optimal modification for the original problem.
                           

Let 
                                 
                                    x
                                    e
                                    *
                                 
                               for e ∈ E, shortly denoted by x
                              *, be the optimal modification with cost C
                              * such that 
                                 
                                    G
                                    
                                       T
                                       ′
                                    
                                 
                               ≤ 0. We distinguish two cases.

Case 1: Applying edge modification x
                              * makes vertex v
                              * an ordered 1-median of T. As every other modification x′ with cost C′ making v
                              * an ordered 1-median of T induces a gap 
                                 
                                    G
                                    
                                       T
                                       ′
                                    
                                 
                               ≤ 0 and x
                              * was the optimal modification ensuring this, it must hold that C
                              * ≤ C′. Hence x
                              * is an optimal modification of the original problem.

Case 2: Applying x
                              * makes v
                              * not an ordered 1-median of T. Thus, we know that there must exists a subtree 
                                 
                                    
                                       T
                                       
                                          ′
                                          ′
                                       
                                    
                                    ∈
                                    T
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       )
                                    
                                 
                               with 
                                 
                                    
                                       Λ
                                       
                                          T
                                          
                                             ′
                                             ′
                                          
                                       
                                    
                                    >
                                    
                                       Λ
                                       
                                          T
                                          
                                             ′
                                             ′
                                          
                                       
                                       ′
                                    
                                 
                               and T′′ ≠ T′. This means that for all feasible permutations σ it holds that 
                                 
                                    
                                       ∑
                                       
                                          
                                             v
                                             σ
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          ∈
                                          
                                             T
                                             
                                                ′
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       λ
                                       i
                                    
                                    >
                                    
                                       ∑
                                       
                                          
                                             v
                                             σ
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                             ∈
                                             T
                                             ∖
                                          
                                          
                                             T
                                             
                                                ′
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       λ
                                       i
                                    
                                 
                              . As T′ ⊂ T\T′′ and T′′ ⊂ T\T′ we conclude further that

                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            v
                                                            σ
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            ∈
                                                            T
                                                            ∖
                                                         
                                                         
                                                            T
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      ∑
                                                      
                                                         
                                                            v
                                                            σ
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         ∈
                                                         
                                                            T
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   >
                                                   
                                                      ∑
                                                      
                                                         
                                                            v
                                                            σ
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            ∈
                                                            T
                                                            ∖
                                                         
                                                         
                                                            T
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      ∑
                                                      
                                                         
                                                            v
                                                            σ
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         ∈
                                                         
                                                            T
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

But this would mean that 
                                 
                                    
                                       G
                                       
                                          T
                                          ′
                                       
                                    
                                    <
                                    0
                                 
                               for all feasible permutations, even for the permutation that breaks all ties not in favor of T′, i.e. the nodes of T′ are assigned to the largest λ-values among of all nodes with equal distance. But if all ties could be broken this way, we could also decrease the objective function by a small amount, by reducing the edge length modifications by a small amount. Note that this can only increase (decrease) the distance from v
                              * to all nodes from T′ (T\T′). The changed distances would lead to a changed set of feasible permutations, but this set would still contain a permutation that would yield a gap 
                                 
                                    
                                       G
                                       
                                          T
                                          ′
                                       
                                    
                                    ≤
                                    0
                                 
                              . This yields a contradiction to the optimality of C
                              *.□

By Proposition 2, we aim to reduce 
                           G
                         until it is nonpositive with minimum cost. Note that, the gap 
                           
                              G
                              =
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                              
                              −
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                                 ′
                              
                           
                         is decreased as much as possible if for the same cost C we increase the edge lengths in T\T′* and decrease the edge lengths in T′* by maximum amounts such that the cost is limited within C. We give the following definition.

                           Definition 2
                           A maximum modification (xe
                              (C))
                                 e ∈ E
                               
                              with cost 
                              C is given as follows.

                                 
                                    
                                       
                                          
                                             x
                                             e
                                          
                                          
                                             (
                                             C
                                             )
                                          
                                          :
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               c
                                                               e
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         
                                                            c
                                                            e
                                                         
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            e
                                                         
                                                         >
                                                         C
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            e
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         
                                                            c
                                                            e
                                                         
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            e
                                                         
                                                         ≤
                                                         C
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Observe that one can decrease the optimality gap 
                           G
                         as much as possible with respect to a given cost by applying a maximum modification. The next proposition is a immediate consequence of this observation.

                           Proposition 3
                           
                              There exists an optimal modification such that
                              
                                 
                                    G
                                    ≤
                                    0
                                 
                               
                              which is a maximum modification.
                           

We assume without loss of generality that the problem is feasible and that the set 
                           
                              S
                              =
                              
                                 
                                    {
                                    
                                       c
                                       e
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       e
                                    
                                    }
                                 
                                 
                                    e
                                    ∈
                                    E
                                    ,
                                    
                                       
                                          x
                                          ¯
                                       
                                       e
                                    
                                    >
                                    0
                                 
                              
                           
                         contains distinct elements, i.e. 
                           
                              
                                 c
                                 e
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              ≠
                              
                                 c
                                 
                                    e
                                    ′
                                 
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    e
                                    ′
                                 
                              
                           
                         for e ≠ e′, e, e′ ∈ E. Denote by 
                           
                              m
                              :
                              =
                              n
                              −
                              1
                           
                         the number of all edges in T. After sorting the elements of 
                           S
                         in nondecreasing order, we get 
                           
                              S
                              =
                              
                                 
                                    {
                                    
                                       c
                                       i
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                 
                              
                           
                         with

                           
                              
                                 
                                    
                                       c
                                       1
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       1
                                    
                                    <
                                    
                                       c
                                       2
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       2
                                    
                                    <
                                    …
                                    <
                                    
                                       c
                                       m
                                    
                                    
                                       
                                          x
                                          ¯
                                       
                                       m
                                    
                                    .
                                 
                              
                           
                        Now we aim to find the smallest index 
                           
                              
                                 i
                                 0
                              
                              ∈
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 }
                              
                           
                         such that the gap 
                           G
                         becomes nonpositive by applying the maximum modification with cost 
                           
                              
                                 c
                                 
                                    i
                                    0
                                 
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    0
                                 
                              
                           
                        . We can find such an index by applying a binary search algorithm. If the application of the maximum modification with cost 
                           
                              
                                 c
                                 k
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 k
                              
                           
                         results in a gap 
                           
                              G
                              >
                              0
                              ,
                           
                         we know that i
                        0 > k. In the case where 
                           
                              G
                              ≤
                              0
                              ,
                           
                         we know that i
                        0 ≤ k.

Let us analyze the complexity of the procedure to find the index i
                        0. For a given cost C, we can update the length of each edges of the tree and calculate the new distances to the root node v
                        * by a breath-first-search algorithm in linear time. Then we sort the distances with priority of T′ in order to update 
                           G
                         in O(nlog n) time. As the binary search stops after O(log n) steps and each iteration costs O(nlog n) time, the procedure runs in O(nlog2
                        n) time.

After finding the index i
                        0, we apply the maximum modification 
                           
                              
                                 (
                                 
                                    x
                                    e
                                 
                                 
                                    (
                                    
                                       C
                                       ˜
                                    
                                    )
                                 
                                 )
                              
                              
                                 e
                                 ∈
                                 E
                              
                           
                         with cost 
                           
                              
                                 C
                                 ˜
                              
                              :
                              =
                              
                                 c
                                 
                                    
                                       i
                                       0
                                    
                                    −
                                    1
                                 
                              
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    
                                       i
                                       0
                                    
                                    −
                                    1
                                 
                              
                           
                         and update the upper bounds as below. Note that if 
                           
                              
                                 i
                                 0
                              
                              =
                              1
                              ,
                           
                         we apply no modification.

                           
                              •
                              Update the length of an edge e ∈ T′* (e ∈ T\T′*) to

                                    
                                       
                                          
                                             
                                                
                                                   ℓ
                                                   e
                                                
                                                ˜
                                             
                                             :
                                             =
                                             
                                                ℓ
                                                e
                                             
                                             −
                                             
                                                x
                                                e
                                             
                                             
                                                (
                                                
                                                   C
                                                   ˜
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      ℓ
                                                      e
                                                   
                                                   ˜
                                                
                                                :
                                                =
                                                
                                                   ℓ
                                                   e
                                                
                                                +
                                                
                                                   x
                                                   e
                                                
                                                
                                                   (
                                                   
                                                      C
                                                      ˜
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Update the modification bound of an edge e to

                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   ˜
                                                
                                                e
                                             
                                             :
                                             =
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                e
                                             
                                             −
                                             
                                                x
                                                e
                                             
                                             
                                                (
                                                
                                                   C
                                                   ˜
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Denote the distance that is computed with respect to edge lengths 
                           
                              ℓ
                              ˜
                           
                         by 
                           
                              d
                              ˜
                           
                        .

Next, our goal is to find a maximum modification with smallest cost in 
                           
                              [
                              0
                              ,
                              
                                 c
                                 
                                    i
                                    0
                                 
                              
                              
                                 
                                    x
                                    ˜
                                 
                                 
                                    i
                                    0
                                 
                              
                              ]
                           
                         in order to get a nonpositive gap. We use a parameter 
                           
                              t
                              ∈
                              [
                              0
                              ,
                              
                                 
                                    x
                                    ˜
                                 
                                 
                                    i
                                    0
                                 
                              
                              ]
                           
                         to present the modified distances in T. In other words, applying the maximum modification with cost 
                           
                              
                                 c
                                 
                                    i
                                    0
                                 
                              
                              t
                           
                         yields the modified distance

                           
                              
                                 
                                    
                                       
                                          d
                                          t
                                       
                                       
                                          (
                                          v
                                          ,
                                          
                                             v
                                             *
                                          
                                          )
                                       
                                       :
                                       =
                                       
                                          d
                                          ˜
                                       
                                       
                                          (
                                          v
                                          ,
                                          
                                             v
                                             *
                                          
                                          )
                                       
                                       +
                                       s
                                       i
                                       g
                                       n
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                          ∑
                                          
                                             e
                                             ∈
                                             P
                                             
                                                (
                                                v
                                                ,
                                                
                                                   v
                                                   *
                                                
                                                )
                                             
                                             :
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                e
                                             
                                             >
                                             0
                                          
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   i
                                                   0
                                                
                                             
                                             t
                                          
                                          
                                             c
                                             e
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                        where 
                           
                              s
                              i
                              g
                              n
                              (
                              v
                              )
                              =
                              −
                              1
                           
                         if v ∈ T′* and 
                           
                              s
                              i
                              g
                              n
                              (
                              v
                              )
                              =
                              1
                           
                         otherwise. Computing dt
                        (v, v
                        *) for a fixed t and for all v ∈ V can be done in linear time by a breath-first-search algorithm.

As can be seen by the following observation, the number of values of t that have to be considered is bounded by n
                        2. The optimality gap 
                           G
                         can only be reduced for a value t if for a pair of vertices v ∈ T\T′* and v′ ∈ T′* with 
                           
                              
                                 d
                                 ˜
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 v
                                 )
                              
                              <
                              
                                 d
                                 ˜
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 
                                    v
                                    ′
                                 
                                 )
                              
                           
                         holds that dt
                        (v
                        *, v) ≥ dt
                        (v
                        *, v′).

For each pair v ∈ T\T′* and v′ ∈ T′* with 
                           
                              
                                 d
                                 ˜
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 v
                                 )
                              
                              <
                              
                                 d
                                 ˜
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 
                                    v
                                    ′
                                 
                                 )
                              
                           
                         we calculate an amount, say 
                           
                              
                                 t
                                 
                                    v
                                    
                                       v
                                       ′
                                    
                                 
                              
                              ,
                           
                        
                        
                           
                              
                                 t
                                 
                                    v
                                    
                                       v
                                       ′
                                    
                                 
                              
                              ≤
                              
                                 
                                    x
                                    ˜
                                 
                                 
                                    i
                                    0
                                 
                              
                              ,
                           
                         such that 
                           
                              
                                 d
                                 
                                    t
                                    
                                       v
                                       
                                          v
                                          ′
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 d
                                 
                                    t
                                    
                                       v
                                       
                                          v
                                          ′
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 
                                    v
                                    ′
                                 
                                 )
                              
                           
                        . As there are at most O(n
                        2) pairs (v, v′) for v ∈ T\T′* and v′ ∈ T′* we obtain at most O(n
                        2) distinct values 
                           
                              t
                              
                                 v
                                 
                                    v
                                    ′
                                 
                              
                           
                        . Note that dt
                        (v
                        *, v) is an affine function. We can compute the n different affine functions dt
                        (v
                        *, v) for v ≠ v
                        * in O(n
                        2) time. To compute 
                           
                              t
                              
                                 v
                                 
                                    v
                                    ′
                                 
                              
                           
                         we have just to compute the intersection of two affine functions which can be done in constant time. We sort these values in O(n
                        2log n) time in order to get the set 
                           
                              {
                              
                                 t
                                 1
                              
                              ,
                              
                                 t
                                 2
                              
                              ,
                              …
                              ,
                              
                                 t
                                 τ
                              
                              }
                           
                         with 
                           
                              
                                 t
                                 1
                              
                              <
                              
                                 t
                                 2
                              
                              <
                              …
                              <
                              
                                 t
                                 τ
                              
                           
                         and τ ≤ n
                        2.

In the next step we use binary search to find the smallest index 
                           
                              
                                 j
                                 0
                              
                              ∈
                              
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 τ
                                 }
                              
                           
                         such that the gap 
                           G
                         becomes nonpositive by applying the maximum modification with cost 
                           
                              
                                 c
                                 
                                    i
                                    0
                                 
                              
                              
                                 t
                                 
                                    j
                                    0
                                 
                              
                           
                        . The binary search stops after O(log n) iterations. In each iteration we have to calculate the distance 
                           
                              
                                 d
                                 
                                    t
                                    j
                                 
                              
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 ,
                                 v
                                 )
                              
                           
                         for all nodes v ∈ T. This can be done in O(n) time by a breath-first-search algorithm. Next we have to sort the modified distances with priority to T′ to update 
                           
                              G
                              ,
                           
                         this can be done in O(nlog n) time. Hence, the index j
                        0 can be found in O(nlog2
                        n) time. The complete algorithm is stated as Algorithm 1
                        .

In conclusion, we get the following result.

                           Theorem 2
                           
                              The inverse convex ordered 1-median problem on unweighted trees under Chebyshev norm requiring no topology change can be solved in O(n
                              2log n) time.
                           

In this section condition (1) is relaxed, i.e. we can reduce the length of an edge e
                        * incident to v
                        * to 0. This yields a change of the structure of 
                           
                              T
                              (
                              
                                 v
                                 *
                              
                              )
                           
                         , i.e. a topology change.

We use the following idea for the algorithm. First identify the tree T′ with positive gap 
                           G
                        . Let e
                        * be the edge that connects T′ and v
                        *. Check if e
                        * can be contracted to a 0 length edge. If this is not the case, one can just solve the problem as in Section 3.1. Otherwise check if the edge must be contracted in an optimal solution. If there exists an optimal solution that does not contract the edge, one can again solve the problem as in Section 3.1. In the other case, where an optimal solution contracts edge e
                        * we set 
                           
                              
                                 ℓ
                                 
                                    e
                                    *
                                 
                              
                              :
                              =
                              0
                           
                         as well as 
                           
                              
                                 
                                    p
                                    ¯
                                 
                                 
                                    e
                                    *
                                 
                              
                              =
                              
                                 
                                    q
                                    ¯
                                 
                                 
                                    e
                                    *
                                 
                              
                              :
                              =
                              0
                              ,
                           
                         i.e. we fix edge e
                        * to be a 0-length edge, and store the cost that were necessary to contract edge e
                        *. We continue by restarting the algorithm with the modified instance. Note that the algorithm will terminate after at most m edge contractions.

We still need to discuss how one can check efficiently (in O(nlog n) time), whether an edge e must be contracted in an optimal solution. First apply the maximum modification with cost ce
                        ℓ
                           e
                        . Next compute all distances d(v
                        *, v). Remember the idea that was used in Section 3.1 to discretize the cost interval to a finite set of points. We consider the cost interval [0, ce
                        ℓ
                           e
                        ). Denote by {t
                        1, ..., tτ
                        } the set of points where the vertex ordering changes if a maximum modification with cost ceti
                         is applied. Hence, we can choose a small enough 
                           
                              ϵ
                              >
                              0
                           
                         such that 
                           
                              
                                 c
                                 e
                              
                              
                                 t
                                 τ
                              
                              <
                              
                                 c
                                 e
                              
                              
                                 (
                                 
                                    ℓ
                                    e
                                 
                                 −
                                 ϵ
                                 )
                              
                              <
                              
                                 c
                                 e
                              
                              
                                 ℓ
                                 e
                              
                           
                        . Next we apply a maximum modification with cost 
                           
                              
                                 c
                                 e
                              
                              
                                 (
                                 
                                    ℓ
                                    e
                                 
                                 −
                                 ϵ
                                 )
                              
                           
                         and compute the value of 
                           G
                        .

If 
                           
                              G
                              ≤
                              0
                           
                         the value of the optimal solution must be smaller then ce
                        ℓ
                           e
                        , hence no topology change will occur in an optimal solution. On the other hand if 
                           
                              G
                              >
                              0
                              ,
                           
                         we know that the cost of the optimal solution must be at least ce
                        ℓ
                           e
                        , as the value of the gap 
                           G
                         is the same for all maximum modifications with cost from the interval 
                           
                              [
                              
                                 c
                                 e
                              
                              
                                 (
                                 
                                    ℓ
                                    e
                                 
                                 −
                                 ϵ
                                 )
                              
                              ,
                              
                                 c
                                 e
                              
                              
                                 ℓ
                                 e
                              
                              )
                           
                        .

An appropriate value for 
                           ϵ
                         can be computed by the following procedure. Assume that the maximum modification with cost ce
                        ℓ
                           e
                         is applied and the distances d(v
                        *, v) are computed. Sort all vertices with respect to their distances. Compute

                           
                              
                                 
                                    δ
                                    :
                                    =
                                    
                                       min
                                       
                                          
                                             (
                                             
                                                v
                                                ′
                                             
                                             ,
                                             v
                                             )
                                          
                                          ∈
                                          
                                             (
                                             
                                                T
                                                ′
                                             
                                             ,
                                             T
                                             ∖
                                             
                                                T
                                                ′
                                             
                                             )
                                          
                                          :
                                          d
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             
                                                v
                                                ′
                                             
                                             )
                                          
                                          ≠
                                          d
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             v
                                             )
                                          
                                       
                                    
                                    
                                       |
                                       d
                                       
                                          (
                                          
                                             v
                                             *
                                          
                                          ,
                                          
                                             v
                                             ′
                                          
                                          )
                                       
                                       −
                                       d
                                       
                                          (
                                          
                                             v
                                             *
                                          
                                          ,
                                          v
                                          )
                                       
                                       |
                                    
                                 
                              
                           
                        the smallest difference between the distances of two vertices from T′ and T\T′ that have not the same distance. To simplify the presentation of the algorithm we do not cover the special case, where all vertices have the same distance to v
                        *. If we are in this case and the gap 
                           
                              G
                              >
                              0
                           
                         it is obvious that the edge connecting v
                        * and T′ must be contracted. Hence, we can just skip Algorithm 2
                         and directly contract this edge. Note that all edges e′ with 
                           
                              
                                 c
                                 
                                    e
                                    ′
                                 
                              
                              =
                              0
                           
                         have under every maximum modification the same length. Hence, we only need to consider edges with 
                           
                              
                                 c
                                 
                                    e
                                    ′
                                 
                              
                              >
                              0
                           
                        . Define by 
                           
                              
                                 C
                                 ′
                              
                              :
                              =
                              
                                 min
                                 
                                    {
                                    
                                       e
                                       ′
                                    
                                    ∈
                                    E
                                    :
                                    
                                       c
                                       
                                          e
                                          ′
                                       
                                    
                                    >
                                    0
                                    }
                                 
                              
                              
                                 c
                                 
                                    e
                                    ′
                                 
                              
                           
                        . Note that the change of the edge length, if one switches from the maximum modification with cost ce
                        ℓ
                           e
                         to the maximum modification with cost 
                           
                              
                                 c
                                 e
                              
                              
                                 (
                                 
                                    ℓ
                                    e
                                 
                                 −
                                 ϵ
                                 )
                              
                              ,
                           
                         is bounded by 
                           
                              
                                 
                                    c
                                    e
                                 
                                 ϵ
                              
                              
                                 C
                                 ′
                              
                           
                        . Therefore, as at most m edges lie between a vertex v and v
                        *, the distance from v to v
                        * changes by at most 
                           
                              
                                 m
                                 
                                    c
                                    e
                                 
                                 ϵ
                              
                              
                                 C
                                 ′
                              
                           
                         by using the cheaper modification. By setting 
                           
                              ϵ
                              :
                              =
                              
                                 
                                    δ
                                    
                                       C
                                       ′
                                    
                                 
                                 
                                    4
                                    m
                                    
                                       c
                                       e
                                    
                                 
                              
                              ,
                           
                         we can guarantee the demanded property of 
                           ϵ
                        . Note that all necessary computations can be done in O(nlog n) time.

To give a clearer presentation of the algorithm we extract the method CONTRACT-TEST
                           Che
                         that tests for a given edge e if this edge has to be contracted in an optimal solution and describe this method explicitly.

At the end of the section we analyze the time complexity of Algorithm 3
                        . All iterations of the while loop except of the last one have to execute algorithm CONTRACT-TEST
                           Che
                         which can be done in O(nlog n) time. Identifying the new tree that maximizes the gap 
                           G
                         after the topology change has occurred needs O(deg(v′)log n) time, where v′ is the vertex of T′ that is connected to v
                        *, as only subtrees of T′ are candidates for the new tree. Hence, the amortized cost of this step is also in O(nlog n). The last iteration of the while loop can be done in O(n
                        2log n) time as shown in Section 3.1. Hence, as there are at most n iterations of the while loop the complete Algorithm can be executed in O(n
                        2log n) time. This proves the main theorem of this section.

                           Theorem 3
                           
                              The inverse convex ordered 1-median problem on an unweighted tree under Chebyshev norm can be solved in O(n
                              2log n) time.
                           

We will illustrate the algorithm in the following example. Given an unweighted tree T as in Fig. 1
                        . The modification costs are uniform, i.e. 
                           
                              
                                 c
                                 e
                                 +
                              
                              =
                              
                                 c
                                 e
                                 −
                              
                              =
                              1
                           
                         for all e ∈ T. The vector of multipliers is 
                           
                              λ
                              =
                              (
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                              ,
                              5
                              ,
                              7
                              )
                           
                        . Assume that the prespecified vertex is v
                        1.

We note that the subtree T′ induced by {v
                        2, v
                        3, v
                        4, v
                        5, v
                        6} violates the optimality criterion as 
                           
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                              
                              >
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                                 ′
                              
                           
                        . At first, we have to check if (v
                        1, v
                        2) has to be contracted in the optimal solution or not. By using the formula presented in Algorithm 2 with 
                           
                              δ
                              =
                              1
                              ,
                           
                        
                        
                           
                              
                                 C
                                 ′
                              
                              =
                              1
                              ,
                           
                         and 
                           
                              m
                              =
                              6
                           
                         we get that 
                           
                              ϵ
                              :
                              =
                              
                                 1
                                 24
                              
                           
                        . Applying the maximum modification with cost 
                           
                              
                                 c
                                 
                                    e
                                    *
                                 
                              
                              
                                 (
                                 
                                    ℓ
                                    
                                       e
                                       *
                                    
                                 
                                 −
                                 ϵ
                                 )
                              
                              :
                              =
                              
                                 23
                                 24
                              
                              ,
                           
                         where e
                        * ≔ (v
                        1, v
                        2), yields a gap 
                           
                              G
                              :
                              =
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                              
                              −
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                                 ′
                              
                              =
                              18
                              −
                              −
                              4
                              >
                              0
                           
                        . Therefore, we have to contract edge e
                        * and get the tree as shown in Fig. 2
                        .

Note that the tree T′′ induced by {v
                        3, v
                        4, v
                        5} maximizes the gap 
                           
                              G
                              
                                 T
                                 
                                    ′
                                    ′
                                 
                              
                           
                         after the topology change has occurred. We update e
                        * ≔ (v
                        1, 2, v
                        3) and check if edge e
                        * has to be contracted or not. We obtain again 
                           
                              ϵ
                              :
                              =
                              
                                 1
                                 24
                              
                           
                        . The gap is 
                           
                              G
                              :
                              =
                              11
                              −
                              11
                              ≤
                              0
                           
                         if we apply the maximum modification with cost 
                           
                              
                                 c
                                 
                                    e
                                    *
                                 
                              
                              
                                 (
                                 
                                    ℓ
                                    
                                       e
                                       *
                                    
                                 
                                 −
                                 ϵ
                                 )
                              
                              :
                              =
                              
                                 47
                                 24
                              
                           
                        . We use the Algorithm 1 to get the optimal perturbed tree shown in Fig. 3
                        . The optimal cost of this instance is 
                           
                              5
                              3
                           
                        .

In this section we consider the inverse ordered 1-median problem under bottleneck Hamming cost function, i.e.

                        
                           
                              
                                 
                                    F
                                    
                                       (
                                       p
                                       ,
                                       q
                                       )
                                    
                                    =
                                    
                                       max
                                       
                                          e
                                          ∈
                                          E
                                       
                                    
                                    
                                       {
                                       
                                          c
                                          e
                                          +
                                       
                                       H
                                       
                                          (
                                          
                                             p
                                             e
                                          
                                          )
                                       
                                       ,
                                       
                                          c
                                          e
                                          −
                                       
                                       H
                                       
                                          (
                                          
                                             q
                                             e
                                          
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                        
                     where the Hamming distance H is defined as

                        
                           
                              
                                 H
                                 
                                    (
                                    θ
                                    )
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                if
                                                
                                                θ
                                                =
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We solve the inverse convex ordered 1-median problem under bottleneck Hamming distance according to the following two cases.

In this section condition (1) holds, i.e. there exists no topology change during the edge length modification. Assume that the prespecified vertex v
                        * is not an ordered 1-median of the tree, then there exists exactly one subtree 
                           
                              
                                 T
                                 ′
                              
                              ∈
                              T
                              
                                 (
                                 
                                    v
                                    *
                                 
                                 )
                              
                           
                         that violates the optimality criterion, i.e. 
                           
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                              
                              >
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                                 ′
                              
                           
                        . We define the optimality gap 
                           
                              G
                              =
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                              
                              −
                              
                                 Λ
                                 
                                    T
                                    ′
                                 
                                 ′
                              
                              >
                              0
                           
                         as in the last section and aim to reduce the gap until the optimality criterion holds.

We can easily observe that Proposition 1 is still true for the case of the bottleneck Hamming distance. Thus, the objective function can be simplified as

                           
                              (2)
                              
                                 
                                    
                                       F
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                       
                                       :
                                       =
                                       
                                          max
                                          
                                             e
                                             ∈
                                             E
                                          
                                       
                                       
                                          {
                                          
                                             c
                                             e
                                          
                                          H
                                          
                                             (
                                             
                                                x
                                                e
                                             
                                             )
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           
                        where 
                           
                              
                                 c
                                 e
                              
                              :
                              =
                              
                                 c
                                 e
                                 +
                              
                           
                         if e ∈ T\T′* and 
                           
                              
                                 c
                                 e
                              
                              :
                              =
                              
                                 c
                                 e
                                 −
                              
                           
                         if e ∈ T′*. Furthermore, 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              =
                              
                                 
                                    p
                                    ¯
                                 
                                 e
                              
                           
                         if e ∈ T\T′* and 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              =
                              
                                 
                                    q
                                    ¯
                                 
                                 e
                              
                           
                         otherwise. Recall that an edge e ∈ T\T′* (e ∈ T′*) is modified by an amount xe
                         if its length is increased (decreased) by the amount xe
                        .

Note that the cost function (2) can only attain at most m different values ci
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        .

We first sort the modification costs increasingly to get the sequence

                           
                              
                                 
                                    
                                       c
                                       1
                                    
                                    ≤
                                    
                                       c
                                       2
                                    
                                    ≤
                                    …
                                    ≤
                                    
                                       c
                                       m
                                    
                                 
                              
                           
                        Consider the following definition.

                           Definition 3
                           The active edge 
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               is the edge with the smallest index i
                              0 such that modifying all edges ei
                               with i ≤ i
                              0 suffices to obtain 
                                 
                                    G
                                    ≤
                                    0
                                 
                              .

We consider the relation between the active edge and the optimal solution in the following proposition.

                           Proposition 4
                           
                              The cost
                              
                                 
                                    c
                                    
                                       i
                                       0
                                    
                                 
                               
                              corresponding to the active edge
                              
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               
                              is the optimal cost.
                           

We construct a solution of the the inverse convex ordered median problem as follows. We modify all edges ej
                               ∈ E by 
                                 
                                    
                                       x
                                       ¯
                                    
                                    j
                                 
                               if j < i
                              0. By the definition of the active edge, the gap 
                                 G
                               must still be positive after this modification. We now modify 
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               step by step. Note again that there are at most O(n
                              2) many interesting modification values t for edge 
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               that lead to a change of 
                                 G
                              . Namely, all modifications such that a pair of vertices v′ ∈ T′ and v ∈ T\T′ with d(v
                              *, v′) ≠ d(v
                              *, v) and 
                                 
                                    
                                       d
                                       t
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          ′
                                       
                                       )
                                    
                                    =
                                    
                                       d
                                       t
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       v
                                       )
                                    
                                    ,
                                 
                               where d is the distance obtained by modifying the edges ej
                               with j < i
                              0 and dt
                               is the distance where additionally the length of edge 
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               is modified by t. Let 
                                 
                                    t
                                    ˜
                                 
                               be the smallest modification such that 
                                 
                                    G
                                    ≤
                                    0
                                 
                              . Assume that v
                              * is not the ordered 1-median of the tree if we have modified edge 
                                 
                                    e
                                    
                                       i
                                       0
                                    
                                 
                               by 
                                 
                                    t
                                    ˜
                                 
                              . Hence, there must exist another subtree 
                                 
                                    
                                       T
                                       
                                          ′
                                          ′
                                       
                                    
                                    ∈
                                    T
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       )
                                    
                                 
                               with 
                                 
                                    
                                       Λ
                                       
                                          T
                                          
                                             ′
                                             ′
                                          
                                       
                                    
                                    >
                                    
                                       Λ
                                       
                                          T
                                          
                                             ′
                                             ′
                                          
                                       
                                       ′
                                    
                                 
                              . We can use again the tie breaking argument, that was used in the proof of Proposition 2 to create a contradiction.

By the definition of the active edge, every modification with cost smaller than 
                                 
                                    c
                                    
                                       i
                                       0
                                    
                                 
                               can not lead to a gap 
                                 
                                    G
                                    ≤
                                    0
                                 
                               and, hence, make v
                              * to be an ordered 1-median of T. This shows the proposition.□

By Proposition 4, we can find the optimal objective value through finding the active edge.

Without loss of generality we assume that all modification costs are pairwise different and that the problem is feasible, i.e. the gap 
                           
                              G
                              ≤
                              0
                           
                         with respect to the modification 
                           
                              
                                 x
                                 e
                              
                              :
                              =
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                           
                         for all e ∈ E. Note that the active edge can be found by using a binary search algorithm. If modifying all edges ej
                         with j ≤ k by 
                           
                              
                                 x
                                 ¯
                              
                              j
                           
                         results in a gap 
                           
                              G
                              >
                              0
                              ,
                           
                         we know that k < i
                        0. In the case where 
                           
                              G
                              ≤
                              0
                           
                         we know that i
                        0 ≤ k. In every iteration of the branch and bound algorithm we have to apply one edge modification and recompute all modified distances. This can be done in linear time by a breath first search algorithm. Computing the gap 
                           G
                         can be done in O(nlog n) time. As the binary search algorithm stops after O(log n) many iterations and each iteration costs O(nlog n) time, finding the active edge can be done in O(nlog2
                        n) time.

After one has found the active edge one has already computed the optimal objective function. To obtain also an optimal edge modification one has only to consider the modification of edge 
                           
                              
                                 e
                                 
                                    i
                                    0
                                 
                              
                              ,
                           
                         as all edges ej
                         with j < i
                        0 can be modified by 
                           
                              
                                 x
                                 ¯
                              
                              j
                           
                        . The idea used at the end of Section 3.1 can be reused to solve the problem of finding the optimal modification of edge 
                           
                              e
                              
                                 i
                                 0
                              
                           
                        . Compute the set of O(n
                        2) many interesting modifications {t
                        1 
                        
                           
                              ,
                              …
                              ,
                           
                         
                        tτ
                        } that lead to a change of 
                           G
                        . The smallest of these modifications that lead to a gap 
                           
                              G
                              ≤
                              0
                           
                         ensures that v
                        * becomes an ordered 1-median of the tree (see the proof of Proposition 4). Finding this modification can be done in O(n
                        2log n) time using basically the same technique as at the end of Section 3.1. In conclusion, we get:

                           Theorem 4
                           
                              The inverse convex ordered 1-median problem on unweighted trees under bottleneck Hamming objective function with no topology change can be solved in O(n
                              2log n) time.
                           

In this section condition (1) is relaxed, i.e. we can reduce the length of an edge e
                        * incident to v
                        * to 0. This yields to a change of the structure of 
                           
                              T
                              (
                              
                                 v
                                 *
                              
                              )
                           
                         , i.e. a topology change.

We use basically the same algorithm as described in Section 3.2. First we test if the edge e
                        * that connects T′ which is the subtree that maximizes the gap 
                           G
                         with v
                        * has to be contracted in an optimal solution with algorithm CONTRACT-TEST
                           Ham
                         (Algorithm 4
                        ). We use the same concept as in CONTRACT-TEST
                           Che
                        . Compute a small 
                           
                              ϵ
                              >
                              0
                           
                         such that the gap value 
                           G
                         must be the same for all modifications in 
                           
                              [
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              −
                              ϵ
                              ,
                              
                                 
                                    x
                                    ¯
                                 
                                 e
                              
                              )
                           
                        . Note that we can simplify the formula for 
                           ϵ
                         as we modify only a single and not multiple edges simultaneously. Next we compute the gap value 
                           G
                         for the modifications given in the algorithm. If the gap value 
                           
                              G
                              ≤
                              0
                           
                         only two cases can happen. If 
                           
                              G
                              ≤
                              0
                           
                         even for the case where we use no modification for edge e
                        *, we know that edge e
                        * must not be modified in an optimal solution. On the other hand if 
                           
                              G
                              >
                              0
                           
                         for these modifications, we know that there exists a modification of edge e
                        * that does not contract e
                        * completely but ensures that v
                        * becomes an ordered 1-median of T. In both cases no topology change occurs. In the other case where 
                           
                              G
                              >
                              0
                              ,
                           
                         edge e
                        * must be contracted in an optimal solution as all other modifications of this edge that do not contract the edge yield also strict positive gap values. Hence, a topology change occurs for this case. If CONTRACT-TEST
                           Ham
                         is positive, we contract edge e
                        * and restart the process. Otherwise, we can solve the problem as described in Section 4.1. The correctness proof of Algorithm 5
                         is similar to the proof of Algorithm 3.

The time complexity of Algorithm 5 can be analyzed basically in the same way as for Algorithm 3. Hence, we get that the running time of Algorithm 5 lies in O(n
                        2log n).

                           Theorem 5
                           
                              The inverse convex ordered 1-median problem on trees under bottleneck Hamming objective function can be solved in O(n
                              2log n) time.
                           

In the rest of the paper, we focus on the inverse ordered 1-median problem on unweighted trees under weighted sum Hamming objective function. Note that the inverse 1-center problem is a special case of the inverse ordered 1-median problem. One can obtain the inverse 1-center problem from the inverse ordered 1-median problem by setting 
                           
                              
                                 λ
                                 i
                              
                              =
                              0
                           
                         for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                              −
                              1
                           
                         and 
                           
                              
                                 λ
                                 n
                              
                              =
                              1
                           
                        . We can show the following negative result even for the special case of inverse 1-center problems.

                           Theorem 6
                           
                              The inverse 1-center problem on unweighted path graphs under weighted sum Hamming objective function is NP-hard.
                           

We consider an instance (I) of the partition problem. Given a set 
                                 
                                    S
                                    =
                                    {
                                    
                                       a
                                       1
                                    
                                    ,
                                    
                                       a
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       a
                                       k
                                    
                                    }
                                    ⊂
                                    N
                                 
                               such that 
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       a
                                       i
                                    
                                    =
                                    2
                                    B
                                    ,
                                 
                              
                              
                                 
                                    B
                                    ∈
                                    N
                                 
                              . Does there exist a subset S′ ⊂ S such that 
                                 
                                    
                                       ∑
                                       
                                          
                                             a
                                             i
                                          
                                          ∈
                                          
                                             S
                                             ′
                                          
                                       
                                    
                                    
                                       a
                                       i
                                    
                                    =
                                    B
                                 
                              ? The partition problem is known to be NP-hard, see Garey and Johnson (1979).

For a given instance (I), we construct an instance (Inv) of the inverse 1-center problem. The path graph 
                                 
                                    P
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               consists of the vertex set 
                                 
                                    V
                                    =
                                    {
                                    
                                       v
                                       *
                                    
                                    ,
                                    
                                       v
                                       0
                                    
                                    ,
                                    
                                       v
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       v
                                       k
                                    
                                    }
                                 
                               and the edge set 
                                 
                                    E
                                    =
                                    {
                                    
                                       e
                                       0
                                    
                                    ,
                                    
                                       e
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       e
                                       k
                                    
                                    }
                                 
                               where 
                                 
                                    
                                       e
                                       0
                                    
                                    =
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          0
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       e
                                       1
                                    
                                    =
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          1
                                       
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       e
                                       i
                                    
                                    =
                                    
                                       (
                                       
                                          v
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          v
                                          i
                                       
                                       )
                                    
                                 
                               for 
                                 
                                    i
                                    =
                                    2
                                    ,
                                    …
                                    ,
                                    k
                                 
                               as in Fig. 4
                              .

The length of each edge ei
                               is set to 1 for 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    k
                                 
                               and the length of edge e
                              0 is set to 
                                 
                                    B
                                    +
                                    k
                                 
                              . The length of edge e
                              0 is fixed and the length of edge ei
                               can be increased by pi
                               with 0 ≤ pi
                               ≤ ai
                               with the cost coefficient ai
                               for each 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    k
                                 
                              . (Inv) is a ’yes’-instance if there exists a feasible edge length modification that has costs at most B under weighted sum Hamming distance. To make v
                              * the 1-center of the path graph P one has to modify the edge lengths such that 
                                 
                                    
                                       d
                                       ˜
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          0
                                       
                                       )
                                    
                                    =
                                    
                                       d
                                       ˜
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          k
                                       
                                       )
                                    
                                 
                              .

Assume that (I) is a ’yes’-instance. Hence, there exists a subset S′ ⊂ S such that 
                                 
                                    
                                       ∑
                                       
                                          
                                             a
                                             i
                                          
                                          ∈
                                          
                                             S
                                             ′
                                          
                                       
                                    
                                    
                                       a
                                       i
                                    
                                    =
                                    B
                                 
                              . Consider the following modification. For all i ∈ S′ increase the edge lengths of edge ei
                               by ai
                              . The costs of this modification under weighted sum Hamming distance are exactly 
                                 
                                    
                                       ∑
                                       
                                          
                                             a
                                             i
                                          
                                          ∈
                                          
                                             S
                                             ′
                                          
                                       
                                    
                                    
                                       a
                                       i
                                    
                                    =
                                    B
                                 
                              . We get further that the modified distance from v
                              * to vk
                               is

                                 
                                    
                                       
                                          
                                             d
                                             ˜
                                          
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             
                                                v
                                                k
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   a
                                                   i
                                                
                                                ∈
                                                
                                                   S
                                                   ′
                                                
                                             
                                          
                                          
                                             a
                                             i
                                          
                                          +
                                          k
                                          =
                                          B
                                          +
                                          k
                                          =
                                          
                                             d
                                             ˜
                                          
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             
                                                v
                                                0
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              Hence, (Inv) is ‘yes’-instance.

Conversely, assume that (Inv) is a ’yes-instance, i.e. there exists a solution of (Inv) with cost at most B. Denote by I the set of indices of edges ei
                               that are lengthened in this solution. The bound of the cost function gives that ∑
                                 i ∈ I
                              
                              ai
                               ≤ B. Assume that ∑
                                 i ∈ I
                              
                              ai
                               < B, in this case we get that

                                 
                                    
                                       
                                          
                                             d
                                             ˜
                                          
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             
                                                v
                                                k
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   a
                                                   i
                                                
                                                ∈
                                                I
                                             
                                          
                                          
                                             a
                                             i
                                          
                                          +
                                          k
                                          <
                                          B
                                          +
                                          k
                                          =
                                          
                                             d
                                             ˜
                                          
                                          
                                             (
                                             
                                                v
                                                *
                                             
                                             ,
                                             
                                                v
                                                0
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              This leads to a contradiction as 
                                 
                                    
                                       d
                                       ˜
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          k
                                       
                                       )
                                    
                                    =
                                    
                                       d
                                       ˜
                                    
                                    
                                       (
                                       
                                          v
                                          *
                                       
                                       ,
                                       
                                          v
                                          0
                                       
                                       )
                                    
                                 
                               must hold in every feasible solution of (Inv). Therefore, we can conclude that 
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       a
                                       i
                                    
                                    =
                                    B
                                    ,
                                 
                               which shows that (I) is a ‘yes’-instance. This finishes the proof.□

@&#CONCLUSION@&#

Although the inverse convex ordered 1-median problem on unweighted trees is NP-hard (Gassner (2012)), the problem under Chebyshev norm and bottleneck Hamming distance could be solved efficiently in O(n
                     2log n) time, where n is the number of vertices in the tree. Moreover, the inverse 1-center problem on unweighted paths under weighted sum Hamming distance has been proved to be NP-hard.

As future research topic one can study the problem on general weighted trees. Also, heuristic or approximation approaches for the NP-hard problems are worthwhile. One may deal with the NP-hard problems by practical methods, e.g. integer programming, that seems to be promising.

@&#ACKNOWLEDGMENT@&#

We would like to thank the two anonymous referees for their comments, which helped to improve the paper.

@&#REFERENCES@&#

