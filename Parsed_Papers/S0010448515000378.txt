@&#MAIN-TITLE@&#HiGeoM: A symbolic framework for a unified function space representation of trivariate solids for isogeometric analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a unified function space representation of trivariate solids and its attributes.


                        
                        
                           
                           We develop an approach for ab-initio construction of trivariate description of geometry using generative modeling techniques.


                        
                        
                           
                           The analysis of the constructed geometries enables isogeometric analysis without need for finite element mesh.


                        
                        
                           
                           We develop a symbolic modeling framework to construct trivariate solids and carry out isogeometric analysis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Generative modeling

Trivariate solid NURBS

Isogeometric analysis

Symbolic modeling

CAD–CAE integration

Analytic solids

@&#ABSTRACT@&#


               
               
                  In this paper, a procedural description of solids is proposed with representational domain that encompasses the needs in Computer Aided Design (CAD), heterogeneous object modeling and Computer Aided Engineering (CAE). Specifically, a function space formalism, that unifies the representation of geometry and physical attributes, is proposed along with an algebra that operates on elements in those spaces. A declarative programming language is provided, which accepts a subset of mathematical semantics specified using the Mathematical Markup Language (MathML) as well as a fortran-like syntax. The language enables a high-level definition of the geometric model using continuous affine transformation and boolean operators leading to a mixed-dimensional representation. Thus, it is possible to construct analytically defined shapes as well as spline representation of complex geometry. The framework is demonstrated by constructing complex engineered solids and isogeometrically solving boundary value problems on the constructed solid.
               
            

@&#INTRODUCTION@&#

The solid models constructed in a modern CAD system satisfy many requirements including: boundedness/finiteness, closure under constructive operations, finite describability and boundary determinism  [1–3]. One property that is arguably missing from this requirement list is deformation and solid-like behavior, so that the model for solids takes into consideration the behavior of physical solids.

In recent times, solid modeling has spawned the area of heterogeneous object modeling  [4–8]. This area concerns itself with methods and systems for primarily modeling solid objects composed of different constituent materials and/or subregions with different material composition. Classical solid models (Manifolds and cell complexes  [9]; R-sets and constructive solid geometry (CSG)  [1]) assume homogeneous domains. Heterogeneous object modeling aims at increasing the representational fidelity of solids to support emerging manufacturing applications such as those aimed at functionally graded materials. But, the focus has yet to be extended to enable modeling of other physical attributes of solids.

The physical behavior of solids (displacement, stress, temperature etc.) is computationally deduced from solutions to partial differential equations (PDEs) applied on a given domain. Implied in solving such PDEs is the need to address specific regions within the domain on which the problem is posed as well as a need to directly specify locations within the domain at which the solutions are desired. Consequently, the mathematical models defined in traditional solid modeling, particularly the approaches that are based on a boundary representation, may be insufficient to represent such a physical behavior.

Therefore, the question can be asked if it is indeed possible to develop a procedural description of solids with representational domain that encompasses the needs in Computer Aided Design (CAD), heterogeneous object modeling and engineering analysis (CAE). Additionally, can this representation meet the practical, adaptive (or as needed) refinement/fidelity requirements in both CAD and engineering analysis with minimal computational cost. That is, would the representation be suitable to describe the boundary as well as enumerate over the field for solving the analysis problem. These questions also naturally fall within the scope of CAD–CAE integration methods or isogeometric analysis techniques  [10,11].

To address these questions, we develop and describe a symbolic trivariate solid construction approach that allows the generative definition of trivariate solids. Such mathematical solids that represent the behavior of physical solids are referred here as analysis amenable solids. Throughout the discussion here, we focus on solving elliptical PDE for engineering applications and refer to such a solution procedure as engineering analysis.

Related to the present work, Staton and Crain  [12] defined a parametric cubic modeling system for unified representation of lines, surfaces, volumes and additional physical attributes. Casale and Stanton further studied construction techniques of the parametric cubic modeling, referring to it as analytic solid modeling  [13]. The freeform deformation approach by Sederberg  [14] defines a deformation field represented by a trivariate Bernstein polynomial for manipulating an embedded solid model. An approach for using trivariate functions for freeform sculpting was considered by Raviv et al.  [15] in which surfaces are defined as zero sets of scalar trivariate B-spline fields. Joy  [16] explored the use of hyperpatches for modeling free-form solids as an extension of modeling operations on surfaces. It should be further noted that with the exception of hyperpatch modeling and analytic solid modeling approaches, most methods utilize the trivariate representation only as a geometric manipulation tool. Recently, there is an increasing interest in trivariate solid construction motivated by isogeometric analysis that is exemplified by Refs.  [17–19]. The aim of this literature is to achieve tighter integration between design and analysis through a common mathematical representation.

A number of procedural approaches exist in CAD  [20,21]. Procedural approaches allow the construction of solid models such that the validity of the models directly correlate to syntactic validity. These approaches are naturally amenable to a symbolic approach for defining the CAD geometry construction procedure and also result in a compact representation. Multiple CAD approaches, which include symbolic feature-based approaches, fall into the category of procedural approaches, but we focus only on those procedural approaches that define and manipulate geometric entities directly. Examples of systems that provide complete environments for creating geometric models of solids are PLaSM  [22,23], GenMod  [24] and FRep  [25]. PLaSM, which stands for Programming Language for Solid Modeling is based on the FL functional  [26] style programming language where the basic type are polyhedral objects, which enables it to define both manifold and non-manifold polyhedral solid models. GenMod is likewise a symbolic programming language, but it aims to produce shapes and constructs that are general transformations resulting in surface models. F-Rep was developed as a formalism for allowing general implicit functions as the main defining functions to allow the creation of semi-analytic representation of solids. The Hyperfun language was, for instance, derived from F-Rep  [21], however, with a focus on visualization applications. These approaches provide symbolic solid modeling framework, however, they lack the capability of constructing analysis amenable solids.

In this work, we describe a symbolic trivariate solid construction approach that allows the generative definition of trivariate solids. We propose functional spaces and an algebra which operates on elements in those spaces for the representation of heterogeneous solids through their geometry and attributes. The specific contributions described in this paper are: 
                        
                           1.
                           Algebraic system: The development of a function/curve-based algebraic system with a set of operators sufficient for capturing geometric operations and final construction of analysis amenable trivariate solids.

Discretization algorithm: A discretization operation for converting the symbolic trivariate solid description to an analysis suitable solid. The discretization operation is linear over the operators for constructing the trivariate representation, leading to a procedural discretization approach.

Implementation framework: A framework embodying the shape algebraic system. The framework includes a parser for the MathML expressions, an ability to carryout symbolic calculus or other operations, and a semantic analysis code that maps the expressions to geometric construction operations based on the developed algebra.

The rest of the paper is organized as follows. In Section  2, a general representation of analysis amenable solids is proposed. A symbolic geometric modeling framework that has the capability of generating analysis amenable functional solids is described in Section  3. Trivariate construction through continuous affine transformations is proposed in Section  4. A discretization approach for constructing analysis suitable trivariate solids is described in Section  5. The architecture, organization of code and implementation details of the system are described in Section  6. The capabilities of the system are illustrated through examples in Section  7. The paper is finally summarized in Section  8.

In this section, we propose a representation for general solids to meet the needs in CAD, heterogeneous object modeling and engineering analysis (see Fig. 1
                     ).

Consider a functional space 
                           F
                        . We define the instance of a solid 
                           S
                         as a product space of the geometry 
                           G
                           ⊂
                           F
                         and a collection of its 
                           k
                         attributes 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           ⊂
                           F
                           ,
                           
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           k
                        , thus, 
                           S
                           =
                           
                              (
                              G
                              ×
                              
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 ⋯
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 …
                                 ×
                                 
                                    
                                       A
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              )
                           
                        . This functional representation of solids provides an explicit enumerative description for every point in the domain. The attribute fields are modeled through the same space of functions used for modeling the geometry and completely describe the physical behavior of the solids. Some of the attribute fields are defined a priori, for instance, material field. Other attribute fields are obtained by an appropriate mapping; for example, in  [27], the analysis problem is defined as a mapping from the design state consisting of geometry and material fields in the domain to the behavioral field. Another example is a mapping for creating an instance of a solid needed for visualization. In this case, the mapping would create attributes defining color appropriate to display some specific behavior 
                           
                              
                                 S
                              
                              
                                 u
                              
                           
                           =
                           G
                           ×
                           U
                        .

A design state 
                           D
                         is described as the product space 
                           D
                           =
                           
                              (
                              G
                              ,
                              ℳ
                              )
                           
                         of geometry 
                           G
                           ⊂
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                        , material 
                           ℳ
                           ⊂
                           
                              
                                 H
                              
                              
                                 q
                              
                           
                         and an appropriate mapping 
                           
                              A
                           
                           :
                           G
                           ×
                           ℳ
                           →
                           U
                         to behavior 
                           U
                         for analyzing the design state (Fig. 1). Here, 
                           H
                         is the space of Hilbert functions. These functions have properties needed for representing both analysis fields in discretized form and suitable for engineering analysis as well as the functions needed to define other attributes over the domain. Hilbert space of functions of order 
                           m
                           ,
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                         are particularly important because they are complete inner product spaces, and every Cauchy sequence defined within the space converges, guaranteeing that the PDE problems approximated by functions from this space converge  [28]. Further, in 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        , 
                           u
                           ,
                           v
                           :
                           Ω
                           →
                           R
                           ,
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                         is defined by an inner product of the form: 
                           
                              (1)
                              
                                 
                                    
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    (
                                    u
                                    v
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          ,
                                          i
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ,
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          ,
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ,
                                          i
                                          j
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          ,
                                          
                                             
                                                
                                                   
                                                      i
                                                      j
                                                      ⋯
                                                      k
                                                   
                                                   ︸
                                                
                                             
                                             
                                                m
                                                
                                                
                                                   indices
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ,
                                          
                                             
                                                
                                                   
                                                      i
                                                      j
                                                      ⋯
                                                      k
                                                   
                                                   ︸
                                                
                                             
                                             
                                                m
                                                
                                                
                                                   indices
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 d
                                 Ω
                                 ,
                                 
                                 1
                                 ≤
                                 i
                                 ,
                                 j
                                 ,
                                 …
                                 ,
                                 k
                                 ≤
                                 n
                                 .
                              
                           
                         Hence, every function in this space has the norm 
                           
                              
                                 
                                    ‖
                                    u
                                    ‖
                                 
                              
                              
                                 m
                              
                           
                           =
                           
                              
                                 
                                    (
                                    u
                                    ,
                                    u
                                    )
                                 
                              
                              
                                 m
                              
                              
                                 1
                                 /
                                 2
                              
                           
                         defined, and the function values and all the derivatives up to the 
                           m
                        th one are bounded.

The order 
                           p
                         for 
                           G
                           ⊂
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                         depends on the smoothness requirement on the geometry. Let 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         be the space of functions which are bounded, continuous and have continuous and bounded derivatives of order 
                           j
                           ,
                           
                           1
                           ≤
                           j
                           ≤
                           k
                        . An important result of the Sobolev embedding theorem is that 
                           
                              
                                 H
                              
                              
                                 s
                              
                           
                           ⊂
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         if 
                           s
                           >
                           n
                           /
                           2
                           +
                           k
                         where 
                           n
                         is the dimension of the space  [29]. Thus, in three-dimensional space with 
                           n
                           =
                           3
                        , in order to ensure 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         continuity, 
                           G
                           ⊂
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         while for 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         smoothness, 
                           G
                           ⊂
                           
                              
                                 H
                              
                              
                                 3
                              
                           
                        . A discontinuous material field, 
                           ℳ
                           ⊂
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                         is, in general, acceptable for analysis. However, material field with higher smoothness may be desired in applications involving functionally graded materials, thus, 
                           ℳ
                           ⊂
                           
                              
                                 H
                              
                              
                                 q
                              
                           
                           ,
                           q
                           ≥
                           0
                        .

Here, we assume that the general functional space 
                           F
                         is defined over the unit interval 
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 n
                              
                           
                        . We further assume that the types of functions in 
                           F
                         that are allowed are functions that belong to the space of smooth functions 
                           
                              
                                 C
                              
                              
                                 ∞
                              
                           
                         or functions that belong to the space of Hilbert functions of an appropriate order 
                           m
                           ,
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                        . Functions from the space of smooth functions are particularly useful for describing attribute fields as will be discussed later.

A complex design state or the global instance of a solid is viewed as the union of local instances of solids. Every element 
                           
                              {
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         of the local set of instances of a solid 
                           S
                         is the product space of the local geometry and the collection of attributes 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                           ×
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              ×
                              ⋯
                              
                                 
                                    A
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . The global state is then defined as 
                           S
                           =
                           
                              
                                 ∗
                              
                              
                                 i
                              
                           
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        , where 
                           ∗
                         denotes valid operations 
                           
                              {
                              ⋃
                              ,
                              ⋂
                              ,
                              −
                              }
                           
                         on the local geometry. The physical attributes in the global design state are defined using the Hierarchical Partition of Unity Field Compositions (HPFC) theory  [27] as weighted composition of attributes of the local instances of solids such that the weights 
                           
                              
                                 w
                              
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         satisfy partition of unity over the global domain. Such partitions of unity ensure convergence of the global approximations when errors in local approximations are bounded. Thus, at any point 
                           
                              x
                           
                         in the design domain 
                           Ω
                        , the following representation of the composed attribute fields 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         is possible 
                           
                              (2)
                              
                                 f
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                              
                           
                         such that weights obey partition of unity as follows: 
                           
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                
                                                   w
                                                
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             ≤
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   w
                                                
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ≤
                                    
                                       
                                          C
                                       
                                       
                                          ∞
                                       
                                    
                                 
                              
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             ‖
                                             ∇
                                             
                                                
                                                   w
                                                
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   d
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ≤
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                G
                                             
                                          
                                       
                                       
                                          
                                             diam
                                          
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

This smooth weight field 
                           
                              
                                 w
                              
                              
                                 Ω
                              
                              
                                 i
                              
                           
                         described over the local instance of solid is another example of an attribute field of the solid.

Here, we describe a symbolic geometric modeling framework that has the capability of generating analysis amenable functional solids based on parametric functions that fall into the class of functions 
                        F
                      mentioned earlier and mixed topological dimension. The generative modeling approach followed here is based on the work by Snyder  [24].

A generative model is created by continuous transformation of lower-dimensional entities, namely, the generators. In this work, generative definition of trivariate solids is proposed by defining valid operands (generators) operated on by valid operators (transformations). The geometry construction of the primitive solid at the local level of the design state is done through operators defined such that the functions on which they operate become significant as shape descriptors in the resulting geometric entities. Additionally, the operators are defined such that they are closed under the general space of defining functions.

A parametric function 
                           f
                         is defined as 
                           f
                           ∈
                           F
                           :
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 n
                              
                           
                           ⊂
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 l
                              
                           
                        . Parametric functions that belong to the space of smooth functions 
                           
                              
                                 C
                              
                              
                                 ∞
                              
                           
                         or to the space of Hilbert functions of order 
                           m
                         with complete inner product 
                           
                              
                                 H
                              
                              
                                 m
                              
                           
                         are permitted as valid operands.

For example, consider the function, 
                           f
                           :
                           R
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , with parametric variable 
                           u
                         such that 
                           f
                           
                              (
                              u
                              )
                           
                           =
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              )
                           
                         represents the geometric coordinates in 
                           
                              
                                 E
                              
                              
                                 3
                              
                           
                         of a helix (Fig. 2
                        ) as shown in Eq. (6):
                           
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    2
                                    cos
                                    
                                       (
                                       20
                                       π
                                       u
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    2
                                    sin
                                    
                                       (
                                       20
                                       π
                                       u
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    10
                                    u
                                 
                              
                              
                                 (6)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             
                                                y
                                             
                                          
                                          
                                             
                                                z
                                             
                                          
                                       
                                       }
                                    
                                    =
                                    
                                       f
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

The same class of parametric functions are also used to define the attributes associated with the geometric entity. For instance, in the previous example, the geometry 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                         and r–g–b color attributes 
                           
                              
                                 A
                              
                              
                                 r
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 g
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 b
                              
                              
                                 i
                              
                           
                         are defined by the parametric function in Eq. (7) where 
                           
                              
                                 G
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 r
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 g
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 b
                              
                              
                                 i
                              
                           
                           ⊂
                           F
                           
                              (
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              )
                           
                        . 
                           
                              (7)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                      
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    f
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            |
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            |
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

In this example, the parametric functions are represented as vector objects. In Appendix, more general tensor objects are defined to represent a collection of parametric functions.

Valid operators 
                           ϕ
                         are defined such that they are closed under the general space of defining functions, that is, given functions 
                           f
                           ,
                           g
                           ∈
                           F
                         then 
                           ϕ
                           
                              (
                              f
                              ,
                              g
                              )
                           
                           ∈
                           F
                        .

Two types of operators are considered in this work. One set of operators only modify the underlying parameterization without changing the topological dimension of the entity. Examples of operators that only modify the underlying parameterization without changing the topological dimension of the entity are arithmetic, inversion, join and calculus operators. These are described in detail in Appendix. Figs. 3 and 4
                        
                         illustrate the application of these operators.

The second set of operators result in an increase in the manifold dimension of geometric entities. Operators that turn functions defined over unit intervals to functions defined over unit squares are an example of the latter type resulting in an increase in the topological dimension of the entity.

The operators considered in this section 
                           
                              A
                           
                           
                              (
                              v
                              )
                           
                           ∈
                           F
                         when applied on parametric functions 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                           ∈
                           F
                         result in higher-dimensional topological entities 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ∈
                           F
                         from lower-dimensional topological entities, i.e., defining 3-manifolds from 2-manifolds and 2-manifolds from 1-manifolds. The generalized continuous affine transformation applied in this section is of the form 
                           
                              (8)
                              
                                 
                                    S
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    A
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 +
                                 
                                    t
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 .
                              
                           
                         The result of these operations are functions whose domains are tensor product of the domains of the operand 
                           f
                           :
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                           ×
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                           →
                           R
                         and the parameterization of the individual operands are considered independently. The surface defined in Eq. (8) can be defined in homogeneous coordinates as a tensor product surface of the form 
                           
                              (9)
                              
                                 
                                    S
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    H
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                              
                           
                        
                        
                           
                              H
                           
                           
                              (
                              v
                              )
                           
                         represents the transformation in homogeneous form and 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                         is a curve both with elements in 
                           F
                         and defined as tensors of order 2 and order 1 respectively. We describe specific types of generalized continuous affine transformations next.

The profile product is the simplest surface that may be generatively defined  [24]. It is defined as the product of a cross-section curve 
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                            with a profile curve 
                              
                                 p
                              
                              
                                 (
                                 v
                                 )
                              
                           , both assumed here to be in the 
                              x
                              −
                              y
                            plane for simplicity, as shown below: 
                              
                                 (10)
                                 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                            In Fig. 5
                           , the use of profile product operations to create the body and cap of the tea pot is illustrated.

The wire product transformation is obtained when a cross-section curve is translated along a “wire” curve while maintaining the cross-section curve to be perpendicular to the wire curve. This is illustrated in Fig. 6
                           . The tensor product operator is therefore obtained from a moving frame computed from the second operand (curve). Let 
                              
                                 
                                    γ
                                 
                                 
                                    v
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                            be the wire curve with 
                              τ
                              
                                 (
                                 v
                                 )
                              
                            as its unit tangent vector. Then, a moving frame associated with 
                              
                                 
                                    γ
                                 
                                 
                                    v
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                            is defined by an orthonormal system of vectors 
                              
                                 (
                                 τ
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 η
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 b
                                 
                                    (
                                    v
                                    )
                                 
                                 )
                              
                            (see Fig. 6(a)) such that 
                              
                                 (11)
                                 
                                    τ
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                v
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   γ
                                                
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ‖
                                          
                                       
                                    
                                    
                                    b
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                v
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                          ×
                                          
                                             
                                                γ
                                             
                                             
                                                v
                                             
                                             
                                                ″
                                             
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   γ
                                                
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ×
                                             
                                                
                                                   γ
                                                
                                                
                                                   v
                                                
                                                
                                                   ″
                                                
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ‖
                                          
                                       
                                    
                                    
                                    η
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    b
                                    
                                       (
                                       v
                                       )
                                    
                                    ×
                                    τ
                                    
                                       (
                                       v
                                       )
                                    
                                    .
                                 
                              
                            Then, we obtain 
                              H
                              
                                 (
                                 v
                                 )
                              
                            from the moving frame, 
                              
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       v
                                    
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 τ
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 η
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 b
                                 
                                    (
                                    v
                                    )
                                 
                                 }
                              
                            relative to the original frame 
                              
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       v
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 ,
                                 τ
                                 
                                    (
                                    0
                                    )
                                 
                                 ,
                                 η
                                 
                                    (
                                    0
                                    )
                                 
                                 ,
                                 b
                                 
                                    (
                                    0
                                    )
                                 
                                 }
                              
                           . We make the choice of using the rotation minimizing frame which may be readily obtained using the project method  [30] or the double reflection method  [31]. However, in our case we solve the rotation minimizing vector 
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                           , which uniquely describes the rotation minimizing frame as the solution to the differential equation 
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                −
                                                d
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                τ
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                ⋅
                                                τ
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                =
                                                0
                                             
                                          
                                       
                                       }
                                    
                                 
                              
                            for some function 
                              d
                              
                                 (
                                 v
                                 )
                              
                           . The first equation constrains the direction of 
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                            to be parallel to the tangent 
                              τ
                              
                                 (
                                 v
                                 )
                              
                            and second equation preserves orthogonality. With the goal of ensuring that the result of the product transformation is closed under Non-Uniform Rational B-Splines (NURBS) operations, we approximate the frame vector 
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                            as a B-Spline. Product transformation over a closed curve prescribes an additional condition on Eq. (12) that 
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 1
                                 )
                              
                           .


                           Fig. 4 as well as Fig. 7
                            are examples of surfaces constructed through a wire product operation. The functional form of the helix and the circle defined parametrically such that its coordinates belong to 
                              F
                            are referred to as shape descriptor functions. The transformation tensor 
                              
                                 H
                              
                              
                                 (
                                 v
                                 )
                              
                            in Eq. (9) is obtained from the helix 
                              
                                 f
                              
                              
                                 (
                                 v
                                 )
                              
                            defining the moving orthogonal frame 
                              
                                 (
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       f
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                           , where these are the tangent, normal and binormal unit vectors. In general, the normal and binormal vectors are non-unique, but simply span the normal plane of the defining curve, or helix in this case.

The rail transformation is a sweeping operation on the cross section area constrained between two curves. The rail transformation is similar to a constrained sweep operation, in which a scaling effect is introduced into the transformation to ensure that resulting surface interpolates the ends. A simple example of this type of transformation is a ruled surface, in which the cross section of the transformation is a straight line. Fig. 8
                            shows an example of a rail transformation defined by a trochoid, 
                              
                                 t
                              
                              
                                 (
                                 v
                                 )
                              
                           , shown in red, and a straight line, 
                              
                                 l
                              
                              
                                 (
                                 v
                                 )
                              
                           , shown in green. Both of these rail curves are assumed here to be in the 
                              x
                              –
                              y
                            plane for simplicity. These quantities are defined in Eq. (13)
                           
                              
                                 (13)
                                 
                                    
                                       t
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                4
                                                +
                                                b
                                                cos
                                                
                                                   (
                                                   6
                                                   π
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                6
                                                π
                                                v
                                                +
                                                b
                                                sin
                                                
                                                   (
                                                   6
                                                   π
                                                   v
                                                   )
                                                
                                             
                                          
                                       
                                       }
                                    
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       (
                                       1
                                       −
                                       v
                                       )
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       }
                                    
                                    +
                                    v
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                              
                            where, 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    2
                                 
                              
                            are the end points of the straight line 
                              
                                 l
                              
                              
                                 (
                                 v
                                 )
                              
                           , and 
                              b
                            is a parameter that determines the shape of the trochoid 
                              
                                 t
                              
                              
                                 (
                                 v
                                 )
                              
                           . Specifically, in the chosen example, 
                              
                                 
                                    P
                                 
                                 
                                    2
                                    x
                                 
                              
                              =
                              4
                              +
                              b
                              cos
                              
                                 (
                                 6
                                 π
                                 )
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    1
                                    y
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    2
                                    y
                                 
                              
                           . Further defining 
                              
                                 (14)
                                 
                                    
                                       r
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             [
                                             
                                                t
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             −
                                             
                                                l
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             [
                                             
                                                t
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             +
                                             
                                                l
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            The surface 
                              S
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            in Fig. 8 is obtained by the rail transformation: 
                              
                                 (15)
                                 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                1
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       c
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    ,
                                    
                                    with  
                                    
                                       c
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                cos
                                                
                                                   (
                                                   2
                                                   π
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                sin
                                                
                                                   (
                                                   2
                                                   π
                                                   u
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

Trivariate geometry construction is achieved through sequential application of continuous affine transformations as defined in Eq. (9). The affine transformations applied on three operands or applied twice sequentially result in a trivariate function belonging to 
                        F
                     . In fact, when multiple operands are passed to the operator, the application is done sequentially in a manner similar to currying in functional programming languages  [32]. In this case, the identity tensor product is applied on the initial operand. Here, a trivariate solid is defined through the following tensor product: 
                        
                           (16)
                           
                              
                                 B
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 w
                                 )
                              
                              =
                              
                                 H
                              
                              
                                 (
                                 w
                                 )
                              
                              
                                 S
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              .
                           
                        
                      In the above equation, 
                        
                           H
                        
                        
                           (
                           w
                           )
                        
                      may be defined using any of the products (profile, wire or rail) described earlier.


                     Fig. 9
                      illustrates a trivariate cylindrical solid obtained as a wire product of the section over the circle of revolution.

In Fig. 10
                     , we illustrate another trivariate solid “thread” constructed using operators defined over the helical shape descriptions.

The boolean operators of union, intersection and difference can be applied on trivariate functions to allow the construction of more complex entities. The boolean operator shares relationships to some of the previously defined operators. For instance, the join operator is a specific union operator defined on 1-manifolds. On the condition that the dimensionality of the operands are the same, the intersection of the operands leads to a lower-dimensional entity. The numerical implementation of the boolean operations is described in detail in Ref.  [33].

Smooth functions are retained as smooth functions, but their evaluations are done over their discretized form. That is, we assume that a suitable “discretization” operation exists such that 
                              p
                              :
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                              →
                              
                                 
                                    H
                                 
                                 
                                    m
                                 
                              
                           . Thus, the functions in 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                              
                                 (
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 )
                              
                            are converted to an appropriate function in 
                              
                                 
                                    H
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 )
                              
                            using a discretization procedure discussed in the next section. The evaluation of an entity therefore constitutes the evaluation over the parameter range of the defining functions. This therefore leads to a recursive evaluation over the composition of the discretized form of the defining functions.

In the previous sections, we described a generative modeling framework for constructing “analysis amenable” functional solids based on parametric functions that fall into the class of functions 
                        F
                     . However, analytic solids belonging to 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                      may not be convenient to use within analysis frameworks that rely on numerical quadrature and matrix solutions. In this section we illustrate the conversion process from 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                      functions to 
                        
                           
                              H
                           
                           
                              m
                           
                        
                     .

NURBS is used as the canonical form of functions belonging to 
                        
                           
                              H
                           
                           
                              m
                           
                        
                     . The NURBS form has desirable properties for engineering analysis  [10,11]. Thus, analysis amenable solids are constructed for the class of functions 
                        F
                      by one of the following two approaches—
                        
                           1.
                           Tensor product operations on NURBS entities. In this case, the discretization step is skipped.

Discretization of analytic functions into NURBS entities followed by suitable product transformations.

In developing a discretization procedure, we exploit some known properties of polynomials and the relationship between B-Splines, Bernstein polynomials and Chebyshev polynomials  [34–36]. The well known Weierstrass theorem from approximation theory states that any function can be approximated arbitrarily close by a polynomial over a finite interval and that a polynomial which gives the best approximation is unique  [37]. Furthermore, the Chebyshev polynomials give the best approximation under the minimax conditions. That is, the Chebyshev polynomials result in the polynomial, 
                        
                           
                              p
                           
                           
                              n
                           
                        
                        
                           (
                           x
                           )
                        
                        =
                        
                           
                              a
                           
                           
                              0
                           
                        
                        +
                        
                           
                              a
                           
                           
                              1
                           
                        
                        x
                        +
                        
                           
                              a
                           
                           
                              2
                           
                        
                        
                           
                              x
                           
                           
                              2
                           
                        
                        +
                        ⋯
                        +
                        
                           
                              a
                           
                           
                              n
                           
                        
                        
                           
                              x
                           
                           
                              n
                           
                        
                     , such that the 
                        
                           
                              
                                 ‖
                                 f
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 ‖
                              
                           
                           
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                           
                        
                      is minimized. A shape adaptive Chebyshev polynomial interpolation procedure with both error and refinement constraints is constructed. The Chebyshev polynomial is converted to the Bezier curve using a basis transformation  [36], which is in turn converted to a B-Spline form. The Chebyshev interpolation procedure that is developed here is motivated by the application of Chebyshev interpolation polynomials for degree reduction of B-Spline and Bezier curves  [38]. Consequently, the procedure described has benefit of generating shape adaptive linear piecewise approximations to a given shape descriptor function from 
                        F
                     .

There are four kinds of Chebyshev polynomials  [35], but we focus on the first-kind, which is typically denoted by its basis function 
                           
                              
                                 T
                              
                              
                                 n
                              
                           
                        . The Chebyshev polynomial of the first kind is a polynomial in 
                           x
                         of degree 
                           n
                         defined by the relation: 
                           
                              (17)
                              
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 cos
                                 n
                                 θ
                                 
                                 and
                                 
                                 x
                                 =
                                 cos
                                 θ
                                 .
                              
                           
                         The natural range of 
                           x
                         is the interval 
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                         and corresponds to 
                           θ
                           ∈
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                        . If one considers the 
                           cos
                           θ
                         over the range 
                           
                              [
                              0
                              ,
                              π
                              ]
                           
                         it is observed that the 
                           x
                         is decreasing from 1 to 
                           −
                           1
                        , therefore the range of 
                           x
                         is reversed during evaluation. The first few bases of the Chebyshev polynomial are 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    cos
                                    0
                                    θ
                                    =
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    cos
                                    1
                                    θ
                                    =
                                    cos
                                    θ
                                    =
                                    x
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    cos
                                    2
                                    θ
                                    =
                                    2
                                    
                                       
                                          cos
                                       
                                       
                                          2
                                       
                                    
                                    θ
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    cos
                                    3
                                    θ
                                    =
                                    4
                                    
                                       
                                          cos
                                       
                                       
                                          3
                                       
                                    
                                    θ
                                    −
                                    3
                                    cos
                                    θ
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    cos
                                    n
                                    θ
                                    =
                                    2
                                    cos
                                    θ
                                    cos
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    θ
                                    −
                                    cos
                                    
                                       (
                                       n
                                       −
                                       2
                                       )
                                    
                                    θ
                                 
                              
                           
                         which result in the recurrence relationship 
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                n
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          2
                                          x
                                          
                                             
                                                T
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          −
                                          
                                             
                                                T
                                             
                                             
                                                n
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          ,
                                          
                                          n
                                          =
                                          2
                                          ,
                                          3
                                          ,
                                          …
                                          .
                                       
                                    
                                 
                              
                           
                         The functions we consider all belong to 
                           F
                         defined over 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Therefore, a change of variable 
                           x
                           =
                           2
                           u
                           −
                           1
                         is used resulting in the shifted form of the Chebyshev polynomial 
                           
                              (19)
                              
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    2
                                    u
                                    −
                                    1
                                    )
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                              
                           
                         leading to the recurrence relation 
                           
                              (20)
                              
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 2
                                 
                                    (
                                    2
                                    u
                                    −
                                    1
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 −
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       −
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 n
                                 =
                                 2
                                 ,
                                 3
                                 ,
                                 …
                                 .
                              
                           
                         The shifted form of the Chebyshev polynomial exhibits all the same desired interpolatory properties of the standard Chebyshev polynomial. The variable 
                           u
                        , however, becomes equal to 
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              (
                              1
                              +
                              cos
                              θ
                              )
                           
                         and the roots of the Chebyshev polynomials are shifted. 
                           
                              (21)
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    {
                                    1
                                    +
                                    cos
                                    
                                       [
                                       
                                          
                                             
                                                (
                                                2
                                                k
                                                −
                                                1
                                                )
                                             
                                             π
                                          
                                          
                                             2
                                             n
                                          
                                       
                                       ]
                                    
                                    }
                                 
                                 .
                              
                           
                         The Chebyshev interpolation to a given function 
                           f
                           ∈
                           F
                         over the interval 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         is 
                           
                              (22)
                              
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          2
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    f
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 .
                              
                           
                         The error of the Chebyshev interpolation is defined as 
                           
                              (23)
                              
                                 
                                    
                                       e
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 f
                                 
                                    (
                                    u
                                    )
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 .
                              
                           
                        
                     

The discretization procedure is made adaptive through a subdivision procedure, for which the number of subdivisions can be determined a priori  [36]. The minimum number of subdivisions based on an error tolerance 
                           ε
                         is given as 
                           s
                           >
                           
                              
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 log
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    ε
                                 
                              
                              )
                           
                        . Therefore, for a given degree, 
                           n
                        , for a B-spline curve sought, the number of coefficients (control points) can be determined as 
                           
                              (24)
                              
                                 
                                    
                                       n
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    (
                                    s
                                    +
                                    1
                                    )
                                 
                                 n
                                 +
                                 2
                                 .
                              
                           
                         Therefore, the relationship between the number of coefficients and the error is 
                           
                              (25)
                              
                                 
                                    
                                       n
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       ε
                                    
                                 
                                 +
                                 n
                                 +
                                 2
                                 .
                              
                           
                        
                        Fig. 11
                         illustrates the fit using Chebyshev basis to a helix.

The transformation from the Chebyshev basis to the Bernstein basis of Bezier curves is done using the transformation matrix described in  [36].

All analytic functions are first discretized prior to evaluation. There are two consequences of this that are worth noting. The first is that discretization ensures that all sharp corners defined through multiplication with step functions or defined through the join operators are not captured in the discretized form. The second is that the operators on analytical functions may be applied on their discretized form, and the functions from the two sub-spaces of operands can be used together. Thus, for instance, in the radius variation shown in Fig. 7, the errors in the discretized form are carried through the join operator. Fig. 12
                         illustrates the NURBS discretization resulting from the trivariate solid evaluation of the piston example described earlier.

The above described discretization procedure converts analytic solids into analysis amenable NURBS solids. While one may debate whether analysis on such a discretized representation of analytic solids is truly “Isogeometric”, at this time, the “procedural” discretization described in the paper (as opposed to volumetric meshing) is necessary for purposes of analysis. However, if the solid is constructed starting from primitive NURBS entities, then no discretization is required and the mathematical representation used for analysis is identical to the geometric representation.

HiGeoM is an integrated symbolic environment for geometric modeling and engineering analysis. HiGeoM enables the construction of complex geometrical shapes with inherent discretization that is amenable to isogeometric analysis  [10,11], as well as the definition and manipulation of variational formulations for elliptic partial differential equations.

The capabilities in HiGeoM are factored into six core components: parser, symbolic manipulator, generative modeler, model data structures, approximations/discretized fields, and data type and arithmetic. These components are illustrated in Fig. 13
                     .

The parsers in HiGeoM accept user defined mathematical expressions in content MathML  [39] and a Fortran-like mathematical syntax. There are limitations to solely using a MathML syntax. This is due to the lack of flexibility needed for controlling the flow of operation and the inability to capture higher-level application specific semantics with intuitive mathematical syntax. Furthermore, the textual encoding of MathML is relatively verbose due to the tagged markup construct inherent in XML-based applications. However, given the availability of an editor such as the connexions Content MathML editor  [40] for the Mozilla Firefox browser or the formulator editor  [41], the use of content MathML can be very expressive when defining functional geometries  [42].

The content MathML parser depends on the Xerces-J XML parser for checking well-formedness (conformity to the XML 1.0 specification) and generation of the Document Object Model (DOM)  [43], which in the case of content MathML corresponds to the expression tree representation of the mathematical expressions.

The HiShar3D.mml sub-package contains the implementation of the Java binding to the MathML DOM interface and extends the MathMLContentElement to include a parse method that validates the subset of content MathML accepted in HiGeoM.

With the Fortran-like syntax, the required parser is defined using the Java Compiler, parser generator (JavaCC)  [44]. The procedure for generating the JNS parser with JavaCC is illustrated in Fig. 14
                           . All the arithmetic, trigonometric, transcendental and relational operators that are defined for the MathML elements are likewise accepted as valid operators by the parser.

The HiExpression class embodies all the mathematical, geometric modeling and analysis problem definitions in HiGeoM and therefore defines the user’s interface to all its capabilities. There are six types of HiExpression: mathematical expression EXPRESSION, constant value VALUE, VARIABLE, function FUNCTION, geometric expression GEOM or an empty expression EMPTY. The typing of HiExpressions, with the exception of FUNCTION is determined from the user specified operations, hence, the typing is done dynamically. HiGeoM also provides a minimal set of operations for algebraic manipulation such as the simplification of HiExpression type of EXPRESSION and FUNCTION as well as symbolic differentiation and integration. The symbolic manipulation capabilities also enable the handling of variational statements of boundary value problem.

The example in Fig. 15
                         shows a mathematical expression containing symbolic variable “
                           x
                        ”, construction of a parametric curve, parameterized over the symbolic variable “
                           u
                        ” defined in HiGeoM. The string arguments to the higeom.makeExpr and higeom.makeLExpr methods in Fig. 15 are examples of valid expressions. Two symbolic operations of differentiation and integration involving the derivative of the expression as well as the line integral of the resulting expression are also illustrated.

Complex 3-D geometric objects can be defined using arbitrary parametric functions and high-level operations such as tensor products in a similar manner as the curve in Fig. 15. Boolean operations can also be applied on the objects. The internal data structures representing the 3-D objects include the mathematical expression and high-level operations used for defining them.

The analysis problem definition is done using a graphical user interface for defining symbolic elements of the analysis problem. These symbolic elements include the specification of the geometry, Geometry entities, material properties for a linear analysis problem, Material, enrichments for specifying discontinuities, singularities and boundary conditions, Enrichment entities. The existence of all these entities indicates that the analysis problem has been fully specified, and the analysis process can be initiated. Consequently, the analysis problem is defined as a collection of Geometry, Material, which is a special type of Attribute, and Enrichments defined on the Geometry.

This section demonstrates the core capabilities of the system that has been developed and implemented for constructing trivariate NURBS solids. It also demonstrates the ability to define boolean operators over the trivariate NURBS solids. As mentioned earlier, the capabilities span three areas with the goal of integrating CAD and CAE through symbolic definition of geometry and its attributes. The underlying representation is based on the notion of product spaces of geometry and attributes for representing instances of solids.

Therefore, the capabilities of the system will be illustrated through the following: 
                        
                           1.
                           Definition of a complex structure: a hex bolt using the operators defined earlier and using HiGeoM expressions.

Computation of smooth weight field as an attribute over the hex bolt.

Analysis and computation of behavior fields using hierarchical approximations enabled by the HPFC theory  [27].

In designing a hexagonal bolt, there are three main parts of the structure: the head of the bolt, the shaft of the bolt and the thread. This division of the parts of the bolt design coincides with the functional aspects of a bolt. However, the partitioning of the bolt leading to its design in a CAD system would typically be governed by the tools and operations that are provided by a specific CAD system. While it is true that most CAD systems provide operations for standard engineered parts through a library of geometric shapes, the intent here is to use this complex geometrical shape to demonstrate the capability of HiGeoM.

In considering the main parts of the hexagonal bolt, it would appear that the most complex part of the design is constructing the thread. Therefore, the dimensions illustrated in Fig. 16
                         are first prescribed for the structure of the bolt. And the thread of the bolt is constructed from the parameterized dimensions given in Fig. 17
                         for the external thread.

The symbolic definition (using HiGeoM code) of the bolt thread is shown in the code snippet in Fig. 18
                        . The circular cross section of the shaft of the bolt, the directrix for the shaft of the bolt and the head of the bolt were defined externally and loaded into the HiGeoM environment.

The bolt solid is defined through the boolean union of the thread, shaft and the head of the bolt as shown in Fig. 19
                        . The discretization and parameterization of the primitives are independently maintained during the boolean construction. As can be seen in Fig. 20
                        , the level of refinement of the individual primitives may also be different. The expression tree of the boolean union of the primitives is equivalent to the CSG tree with the trivariate primitives at the nodes as in Fig. 21
                        .

An important element of HPFC theory is the construction of weight fields that determine the extent of contribution of approximations belonging to each primitive at a domain point (see Section  2.2). Here, the weight fields are constructed using signed distance fields from primitive boundaries. For the 
                           i
                        th primitive, signed distance 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                         is computed from the primitive boundary 
                           
                              
                                 Γ
                              
                              
                                 i
                              
                           
                         such that 
                           
                              (26)
                              
                                 
                                    sign
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   Γ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             1
                                             
                                             if  
                                             
                                                x
                                             
                                             ∉
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                             
                                             if  
                                             
                                                x
                                             
                                             ∈
                                             
                                                
                                                   Γ
                                                
                                                
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Further, R-functions  [46] that are functional equivalent of boolean operations are applied to compute signed distance for each primitive from the boundary of the region obtained by boolean subtraction of given primitive from all other primitives. That is, for two primitives 
                           i
                         and 
                           j
                        , the signed distance field from the boundary 
                           
                              
                                 Γ
                              
                              
                                 i
                                 −
                                 j
                              
                           
                         is given by the following operation on signed distance fields 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                              
                           
                         from boundaries 
                           
                              
                                 Γ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 Γ
                              
                              
                                 j
                              
                           
                         respectively. 
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                             −
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

More generally, for 
                           
                              
                                 n
                              
                              
                                 p
                              
                           
                         intersecting primitives, with intersection region 
                           
                              
                                 Ω
                              
                              
                                 
                                    
                                       ∩
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                           
                        , signed distance field of 
                           i
                        th primitive for the region 
                           
                              (28)
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                       −
                                       
                                          
                                             ∩
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       Ω
                                    
                                    
                                       
                                          
                                             ∩
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          ∩
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          Ω
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                              
                           
                         is computed by using Eq. (27) as follows: 
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                             −
                                             
                                                
                                                   ∩
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                             −
                                             
                                                
                                                   ∩
                                                
                                                
                                                   j
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            i
                                                            −
                                                            
                                                               
                                                                  ∩
                                                               
                                                               
                                                                  j
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 j
                                 ≠
                                 i
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       p
                                    
                                 
                                 .
                              
                           
                        
                     

The weight field for the 
                           i
                        th primitive is constructed using the above signed distance field as 
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             
                                                x
                                             
                                             ∉
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             in  
                                             
                                                
                                                   Ω
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   ⋃
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   p
                                                
                                             
                                             ,
                                             
                                             j
                                             ≠
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        Γ
                                                                     
                                                                     
                                                                        i
                                                                        −
                                                                        
                                                                           
                                                                              ∩
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    n
                                                                                 
                                                                                 
                                                                                    p
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                |
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      
                                                         
                                                            Γ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                   
                                                   )
                                                
                                                |
                                             
                                          
                                          
                                             in  
                                             
                                                
                                                   ⋃
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   p
                                                
                                             
                                             ,
                                             
                                             j
                                             ≠
                                             i
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The global weight fields for a boolean union operation over the primitives with local primitive weight fields 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                         is obtained as 
                           
                              (31)
                              
                                 
                                    
                                       w
                                    
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             Ω
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

For the hex bolt that was constructed in previous Section  7.1, the primitive weight fields are shown in Fig. 22
                        .

The analysis capability of HiGeoM is illustrated by solving for the displacement field in the bolt when constant displacement boundary conditions were applied on the top and bottom surfaces of the bolt as shown in Fig. 23
                        (a). The geometric primitives of both the solids, the head and the shaft of the bolt, were modeled as degree 2×2×2
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         NURBS solids using a 11×11×11 control point net. Thus, the analysis domain contained 7986 degrees of freedom. Elastic modulus and Poisson’s ratio were set as 100 units and 0.3 respectively for each primitive. Compositional analysis was performed using the weight fields constructed in previous section, and the displacement field over the entire geometry was solved as shown in Fig. 23(b).

@&#SUMMARY@&#

In the present paper, the development of a symbolic framework termed HiGeoM for constructing trivariate solids and carrying out isogeometric analysis was described. The framework considers geometry and attributes defined through functions belonging to the same function space. First, an approach for ab-initio construction of complex geometric domains was proposed. Generative modeling techniques were described for constructing trivariate NURBS representation of the solid geometry. The trivariate description of geometric domains enables analysis on those domains without the need for a finite element mesh generation step. Furthermore, the hierarchical partition of unity field composition methodology allows composition of the behavioral fields defined on the primitives. A consequence of these approaches is that the framework enables the integration of CAD and CAE at multiple abstraction levels of user interface, mathematical representation through NURBS and the utilization of the same algorithmic infrastructure and arithmetic operations.

@&#ACKNOWLEDGMENT@&#

O.T. Morgan was partially supported by an Intel Fellowship during the course of this study. The authors are thankful for this support.

Tensor objects describe linear relations between scalars, vectors and other tensors. Tensor representation is an ordered collection of the defining functions. The tensor order ranges from 0 to 
                           n
                        . All geometric entities are stored as order 1 tensors or vector objects. For example, the geometric representation of helix in Eq. (6).

The tensor product operators are specified as order 2 tensors and satisfy the standard tensor algebra. Such operator functions perform transformation operations on geometric entities as well as the attributes. Geometric entities that are defined are stored as tensors, which are considered as ordered collection of the defining functions. Therefore, the tensors can be viewed as containers for functions and the tensors can be of order 0, 1, 2 or n. For containing geometric entities, the tensors will be of order 1, while combinations of geometric entities and attributes can be stored as tensors of order 1 where the elements are also tensors of order 1 as in Eq. (32). 
                           
                              (32)
                              
                                 
                                    f
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         :
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               3
                                                               +
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Operators that require reparameterization are described below.

Arithmetic operations consist of basic operators such as addition operator 
                              f
                              
                                 (
                                 u
                                 )
                              
                              +
                              g
                              
                                 (
                                 u
                                 )
                              
                            and multiplication operator 
                              f
                              
                                 (
                                 u
                                 )
                              
                              g
                              
                                 (
                                 u
                                 )
                              
                           , necessary for constructing more complex operators such as affine transformations. For instance, it is possible to use a step function to suppress the effect of a function and activate another function using both these operators as shown in Fig. 3. The operation shown in Fig. 3 includes a regularized join operator of the form 
                              
                                 g
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 [
                                 d
                                 
                                    (
                                    u
                                    )
                                 
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    (
                                    1
                                    −
                                    d
                                    
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 
                                    b
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ]
                              
                            that is described in detail in the following sections. The join operator as well as arithmetic operators in general require reparameterization, which in turn requires the inverse operator described next.

The inversion operator allows for the ability to obtain parametric values for specified values of functions and particularly finds application in reparameterization of functions such as matching intrinsic monotonic result of functions. An example is for normalizing multiple functions using a common parameterization derived from such intrinsic monotonic property as arc length. To ensure closure of the inversion operator on 
                              F
                           , we define this operator for 
                              f
                              
                                 (
                                 u
                                 )
                              
                            as:
                              
                                 (33)
                                 
                                    u
                                    
                                       (
                                       s
                                       )
                                    
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       s
                                       f
                                       
                                          (
                                          1
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                            Eq. (33) is indeed an inversion operator and belongs to 
                              F
                            under the condition that 
                              f
                              
                                 (
                                 u
                                 )
                              
                            is monotonic and can be scaled over the unit interval. In the general case, the inversion operator is only guaranteed to be valid for arc length computation.

Given functions 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                              ∈
                              F
                            it is possible to join the functions resulting in a concatenation of the functions over the domain of their parameterization. That is, if 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                            are operated on by the join operator, it results in a new function 
                              f
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ]
                              
                           , where the 
                              u
                            is a normalized reparameterization of the concatenation of the parameter domain. The join operator therefore results in a list of functions with a shared parameter domain which is scale sensitive. This implies that feature size specified by the function is inherently taken into consideration. Furthermore, the operator is closed over the defining space of functions since the results are considered to be at least piecewise smooth.

The assumption for the defining function operands to the join operator is that the functions are non-disjoint and that their end points coincide. However, this is not a requirement. For disjoint functions, a regularization operation is performed by linking the end-points through a linear interpolation. Here the linking is between the end point and start point of consecutive operands to the join operator, where the type of point is determined by the original direction of the parameterization of the operands. In such a case 
                              
                                 
                                    f
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 ]
                              
                            and the parameters 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                                 
                                    ∗
                                 
                              
                            and 
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                                 
                                    ∗
                                 
                              
                            are given an arbitrary finite range sufficient to ensure 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            continuity. An example of a regularized join operation is illustrated in Fig. 4.

The join operator is non-commutative and the results are dependent on the parameterization of the defining input functions. Another action of the join operator is that if 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                            have coincident start point 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                           , the join operator reverses the parameterization based on the preceding operand such that the function is continuous with 
                              
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ]
                              
                              →
                              
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                 
                                 ]
                              
                            with 
                              
                                 
                                    u
                                 
                                 
                                    ̃
                                 
                              
                              =
                              1
                              −
                              u
                           .

Differentiation and integration operators allow the definition of differential properties of functions and extend the expressiveness of the parametric functions as well as the domain of operations that can be performed. Furthermore, they allow defining fundamental geometric properties such as arc length. Thus, a vector tangent to a curve is obtained through the following differentiation operation: 
                              
                                 (34)
                                 
                                    
                                       t
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          d
                                          u
                                       
                                    
                                    
                                       c
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                 
                              
                            or obtain the curve length as 
                              
                                 (35)
                                 
                                    l
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ‖
                                       
                                          t
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       ‖
                                    
                                    d
                                    u
                                    .
                                 
                              
                            Again, both the differentiation operator 
                              
                                 
                                    d
                                 
                                 
                                    d
                                    u
                                 
                              
                            and integration operator 
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    u
                                 
                              
                              d
                              u
                            are also closed in 
                              F
                           .

As an example, a smooth function such as a sigmoidal function can be matched to a gaussian function by applying the differentiation operator. The converse is also true by applying the integration operator.

@&#REFERENCES@&#

