@&#MAIN-TITLE@&#On shape-preserving capability of cubic L
               1 spline fits

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We analytically quantify shape-preserving capability of cubic L1 spline fits.


                        
                        
                           
                           We propose a shape-preserving metric for the linear shape of Heaviside step function.


                        
                        
                           
                           We analytically calculate and numerically compute the metric.


                        
                        
                           
                           We find that function-value-based spline fits preserve linear shape best.


                        
                     
                  
               
            

@&#KEYPHRASES@&#




                     




                        




                           




                              L




                           




                           




                              1




                           




                        




                      spline

Shape preservation

Approximation

Spline fit

Univariate

@&#ABSTRACT@&#


               
               
                  Cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits have shown some favorable shape-preserving property for geometric data. To quantify the shape-preserving capability, we consider the basic shape of two parallel line segments in a given window. When one line segment is sufficiently longer than the other, the spline fit can preserve its linear shape in at least half of the window. We propose to use the minimum of such length difference as a shape-preserving metric because it represents the extra information that the spline fits need to preserve the shape. We analytically calculate this metric in a 3-node window for second-derivative-based, first-derivative-based and function-value-based spline fits. In a 5-node window, we compute this metric numerically. In both cases, the shape-preserving metric is rather small, which explains the observed strong shape-preserving capability of spline fits. Moreover, the function-value-based spline fits are indicated to preserve shape better than the other two types of spline fits. This study initiates a quantitative research on shape preservation of 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits.
               
            

@&#INTRODUCTION@&#

Shape preservation is an important objective in the interpolation and approximation of data with abrupt changes in magnitude and/or spacing, such as natural and urban terrain, geophysical features, robot paths, financial data and many other irregular phenomena. Over the past decade and more, 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      splines have been developed for multiscale univariate (Auquiert et al., 2007a; Cheng et al., 2002; Lavery, 2000, 2002) and bivariate (Lavery, 2001; Wang et al., 2005; Zhang et al., 2006) data and have shown excellent performances in shape preservation, such as 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating splines (Auquiert et al., 2007b; Cheng et al., 2005b; Jin et al., 2010; Nyiri et al., 2011; Yu et al., 2010), 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      smoothing splines (Cheng et al., 2005a; Lavery, 2000) and 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits (Lavery, 2004; Wang et al., 2014). Applications on urban terrain reconstruction can be seen, for example, in Bulatov and Lavery (2010) and Lin et al. (2006).

Cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits are defined by minimizing an 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      data fitting functional over a manifold of 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating splines. Such 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating splines are calculated by minimizing an 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating functional. Regarding the order of derivative that is involved in the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating functional, there are three types of spline fits which are second-derivative based, first-derivative based and function-value based, respectively (Jin et al., 2011; Lavery, 2006, 2009). Global algorithms and local moving-window approach have been designed and both produce spline fits that preserve shapes well (Lavery, 2004; Wang et al., 2014; Jin et al., 2010; Yu et al., 2010).

Nevertheless, to the best of our knowledge, no theoretic analysis on the shape-preserving capability of the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits is available while the demand for it is growing. Fundamentally, such a theory should define shape preservation in a mathematical form so that different data-approximating principles could be fairly compared. In particular, comparison of the three types of spline fits is of interest. Practically, it should enable us to explain or predict the approximating results of cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits in various circumstances. It could help users improve the spline nodes placement or acquire more data where needed. This study is the first step towards this direction. We propose a metric to assess the capability of spline fits in preserving a given linear shape. Then we compare second-derivative-based, first-derivative-based and function-value-based spline fits against this metric. Throughout this paper, by “spline fits” we refer to the univariate cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits. Bivariate splines, multivariate splines and polynomials of higher orders are beyond the scope of this paper.

One of the basic principles of shape preservation is that, if some portion of the data is aligned along a straight line segment, the spline fit should reconstruct that line segment. We consider two parallel horizontal line segments, which is a simple and often seen pattern in irregular and multiscale geometric data. For example, a building and its ground around may form such a pattern. This pattern is characterized by a Heaviside step function. Another practical significance of Heaviside step function is in G01 codes in CNC machining, where there is often data lying along a straight line and they need to be fitted by splines (Farouki and Shah, 1996). Spline fits, however, are designed to be 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -smooth and thus cannot perfectly recover the jump between the two parallel line segments. Additionally, the spline nodes in applied scenarios are usually fixed a priori. Then, the shape-preserving performance of a spline fit is highly dependent on the relative positions of spline nodes and data. In this study, we approximate the Heaviside step function by spline fits in a window of odd-number equally spaced spline nodes. Naturally, the definition of spline fits is generalized to handle not only discrete data but also functions. In this window, the two parallel line segments may have different lengths. Without loss of generality, we assume the line segment on the left is longer than the line segment on the right. When this length difference is large enough, the spline fit will preserve the linear shape of the longer line segment in at least the left half of the window. The shorter line segment is not necessarily preserved. The reason to this phenomenon is that the longer line segment provides sufficient extra information that leads the spline fit to preserve its linear shape. This extra information can be represented by the length difference between the line segments. Hence, we define the “shape-preserving metric” to be the minimum of such length difference that the linear shape of the loner line segment can be preserved. A smaller metric value indicates the stronger shape-preserving capability.

To calculate the shape-preserving metric, we develop an analytic approach in a 3-node window and a numerical procedure in a 5-node window. In the 3-node window, to keep the information contained in the Heaviside step function from being completely lost, we impose boundary conditions that the first and third spline node have the same function value and first derivative as the Heaviside step function. Then, we can solve the spline fit problem analytically and obtain the explicit relation between the length difference and the function value and first derivative at the middle spline node. Thus, the metric is the minimum length difference such that the middle spline node has the same function value and first derivative as the Heaviside step function. In the 5-node window, we keep increasing the length difference by a given precision and solve the spline fit problem numerically. The metric is the corresponding length difference when the linear shape is preserved for the first time. No boundary conditions are fixed in this case.

Results in 3-node and 5-node windows show that all three types of spline fits have relatively small shape-preserving metrics compared to the space between adjacent spline nodes. Furthermore, we find the second-derivative-based spline fits yield the biggest metric value and the function-value-based spline fits have the smallest. This suggests that the function-value-based spline fits may perform better in shape preservation than the other two types of spline fits.

The remaining of this paper is organized as follows. In Section 2, we extend the second-derivative-based cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits to function approximation and introduce first-derivative-based spline fits and function-value-based spline fits. In Section 3, we define the shape-preserving metric by approximating the Heaviside step function in a given window. In Section 4, we calculate the shape-preserving metrics for the three types of spline fits in a 3-node window with fixed boundary conditions. In Section 5, we numerically compute the shape-preserving metrics in a 5-node window. Section 6 summarizes the paper with some concluding remarks.

Cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits are originally designed in Lavery (2004) to be used for approximating discrete data and they are based on second derivatives of the splines. In this section, we extend the use of spline fits to function approximation and introduce first-derivative and function-value-based spline fits. Suppose the function to be approximated is 
                        f
                        (
                        x
                        )
                        ,
                        −
                        ∞
                        <
                        x
                        <
                        ∞
                     . Let the monotonically increasing spline nodes be 
                        
                           
                              x
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                     . The function values and first derivatives of the spline fit at these nodes are denoted by 
                        
                           
                              z
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              i
                           
                        
                     , respectively. Let 
                        z
                        =
                        (
                        
                           
                              z
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              z
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              z
                           
                           
                              I
                           
                        
                        )
                      and 
                        b
                        =
                        (
                        
                           
                              b
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              b
                           
                           
                              I
                           
                        
                        )
                     . Also let 
                        
                           
                              h
                           
                           
                              i
                           
                        
                        =
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              x
                           
                           
                              i
                           
                        
                      and 
                        Δ
                        
                           
                              z
                           
                           
                              i
                           
                        
                        =
                        
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                           
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                        
                     . We consider 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -smooth piecewise cubic polynomials 
                        z
                        (
                        x
                        )
                      with nodes 
                        
                           
                              x
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                     , of the form
                        
                           (1)
                           
                              
                                 z
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 
                                    1
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    [
                                    −
                                    (
                                    2
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    3
                                    Δ
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    2
                                    Δ
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        
                      in each interval 
                        [
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        ]
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                        −
                        1
                     . A cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fit is a function 
                        z
                        (
                        x
                        )
                      of form (1) that minimizes the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      fitting functional
                        
                           
                              
                                 F
                                 (
                                 z
                                 ,
                                 b
                                 )
                                 :
                                 =
                                 
                                    ∫
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    |
                                    z
                                    (
                                    x
                                    )
                                    −
                                    f
                                    (
                                    x
                                    )
                                    |
                                 
                                 d
                                 x
                              
                           
                        
                      over a manifold of cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating splines. The free parameters in a cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fit are the function values 
                        
                           
                              z
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                     , at the nodes. For each z, the first derivatives 
                        
                           
                              b
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                      of the corresponding interpolating spline are calculated by minimizing an 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating functional as described below.

The second-derivative-based interpolating functional is
                        
                           
                              
                                 G
                                 (
                                 b
                                 )
                                 :
                                 =
                                 
                                    ∫
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          z
                                       
                                       
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    |
                                 
                                 d
                                 x
                              
                           
                        
                      with z fixed. Therefore, the second-derivative-based spline fit optimization problem is
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             z
                                          
                                       
                                       
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             |
                                             z
                                             (
                                             x
                                             )
                                             −
                                             f
                                             (
                                             x
                                             )
                                             |
                                          
                                          d
                                          x
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          b
                                          =
                                          arg
                                          ⁡
                                          
                                             min
                                             b
                                          
                                          ⁡
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   z
                                                
                                                
                                                   d
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                          
                                          d
                                          x
                                          .
                                       
                                    
                                 
                              
                           
                        
                      The lower-level problem is called the interpolating spline problem.

For the first-derivative-based interpolating spline, the interpolating functional is
                        
                           
                              
                                 G
                                 (
                                 b
                                 )
                                 :
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       I
                                       −
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    1
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          d
                                          z
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    −
                                    
                                       
                                          d
                                          ζ
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    |
                                 
                                 d
                                 x
                              
                           
                        
                      where 
                        ζ
                        (
                        x
                        )
                      is the piecewise linear function that connects 
                        (
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              z
                           
                           
                              i
                           
                        
                        )
                        ,
                        i
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        I
                     , i.e.,
                        
                           (3)
                           
                              
                                 ζ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       Δ
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                      in each interval 
                        [
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              i
                              +
                              1
                           
                        
                        ]
                     . Consequently, the first-derivative-based spline fit optimization problem is
                        
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             z
                                          
                                       
                                       
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             |
                                             z
                                             (
                                             x
                                             )
                                             −
                                             f
                                             (
                                             x
                                             )
                                             |
                                          
                                          d
                                          x
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          b
                                          =
                                          arg
                                          ⁡
                                          
                                             min
                                             b
                                          
                                          ⁡
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                I
                                                −
                                                1
                                             
                                          
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             1
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   d
                                                   z
                                                
                                                
                                                   d
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   d
                                                   ζ
                                                
                                                
                                                   d
                                                   x
                                                
                                             
                                             |
                                          
                                          d
                                          x
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The function-value-based interpolating functional is
                        
                           
                              
                                 G
                                 (
                                 b
                                 )
                                 :
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       I
                                       −
                                       1
                                    
                                 
                                 
                                    ∫
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    1
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    |
                                    z
                                    (
                                    x
                                    )
                                    −
                                    ζ
                                    (
                                    x
                                    )
                                    |
                                 
                                 d
                                 x
                              
                           
                        
                      where 
                        ζ
                        (
                        x
                        )
                      is the same as in (3). The function-value-based spline fit optimization problem is
                        
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             z
                                          
                                       
                                       
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   I
                                                
                                             
                                          
                                          
                                             |
                                             z
                                             (
                                             x
                                             )
                                             −
                                             f
                                             (
                                             x
                                             )
                                             |
                                          
                                          d
                                          x
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          b
                                          =
                                          arg
                                          ⁡
                                          
                                             min
                                             b
                                          
                                          ⁡
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                I
                                                −
                                                1
                                             
                                          
                                          
                                             ∫
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             1
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             |
                                             z
                                             (
                                             x
                                             )
                                             −
                                             ζ
                                             (
                                             x
                                             )
                                             |
                                          
                                          d
                                          x
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

For each given z, we denote the optimal solution to the interpolating spline problem by 
                        
                           
                              b
                           
                           
                              ⁎
                           
                        
                        (
                        z
                        )
                     . The optimal solution to the spline fit problem is denoted by 
                        
                           
                              z
                           
                           
                              ⁎
                           
                        
                     .

Consider the following Heaviside step function with a jump at 
                        x
                        =
                        ϵ
                        ≥
                        0
                     :
                        
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             if 
                                             x
                                             ≤
                                             ϵ
                                             ,
                                          
                                       
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             if 
                                             x
                                             >
                                             ϵ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                      
                     
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                      characterizes the geometric pattern of two parallel line segments, as shown in Fig. 1
                     . W.l.o.g., the gap between two parallel line segments is set to be 1. We approximate 
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                      in a window of 
                        I
                        +
                        1
                      equally spaced spline nodes 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        =
                        −
                        
                           I
                           2
                        
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              I
                              /
                              2
                           
                        
                        =
                        0
                        ,
                        …
                        ,
                        
                           
                              x
                           
                           
                              I
                           
                        
                        =
                        
                           I
                           2
                        
                      where 
                        I
                        ≥
                        2
                      is an even number. For convenience, the splines nodes are set to be equally spaced and the space between each two adjacent nodes is 1. General spacing settings can be handled without difficulty. If the spline fit 
                        z
                        (
                        x
                        )
                      satisfies 
                        z
                        (
                        x
                        )
                        =
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                      for all 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        =
                        −
                        
                           I
                           2
                        
                        ≤
                        x
                        ≤
                        0
                        =
                        
                           
                              x
                           
                           
                              I
                              /
                              2
                           
                        
                     , we say the spline fit ϵ-preserves the linear shape. (If not specified otherwise, we use “preserve” instead of “ϵ-preserve” for simplicity.) For example, it is easy to see that when 
                        ϵ
                        =
                        
                           I
                           2
                        
                     , we have 
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                        =
                        0
                     . The spline fit satisfies 
                        
                           
                              z
                           
                           
                              i
                           
                        
                        =
                        
                           
                              b
                           
                           
                              i
                           
                        
                        =
                        0
                     , 
                        i
                        =
                        0
                        ,
                        …
                        ,
                        I
                      and preserves the linear shape.

The spline fit can preserve the linear shape when the longer line segment contains sufficient extra information over the shorter one. Such extra information is represented by the length difference of the two parallel line segments in 
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                     , which is 2ϵ. For simplicity, we use ϵ to denote this length difference. We propose the shape-preserving metric as defined below.


                     
                        Definition 1
                        The ϵ-shape-preserving metric 
                              
                                 
                                    ϵ
                                 
                                 
                                    ⁎
                                 
                              
                            of cubic 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                            spline fits for approximating 
                              
                                 
                                    H
                                 
                                 
                                    ϵ
                                 
                              
                              (
                              x
                              )
                            is defined as the minimum of such ϵ that the spline fit 
                              z
                              (
                              x
                              )
                            satisfies 
                              z
                              (
                              x
                              )
                              =
                              
                                 
                                    H
                                 
                                 
                                    ϵ
                                 
                              
                              (
                              x
                              )
                            for 
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ≤
                              x
                              ≤
                              
                                 
                                    x
                                 
                                 
                                    I
                                    /
                                    2
                                 
                              
                           .

For simplicity, we use “shape-preserving metric” to refer to “ϵ-shape-preserving metric” in the rest of this paper.

The existence of 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                      is guaranteed. Actually, 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                        ≤
                        
                           I
                           2
                        
                     . As we will show in the later sections, when 
                        ϵ
                        <
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                     , the spline fit fails to preserve the linear shape. When 
                        ϵ
                        ≥
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                     , the spline fit preserves the linear shape. Fig. 1 illustrates that the second-derivative-based spline fit fails to preserve the linear shape of 
                        
                           
                              H
                           
                           
                              0
                           
                        
                        (
                        x
                        )
                      in a 5-node window. Fig. 2
                      illustrates the second-derivative-based spline fit preserves the linear shape of 
                        
                           
                              H
                           
                           
                              0.5
                           
                        
                        (
                        x
                        )
                      in a 5-node window.

In this section, we calculate 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                      for the three types of spline fits in a 3-node window, i.e., 
                        I
                        =
                        2
                     . Noting that a 3-node window is relatively small, we impose boundary conditions so that the information of 
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                      can be contained at the boundary. Specifically, we set
                        
                           (4)
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                  and 
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                      That means that, the boundary nodes coincide with 
                        
                           
                              H
                           
                           
                              ϵ
                           
                        
                        (
                        x
                        )
                      in terms of function values and first derivatives. In this case, the linear shape will be preserved for 
                        −
                        1
                        ≤
                        x
                        ≤
                        0
                      if 
                        
                           
                              z
                           
                           
                              1
                           
                        
                        =
                        0
                      and 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        =
                        0
                     .

We adopt an analytic approach. For second-derivative-based spline fits, we can solve the interpolating spline problem in (2) for the first derivative 
                        
                           
                              b
                           
                           
                              1
                           
                        
                     , which is a function in 
                        
                           
                              z
                           
                           
                              1
                           
                        
                     . Then we solve the spline fit problem (2) and analyze the relation between the optimal solution 
                        
                           
                              z
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                      and ϵ. We prove that there exists 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                        >
                        0
                      such that 
                        
                           
                              z
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                        =
                        0
                      if and only if 
                        ϵ
                        ≥
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                     . In this case, 
                        
                           
                              b
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                        (
                        
                           
                              z
                           
                           
                              1
                           
                           
                              ⁎
                           
                        
                        )
                        =
                        0
                      and thus spline fit preserves linear shape. The value of 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                      can be analytically calculated. Shape-preserving metrics of first-derivative-based and function-value-based spline fits are calculated by similar procedures.

The solution to the interpolating spline problem is given by the following theorem:


                        
                           Theorem 1
                           
                              Given 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                              , the first derivative 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                               
                              that minimizes the second-derivative-based 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               
                              interpolating functional 
                              
                                 
                                    ∫
                                    
                                       −
                                       1
                                    
                                    1
                                 
                                 
                                    |
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          z
                                       
                                       
                                          d
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    |
                                 
                                 d
                                 x
                               
                              is a function of 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               
                              with the following explicit form:
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      4
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      0
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      
                                                         1
                                                         4
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         1
                                                         4
                                                      
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      
                                                         2
                                                         5
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         smaller root of 
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         12
                                                      
                                                      (
                                                      6
                                                      −
                                                      
                                                         2
                                                      
                                                      
                                                         
                                                            21
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  81
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  −
                                                                  156
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  +
                                                                  76
                                                                  )
                                                               
                                                            
                                                            −
                                                            38
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            18
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         2
                                                         5
                                                      
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      
                                                         1
                                                         2
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         smaller root of 
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         1
                                                         12
                                                      
                                                      (
                                                      6
                                                      +
                                                      
                                                         2
                                                      
                                                      
                                                         
                                                            21
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  81
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  −
                                                                  156
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  +
                                                                  76
                                                                  )
                                                               
                                                            
                                                            −
                                                            38
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            18
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         1
                                                         2
                                                      
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      
                                                         3
                                                         5
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         3
                                                         5
                                                      
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      <
                                                      
                                                         3
                                                         4
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      4
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         3
                                                         4
                                                      
                                                      <
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ≤
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      >
                                                      1
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

By direct calculation, we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                (
                                                −
                                                1
                                                )
                                                =
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                6
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                             
                                             
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                (
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      −
                                                   
                                                
                                                )
                                                =
                                                4
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                6
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                (
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                                =
                                                −
                                                4
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                6
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                6
                                                ,
                                             
                                             
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ″
                                                   
                                                
                                                (
                                                1
                                                )
                                                =
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                6
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                6
                                                .
                                             
                                          
                                       
                                    
                                 
                               Note that 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 x
                                 )
                               is discontinuous at 
                                 x
                                 =
                                 0
                              . The expression of 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               depends on the signs of 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 1
                                 )
                              . Accordingly, there are 11 cases as shown in Table 1
                              , along with their defining linear inequalities in terms of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . The second column denotes the signs of (
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       −
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 1
                                 )
                              ). Fig. 3
                               illustrates the 11 cases in a 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               plane. Within each case, we minimize 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for any given 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and denote its minimizer by 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . The results are listed in Table 1. We use Case 9 and Case 5 as examples to show how to find 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              .

In Case 9, 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                                 ≤
                                 0
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 ≥
                                 0
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 ≤
                                 0
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 1
                                 )
                                 ≥
                                 0
                              . The roots of 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                               in 
                                 [
                                 −
                                 1
                                 ,
                                 0
                                 ]
                               and 
                                 [
                                 0
                                 ,
                                 1
                                 ]
                               are
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                3
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                           and 
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                3
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                               respectively. Hence, for any fixed 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              ,
                                 
                                    
                                       
                                          G
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             1
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          =
                                          2
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          ]
                                          .
                                       
                                    
                                 
                               The first derivative of 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          2
                                          
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   3
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   3
                                                   )
                                                
                                                
                                                   3
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         2
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   3
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   3
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             +
                                             1
                                             ]
                                          
                                          .
                                       
                                    
                                 
                               Note that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . Then 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 0
                               for all 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 R
                              . Therefore, the minimizer 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                               of 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               in this case is
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          max
                                          ⁡
                                          {
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          3
                                          (
                                          1
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          }
                                          .
                                       
                                    
                                 
                               
                              
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 0
                               in this case.

In Case 5, 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                                 ≥
                                 0
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       −
                                    
                                 
                                 )
                                 ≤
                                 0
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 ≥
                                 0
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 1
                                 )
                                 ≤
                                 0
                              . We have
                                 
                                    
                                       
                                          G
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             0
                                          
                                          
                                          −
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                          +
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             1
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                             
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          =
                                          2
                                          [
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          ]
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          2
                                          
                                             [
                                             −
                                             
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   3
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   3
                                                   )
                                                
                                                
                                                   3
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         2
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   3
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   3
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             1
                                             ]
                                          
                                          .
                                       
                                    
                                 
                               Within this case, for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              , we have 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 −
                                 
                                    
                                       2
                                       (
                                       3
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       1
                                       )
                                       (
                                       11
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       5
                                       )
                                    
                                    
                                       
                                          (
                                          5
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          2
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ≤
                                 0
                              . Consequently, 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . We also have 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    3
                                    2
                                 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                              , 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    3
                                    2
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for 
                                 
                                    3
                                    5
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                              , and 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 1
                              .

For 
                                 
                                    2
                                    5
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              , we have 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    3
                                    2
                                 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≥
                                 0
                               and 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 0
                                 )
                                 <
                                 0
                              . Hence, 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               solves the equation 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              . Fig. 4
                               shows the curve 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              . We can see that in the region corresponding to Case 5, 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is the smaller root of the equation 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              . Finding an explicit form of 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is a difficult task. (We tried in Mathematica and the obtained expression of 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is complicated and inaccurate.) Nevertheless, by simplifying 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              , we have
                                 
                                    (6)
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             1
                                             12
                                          
                                          (
                                          6
                                          −
                                          
                                             2
                                          
                                          
                                             
                                                21
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      81
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      156
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      76
                                                      )
                                                   
                                                
                                                −
                                                38
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                18
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                               Therefore, for 
                                 
                                    2
                                    5
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              , 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is the smaller root of Equation (6).

For 
                                 
                                    1
                                    2
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    3
                                    5
                                 
                              , 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is the smaller root of the equation
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             1
                                             12
                                          
                                          (
                                          6
                                          +
                                          
                                             2
                                          
                                          
                                             
                                                21
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      81
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      156
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      76
                                                      )
                                                   
                                                
                                                −
                                                38
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                18
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                              
                           

Similarly, we can calculate 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               and the sign of 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for all other cases. Note that 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is continuous and convex in 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              . Then 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               should be the 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               that satisfies 
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              . By observing Table 1, we have the expression as in Equation (5). Fig. 5
                               shows the graph of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              .  □

Now we study the 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         fitting functional and calculate the shape-preserving metric 
                           
                              
                                 ϵ
                              
                              
                                 ⁎
                              
                           
                        .


                        
                           Lemma 1
                           
                              For two splines 
                              
                                 z
                                 (
                                 x
                                 )
                               
                              and 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               
                              in the 3-node window with boundary conditions 
                              
                                 (4)
                              
                              , if 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              , then 
                              
                                 z
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 z
                                 (
                                 −
                                 x
                                 )
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 −
                                 x
                                 )
                               
                              for 
                              
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 1
                              
                              .
                           

When 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              , we have
                                 
                                    
                                       
                                          z
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             1
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          Δ
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          [
                                          3
                                          −
                                          
                                             2
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ]
                                          =
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          1
                                          −
                                          3
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          z
                                          (
                                          −
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          −
                                          x
                                          )
                                          =
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                (
                                                −
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          Δ
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          [
                                          3
                                          −
                                          
                                             2
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          (
                                          −
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ]
                                          =
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          1
                                          −
                                          3
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          )
                                          .
                                       
                                    
                                 
                               Therefore, 
                                 z
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 z
                                 (
                                 −
                                 x
                                 )
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 −
                                 x
                                 )
                               for 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              . Similar proof applies to 
                                 0
                                 ≤
                                 x
                                 ≤
                                 1
                              .  □


                        
                           Lemma 2
                           
                              Given any 
                              
                                 0
                                 <
                                 ϵ
                                 ≤
                                 1
                              
                              , 
                              
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               
                              holds for the second-derivative-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                              
                              .
                           

We prove this lemma by considering different ranges of 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               according to the expression of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              .

First, we prove that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . Consider two splines 
                                 z
                                 (
                                 x
                                 )
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               with 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 >
                                 
                                    1
                                    2
                                 
                               and 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . By symmetry, the first derivatives at node 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                               for both splines are equal, i.e., 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . We have 
                                 z
                                 (
                                 x
                                 )
                                 =
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 −
                                 x
                                 )
                               and
                                 
                                    
                                       
                                          z
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          
                                             1
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          Δ
                                          
                                             
                                                z
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          Δ
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          [
                                          3
                                          −
                                          
                                             2
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ]
                                          ≥
                                          0
                                       
                                    
                                 
                               for all 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              . By Lemma 1 we have 
                                 z
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 ≥
                                 0
                               for 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 1
                              . When 
                                 ϵ
                                 =
                                 0
                              , we know 
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                              . When 
                                 0
                                 <
                                 ϵ
                                 ≤
                                 1
                              , we consider
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ϵ
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          −
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          =
                                          
                                             ∫
                                             0
                                             ϵ
                                          
                                          [
                                          |
                                          z
                                          (
                                          x
                                          )
                                          −
                                          0
                                          |
                                          −
                                          |
                                          z
                                          (
                                          x
                                          )
                                          −
                                          1
                                          |
                                          ]
                                          d
                                          x
                                          =
                                          
                                             ∫
                                             0
                                             ϵ
                                          
                                          [
                                          z
                                          (
                                          x
                                          )
                                          −
                                          |
                                          z
                                          (
                                          x
                                          )
                                          −
                                          1
                                          |
                                          ]
                                          d
                                          x
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ϵ
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          −
                                          
                                             
                                                F
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          =
                                          
                                             ∫
                                             0
                                             ϵ
                                          
                                          [
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          0
                                          |
                                          −
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          1
                                          |
                                          ]
                                          d
                                          x
                                          =
                                          
                                             ∫
                                             0
                                             ϵ
                                          
                                          [
                                          |
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          |
                                          −
                                          1
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          ]
                                          d
                                          x
                                          .
                                       
                                    
                                 
                              
                              
                                 
                                    (1)
                                    If 
                                          
                                             1
                                             2
                                          
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          
                                             3
                                             4
                                          
                                       , then 
                                          
                                             1
                                             2
                                          
                                          <
                                          z
                                          (
                                          x
                                          )
                                          <
                                          1
                                        and 
                                          0
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          <
                                          z
                                          (
                                          x
                                          )
                                        for 
                                          0
                                          ≤
                                          x
                                          ≤
                                          ϵ
                                       . Hence,
                                          
                                             
                                                
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   |
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   |
                                                   =
                                                   2
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   >
                                                   2
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   =
                                                   |
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   |
                                                   −
                                                   1
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    

If 
                                          
                                             3
                                             4
                                          
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          1
                                       , then 
                                          0
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          <
                                          min
                                          ⁡
                                          {
                                          z
                                          (
                                          x
                                          )
                                          ,
                                          1
                                          }
                                        for 
                                          0
                                          ≤
                                          x
                                          ≤
                                          ϵ
                                       . Hence,
                                          
                                             
                                                
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   |
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   |
                                                   =
                                                   min
                                                   ⁡
                                                   {
                                                   2
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   ,
                                                   1
                                                   }
                                                   >
                                                   2
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   =
                                                   |
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   |
                                                   −
                                                   1
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    

If 
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          1
                                       , then 
                                          z
                                          (
                                          x
                                          )
                                          >
                                          1
                                        and 
                                          
                                             
                                                z
                                             
                                             
                                                ˜
                                             
                                          
                                          (
                                          x
                                          )
                                          <
                                          1
                                        for 
                                          0
                                          ≤
                                          x
                                          ≤
                                          ϵ
                                       . Hence,
                                          
                                             
                                                
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   |
                                                   z
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   |
                                                   =
                                                   1
                                                   >
                                                   max
                                                   ⁡
                                                   {
                                                   2
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   −
                                                   1
                                                   ,
                                                   −
                                                   1
                                                   }
                                                   =
                                                   |
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   |
                                                   −
                                                   1
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    

Second, we prove that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                              . Suppose that 
                                 
                                    2
                                    5
                                 
                                 <
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . It is easy to see there exists 
                                 
                                    1
                                    4
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                               such that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . Notice that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . Thus, we have 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 ≤
                                 z
                                 (
                                 x
                                 )
                                 ≤
                                 1
                               for all 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 1
                               and the equality holds only at 
                                 x
                                 =
                                 −
                                 1
                               and 1. By Lemma 1, we know 
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       1
                                    
                                    
                                       −
                                       ϵ
                                    
                                 
                                 |
                                 z
                                 (
                                 x
                                 )
                                 −
                                 0
                                 |
                                 d
                                 x
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       1
                                    
                                    
                                       −
                                       ϵ
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 0
                                 |
                                 d
                                 x
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       ϵ
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 1
                                 |
                                 d
                                 x
                                 −
                                 
                                    
                                       ∫
                                    
                                    
                                       ϵ
                                    
                                    
                                       1
                                    
                                 
                                 |
                                 z
                                 (
                                 x
                                 )
                                 −
                                 1
                                 |
                                 d
                                 x
                              . Note 
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       ϵ
                                    
                                    
                                       ϵ
                                    
                                 
                                 |
                                 z
                                 (
                                 x
                                 )
                                 −
                                 0
                                 |
                                 d
                                 x
                                 >
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       ϵ
                                    
                                    
                                       ϵ
                                    
                                 
                                 |
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 0
                                 |
                                 d
                                 x
                              . Hence, 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 >
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                              . Consequently, 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                              .

Third, we show that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              . When 
                                 
                                    1
                                    4
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . Then, the fitting functional becomes
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ϵ
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             2
                                          
                                          −
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   4
                                                
                                             
                                             2
                                          
                                          −
                                          
                                             
                                                2
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                z
                                             
                                             3
                                          
                                          +
                                          
                                             
                                                2
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             3
                                          
                                          −
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          ϵ
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          ϵ
                                          +
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             6
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          .
                                       
                                    
                                 
                               The first derivative in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               is
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             6
                                          
                                          (
                                          3
                                          
                                             
                                                ϵ
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          4
                                          
                                             
                                                ϵ
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          6
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          12
                                          ϵ
                                          +
                                          1
                                          )
                                          =
                                          
                                             1
                                             6
                                          
                                          [
                                          3
                                          
                                             
                                                ϵ
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          4
                                          ϵ
                                          (
                                          1
                                          −
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          +
                                          6
                                          ϵ
                                          (
                                          1
                                          −
                                          ϵ
                                          )
                                          +
                                          2
                                          ϵ
                                          +
                                          1
                                          ]
                                          >
                                          0
                                          .
                                       
                                    
                                 
                               Therefore, the minimum 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                               of 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    2
                                    5
                                 
                               satisfies 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              .

Finally, we prove that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≥
                                 0
                              . Suppose that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 0
                              . Then we know 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                              . For 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              , 
                                 z
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       +
                                       x
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 −
                                 2
                                 x
                                 )
                                 ≤
                                 0
                              . For 
                                 0
                                 ≤
                                 x
                                 ≤
                                 1
                              , 
                                 z
                                 (
                                 x
                                 )
                                 =
                                 3
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 −
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . It is easy to verify that 
                                 
                                    
                                       z
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 ≥
                                 0
                              . Thus, 
                                 z
                                 (
                                 x
                                 )
                                 =
                                 0
                               has one root in 
                                 0
                                 ≤
                                 x
                                 ≤
                                 1
                              . Denote this root by 
                                 r
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                              . Using the implicit function theorem, we have
                                 
                                    
                                       
                                          
                                             
                                                d
                                                r
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                
                                                   ∂
                                                   z
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∂
                                                   z
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                −
                                                3
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                
                                                +
                                                1
                                             
                                             
                                                6
                                                x
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                1
                                                −
                                                x
                                                )
                                             
                                          
                                          ≤
                                          0
                                          .
                                       
                                    
                                 
                               Hence, 
                                 r
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               decreases as 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               increases. For any 
                                 0
                                 <
                                 ϵ
                                 ≤
                                 1
                              , there exists some node function value 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ϵ
                                 )
                               such that 
                                 r
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 )
                                 =
                                 ϵ
                              . When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ϵ
                                 )
                              , we can easily see 
                                 z
                                 (
                                 x
                                 )
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 x
                                 )
                               and, consequently, 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                                 >
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                              . When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 <
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              ,
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ϵ
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             0
                                          
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                r
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                r
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             ϵ
                                          
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             ϵ
                                             1
                                          
                                          1
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          .
                                       
                                    
                                 
                               Taking the derivative with respect to 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , we have
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             0
                                          
                                          −
                                          
                                             
                                                d
                                                z
                                                (
                                                x
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                r
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                d
                                                z
                                                (
                                                x
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                r
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             ϵ
                                          
                                          
                                             
                                                d
                                                z
                                                (
                                                x
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             ϵ
                                             1
                                          
                                          −
                                          
                                             
                                                d
                                                z
                                                (
                                                x
                                                )
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          .
                                       
                                    
                                 
                               Notice that 
                                 
                                    
                                       d
                                       z
                                       (
                                       x
                                       )
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               for 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 1
                              . By direct calculation, we have 
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       1
                                    
                                    
                                       0
                                    
                                 
                                 −
                                 
                                    
                                       d
                                       z
                                       (
                                       x
                                       )
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 d
                                 x
                                 +
                                 
                                    
                                       ∫
                                    
                                    
                                       0
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       d
                                       z
                                       (
                                       x
                                       )
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 d
                                 x
                                 =
                                 0
                              . Hence, 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≤
                                 0
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≥
                                 0
                              .

Combining all arguments above, we have 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              .  □


                        
                           Theorem 2
                           
                              Fix 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               
                              in the 3-node window. The second-derivative-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               
                              preserves its linear shape in 
                              
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              
                              , i.e., 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 0
                              
                              , if and only if 
                              
                                 ϵ
                                 ≥
                                 0.250
                              
                              . This means that the shape-preserving metric of second-derivative-based spline fits is 0.250.
                           

To solve the spline fit problem, we only need to consider 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              . In this range of 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 4
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . This means 
                                 
                                    
                                       z
                                    
                                    
                                       ″
                                    
                                 
                                 (
                                 −
                                 1
                                 )
                                 ≤
                                 0
                               and the cubic 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               spline fit intersects with 
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               in the interval 
                                 −
                                 1
                                 <
                                 x
                                 <
                                 0
                               at another point besides 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                              . Solve the equation 
                                 z
                                 (
                                 x
                                 )
                                 =
                                 0
                              , we have this point 
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       4
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       2
                                    
                                 
                              . The cubic 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               spline fit has no other intersection with 
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               than 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                               in the interval 
                                 0
                                 ≤
                                 x
                                 ≤
                                 1
                               because 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 <
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               when 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              .

The 
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               fitting functional then becomes
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      1
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                [
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                −
                                                z
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                                +
                                                
                                                   ∫
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   0
                                                
                                                [
                                                z
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                                +
                                                
                                                   ∫
                                                   0
                                                   ϵ
                                                
                                                [
                                                z
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                                +
                                                
                                                   ∫
                                                   ϵ
                                                   1
                                                
                                                [
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                −
                                                z
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                −
                                                2
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                3
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                
                                                   
                                                      16
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   3
                                                
                                                −
                                                
                                                   
                                                      22
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   3
                                                
                                                +
                                                2
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                4
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                4
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                2
                                                ϵ
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                ϵ
                                             
                                          
                                          
                                             
                                             
                                                −
                                                
                                                   
                                                      8
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                      
                                                         
                                                            (
                                                            2
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      8
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                      
                                                         
                                                            (
                                                            2
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   3
                                                
                                                +
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         2
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      5
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   6
                                                
                                                −
                                                
                                                   
                                                      3
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                      
                                                         
                                                            (
                                                            2
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            1
                                                            )
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               The first derivative in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               is
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ϵ
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            ⁎
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                (
                                                3
                                                −
                                                4
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                +
                                                
                                                   2
                                                   3
                                                
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                16
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                11
                                                )
                                                +
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                4
                                                −
                                                8
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                +
                                                2
                                                ϵ
                                                +
                                                
                                                   
                                                      4
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      73
                                                      −
                                                      64
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      3
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      2
                                                      )
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      4
                                                      )
                                                      )
                                                      −
                                                      31
                                                   
                                                   
                                                      48
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            2
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               Then we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ∂
                                                ϵ
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          −
                                          2
                                          
                                             
                                                (
                                                ϵ
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          ϵ
                                          (
                                          8
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          6
                                          )
                                          −
                                          1
                                          )
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                2
                                                (
                                                37
                                                −
                                                64
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                11
                                             
                                             
                                                12
                                                
                                                   
                                                      (
                                                      2
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             4
                                             3
                                          
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          ϵ
                                          (
                                          3
                                          ϵ
                                          −
                                          8
                                          )
                                          +
                                          6
                                          )
                                          .
                                       
                                    
                                 
                               It is easy to verify that 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ≥
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               and 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 1
                              . Notice that 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   0.5
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 0
                              . Therefore, 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             0.5
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                              . Then 
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   0.5
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ≥
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   0.5
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 
                                    15
                                    24
                                 
                                 >
                                 0
                              . On the other hand, 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       ϵ
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               and 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 1
                              . Hence, 
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               and 
                                 0.5
                                 ≤
                                 ϵ
                                 ≤
                                 1
                              . This implies that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               for 
                                 0.5
                                 ≤
                                 ϵ
                                 ≤
                                 1
                               and 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 0.5
                              .

When 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               and 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 0.5
                              , by noticing 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               is decreasing in ϵ, we have 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ≥
                                       
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   0.5
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 
                                 =
                                 0
                              . Consequently, 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               is convex in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                               for 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 0.5
                              . Then 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               minimizes 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               if 
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 ≥
                                 0
                              . By direct calculation we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ϵ
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            ⁎
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          3
                                          
                                             
                                                ϵ
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          
                                             
                                                22
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             3
                                          
                                          +
                                          4
                                          
                                             
                                                ϵ
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          ϵ
                                          −
                                          
                                             31
                                             48
                                          
                                          .
                                       
                                    
                                 
                               Recall that 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       ϵ
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                              . Solve the equation 
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 0
                               and we have its unique solution
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   11
                                                   18
                                                
                                                −
                                                
                                                   1
                                                   18
                                                
                                                
                                                   
                                                      
                                                         7
                                                         2
                                                      
                                                      
                                                         (
                                                         9
                                                         
                                                            
                                                               7
                                                               −
                                                               
                                                                  22
                                                               
                                                            
                                                            3
                                                         
                                                         +
                                                         9
                                                         
                                                            
                                                               7
                                                               +
                                                               
                                                                  22
                                                               
                                                            
                                                            3
                                                         
                                                         +
                                                         14
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                +
                                                
                                                   1
                                                   18
                                                
                                                
                                                   
                                                      
                                                         7
                                                         2
                                                      
                                                      
                                                         (
                                                         −
                                                         9
                                                         
                                                            
                                                               7
                                                               −
                                                               
                                                                  22
                                                               
                                                            
                                                            3
                                                         
                                                         −
                                                         9
                                                         
                                                            
                                                               7
                                                               +
                                                               
                                                                  22
                                                               
                                                            
                                                            3
                                                         
                                                         +
                                                         28
                                                         
                                                            
                                                               14
                                                               
                                                                  9
                                                                  
                                                                     
                                                                        7
                                                                        −
                                                                        
                                                                           22
                                                                        
                                                                     
                                                                     3
                                                                  
                                                                  +
                                                                  9
                                                                  
                                                                     
                                                                        7
                                                                        +
                                                                        
                                                                           22
                                                                        
                                                                     
                                                                     3
                                                                  
                                                                  +
                                                                  14
                                                               
                                                            
                                                         
                                                         +
                                                         28
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                ≃
                                             
                                             
                                                0.250
                                                .
                                             
                                          
                                       
                                    
                                 
                               Therefore, when 
                                 ϵ
                                 ≥
                                 0.250
                              , the second-derivative-based spline fit for 
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               satisfies 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 0
                              .  □


                        
                           Theorem 3
                           
                              Given 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                              , the first derivative 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                               
                              that minimizes the first-derivative-based 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               
                              interpolating functional 
                              
                                 
                                    ∫
                                    
                                       −
                                       1
                                    
                                    1
                                 
                                 
                                    |
                                    
                                       
                                          d
                                          z
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    −
                                    
                                       
                                          d
                                          ζ
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    |
                                 
                                 d
                                 x
                               
                              satisfies the following properties:
                              
                                 
                                    
                                       (1)
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                       , if 
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          0
                                       
                                       ,
                                    


                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                       
                                       , if 
                                       
                                          0
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          0.255443
                                       
                                       ,
                                    


                                       
                                          0
                                          <
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                       
                                       , if 
                                       
                                          0.255443
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          
                                             1
                                             2
                                          
                                       
                                       ,
                                    


                                       
                                          0
                                          <
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          1
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                       
                                       , if 
                                       
                                          
                                             1
                                             2
                                          
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          0.755443
                                       
                                       ,
                                    


                                       
                                          1
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          2
                                          (
                                          1
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       , if 
                                       
                                          0.755443
                                          <
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          1
                                       
                                       ,
                                    


                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                       , if 
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          1
                                       
                                       .
                                    


                        
                           Proof
                           Note that the interpolating functional 
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 
                                    |
                                    
                                       
                                          d
                                          z
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    −
                                    
                                       
                                          d
                                          ζ
                                       
                                       
                                          d
                                          x
                                       
                                    
                                    |
                                 
                                 d
                                 x
                               is convex in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                              . Consequently, 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is convex in 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                               for any given 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              .

When 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              , we have
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          =
                                          3
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                x
                                                +
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          x
                                          +
                                          1
                                          )
                                       
                                    
                                 
                               and 
                                 
                                    
                                       ζ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              .

When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , the equation 
                                 
                                    
                                       z
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       ζ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                               has two roots in 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              . Moreover,
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      3
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      3
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                3
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      3
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      3
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                3
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             0
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          ,
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                d
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          −
                                          
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             0
                                          
                                          
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                x
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                          .
                                       
                                    
                                 
                               When 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                              , we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                3
                                                
                                                   3
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                3
                                                
                                                   3
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Similarly, when 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , we can calculate
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                3
                                                
                                                   3
                                                
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          −
                                          
                                             1
                                             
                                                3
                                                
                                                   3
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                               Hence,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  G
                                                               
                                                               
                                                                  d
                                                                  
                                                                     
                                                                        b
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            |
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  G
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                               Therefore, 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              .

When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 0
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 2
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , the equation 
                                 
                                    
                                       z
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 
                                    
                                       ζ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 0
                               has one root 
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                               in 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                               and the following two roots 
                                 
                                    
                                       w
                                    
                                    
                                       3
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       4
                                    
                                 
                               in 
                                 0
                                 ≤
                                 x
                                 ≤
                                 1
                              :
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      3
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      3
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                3
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                4
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      3
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      3
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                −
                                                2
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                3
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                3
                                                (
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                2
                                                (
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                               Then
                                 
                                    
                                       
                                          G
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             0
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                
                                                   w
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          +
                                          
                                             ∫
                                             
                                                
                                                   w
                                                
                                                
                                                   3
                                                
                                             
                                             1
                                          
                                          
                                             
                                                ζ
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          x
                                          )
                                          d
                                          x
                                          .
                                       
                                    
                                 
                               We can verify that 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       2
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 >
                                 0
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    3
                                 
                               and 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       1
                                       −
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 >
                                 0
                               for 
                                 
                                    1
                                    3
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . Furthermore, 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               is increasing in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              , 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 <
                                 0
                               and 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 >
                                 0
                              . Denote the root of 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       |
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 0
                               by θ. We can compute 
                                 θ
                                 ≈
                                 0.255443
                              . Therefore, 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 2
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , if 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0.255443
                              . Moreover, 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , if 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              .

When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 0
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , we can calculate
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      G
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             2
                                             
                                                3
                                                
                                                   3
                                                
                                             
                                          
                                          <
                                          0
                                          .
                                       
                                    
                                 
                               Then 
                                 0
                                 <
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , if 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . The remaining part of the theorem holds by symmetry.  □


                        Fig. 6
                         shows the graph of 
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           (
                           
                              
                                 z
                              
                              
                                 1
                              
                           
                           )
                        .


                        
                           Lemma 3
                           
                              Given any 
                              
                                 0
                                 <
                                 ϵ
                                 ≤
                                 1
                              
                              , 
                              
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                               
                              holds for the first-derivative-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                              
                              .
                           

Note that 
                                 0
                                 ≤
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for 
                                 
                                    1
                                    2
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 1
                              , and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              . The proof of Lemma 2 can be applied.  □


                        
                           Theorem 4
                           
                              Fix 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               
                              in the 3-node window. The first-derivative-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               
                              preserves its linear shape in 
                              
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              
                              , i.e., 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 0
                              
                              , if and only if 
                              
                                 ϵ
                                 ≥
                                 0.109
                              
                              . This means that the shape-preserving metric of first-derivative-based spline fits is 0.109.
                           

We only need to consider 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . First, we prove that 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               minimizes 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               locally in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0.255443
                               only if 
                                 ϵ
                                 ≥
                                 0.109
                              . Second, that we prove when 
                                 ϵ
                                 ≥
                                 0.109
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               minimizes 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               globally in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              .

We notice that 
                                 0
                                 ≤
                                 z
                                 (
                                 x
                                 )
                                 ≤
                                 1
                               for 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 1
                               because 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 <
                                 min
                                 ⁡
                                 {
                                 3
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 }
                              . Therefore,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∫
                                                   
                                                      −
                                                      1
                                                   
                                                   0
                                                
                                                [
                                                z
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                                +
                                                
                                                   ∫
                                                   0
                                                   ϵ
                                                
                                                [
                                                z
                                                (
                                                x
                                                )
                                                −
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                                +
                                                
                                                   ∫
                                                   ϵ
                                                   1
                                                
                                                [
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                x
                                                )
                                                −
                                                z
                                                (
                                                x
                                                )
                                                ]
                                                d
                                                x
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      2
                                                   
                                                   −
                                                   
                                                      
                                                         4
                                                         
                                                            
                                                               ϵ
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      3
                                                   
                                                   +
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      6
                                                   
                                                   )
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   −
                                                   2
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   2
                                                   ϵ
                                                   )
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                +
                                                2
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                −
                                                ϵ
                                                +
                                                
                                                   1
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               The first derivative in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               is
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                2
                                             
                                             −
                                             
                                                
                                                   4
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                3
                                             
                                             +
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                1
                                                6
                                             
                                             )
                                          
                                          
                                             
                                                d
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   4
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             2
                                             ϵ
                                             )
                                          
                                          .
                                       
                                    
                                 
                               The second derivative in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               is
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      4
                                                   
                                                
                                                2
                                             
                                             −
                                             
                                                
                                                   4
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                3
                                             
                                             +
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                1
                                                6
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

We observe from Fig. 6 that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is concave in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0.255443
                              . Thus 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≤
                                 0
                              . On the other hand, 
                                 (
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          4
                                       
                                    
                                    2
                                 
                                 −
                                 
                                    
                                       4
                                       
                                          
                                             ϵ
                                          
                                          
                                             3
                                          
                                       
                                    
                                    3
                                 
                                 +
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    1
                                    6
                                 
                                 )
                                 =
                                 
                                    1
                                    6
                                 
                                 
                                    
                                       (
                                       ϵ
                                       −
                                       1
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 3
                                 ϵ
                                 +
                                 1
                                 )
                                 ≤
                                 0
                               for 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 1
                              . Consequently, we have 
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               and then 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               is convex in 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               minimizes 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0.255443
                               if and only if 
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   F
                                                
                                                
                                                   ϵ
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             ∂
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 ≥
                                 0
                              . Notice that
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ϵ
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      ⁎
                                                   
                                                
                                                (
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                ∂
                                                ϵ
                                                ∂
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          2
                                          
                                             
                                                (
                                                ϵ
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          ϵ
                                          
                                             
                                                d
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                d
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                (
                                                ϵ
                                                −
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          2
                                          ϵ
                                          +
                                          1
                                          )
                                          ≥
                                          0
                                       
                                    
                                 
                               for 
                                 0
                                 ≤
                                 ϵ
                                 ≤
                                 1
                              . We need to solve the following equation for 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                              :
                                 
                                    (7)
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      −
                                                      2
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      +
                                                      2
                                                      ϵ
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ϵ
                                                            
                                                            
                                                               4
                                                            
                                                         
                                                         2
                                                      
                                                      −
                                                      
                                                         
                                                            4
                                                            
                                                               
                                                                  ϵ
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                         3
                                                      
                                                      +
                                                      
                                                         
                                                            ϵ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         6
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Now we calculate 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                              . Suppose 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 k
                              . Solve the equation
                                 
                                    
                                       
                                          
                                             
                                                
                                                   lim
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      →
                                                      0
                                                   
                                                
                                                ⁡
                                                
                                                   
                                                      d
                                                      G
                                                      (
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                k
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                               and we have 
                                 k
                                 =
                                 1.37885
                              . Substituting 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 1.37885
                               to Equation (7), we can obtain 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0.109
                              .

Now we prove that when 
                                 ϵ
                                 ≥
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                              , 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               is the global minimum of 
                                 
                                    
                                       F
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 )
                               in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . We observe that 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is concave in 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . Moreover, 
                                 
                                    
                                       d
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       d
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0.255443
                                    
                                 
                                 ≤
                                 1
                               because 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 0.255443
                                 )
                                 =
                                 0.255443
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               for 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . Hence, 
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≥
                                 0
                               in 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . Therefore, when 
                                 ϵ
                                 ≥
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                              , 
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             ϵ
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               is monotonically increasing in 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . The minimum is 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                              .  □


                        
                           Remark 1
                           In the proof of Theorem 4, we used the concavity of function 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               in intervals 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0.255443
                               and 
                                 0.255443
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              . This property of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is assumed without a mathematical proof because no analytic expression of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is available. Nevertheless, we can observe it in Fig. 6.


                        
                           Theorem 5
                           
                              Given 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              
                              , the first derivative 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                               
                              that minimizes the function-value-based 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               
                              interpolating functional 
                              
                                 
                                    
                                       ∫
                                    
                                    
                                       −
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 
                                    |
                                    z
                                    (
                                    x
                                    )
                                    −
                                    ζ
                                    (
                                    x
                                    )
                                    |
                                 
                                 d
                                 x
                               
                              satisfies the following properties:
                              
                                 
                                    
                                       (1)
                                    
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                       , if 
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          0
                                       
                                       ,
                                    


                                       
                                          0
                                          ≤
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                       
                                       , if 
                                       
                                          0
                                          ≤
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          
                                             1
                                             2
                                          
                                       
                                       ,
                                    


                                       
                                          0
                                          ≤
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          ≤
                                          1
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                       
                                       , if 
                                       
                                          
                                             1
                                             2
                                          
                                          ≤
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≤
                                          1
                                       
                                       ,
                                    


                                       
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          0
                                       
                                       , if 
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          ≥
                                          1
                                       
                                       .
                                    

Note that 
                                 G
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is convex in 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                               for any given 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              . When 
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              , we have
                                 
                                    
                                       
                                          z
                                          (
                                          x
                                          )
                                          =
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                x
                                                +
                                                1
                                                )
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                x
                                                +
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                               and 
                                 ζ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 1
                                 +
                                 x
                                 )
                              .

When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , the equation 
                                 z
                                 (
                                 x
                                 )
                                 −
                                 ζ
                                 (
                                 x
                                 )
                                 =
                                 0
                               has a root in 
                                 −
                                 1
                                 <
                                 x
                                 <
                                 0
                               as 
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              . We have
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          z
                                          (
                                          x
                                          )
                                          −
                                          ζ
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             0
                                          
                                          ζ
                                          (
                                          x
                                          )
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          
                                             1
                                             32
                                          
                                          .
                                       
                                    
                                 
                               When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , the equation 
                                 z
                                 (
                                 x
                                 )
                                 −
                                 ζ
                                 (
                                 x
                                 )
                                 =
                                 0
                               has a root in 
                                 0
                                 <
                                 x
                                 <
                                 1
                               as 
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       2
                                    
                                 
                              . We have
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             0
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ζ
                                          (
                                          x
                                          )
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             1
                                          
                                          z
                                          (
                                          x
                                          )
                                          −
                                          ζ
                                          (
                                          x
                                          )
                                          d
                                          x
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             1
                                             32
                                          
                                          .
                                       
                                    
                                 
                               Hence,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      G
                                                      (
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          0
                                       
                                    
                                 
                               when 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              . Consequently, 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              .

When 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 0
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                              , we have
                                 
                                    
                                       
                                          G
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                −
                                                1
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ζ
                                          (
                                          x
                                          )
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   r
                                                
                                                
                                                   1
                                                
                                             
                                             0
                                          
                                          z
                                          (
                                          x
                                          )
                                          −
                                          ζ
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             0
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ζ
                                          (
                                          x
                                          )
                                          −
                                          z
                                          (
                                          x
                                          )
                                          d
                                          x
                                          +
                                          
                                             ∫
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             1
                                          
                                          z
                                          (
                                          x
                                          )
                                          −
                                          ζ
                                          (
                                          x
                                          )
                                          d
                                          x
                                       
                                    
                                 
                               and
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      G
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          =
                                          −
                                          
                                             1
                                             16
                                          
                                          <
                                          0
                                          .
                                       
                                    
                                 
                               Hence 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 >
                                 0
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                              .

When 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                              , we have
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      G
                                                   
                                                   
                                                      d
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                |
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      3
                                                   
                                                
                                                (
                                                9
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                5
                                                )
                                             
                                             
                                                6
                                                
                                                   
                                                      (
                                                      2
                                                      −
                                                      3
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          >
                                          0
                                          .
                                       
                                    
                                 
                               Hence 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                               for 
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                              . By symmetry we can prove the remaining of the theorem.  □


                        Fig. 7
                         shows the graph of 
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 ⁎
                              
                           
                           (
                           
                              
                                 z
                              
                              
                                 1
                              
                           
                           )
                        .


                        
                           Lemma 4
                           
                              Given any 
                              
                                 0
                                 <
                                 ϵ
                                 ≤
                                 1
                              
                              , 
                              
                                 0
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                               
                              holds for the function-value-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                              
                              .
                           

Note that 
                                 0
                                 ≤
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ≤
                                 3
                                 (
                                 1
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               for 
                                 
                                    1
                                    2
                                 
                                 ≤
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 1
                              , 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 1
                              , and 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 0
                               for 
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 0
                              . The proof of Lemma 2 can be applied.  □


                        
                           Theorem 6
                           
                              Fix 
                              
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               
                              in the 3-node window. The function-value-based spline fit for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ϵ
                                    
                                 
                                 (
                                 x
                                 )
                               
                              preserves its linear shape in 
                              
                                 −
                                 1
                                 ≤
                                 x
                                 ≤
                                 0
                              
                              , i.e., 
                              
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0
                               
                              and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                                 =
                                 0
                              
                              , if and only if 
                              
                                 ϵ
                                 ≥
                                 0.050
                              
                              . This means that the shape-preserving metric of function-value-based spline fits is 0.050.
                           

Proof of Theorem 4 applies. For function-value-based spline fits, 
                                 
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             d
                                             
                                                
                                                   z
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                 
                                 =
                                 0.61191
                               and 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 0.050
                              . We also need the assumption of concavity of 
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 )
                               here. This property can be observed in Fig. 7.  □


                        Table 2
                         shows the shape-preserving metrics of the three types of spline fits. The shape-preserving metrics are no more than 
                           25
                           %
                         of the space between adjacent spline nodes. This implies the strong shape-preserving capability of spline fits. We can see that the shape-preserving metrics of the second-derivative-based, first-derivative-based and function-value-based spline fits decrease in sequence. This indicates that the function-value-based spline fits have the strongest shape-preserving capability among these three types of spline fits.

In the local-calculation approaches for interpolating spline and spline fits, a window of 5 nodes is of the appropriate size for both accuracy and efficiency (Jin et al., 2010, 2011; Wang et al., 2014; Yu et al., 2010). To evaluate the shape-preserving performance of the local-calculation approach and provide further comparison of the three types of spline fits, we compute 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                      in a 5-node window. No boundary conditions are imposed in this case. Considering that a similar analysis as in Section 4 for the 5-node window case is extremely cumbersome, we compute 
                        
                           
                              ϵ
                           
                           
                              ⁎
                           
                        
                      numerically in this section. The numerically computational procedure is as follows.
                        
                           Step 1
                           Set a precision increment of 
                                 0
                                 <
                                 Δ
                                 ϵ
                                 <
                                 1
                              . Let 
                                 ϵ
                                 =
                                 0
                              .

Solve the spline fit problem numerically. If 
                                 
                                    
                                       z
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       b
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                              , go to Step 3. Otherwise, let 
                                 ϵ
                                 =
                                 ϵ
                                 +
                                 Δ
                                 ϵ
                               and repeat Step 2.

Output 
                                 
                                    
                                       ϵ
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 ϵ
                              . Stop.

In Step 2, we need to solve the interpolating spline problem for 
                        
                           
                              b
                           
                           
                              ⁎
                           
                        
                        (
                        z
                        )
                     . While analytic methods have been developed for second-derivative-based and first-derivative-based splines, no such method is available for function-value-based splines. To conduct a fair comparison of the three types of spline fits, we use the Lagrangian multiplier primal affine method as in Lavery (2004) and (2009). This algorithm is satisfyingly accurate for our purpose of comparing the metrics. We use the MATLAB function fmincon to numerically minimize the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      fitting functional, which is in general not analytically expressed. The starting point for fmincon is set as 
                        z
                        =
                        (
                        0.5
                        ,
                        0.5
                        ,
                        0.5
                        ,
                        0.5
                        ,
                        0.5
                        )
                     . The criterion of determining 
                        
                           
                              z
                           
                           
                              0
                           
                        
                        =
                        
                           
                              z
                           
                           
                              1
                           
                        
                        =
                        
                           
                              z
                           
                           
                              2
                           
                        
                        =
                        0
                      is that 
                        |
                        
                           
                              z
                           
                           
                              0
                           
                        
                        |
                        +
                        |
                        
                           
                              z
                           
                           
                              1
                           
                        
                        |
                        +
                        |
                        
                           
                              z
                           
                           
                              2
                           
                        
                        |
                        <
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                     . The criterion of determining 
                        
                           
                              b
                           
                           
                              0
                           
                        
                        =
                        
                           
                              b
                           
                           
                              1
                           
                        
                        =
                        
                           
                              b
                           
                           
                              2
                           
                        
                        =
                        0
                      is that 
                        |
                        
                           
                              b
                           
                           
                              0
                           
                        
                        |
                        +
                        |
                        
                           
                              b
                           
                           
                              1
                           
                        
                        |
                        +
                        |
                        
                           
                              b
                           
                           
                              2
                           
                        
                        |
                        <
                        
                           
                              10
                           
                           
                              −
                              3
                           
                        
                     . We set 
                        Δ
                        ϵ
                        =
                        0.001
                     .

The computational results are shown in Table 3
                     . The strong capability of spline fits and superior performance of function-value-based spline fits are verified. Moreover, by comparing to Table 2, we note that the metrics in the 5-node window are smaller than those in the 3-node window. This suggests that a 5-node window contains more information about the geometric pattern to be approximated. Hence, in the local-calculation approach for spline fits, the 5-node algorithm should be preferred to the 3-node algorithm.

Analysis and numerical study for windows of 7 or more nodes may provide additional comparison of the three types of splines. In Yu et al. (2010), numerical experiments for interpolating splines in 7-node windows and global windows are conducted respectively, and are compared with 5-node windows. Yu et al. (2010) claim that these experiments provide “a piece of evidence supporting the use of second-derivative-based 5-point-window 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      splines.” For spline fits, we may also conduct experiments of different sizes. Since the numerical method would be very similar to that for 5-node windows, and the primary purpose of this paper is not calculating shape-preserving metrics of all kinds of windows, we leave the study of other window sizes to future research.

We close the section by giving the general form of minimum length difference needed for preserving linear shape of two parallel line segments. The next theorem shows that the minimum length difference is proportional to the node space and is independent of the gap between the parallel line segments. 
                        Theorem 7
                        
                           Let 
                           
                              I
                              ≥
                              2
                            
                           be an even number, 
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    ˆ
                                 
                              
                              >
                              0
                           
                           , 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              >
                              0
                            
                           and 
                           
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                           
                           . The spline fit 
                           
                              
                                 
                                    z
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                            
                           with nodes 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              =
                              −
                              
                                 I
                                 2
                              
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    I
                                    /
                                    2
                                 
                              
                              =
                              0
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    I
                                 
                              
                              =
                              
                                 I
                                 2
                              
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                            
                           preserves the linear shape of the function
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   x
                                                   ≤
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   x
                                                   >
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            
                           in 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              ≤
                              x
                              ≤
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    I
                                    /
                                    2
                                 
                              
                            
                           if and only if 
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    ˆ
                                 
                              
                              ≥
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ϵ
                                 
                                 
                                    ⁎
                                 
                              
                           
                           , where 
                           
                              
                                 
                                    ϵ
                                 
                                 
                                    ⁎
                                 
                              
                            
                           is the corresponding shape-preserving metric to the type of the spline fit.
                        


                     
                        Proof
                        Note that for any cubic spline 
                              z
                              (
                              x
                              )
                            with first derivatives 
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                            at node 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              0
                              ,
                              …
                              ,
                              I
                            and 
                              
                                 
                                    z
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                            with first derivatives 
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            at node 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              0
                              ,
                              …
                              ,
                              I
                           , if 
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              0
                              ,
                              …
                              ,
                              I
                           , then 
                              
                                 
                                    z
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              z
                              (
                              
                                 x
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                            for all 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              ≤
                              x
                              ≤
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    I
                                 
                              
                           . Consequently, if 
                              
                                 
                                    b
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                            minimizes the interpolating functional 
                              G
                              (
                              b
                              )
                           , then 
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                              =
                              
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                            will minimize 
                              G
                              (
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           . For the fitting functional, we have 
                              F
                              (
                              z
                              ,
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              F
                              (
                              z
                              ,
                              
                                 
                                    b
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              z
                              )
                              )
                           . The spline fits for 
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              (
                              x
                              )
                            and 
                              
                                 
                                    H
                                 
                                 
                                    ϵ
                                 
                              
                              (
                              x
                              )
                            will then have the same function values at nodes 
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              0
                              ,
                              …
                              ,
                              I
                           . Therefore, spline fit 
                              
                                 
                                    z
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              x
                              )
                            preserves linear shape of 
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ϵ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                              
                              (
                              x
                              )
                            if and only if 
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                              
                              ≥
                              
                                 
                                    ϵ
                                 
                                 
                                    ⁎
                                 
                              
                           , i.e., 
                              
                                 
                                    ϵ
                                 
                                 
                                    ˆ
                                 
                              
                              ≥
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ϵ
                                 
                                 
                                    ⁎
                                 
                              
                           .  □

We have defined a metric to quantitatively characterize the shape-preserving capability of three types of cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits. To calculate this metric, we have developed an analytic approach in a 3-node window and a numerical procedure in a 5-node window. In both cases, the spline fits are shown to have convincingly strong capability in preserving linear shape. The function-value-based spline fit yields the smallest metric, which suggests it is better in shape preservation than the other two types of spline fits. This paper is of the first theoretic study on shape-preserving property of cubic 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      spline fits. Such a study may help explain phenomena in 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      splines applications. It may also be used as a reference to improve spline node positions and collect data of better quality for shape preservation purposes.

Shape preservation deserves a more general and precise definition. We have discussed the principle of preserving linear shapes in given data. Another principle is to preserve convex shapes, such as corners and circles. To fully evaluate the shape-preserving capability, we need to investigate more shapes such as a triangular function or a circle. The shape-preserving metrics in these cases should be defined accordingly. Furthermore, an analytic approach for calculating the metric in a 5-node window is worth designing. The analysis in the 3-node window, as well as the analytic solution to the 
                        
                           
                              L
                           
                           
                              1
                           
                        
                      interpolating spline problem in a 5-node window (Jin et al., 2010, 2011; Yu et al., 2010), shows the potential in these regards.

As indicated, function-value-based spline fits may perform superiorly in shape preservation. Analytic methods for solving the function-value-based interpolating spline problem and spline fit problem become more necessary and appealing. Such computational development may also be used to better evaluate the shape-preserving capability.

@&#ACKNOWLEDGEMENTS@&#

This work was generously supported by US Army Research Office Grants # W911NF-04-D-0003 and #W911NF-15-1-0223, by the North Carolina State University Edward P. Fitts Fellowship and by US NSF Grant # DMI-0553310. It is the policy of the Army Research Office that university personnel do not need to do joint work with ARO personnel in order to receive grants from the Army Research Office.

The authors would like to thank the editor and reviewers for their valuable comments and suggestions that have helped significantly improve the paper.

@&#REFERENCES@&#

