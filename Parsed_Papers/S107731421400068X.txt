@&#MAIN-TITLE@&#Efficient algorithm for finding the exact minimum barrier distance

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introduction of fast algorithm for the exact values of minimum barrier distance, MBD.


                        
                        
                           
                           Comparison of the novel algorithm with its approximate versions.


                        
                        
                           
                           Experimental comparison MBD induced segmentations with other segmentation algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image processing

Distance function

Distance transform

Minimum barrier

Path strength

Segmentation

Fuzzy Connectedness

Fuzzy distance

@&#ABSTRACT@&#


               
               
                  The minimum barrier distance, MBD, introduced recently in [1], is a pseudo-metric defined on a compact subset D of the Euclidean space 
                        
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                      and whose values depend on a fixed map (an image) f from D into 
                        
                           R
                        
                     . The MBD is defined as the minimal value of the barrier strength of a path between the points, which constitutes the length of the smallest interval containing all values of f along the path.
                  In this paper we present a polynomial time algorithm, that provably calculates the exact values of MBD for the digital images. We compare this new algorithm, theoretically and experimentally, with the algorithm presented in [1], which computes the approximate values of the MBD. Moreover, we notice that every generalized distance function can be naturally translated to an image segmentation algorithm. The algorithms that fall under such category include: Relative Fuzzy Connectedness, and those associated with the minimum barrier, fuzzy distance, and geodesic distance functions. In particular, we compare experimentally these four algorithms on the 2D and 3D natural and medical images with known ground truth and at varying level of noise, blur, and inhomogeneity.
               
            

@&#INTRODUCTION@&#

The distance transform, DT, mappings [1–8] have been widely used as the effective tools for analyzing object morphology and geometry [9–11]. The value 
                        
                           DT
                           (
                           x
                           )
                        
                      of a distance transform map at a point x from the domain C of DT is usually defined as a (possibly signed) distance of x from a fixed target set 
                        
                           B
                           ⊂
                           C
                        
                     , the distance measured with respect to some fixed (possibly generalized) metric on C. Most commonly, C is a bounded subset of the Euclidean space 
                        
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                      and DT is defined in terms of the Euclidean distance. For the rectangular shape digital domains C, a fast algorithm for finding the approximate values of the Euclidean distance transform was introduced by Rosenfeld and Pfaltz [12]. An algorithm for computing the exact values of such transform in linear time for the n-dimensional images was described in [13,14] and elaborated on in [15]. Such algorithms for the 2-dimensional images were also presented in [16,17].

The distance transforms used in the image processing commonly take into account the image data [6,18–20]. Most of the distance notions used in such setting define the distance between two points in the image’s scene as the minimum cost of a path connecting such points, where the path cost functions depend on the image intensity and differ for different methods. Such defined distance measures include the connection value (a variant of Rosenfeld’s degree of connectivity [21–23]), which allows for an equivalent characterization of topological watersheds, leading to an efficient Watershed (WS) segmentation algorithm [24,25], as well as the geodesic distance (see e.g. [26]). Moreover, the degree of connectivity, on the basis of which the Fuzzy Connectedness (FC) algorithms are defined, can be also treated as the distance measure defined in the same form. (See e.g. [27,28,20].) Falcão et al. [20] proved that for a general class of the path cost functions, called smooth, including the three examples mentioned above, the related distance transform can be found via Dijkstra’s algorithm. For the case of FC, this was further elaborated in [29], including the discussion of the related results from the papers [30,31].

The subject of this paper is the study of the distance transform for the minimum barrier distance, MBD, and of the segmentation algorithms associated with it. The MBD for an image f is defined from the path cost function, called barrier strength, in a manner described above, where the barrier strength of a path constitutes the length of the smallest interval containing all values of f along the path. However, the barrier strength path cost function is not smooth in the sense defined in [20]. In fact, the naturally defined Dijkstra’s algorithms for barrier strength path cost function do not need to return the exact values for MBD. Nevertheless, the output of such algorithms approximate MBD, as proved in [1] and shortly described in what follows.

Section 2 introduces a general framework for constructing the generalized distance mappings. We represent within this framework: the Minimum Barrier Distance, geodesic distance, fuzzy distance, as well as the distance notions that stand behind two popular segmentation algorithms, Fuzzy Connectedness (FC) and Watershed (WS). We also discuss, how the generalized distance mappings can be used to naturally define an image segmentation via seeds competition. In the case of FC theory, this gives the Relative Fuzzy Connectedness (RFC) objects. In Section 3 we introduce the new algorithm, that calculates the MBD in polynomial time. We also discuss, how this new algorithm relates to the standard Dijkstra’s algorithm, which can be used to calculate the other distance notions mentioned above.

In Section 4 we present our experimental results. In particular, in Section 4.1 we compare different versions of the algorithms that compute MBD (approximately and exactly) with respect to the execution time and accuracy. In Sections 4.2 and 4.3 we compare the segmentation algorithms corresponding to MBD with the segmentation algorithms corresponding to other distance transforms, that is, with Fuzzy Connectedness, and these corresponding to the geodesic and fuzzy distances. The comparison is quantitative (stability to noise, blur, and the choice of seed points) and qualitative.

In this section we review the constructions of the generalized distance mappings (or generalized metrics) on a set C, which we define as symmetric functions 
                        
                           d
                           :
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                           →
                           [
                           0
                           ,
                           ∞
                           ]
                        
                      that satisfy the triangle inequality. (We allow possibility that 
                        
                           d
                           (
                           c
                           ,
                           c
                           )
                           >
                           0
                        
                      for some 
                        
                           c
                           ∈
                           C
                        
                     .) The construction encompasses the Minimum Barrier Distance as well as several other popular distance mappings used in imaging. We notice that any generalized distance can be used to naturally define an image segmentation via seeds competition for 
                        
                           c
                           ∈
                           C
                        
                     . In particular, two popular segmentation algorithms, Relative Fuzzy Connectedness (RFC) and Watershed (WS), fall into this category.

Most of the theoretical results that follow are independent of image processing interpretation and are presented in a general graph-theoretical setting. Nevertheless, we point out to the image processing applications at each step of our exposition.

In this paper a digital image is identified with its intensity (or attribute) function 
                        
                           f
                           :
                           C
                           →
                           
                              
                                 R
                              
                              
                                 ℓ
                              
                           
                        
                     , where C is its domain (whose elements will be referred to as spels, short for space elements) and the value 
                        
                           f
                           (
                           c
                           )
                        
                      of f at 
                        
                           c
                           ∈
                           C
                        
                      represents image intensity (an 
                        
                           ℓ
                        
                     -dimensional vector, each component of which indicates a measure of some aspect of the signal, like tissue property or color) at the spel c. It is assumed that image domain comes with an adjacency relation, that decides which pairs of spels are adjacent. An image domain C together with its adjacency structure is referred to as a scene. In the experimental sections we will concentrate on the images on the rectangular scenes 
                        
                           C
                           =
                           
                              
                                 ∏
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 k
                              
                           
                           {
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                           }
                           ,
                           
                           k
                           =
                           2
                           ,
                           3
                        
                     , with either 4-adjacency, in 2D, or 6-adjacency, in 3D.

By a graph we understand a pair 
                           
                              G
                              =
                              〈
                              C
                              ,
                              E
                              〉
                           
                         with C representing a finite set of its vertices and E the set of its edges G, where an edge connecting c and d from C is identified with an unordered pair 
                           
                              {
                              c
                              ,
                              d
                              }
                           
                        . In the image processing applications, we concentrate on the graphs associated with the images 
                           
                              f
                              :
                              C
                              →
                              
                                 
                                    R
                                 
                                 
                                    ℓ
                                 
                              
                           
                         in which the vertices are the spels (the elements of C) and the set E of edges coincides with the adjacency relation of the image’s scene.

A path in a graph 
                           
                              G
                              =
                              〈
                              C
                              ,
                              E
                              〉
                           
                         is any sequence 
                           
                              π
                              =
                              〈
                              π
                              (
                              0
                              )
                              ,
                              π
                              (
                              1
                              )
                              ,
                              …
                              ,
                              π
                              (
                              k
                              )
                              〉
                           
                         of vertices such that 
                           
                              {
                              π
                              (
                              i
                              )
                              ,
                              π
                              (
                              i
                              -
                              1
                              )
                              }
                              ∈
                              E
                           
                         for every 
                           
                              i
                              ∈
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              k
                              }
                           
                        . A path 
                           
                              π
                              =
                              〈
                              π
                              (
                              0
                              )
                              ,
                              π
                              (
                              1
                              )
                              ,
                              …
                              ,
                              π
                              (
                              k
                              )
                              〉
                           
                         is from s to c when 
                           
                              π
                              (
                              0
                              )
                              =
                              s
                           
                         and 
                           
                              π
                              (
                              k
                              )
                              =
                              c
                           
                        . A family of all paths in G from an 
                           
                              s
                              ∈
                              S
                           
                         to c is denoted by 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                        . We will also write 
                           
                              
                                 
                                    Π
                                 
                                 
                                    s
                                    ,
                                    c
                                 
                              
                           
                         for 
                           
                              
                                 
                                    Π
                                 
                                 
                                    {
                                    s
                                    }
                                    ,
                                    c
                                 
                              
                           
                        .

Now, assume that with any path 
                           
                              π
                           
                         in G we have associated its cost: a number 
                           
                              λ
                              (
                              π
                              )
                              ⩾
                              0
                           
                         treated as the “length” of 
                           
                              π
                           
                        . (The examples of such functions 
                           
                              λ
                           
                         are given below.) With any such 
                           
                              λ
                           
                         we associate a mapping 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              :
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              →
                              [
                              0
                              ,
                              ∞
                              ]
                           
                         (which need not be a generalized distance) defined as
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 λ
                                 (
                                 π
                                 )
                                 :
                                 π
                                 
                                 is
                                 
                                 a
                                 
                                 path
                                 
                                 in
                                 
                                 G
                                 
                                 from
                                 
                                 c
                                 
                                 to
                                 
                                 d
                                 }
                                 .
                              
                           
                        In what follows we work mostly with the connected graphs, that is, such that for any vertices c and d there is a path in G from c to d. In such case, all values of 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                           
                         are finite.

In general, 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                           
                         need not be a generalized distance. However, it must be under the assumptions of the following easy fact.
                           Proposition 1
                           
                              Assume that for every path 
                              
                                 
                                    π
                                    =
                                    〈
                                    π
                                    (
                                    0
                                    )
                                    ,
                                    π
                                    (
                                    1
                                    )
                                    ,
                                    …
                                    ,
                                    π
                                    (
                                    k
                                    )
                                    〉
                                 
                              
                              
                                 
                                    (i)
                                    
                                       
                                          
                                             λ
                                             (
                                             π
                                             )
                                             =
                                             λ
                                             (
                                             〈
                                             π
                                             (
                                             k
                                             )
                                             ,
                                             π
                                             (
                                             k
                                             -
                                             1
                                             )
                                             ,
                                             …
                                             ,
                                             π
                                             (
                                             0
                                             )
                                             〉
                                             )
                                          
                                       
                                       , and
                                    


                                       
                                          
                                             λ
                                             (
                                             π
                                             )
                                             ⩽
                                             λ
                                             (
                                             〈
                                             π
                                             (
                                             0
                                             )
                                             ,
                                             …
                                             ,
                                             π
                                             (
                                             i
                                             )
                                             〉
                                             )
                                             +
                                             λ
                                             (
                                             〈
                                             π
                                             (
                                             i
                                             )
                                             ,
                                             …
                                             ,
                                             π
                                             (
                                             k
                                             )
                                             〉
                                             )
                                          
                                        
                                       for every 
                                       
                                          
                                             0
                                             ⩽
                                             i
                                             ⩽
                                             k
                                          
                                       
                                       .
                                    


                              Then 
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                               
                              is symmetric and it satisfies the triangle inequality.
                           

Since all path length functions we consider here (except for the auxiliary map 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                        ) satisfy the assumptions of Proposition 1, all considered functions 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                           
                         are the generalized metrics.

In the standard examples, the mappings 
                           
                              λ
                           
                         are defined in terms of graph’s 
                           
                              G
                              =
                              〈
                              C
                              ,
                              E
                              〉
                           
                         weight functions: either vertex weight 
                           
                              w
                              :
                              C
                              →
                              [
                              0
                              ,
                              ∞
                              )
                           
                         or edge weight 
                           
                              w
                              :
                              E
                              →
                              [
                              0
                              ,
                              ∞
                              )
                           
                        . In image processing, such weight functions are defined in terms of the intensity function 
                           
                              f
                              :
                              C
                              →
                              
                                 
                                    R
                                 
                                 
                                    ℓ
                                 
                              
                           
                        . (See Section 4 for more on the weight mappings.)

For an edge weight map 
                              
                                 w
                                 :
                                 E
                                 →
                                 (
                                 0
                                 ,
                                 ∞
                                 )
                              
                           , where the value 
                              
                                 w
                                 (
                                 {
                                 c
                                 ,
                                 d
                                 }
                                 )
                              
                            is a (geodesic) distance from c to d, and the path length function 
                              
                                 Σ
                                 (
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 ,
                                 π
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 π
                                 (
                                 k
                                 )
                                 〉
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 w
                                 (
                                 {
                                 π
                                 (
                                 i
                                 -
                                 1
                                 )
                                 ,
                                 π
                                 (
                                 i
                                 )
                                 }
                                 )
                              
                           , the resulted function 
                              
                                 
                                    
                                       d
                                    
                                    
                                       Σ
                                    
                                 
                              
                            is the geodesic metric. (For the length one path 
                              
                                 π
                                 =
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 〉
                              
                           , the formula is interpreted as 
                              
                                 Σ
                                 (
                                 π
                                 )
                                 =
                                 0
                              
                           .)

For a vertex weight map 
                              
                                 w
                                 :
                                 C
                                 →
                                 [
                                 0
                                 ,
                                 ∞
                                 )
                              
                           , associated edge weight map 
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 :
                                 E
                                 →
                                 [
                                 0
                                 ,
                                 ∞
                                 )
                              
                            defined as 
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 =
                                 
                                    
                                       w
                                       (
                                       c
                                       )
                                       +
                                       w
                                       (
                                       d
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           , and the path length function 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 ,
                                 π
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 π
                                 (
                                 k
                                 )
                                 〉
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 {
                                 π
                                 (
                                 i
                                 -
                                 1
                                 )
                                 ,
                                 π
                                 (
                                 i
                                 )
                                 }
                                 )
                              
                           , the resulted function 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                            is the fuzzy distance. (For the length one path 
                              
                                 π
                                 =
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 〉
                              
                           , the formula is interpreted as 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 π
                                 )
                                 =
                                 0
                              
                           .) Clearly the fuzzy distance is a pseudo-metric, that is, it is symmetric and satisfies the triangle inequality (as the assumptions of Proposition 1 hold for 
                              
                                 λ
                                 =
                                 
                                    
                                       Σ
                                    
                                    
                                       ^
                                    
                                 
                              
                           ); moreover, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                                 (
                                 c
                                 ,
                                 c
                                 )
                                 =
                                 0
                              
                            for every 
                              
                                 c
                                 ∈
                                 C
                              
                           . (However, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                              
                            can be equal 0 for 
                              
                                 c
                                 
                                 ≠
                                 
                                 d
                              
                           .) See [6,19] for more on the fuzzy distance.

This is defined for an affinity weight mapping 
                              
                                 κ
                                 :
                                 E
                                 →
                                 [
                                 0
                                 ,
                                 M
                                 ]
                              
                            (usually with 
                              
                                 M
                                 =
                                 1
                              
                           ) interpreted: the closer the value of 
                              
                                 κ
                                 (
                                 {
                                 c
                                 ,
                                 d
                                 }
                                 )
                              
                            is to M, the stronger the vertices c and d are connected. The standard Fuzzy Connectedness strength of a path 
                              
                                 π
                                 =
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 ,
                                 π
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 π
                                 (
                                 k
                                 )
                                 〉
                              
                            is defined as 
                              
                                 μ
                                 (
                                 π
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       k
                                    
                                 
                                 κ
                                 (
                                 {
                                 π
                                 (
                                 i
                                 -
                                 1
                                 )
                                 ,
                                 π
                                 (
                                 i
                                 )
                                 }
                                 )
                              
                           , that is, the weakest link of 
                              
                                 π
                              
                           ; the value of 
                              
                                 μ
                                 (
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 〉
                                 )
                              
                            is interpreted as M. The Fuzzy Connectedness path length is defined as 
                              
                                 λ
                                 (
                                 π
                                 )
                                 =
                                 M
                                 -
                                 μ
                                 (
                                 π
                                 )
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       k
                                    
                                 
                                 w
                                 (
                                 {
                                 π
                                 (
                                 i
                                 -
                                 1
                                 )
                                 ,
                                 π
                                 (
                                 i
                                 )
                                 }
                                 )
                              
                           , where 
                              
                                 w
                                 (
                                 {
                                 c
                                 ,
                                 d
                                 }
                                 )
                                 =
                                 M
                                 -
                                 κ
                                 (
                                 {
                                 c
                                 ,
                                 d
                                 }
                                 )
                              
                           ; that is, 
                              
                                 λ
                                 (
                                 π
                                 )
                              
                            is the biggest w-length of a link in 
                              
                                 π
                              
                           . Then the Fuzzy Connectedness distance map 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                              
                            becomes 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 =
                                 M
                                 -
                                 μ
                                 (
                                 c
                                 ,
                                 d
                                 )
                              
                           , where 
                              
                                 μ
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 =
                                 max
                                 {
                                 μ
                                 (
                                 π
                                 )
                                 :
                                 π
                                 ∈
                                 
                                    
                                       Π
                                    
                                    
                                       c
                                       ,
                                       d
                                    
                                 
                                 }
                              
                            is the standard FC connectivity strength. Note, that this distance 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                              
                            is also a pseudo-metric. For more on this subject see [27,28]. Compare also [24,25,30].

This is defined for the vertex weight mapping 
                              
                                 w
                                 :
                                 C
                                 →
                                 [
                                 0
                                 ,
                                 ∞
                                 )
                              
                           , where the value 
                              
                                 w
                                 (
                                 c
                                 )
                              
                            is interpreted as an elevation at c. Then, for the path length function 
                              
                                 λ
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       w
                                    
                                    
                                       +
                                    
                                 
                              
                            defined as
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    〈
                                    π
                                    (
                                    0
                                    )
                                    ,
                                    π
                                    (
                                    1
                                    )
                                    ,
                                    …
                                    ,
                                    π
                                    (
                                    k
                                    )
                                    〉
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             k
                                          
                                       
                                    
                                    w
                                    (
                                    π
                                    (
                                    i
                                    )
                                    )
                                    ,
                                 
                              
                           the related distance function 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                            is usually referred to as the connection value and it leads to the Watershed (WS) segmentation algorithm [24,25]. The connection value related map 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                              
                            is a generalized metric; however, it is not pseudo-metric, since 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                                 (
                                 c
                                 ,
                                 c
                                 )
                              
                            can be greater than 0. In what follows we will use also the dual path length function 
                              
                                 λ
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       w
                                    
                                    
                                       -
                                    
                                 
                              
                            defined as
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    〈
                                    π
                                    (
                                    0
                                    )
                                    ,
                                    π
                                    (
                                    1
                                    )
                                    ,
                                    …
                                    ,
                                    π
                                    (
                                    k
                                    )
                                    〉
                                    )
                                    =
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             k
                                          
                                       
                                    
                                    w
                                    (
                                    π
                                    (
                                    i
                                    )
                                    )
                                    .
                                 
                              
                           Notice that if 
                              
                                 M
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       c
                                       ∈
                                       C
                                    
                                 
                                 w
                                 (
                                 c
                                 )
                              
                            and the weight function v is defined as 
                              
                                 v
                                 (
                                 c
                                 )
                                 =
                                 M
                                 -
                                 w
                                 (
                                 c
                                 )
                              
                           , then the mapping 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 M
                                 -
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             v
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                            satisfies
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                w
                                             
                                             
                                                -
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       max
                                    
                                    {
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    π
                                    )
                                    :
                                    
                                    is
                                    
                                    a
                                    
                                    path
                                    
                                    in
                                    
                                    G
                                    
                                    from
                                    
                                    c
                                    
                                    to
                                    
                                    d
                                    }
                                    .
                                 
                              
                           In particular, an algorithm that calculates 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             v
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                            can be also used to find 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                              
                           .

This is defined for the vertex weight mapping 
                              
                                 w
                                 :
                                 C
                                 →
                                 [
                                 0
                                 ,
                                 ∞
                                 )
                              
                           . The path length function 
                              
                                 λ
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       w
                                    
                                 
                              
                           , referred to as the barrier strength, is defined for a path 
                              
                                 π
                                 =
                                 〈
                                 π
                                 (
                                 0
                                 )
                                 ,
                                 π
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 π
                                 (
                                 k
                                 )
                                 〉
                              
                            as
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    π
                                    )
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    π
                                    )
                                    -
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    π
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             k
                                          
                                       
                                    
                                    w
                                    (
                                    π
                                    (
                                    i
                                    )
                                    )
                                    -
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             =
                                             0
                                             ,
                                             …
                                             ,
                                             k
                                          
                                       
                                    
                                    w
                                    (
                                    π
                                    (
                                    i
                                    )
                                    )
                                    .
                                 
                              
                           The related Barrier Distance map 
                              
                                 
                                    
                                       d
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                       
                                    
                                 
                              
                            is a pseudo-metric [1].

Let d be a generalized distance on C. For a 
                           
                              c
                              ∈
                              C
                           
                         and a non-empty 
                           
                              W
                              ⊂
                              C
                           
                         define 
                           
                              d
                              (
                              c
                              ,
                              W
                              )
                              =
                              min
                              {
                              d
                              (
                              c
                              ,
                              w
                              )
                              :
                              w
                              ∈
                              W
                              }
                           
                        . For any two non-empty sets 
                           
                              S
                              ⊂
                              C
                           
                         and 
                           
                              T
                              ⊂
                              C
                           
                         of seeds, S indicating the object and T indicating the background, we associate the object
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 S
                                 ,
                                 T
                                 )
                                 =
                                 {
                                 c
                                 ∈
                                 C
                                 :
                                 d
                                 (
                                 c
                                 ,
                                 S
                                 )
                                 <
                                 d
                                 (
                                 c
                                 ,
                                 T
                                 )
                                 }
                                 .
                              
                           
                        Of course, we would expect that
                           
                              (ST)
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       S
                                       ,
                                       T
                                       )
                                    
                                  contains S and is disjoint with T.

This is guaranteed only for a proper choice of the seed sets S and T. In particular, if d is a metric (e.g., geodesic), then (ST) holds precisely when S and T are disjoint. For the pseudo metric d (like the case of FC and MBD), (ST) holds precisely when the number 
                           
                              d
                              (
                              S
                              ,
                              T
                              )
                              =
                              min
                              {
                              d
                              (
                              s
                              ,
                              T
                              )
                              :
                              s
                              ∈
                              S
                              }
                           
                         is greater than 0.

For the Fuzzy Connectedness pseudo metric 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                           
                        , as defined above, the object 
                           
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         is precisely the Relative Fuzzy Connectedness, RFC, object. The Watershed object is also often defined as 
                           
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         (with respect to the distance 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                        ). Similarly, the delineated objects for the geodesic, fuzzy, and MB distances we define as 
                           
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         for their respective distance functions. In either case, the segmentation into k-objects, indicated by the seed sets 
                           
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                         can be defined as 
                           
                              {
                              
                                 
                                    P
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              )
                              :
                              i
                              =
                              1
                              ,
                              …
                              ,
                              k
                              }
                           
                        , where the set 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         is equal to 
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ∪
                              ⋯
                              ∪
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                              )
                              ⧹
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           
                        .

Let 
                        
                           λ
                        
                      be an arbitrary path cost function on a graph 
                        
                           G
                           =
                           〈
                           C
                           ,
                           E
                           〉
                        
                     . We assume that the cost of an empty path is infinite: 
                        
                           λ
                           (
                           ∅
                           )
                           =
                           ∞
                        
                     . Also, for any path 
                        
                           π
                           =
                           〈
                           π
                           (
                           0
                           )
                           ,
                           π
                           (
                           1
                           )
                           ,
                           …
                           ,
                           π
                           (
                           k
                           )
                           〉
                        
                      and c connected by an edge with 
                        
                           π
                           (
                           k
                           )
                        
                     , 
                        
                           π
                           
                           ∧
                           
                           c
                        
                      is a concatenation path 
                        
                           〈
                           π
                           (
                           0
                           )
                           ,
                           π
                           (
                           1
                           )
                           ,
                           …
                           ,
                           π
                           (
                           k
                           )
                           ,
                           c
                           〉
                        
                     .

Notice, that for the path cost functions we consider, the value of 
                        
                           λ
                           (
                           π
                           
                           ∧
                           
                           c
                           )
                        
                      can be calculated from the value of 
                        
                           λ
                           (
                           π
                           )
                        
                      in 
                        
                           O
                           (
                           1
                           )
                        
                      time. (More precisely, in the case of the barrier distance, we need to use the values of 
                        
                           
                              
                                 β
                              
                              
                                 -
                              
                           
                           (
                           π
                           )
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 +
                              
                           
                           (
                           π
                           )
                        
                      to find 
                        
                           
                              
                                 β
                              
                              
                                 -
                              
                           
                           (
                           π
                           
                           ∧
                           
                           c
                           )
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 +
                              
                           
                           (
                           π
                           
                           ∧
                           
                           c
                           )
                        
                      in 
                        
                           O
                           (
                           1
                           )
                        
                      time.) Therefore, for the complexity considerations, we will assume that the values of 
                        
                           λ
                           (
                           〈
                           r
                           〉
                           )
                        
                     , as well as that of 
                        
                           λ
                           (
                           π
                           
                           ∧
                           
                           c
                           )
                        
                      using 
                        
                           λ
                           (
                           π
                           )
                        
                     , can be found in 
                        
                           O
                           (
                           1
                           )
                        
                      time.
                        Algorithm 1
                        Dijkstra’s algorithm 
                              
                                 DA
                                 (
                                 λ
                                 ,
                                 R
                                 )
                              
                            
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             Input: Path cost function 
                                                
                                                   λ
                                                
                                              on a graph 
                                                
                                                   G
                                                   =
                                                   〈
                                                   C
                                                   ,
                                                   E
                                                   〉
                                                
                                             , non-empty 
                                                
                                                   R
                                                   ⊂
                                                   C
                                                
                                             .
                                       
                                       
                                          
                                             Output: For every 
                                                
                                                   c
                                                   ∈
                                                   C
                                                
                                             , a path 
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                              from an 
                                                
                                                   r
                                                   ∈
                                                   R
                                                
                                              to c and 
                                                
                                                   L
                                                   (
                                                   c
                                                   )
                                                   =
                                                   λ
                                                   (
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             Auxiliary: Ordered queue Q: if c precedes d in Q, then 
                                                
                                                   L
                                                   (
                                                   c
                                                   )
                                                   ⩽
                                                   L
                                                   (
                                                   d
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             begin
                                          
                                       
                                       
                                          
                                             1: For all 
                                                
                                                   c
                                                   ∈
                                                   C
                                                   ⧹
                                                   R
                                                
                                              initialize 
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   =
                                                   ∅
                                                
                                              and 
                                                
                                                   L
                                                   (
                                                   c
                                                   )
                                                   =
                                                   ∞
                                                
                                             ;
                                       
                                       
                                          
                                             2: For all 
                                                
                                                   r
                                                   ∈
                                                   R
                                                
                                              initialize 
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   =
                                                   〈
                                                   r
                                                   〉
                                                
                                              and 
                                                
                                                   L
                                                   (
                                                   r
                                                   )
                                                   =
                                                   λ
                                                   (
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   )
                                                
                                             , push all 
                                                
                                                   r
                                                   ∈
                                                   R
                                                
                                              to Q;
                                       
                                       
                                          
                                             3: while 
                                             Q is not empty do
                                          
                                       
                                       
                                          
                                             4:  Pop d from Q;
                                       
                                       
                                          
                                             5:  
                                             for every 
                                                
                                                   c
                                                   ∈
                                                   C
                                                
                                              connected by an edge to d 
                                             do
                                          
                                       
                                       
                                          
                                             6:  Calculate 
                                                
                                                   ℓ
                                                   =
                                                   λ
                                                   (
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                   ∧
                                                   
                                                   c
                                                   )
                                                
                                              using 
                                                
                                                   L
                                                   (
                                                   d
                                                   )
                                                
                                             ;
                                       
                                       
                                          
                                             7:  
                                             if 
                                             
                                                
                                                   ℓ
                                                   <
                                                   L
                                                   (
                                                   c
                                                   )
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             8: 
                                              Put 
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                   ∧
                                                   
                                                   c
                                                   ,
                                                   L
                                                   (
                                                   c
                                                   )
                                                   =
                                                   ℓ
                                                
                                             , place c to an appropriate place in Q;
                                       
                                       
                                          
                                             9:  
                                             end if
                                          
                                       
                                       
                                          10:  
                                             end for
                                          
                                       
                                       
                                          11: end while
                                          
                                       
                                       
                                          12: Return paths 
                                                
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                              and numbers 
                                                
                                                   L
                                                   (
                                                   c
                                                   )
                                                   =
                                                   λ
                                                   (
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   )
                                                
                                             ;
                                       
                                       
                                          
                                             end
                                          
                                       
                                    
                                 
                              
                           
                        

Consider the version of the Dijkstra’s algorithm presented as Algorithm 1. The algorithm always stops and, for the connected graphs, the returned paths 
                           
                              F
                              =
                              {
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              :
                              c
                              ∈
                              C
                              }
                           
                         form a forest rooted at R (i.e., any path in F starts at an 
                           
                              r
                              ∈
                              R
                           
                         and F contains any initial segment of a path in F). It is easy to see that if 
                           
                              λ
                           
                         is the path cost function for geodesic, Fuzzy Connectedness, or watershed distance, then the algorithm 
                           
                              DA
                              (
                              λ
                              ,
                              R
                              )
                           
                         returns 
                           
                              λ
                           
                        -minimal paths, that is, having the property that 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              c
                              ,
                              R
                              )
                              =
                              λ
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         for every 
                           
                              c
                              ∈
                              C
                           
                        . (All these path cost functions are smooth, in the sense of [20].) On the other hand, for the barrier strength cost function 
                           
                              λ
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        , this is not the case, as could be seen on the graph from Fig. 1
                        . Indeed, the two paths 
                           
                              
                                 
                                    π
                                 
                                 
                                    1
                                 
                              
                              =
                              〈
                              s
                              ,
                              a
                              ,
                              d
                              ,
                              s
                              〉
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              =
                              〈
                              s
                              ,
                              b
                              ,
                              d
                              ,
                              s
                              〉
                           
                         between s and c have the barrier weights 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              .
                              8
                              -
                              .
                              4
                              =
                              .
                              4
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              .
                              8
                              -
                              .
                              5
                              =
                              .
                              3
                           
                        , and so 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              s
                              ,
                              c
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              .
                              3
                           
                        . However, the initial restriction 
                           
                              π
                              =
                              〈
                              s
                              ,
                              b
                              ,
                              d
                              〉
                           
                         of 
                           
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                           
                         is not 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                           
                        -optimal for d (as 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                              =
                              .
                              7
                              -
                              .
                              5
                              =
                              .
                              2
                           
                        , while 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              s
                              ,
                              d
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              〈
                              s
                              ,
                              a
                              ,
                              d
                              〉
                              )
                              =
                              .
                              5
                              -
                              .
                              4
                              =
                              .
                              1
                              <
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        ), which is impossible for the Dijkstra’s algorithm.

Even for the good cases, when Algorithm 1 returns 
                           
                              λ
                           
                        -optimal paths, it seems that to find the object 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                              =
                              {
                              c
                              ∈
                              C
                              :
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              c
                              ,
                              S
                              )
                              <
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              c
                              ,
                              T
                              )
                              }
                           
                         it is necessary to run DA twice: 
                           
                              DA
                              (
                              λ
                              ,
                              S
                              )
                           
                         to compute 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              ·
                              ,
                              S
                              )
                           
                         and 
                           
                              DA
                              (
                              λ
                              ,
                              T
                              )
                           
                         to compute 
                           
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              ·
                              ,
                              T
                              )
                           
                        . To avoid this, in the experiments we used a modification 
                           
                              
                                 
                                    DA
                                 
                                 
                                    ∗
                                 
                              
                              (
                              λ
                              ,
                              S
                              ,
                              T
                              )
                           
                         of 
                           
                              DA
                              (
                              λ
                              ,
                              W
                              )
                           
                         with 
                           
                              W
                              =
                              S
                              ∪
                              T
                           
                         obtained by replacing the condition “
                           
                              ℓ
                              <
                              L
                              (
                              c
                              )
                           
                        ” in line 7 with “either λ(π
                        
                           d
                        
                        
                        ˆc)<λ(π
                        
                           c
                        ) or
                           
                              
                                 
                                    ℓ
                                    =
                                    L
                                    (
                                    c
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    0
                                    )
                                    ∈
                                    S
                                 
                               and 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    0
                                    )
                                    ∈
                                    T
                                 
                              .”
                        The additional condition insures, that for the path of same strength, the algorithm favors those that initiate at T.

If 
                           
                              F
                              =
                              {
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              :
                              c
                              ∈
                              C
                              }
                           
                         is a forest returned by 
                           
                              
                                 
                                    DA
                                 
                                 
                                    ∗
                                 
                              
                              (
                              λ
                              ,
                              S
                              ,
                              T
                              )
                           
                        , then the object
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             λ
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 S
                                 ,
                                 T
                                 )
                                 =
                                 {
                                 c
                                 ∈
                                 C
                                 :
                                 
                                    
                                       π
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 0
                                 )
                                 ∈
                                 S
                                 }
                              
                           
                        is uniquely defined, in a sense that any two forests returned by 
                           
                              
                                 
                                    DA
                                 
                                 
                                    ∗
                                 
                              
                              (
                              λ
                              ,
                              S
                              ,
                              T
                              )
                           
                         (which may be different, subject to possible differences in order of processing the vertices from Q) lead to the same set 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                        . Moreover, 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         contains 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         and is disjoint with 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                              (
                              T
                              ,
                              S
                              )
                           
                        ; in other words, 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         is a union of 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         and some of the vertices from the “boundary” set 
                           
                              {
                              c
                              ∈
                              C
                              :
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              c
                              ,
                              S
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    λ
                                 
                              
                              (
                              c
                              ,
                              T
                              )
                              }
                           
                        . All these facts on 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         were rigorously proved in [29] for the FC case, showing, in particular, that 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              ,
                              T
                              )
                           
                         is the Iterative Relative Fuzzy Connectedness, IRFC, object studied earlier. The arguments presented in [29] easily generalize to the case of a general path cost function.

Let 
                           
                              φ
                              (
                              c
                              ,
                              d
                              )
                              =
                              min
                              {
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                              :
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    c
                                    ,
                                    d
                                 
                              
                              }
                              -
                              max
                              {
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              :
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    c
                                    ,
                                    d
                                 
                              
                              }
                           
                        , that is,
                           
                              
                                 φ
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 -
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                                 .
                              
                           
                        Clearly, 
                           
                              φ
                              (
                              c
                              ,
                              d
                              )
                              ⩽
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              c
                              ,
                              d
                              )
                           
                        , that is, 
                           
                              φ
                           
                         gives a lower bound for the MBD 
                           
                              
                                 
                                    d
                                 
                                 
                                    β
                                 
                              
                           
                        . The equation need not hold, as 
                           
                              φ
                              (
                              s
                              ,
                              d
                              )
                              =
                              0
                              <
                              .
                              1
                              =
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              s
                              ,
                              d
                              )
                           
                         for the example from Fig. 1. Nevertheless, for image induced graphs, the map 
                           
                              φ
                           
                         approximates the MBD, as proved in [1] and explained in more details in Theorem 1. The additional advantage of using 
                           
                              φ
                           
                         as an approximation of MBD is that its values can be easily computed by the following algorithm introduced in [1].
                           Algorithm 2
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                       
                                          appr
                                       
                                    
                                    (
                                    {
                                    s
                                    }
                                    )
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: A vertex weight map w on a graph 
                                                   
                                                      G
                                                      =
                                                      〈
                                                      C
                                                      ,
                                                      E
                                                      〉
                                                   
                                                , an 
                                                   
                                                      s
                                                      ∈
                                                      C
                                                   
                                                .
                                          
                                          
                                             
                                                Output: A map 
                                                   
                                                      φ
                                                      (
                                                      ·
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                   
                                                .
                                          
                                          
                                             
                                                begin
                                             
                                          
                                          
                                             1: Run 
                                                   
                                                      DA
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ,
                                                               {
                                                               s
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                 and record 
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  w
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      c
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                      =
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                 for every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                ;
                                          
                                          
                                             2: Run 
                                                   
                                                      DA
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     β
                                                                  
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               ,
                                                               {
                                                               s
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                , where 
                                                   
                                                      v
                                                      =
                                                      M
                                                      -
                                                      w
                                                   
                                                 and 
                                                   
                                                      M
                                                      =
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            c
                                                            ∈
                                                            C
                                                         
                                                      
                                                      w
                                                      (
                                                      c
                                                      )
                                                   
                                                ,
                                          
                                          
                                             
                                                 and record 
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  w
                                                               
                                                               
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      c
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                      =
                                                      M
                                                      -
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                 for every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                ;
                                          
                                          
                                             3: Return map 
                                                   
                                                      φ
                                                      (
                                                      c
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                      =
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  w
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      c
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  w
                                                               
                                                               
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      c
                                                      ,
                                                      {
                                                      s
                                                      }
                                                      )
                                                   
                                                ;
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                              
                           

The following theorem is a variant of a theorem proved in [1]. It specifies an upper bound of a difference between MBD and 
                           
                              φ
                           
                        .
                           Theorem 1
                           
                              Let 
                              
                                 
                                    G
                                    =
                                    〈
                                    C
                                    ,
                                    E
                                    ,
                                    w
                                    〉
                                 
                               
                              be a vertex weighted graph of a rectangular k-D image and let 
                              
                                 
                                    ε
                                    =
                                    max
                                    {
                                    |
                                    w
                                    (
                                    x
                                    )
                                    -
                                    w
                                    (
                                    y
                                    )
                                    |
                                    :
                                    x
                                    ,
                                    y
                                    ∈
                                    C
                                    
                                    are
                                    
                                    (
                                    
                                       
                                          3
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    1
                                    )
                                    -
                                    adjacent
                                    }
                                 
                              
                              . Then for every 
                              
                                 
                                    c
                                    ,
                                    d
                                    ∈
                                    C
                                 
                               
                              there exists a path 
                              
                                 
                                    π
                                    ∈
                                    
                                       
                                          Π
                                       
                                       
                                          c
                                          ,
                                          d
                                       
                                    
                                 
                               
                              with the range in 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         w
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                             (
                                             c
                                             ,
                                             d
                                             )
                                             -
                                             ε
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         w
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                
                                             
                                             (
                                             c
                                             ,
                                             d
                                             )
                                             +
                                             ε
                                          
                                       
                                    
                                 
                              
                              . In particular, 
                              
                                 
                                    0
                                    ⩽
                                    
                                       
                                          d
                                       
                                       
                                          β
                                       
                                    
                                    (
                                    c
                                    ,
                                    d
                                    )
                                    -
                                    φ
                                    (
                                    c
                                    ,
                                    d
                                    )
                                    ⩽
                                    2
                                    ε
                                 
                              
                              , that is, 
                              
                                 
                                    φ
                                 
                               
                              approximates the MBD with at most 
                              
                                 
                                    2
                                    ε
                                 
                               
                              error.
                           

The proof of the theorem translates the discrete MBD to the continuous case and uses the fact that in the continuous case the distance 
                           
                              φ
                           
                         coincides with MBD. This last fact is based heavily on a version of Alexander’s lemma (see e.g. [32, p. 137]), a deep topological result.

Unfortunately, the number 
                           
                              φ
                              (
                              ·
                              ,
                              S
                              )
                           
                         returned by 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         well approximates the MBD distance 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              c
                              ,
                              S
                              )
                           
                         only when S is a singleton. Thus, for larger sets S, to find 
                           
                              φ
                              (
                              ·
                              ,
                              S
                              )
                           
                         using 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    appr
                                 
                              
                           
                         within 
                           
                              2
                              ε
                           
                         error, it is necessary to run 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    appr
                                 
                              
                              (
                              {
                              s
                              }
                              )
                           
                         for every 
                           
                              s
                              ∈
                              S
                           
                         to find maps 
                           
                              φ
                              (
                              ·
                              ,
                              {
                              s
                              }
                              )
                           
                         and, at the end, compute 
                           
                              φ
                              (
                              ·
                              ,
                              S
                              )
                           
                         as 
                           
                              
                                 
                                    min
                                 
                                 
                                    s
                                    ∈
                                    S
                                 
                              
                              φ
                              (
                              ·
                              ,
                              {
                              s
                              }
                              )
                           
                        . Then, the approximation given by Theorem 1 still holds. However, such a procedure essentially increases the computational complexity of finding 
                           
                              φ
                              (
                              ·
                              ,
                              S
                              )
                           
                        .

Of course, the forest 
                           
                              {
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              :
                              c
                              ∈
                              C
                              }
                           
                         returned by the algorithm 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              R
                              )
                           
                         gives an upper bound 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         of MBD map 
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              c
                              ,
                              R
                              )
                           
                        . However, there is no known theoretical result giving an upper bound for the error for the difference 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                              -
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              c
                              ,
                              R
                              )
                           
                        . Nevertheless, all three measures, 
                           
                              φ
                              (
                              c
                              ,
                              s
                              )
                              ,
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                              (
                              c
                              ,
                              s
                              )
                           
                        , and 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        , are experimentally compared, see Section 4.1.

The proof of correctness of the main algorithm presented in this section, 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                        , is a bit involved. However, an idea behind 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                         is relative simple and can be already seen in its simpler version, presented here as the algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                        . Therefore, we start here with the discussion of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                        .

For a vertex weight map w on a graph 
                           
                              G
                              =
                              〈
                              C
                              ,
                              E
                              〉
                           
                         and an 
                           
                              a
                              ∈
                              R
                           
                         define a modified vertex weight map 
                           
                              
                                 
                                    w
                                 
                                 
                                    a
                                 
                              
                           
                         as
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 c
                                 )
                                 =
                                 w
                                 (
                                 c
                                 )
                                 
                                 provided
                                 
                                 w
                                 (
                                 c
                                 )
                                 ⩾
                                 a
                                 
                                 and
                                 
                                 
                                    
                                       w
                                    
                                    
                                       a
                                    
                                 
                                 (
                                 c
                                 )
                                 =
                                 ∞
                                 
                                 otherwise
                                 .
                              
                           
                        
                        
                           Theorem 2
                           
                              The paths 
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          c
                                       
                                    
                                 
                               
                              returned by 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                       
                                          simple
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              indeed satisfy 
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          c
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                w
                                             
                                          
                                       
                                    
                                    (
                                    c
                                    ,
                                    S
                                    )
                                 
                              
                              . Moreover, if 
                              
                                 
                                    n
                                    =
                                    |
                                    C
                                    |
                                 
                              
                              , the size of C, and we assume that 
                              
                                 
                                    O
                                    (
                                    |
                                    E
                                    |
                                    )
                                    =
                                    n
                                 
                              
                              , then 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                       
                                          simple
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              stops after at most 
                              
                                 
                                    O
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    ln
                                    n
                                    )
                                 
                               
                              operations.
                           


                              In addition, if the range of w is a subset of a fixed set of size 
                              
                                 
                                    m
                                    ⩽
                                    n
                                 
                              
                              , then there exists a small modification of 
                              
                                 
                                    DA
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    S
                                    )
                                 
                               
                              such that 
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                       
                                          simple
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              requires at most 
                              
                                 
                                    O
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                    n
                                    )
                                 
                               
                              operations.
                           


                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                       
                                          simple
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: A vertex weight map w on a graph 
                                                   
                                                      G
                                                      =
                                                      〈
                                                      C
                                                      ,
                                                      E
                                                      〉
                                                   
                                                , non-empty 
                                                   
                                                      S
                                                      ⊂
                                                      C
                                                   
                                                .
                                          
                                          
                                             
                                                Output: For every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                 a path 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 from S to c with 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  w
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      c
                                                      ,
                                                      S
                                                      )
                                                   
                                                .
                                          
                                          
                                             
                                                begin
                                             
                                          
                                          
                                             
                                                1: Initialize: 
                                                   
                                                      U
                                                      =
                                                      max
                                                      {
                                                      w
                                                      (
                                                      s
                                                      )
                                                      :
                                                      s
                                                      ∈
                                                      S
                                                      }
                                                   
                                                ; for 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      ∅
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      ∞
                                                   
                                                ;
                                          
                                          
                                             
                                                2: Push all numbers from 
                                                   
                                                      {
                                                      w
                                                      (
                                                      c
                                                      )
                                                      ⩽
                                                      U
                                                      :
                                                      c
                                                      ∈
                                                      C
                                                      }
                                                   
                                                 to a queue Q, each only once;
                                          
                                          
                                             
                                                3: while 
                                                Q is not empty do
                                             
                                          
                                          
                                             
                                                4:  Pop a from Q; run 
                                                   
                                                      DA
                                                      (
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            v
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      ,
                                                      S
                                                      )
                                                   
                                                 with 
                                                   
                                                      v
                                                      =
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                , returning 
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                ’s &
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                ’s;
                                          
                                          
                                             
                                                5:  
                                                for every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                6:  
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                7: 
                                                 Put 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 and update the value of 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                 to 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                ;
                                          
                                          
                                             
                                                8:  
                                                end if
                                             
                                          
                                          
                                             
                                                9:  
                                                end for
                                             
                                          
                                          
                                             10: end while
                                             
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                              
                           

Notice that if there exists a path 
                                 
                                    π
                                 
                               from S to c with the range in 
                                 
                                    [
                                    a
                                    ,
                                    ∞
                                    )
                                 
                              , then the path 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          c
                                       
                                    
                                 
                               returned by 
                                 
                                    DA
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    S
                                    )
                                 
                               with 
                                 
                                    v
                                    =
                                    
                                       
                                          w
                                       
                                       
                                          a
                                       
                                    
                                 
                               also has this property. This immediately implies correctness of the algorithm.

The first complexity estimate follows from the fact that the complexity of the standard form of 
                                 
                                    DA
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    S
                                    )
                                 
                               is 
                                 
                                    O
                                    (
                                    n
                                    ln
                                    n
                                    )
                                 
                              , while we run it at most n-many times. The second complexity estimate follows from the fact that, under the assumption, there is a form of 
                                 
                                    DA
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          w
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    S
                                    )
                                 
                               that runs in 
                                 
                                    O
                                    (
                                    mn
                                    )
                                 
                               time, as shown in [29] (compare discussion below), and that in this case the loop is executed at most m times.□

Notice that in image processing it is very common that indeed m is a lot smaller than n, in which case the complexity of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                           
                         becomes 
                           
                              O
                              (
                              n
                              )
                           
                        . However, the constants in this estimate are significant, so 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                           
                         runs many times (of order 
                           
                              O
                              (
                              m
                              )
                           
                        ) slower than 
                           
                              DA
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       S
                                    
                                 
                              
                           
                        .

As it can be seen, an idea behind the algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                           
                         is that for every 
                           
                              c
                              ∈
                              C
                           
                         we consider all possible lower bounds 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                           
                         among the paths 
                           
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         and, for each such lower bound a, we find a path 
                           
                              
                                 
                                 
                                    a
                                 
                              
                              π
                           
                         minimizing 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                           
                        ; then 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -minimizer of 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         is found among such 
                           
                              
                                 
                                 
                                    a
                                 
                              
                              π
                           
                        ’s. This idea is also present in the algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                        , though in its dual form: we consider all possible upper bounds 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                           
                         among the paths 
                           
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         and, for each such upper bound b, we find a path 
                           
                              
                                 
                                 
                                    b
                                 
                              
                              π
                           
                         maximizing 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                        ; a 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -minimizer of 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         is one of the 
                           
                              
                                 
                                 
                                    b
                                 
                              
                              π
                           
                        ’s with the smallest 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -value. The main difference between 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                         is in how we choose “all possible one-sided bounds:” in the case of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                           
                         we consider for this purpose all 
                           
                              a
                              ∈
                              W
                              ,
                              a
                              ⩽
                              U
                           
                        . In 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                         this process is considerably more subtle.

More precisely, 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                         can be considered as a Dijkstra’s algorithm for finding 
                           
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         with the minimal value of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        , in which “ill-advised order” of the queue Q is used: instead of ordering Q according to the values of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         of already found paths, we order it according the values of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                           
                         of such paths. Although this order would be suboptimal if we were only to find the 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                        -optimal paths, this allows us: (1) to consider as “all possible upper bounds of 
                           
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                        ” only the upper bounds of the paths examined during the execution of the algorithm; (2) while considering such an upper bound, say b, to examine all paths 
                           
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         with 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                              ⩽
                              b
                           
                        , to choose among such paths one, say 
                           
                              
                                 
                                 
                                    b
                                 
                              
                              π
                           
                        , with the largest lower bound, and to update our current best 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -estimate 
                           
                              
                                 
                                    p
                                 
                                 
                                    c
                                 
                              
                           
                         among 
                           
                              π
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                           
                         to 
                           
                              
                                 
                                 
                                    b
                                 
                              
                              π
                           
                        , if appropriate.
                           Algorithm 4
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: A vertex weighted graph 
                                                   
                                                      G
                                                      =
                                                      〈
                                                      C
                                                      ,
                                                      E
                                                      ,
                                                      w
                                                      〉
                                                   
                                                , non-empty 
                                                   
                                                      S
                                                      ⊂
                                                      C
                                                   
                                                .
                                          
                                          
                                             
                                                Output: For every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                 a path 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 from an 
                                                   
                                                      s
                                                      ∈
                                                      S
                                                   
                                                 to c such that the number 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                 is the minimum barrier distance from S to c.
                                          
                                          
                                             
                                                Auxiliary: For every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                   
                                                 a path 
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                 from S to c being 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                   
                                                -optimal.
                                          
                                          
                                             A priority queue Q: if c precedes d in Q then either 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                   
                                                 or 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      ⩾
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                   
                                                .
                                          
                                          
                                             
                                                begin
                                             
                                          
                                          
                                             
                                                1: For every 
                                                   
                                                      s
                                                      ∈
                                                      S
                                                   
                                                 initialize: 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      =
                                                      〈
                                                      s
                                                      〉
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      w
                                                      (
                                                      s
                                                      )
                                                   
                                                ;
                                          
                                          
                                             
                                                2: For every 
                                                   
                                                      c
                                                      ∈
                                                      C
                                                      ⧹
                                                      S
                                                   
                                                 put: 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      =
                                                      ∅
                                                      ,
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      -
                                                      ∞
                                                   
                                                , and 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      =
                                                      ∞
                                                   
                                                ;
                                          
                                          
                                             
                                                3: Push all 
                                                   
                                                      s
                                                      ∈
                                                      S
                                                   
                                                 to Q;
                                          
                                          
                                             
                                                4: while
                                                Q is not empty do
                                             
                                          
                                          
                                             
                                                5:  Pop c from Q;
                                          
                                          
                                             
                                                6:  
                                                for every 
                                                   
                                                      d
                                                      ∈
                                                      C
                                                   
                                                 connected by an edge to c 
                                                do
                                             
                                          
                                          
                                             
                                                7:  Set 
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                      ∧
                                                      
                                                      d
                                                      )
                                                      =
                                                      min
                                                      {
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      ,
                                                      w
                                                      (
                                                      d
                                                      )
                                                      }
                                                   
                                                ;
                                          
                                          
                                             
                                                8:  Set 
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                      ∧
                                                      
                                                      d
                                                      )
                                                      =
                                                      max
                                                      {
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      )
                                                      ,
                                                      w
                                                      (
                                                      d
                                                      )
                                                      }
                                                   
                                                ;
                                          
                                          
                                             
                                                9:  
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             10: 
                                                 Set 
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                      ∧
                                                      
                                                      d
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ←
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ←
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ←
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             11: 
                                                 Remove d from Q, if needed; place d into (a right place) in Q;
                                          
                                          
                                             12: 
                                                 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      <
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             13: 
                                                 Set 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                ;
                                          
                                          
                                             14: 
                                                 
                                                end if
                                             
                                          
                                          
                                             15:  
                                                end if
                                             
                                          
                                          
                                             16:  
                                                end for
                                             
                                          
                                          
                                             17: end while
                                             
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                              
                           

The proof of the complexity (but not of the correctness) of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                        , presented in Theorem 3, requires the assumption that the graph’s degree (i.e., the largest number of edges connected to a single vertex) is small, 
                           
                              O
                              (
                              1
                              )
                           
                        , with respect to the size n of the set C of graph’s vertices. This assumption is essentially always true for the graphs associated with images. Moreover, we make some additional assumptions about the structure of the queue Q it utilizes. Actually, the algorithm works correctly if Q has a simple structure of a double linked list. However, in such structure the insertion of a vertex, as in the line 11 of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                        , would require 
                           
                              O
                              (
                              n
                              )
                           
                         operation. Therefore, we will consider two other structures for Q. The first is a binary heap that allows insertion and deletion of any element in 
                           
                              O
                              (
                              ln
                              n
                              )
                           
                         time [33]. However, for the graphs associated with image processing, the set Z of possible values of a weight function w is usually restricted to a fixed set of a modest size, most frequently of a form 
                           
                              Z
                              =
                              {
                              i
                              /
                              D
                              :
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         for m not exceeding 
                           
                              
                                 
                                    2
                                 
                                 
                                    12
                                 
                              
                              =
                              4096
                           
                        . In this case, Q can be defined as an array of buckets indexed by the set 
                           
                              V
                              =
                              {
                              〈
                              
                                 
                                    β
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    -
                                 
                              
                              〉
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    2
                                 
                              
                              :
                              
                                 
                                    β
                                 
                                 
                                    +
                                 
                              
                              ⩾
                              
                                 
                                    β
                                 
                                 
                                    -
                                 
                              
                              }
                           
                         and ordered as described in the algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                           
                        . This is, essentially, the structure described in [29]. Each bucket with an index 
                           
                              〈
                              
                                 
                                    β
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    -
                                 
                              
                              〉
                              ∈
                              V
                           
                         consists of the pointers to vertices c for which 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    -
                                 
                              
                           
                        . An advantage of Q to be represented in such an array format is that this allows 
                           
                              O
                              (
                              1
                              )
                           
                        -time insertion into Q and deletion from Q of any element c with a fixed label 
                           
                              〈
                              z
                              ,
                              ℓ
                              〉
                           
                        . Emptying Q in the priority order from the largest to the smallest vertex in V, as done when executing line 5 of the algorithm, may require 
                           
                              O
                              (
                              |
                              V
                              |
                              )
                              =
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         operations during the complete execution of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                        . For large images, 
                           
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         is usually considered as smaller than 
                           
                              O
                              (
                              n
                              )
                           
                        , favoring the array of buckets implementation. However, in our implementations, including 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                        , we use Dijkstra’s algorithm with the binary heap queue structure.
                           Theorem 3
                           On the correctness and complexity of 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          MBD
                                       
                                    
                                    (
                                    S
                                    )
                                 
                              
                           


                           
                              
                                 
                                    Correctness: After 
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   MBD
                                                
                                             
                                             (
                                             S
                                             )
                                          
                                        
                                       terminates, we have 
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   w
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   c
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                             
                                             (
                                             c
                                             ,
                                             S
                                             )
                                          
                                        
                                       for all 
                                       
                                          
                                             c
                                             ∈
                                             C
                                          
                                       
                                       .
                                    

Complexity: Let n be the size of the graph and m be the size of a fix set Z, containing 
                                       
                                          
                                             W
                                             =
                                             {
                                             w
                                             (
                                             c
                                             )
                                             :
                                             c
                                             ∈
                                             C
                                             }
                                          
                                       
                                       . The algorithm computational complexity is either
                                       
                                          
                                             (BH) 
                                                   
                                                      O
                                                      (
                                                      m
                                                      
                                                      n
                                                      ln
                                                      n
                                                      )
                                                   
                                                
                                                , if we use binary heap as Q, or
                                             

(LS) 
                                                   
                                                      O
                                                      (
                                                      m
                                                      (
                                                      n
                                                      +
                                                      m
                                                      )
                                                      )
                                                   
                                                
                                                , if we use as Q a list structure described above.
                                             

a vertex d can be popped from the queue, line 5, at most m times.

To see this property, notice that with an ith appearance of d in Q we associate, in line 11, a path 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         from S to d. For d to appear in Q for the 
                           
                              (
                              i
                              +
                              1
                              )
                           
                        -st time, we must have executed the line 11, meaning that 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              >
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        . This means that 
                           
                              〈
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    〉
                                 
                                 
                                    i
                                 
                              
                           
                         is a strictly increasing sequence of numbers from W. So, the sequence cannot have more than m elements and (
                           
                              ∗
                           
                        ) is proved.

Now, in the case of (BH), (
                           
                              ∗
                           
                        ) implies that the loop can be executed at most 
                           
                              mn
                           
                        -times, meaning that the algorithm’s complexity is 
                           
                              O
                              (
                              mn
                              ln
                              n
                              )
                           
                        .

In the case of (LS), the true execution of the loop is 
                           
                              O
                              (
                              mn
                              )
                           
                        . However, in addition, we may need 
                           
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         operations for searching, in line 4, for the top of the queue. This gives complexity 
                           
                              O
                              (
                              mn
                              )
                              +
                              O
                              (
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              O
                              (
                              m
                              (
                              n
                              +
                              m
                              )
                              )
                           
                        .□

Before we prove the correctness of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                        , it might be useful to follow the execution of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              {
                              s
                              }
                              )
                           
                         for the graph from Fig. 1. In this example, we use the convention that 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              ∅
                              )
                              =
                              ∞
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              ∅
                              )
                              =
                              -
                              ∞
                           
                        . After the execution of lines 1–3, we have 
                           
                              
                                 
                                    π
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    s
                                 
                              
                              =
                              〈
                              s
                              〉
                           
                        , and this state does not change, so we will not list it below. The state of the remaining variables is listed as follows, where index i represents the time just before the ith execution of line 4 (so state 1, is just after the initialization).
                           
                              1: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             x
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       =
                                       ∅
                                    
                                  for 
                                    
                                       x
                                       ∈
                                       {
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       ,
                                       d
                                       }
                                    
                                  and 
                                    
                                       Q
                                       =
                                       〈
                                       s
                                       〉
                                    
                                 ;

2: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       ∅
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       ∅
                                    
                                 ,


                                 
                                    
                                       Q
                                       =
                                       〈
                                       a
                                       ,
                                       b
                                       〉
                                    
                                  (
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       )
                                       =
                                       .
                                       5
                                       <
                                       .
                                       7
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                 );

3: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       ∅
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       〉
                                    
                                 ,


                                 
                                    
                                       Q
                                       =
                                       〈
                                       d
                                       ,
                                       b
                                       〉
                                    
                                  (
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       =
                                       .
                                       5
                                       <
                                       .
                                       7
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                 );

4: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       ,
                                       c
                                       〉
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       〉
                                       ,
                                       Q
                                       =
                                       〈
                                       b
                                       ,
                                       c
                                       〉
                                    
                                  (
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       )
                                       =
                                       .
                                       7
                                       <
                                       .
                                       8
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                 );

5: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       ,
                                       c
                                       〉
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       〉
                                    
                                 , 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       ,
                                       d
                                       〉
                                    
                                 , 
                                    
                                       Q
                                       =
                                       〈
                                       d
                                       ,
                                       c
                                       〉
                                    
                                  (
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       =
                                       .
                                       7
                                       <
                                       .
                                       8
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                 );

6: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       ,
                                       d
                                       ,
                                       c
                                       〉
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       ,
                                       d
                                       〉
                                    
                                 , 
                                    
                                       Q
                                       =
                                       〈
                                       c
                                       〉
                                    
                                 ;

7: 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             a
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             b
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       ,
                                       d
                                       ,
                                       c
                                       〉
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       a
                                       ,
                                       d
                                       〉
                                       ,
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       〈
                                       s
                                       ,
                                       b
                                       ,
                                       d
                                       〉
                                       ,
                                       Q
                                       =
                                       ∅
                                    
                                 ;

Pop c from Q; Set 
                                    
                                       j
                                       ←
                                       j
                                       +
                                       1
                                    
                                  and 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ¯
                                          
                                       
                                       [
                                       j
                                       ]
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                 .

Let 
                           
                              〈
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              [
                              j
                              ]
                              
                                 
                                    〉
                                 
                                 
                                    j
                                 
                              
                           
                         be the array recorded during the execution of the algorithm. Then, by the order imposed on Q, it is non-decreasing (i.e., 
                           
                              
                                 
                                    M
                                 
                                 
                                    ¯
                                 
                              
                              [
                              k
                              ]
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ¯
                                 
                              
                              [
                              k
                              +
                              1
                              ]
                           
                         for all allowable indices k).

For any real number M define the sets 
                           
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                              =
                              {
                              π
                              ∈
                              Π
                              :
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                              ⩽
                              M
                              }
                           
                         and 
                           
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                              =
                              {
                              π
                              ∈
                              Π
                              :
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                              <
                              M
                              }
                           
                        . We prove that for every 
                           
                              M
                              ∈
                              W
                           
                         the following property holds. This will finish the proof, since (
                           
                              •
                           
                        ) for 
                           
                              M
                              =
                              max
                              W
                           
                         is precisely the desired correctness of the algorithm.
                           
                              (
                                    
                                       •
                                    
                                 )
                              Let k be the largest index with 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ¯
                                          
                                       
                                       [
                                       k
                                       ]
                                       ⩽
                                       M
                                    
                                 . Then, for every 
                                    
                                       d
                                       ∈
                                       C
                                    
                                  with 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             S
                                             ,
                                             d
                                          
                                       
                                       ∩
                                       
                                          
                                             Π
                                          
                                          
                                             M
                                          
                                       
                                       
                                       ≠
                                       
                                       ∅
                                    
                                 , after the kth execution of the loop 5–16 we have
                                    
                                       (a)
                                       
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                           maximizes 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      w
                                                   
                                                   
                                                      -
                                                   
                                                
                                             
                                           on 
                                             
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      S
                                                      ,
                                                      d
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          , and


                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                           minimizes 
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      w
                                                   
                                                
                                             
                                           on 
                                             
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      S
                                                      ,
                                                      d
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          .

To see (a), for every 
                           
                              m
                              ∈
                              W
                           
                         and 
                           
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                         consider the property:
                           
                              (
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                          
                                             m
                                          
                                       
                                    
                                 )
                              For every 
                                    
                                       d
                                       ∈
                                       C
                                    
                                 , if there exists a 
                                    
                                       π
                                       ∈
                                       
                                          
                                             Π
                                          
                                          
                                             S
                                             ,
                                             d
                                          
                                       
                                       ∩
                                       
                                          
                                             Π
                                          
                                          
                                             M
                                          
                                       
                                    
                                  of length 
                                    
                                       ⩽
                                       ℓ
                                    
                                  such that 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                       (
                                       π
                                       )
                                       ⩾
                                       m
                                    
                                  and 
                                    
                                       π
                                    
                                  maximizes 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                  on 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             S
                                             ,
                                             d
                                          
                                       
                                       ∩
                                       
                                          
                                             Π
                                          
                                          
                                             M
                                          
                                       
                                    
                                 , then 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             d
                                          
                                       
                                    
                                  also maximizes 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                  on 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             S
                                             ,
                                             d
                                          
                                       
                                       ∩
                                       
                                          
                                             Π
                                          
                                          
                                             M
                                          
                                       
                                    
                                 .

We need to show that (
                           
                              
                                 
                                    a
                                 
                                 
                                    ℓ
                                 
                                 
                                    m
                                 
                              
                           
                        ) holds for every 
                           
                              m
                              ∈
                              W
                           
                         and 
                           
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                        . To prove this, for 
                           
                              μ
                              ∈
                              W
                           
                         consider the statement:
                           
                              (
                                    
                                       
                                          
                                             a
                                          
                                          
                                             μ
                                          
                                       
                                    
                                 )
                              The property (
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                          
                                             μ
                                          
                                       
                                    
                                 ) holds for every 
                                    
                                       ℓ
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                    
                                 .

By the power of recursion, it is enough to prove that for every 
                           
                              m
                              ∈
                              W
                           
                        : if (
                           
                              
                                 
                                    a
                                 
                                 
                                    μ
                                 
                              
                           
                        ) holds for every 
                           
                              μ
                              >
                              m
                           
                         with 
                           
                              μ
                              ∈
                              W
                           
                        , then (
                           
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                              
                           
                        ) is also true.

So, fix an 
                           
                              m
                              ∈
                              W
                           
                         and assume that (
                           
                              
                                 
                                    a
                                 
                                 
                                    μ
                                 
                              
                           
                        ) holds for every 
                           
                              μ
                              >
                              m
                           
                         with 
                           
                              μ
                              ∈
                              W
                           
                        . We must show (
                           
                              
                                 
                                    a
                                 
                                 
                                    m
                                 
                              
                           
                        ), that is, that (
                           
                              
                                 
                                    a
                                 
                                 
                                    ℓ
                                 
                                 
                                    m
                                 
                              
                           
                        ) holds for every 
                           
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                        . This will be proven by induction on 
                           
                              ℓ
                           
                        .

Clearly, 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                         holds for 
                           
                              ℓ
                              =
                              1
                           
                        , since in this case we need only to consider d from S and then 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                           
                         must be equal 
                           
                              〈
                              d
                              〉
                           
                        , what is insured in line 1. So, assume that for some 
                           
                              ℓ
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                         the property 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                         holds. We need to prove 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             +
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        . To see 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                             +
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        , fix a 
                           
                              π
                              =
                              〈
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    ℓ
                                 
                              
                              〉
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                           
                         maximizing 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        , for which 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                              ⩾
                              m
                           
                        . We need to show that 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                           
                         maximizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        .

If 
                           
                              μ
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                              >
                              m
                           
                        , then this maximization is insured by (
                           
                              
                                 
                                    a
                                 
                                 
                                    μ
                                 
                              
                           
                        ). So, assume that 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                              =
                              m
                           
                         and let 
                           
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              =
                              〈
                              
                                 
                                    c
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    ℓ
                                    -
                                    1
                                 
                              
                              〉
                           
                        . Notice that for 
                           
                              c
                              =
                              
                                 
                                    c
                                 
                                 
                                    ℓ
                                    -
                                    1
                                 
                              
                           
                        ,
                           
                              (
                                    
                                       ∗
                                    
                                 )
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             c
                                          
                                       
                                    
                                  maximizes 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                          
                                             -
                                          
                                       
                                    
                                  on 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             S
                                             ,
                                             c
                                          
                                       
                                       ∩
                                       
                                          
                                             Π
                                          
                                          
                                             M
                                          
                                       
                                    
                                 .

Indeed, if 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              >
                              m
                           
                        , then for any 
                           
                              
                                 
                                    π
                                 
                                 
                                    ″
                                 
                              
                           
                         maximizing 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    c
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                         (which may have length greater than 
                           
                              ℓ
                           
                        ) we have 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ″
                                 
                              
                              )
                              ⩾
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              >
                              m
                           
                        . Thus, (
                           
                              ∗
                           
                        ) is insured by (
                           
                              
                                 
                                    a
                                 
                                 
                                    μ
                                 
                              
                           
                        ). On the other hand, if 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              m
                           
                        , then (
                           
                              ∗
                           
                        ) is insured by 
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ℓ
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                           
                        .

Finally, notice that, by (
                           
                              ∗
                           
                        ), vertex c, together with the path 
                           
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                           
                        , must have been placed into Q prior to kth execution of the loop 5–16 (through the execution of either line 3 or line 11). Therefore, for some 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ⩽
                              k
                           
                        , this c, with the same path 
                           
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                           
                        , is popped from Q and after the consecutive execution of the lines 10–11 we must have 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                              )
                              =
                              max
                              {
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    c
                                 
                              
                              )
                              ,
                              w
                              (
                              d
                              )
                              }
                              ⩾
                              m
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                           
                        . This means, that 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                           
                         maximizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        , finishing the proof of (a).

We prove part (b) by induction along the increasing order of W. So, let 
                           
                              M
                              ∈
                              W
                           
                         be such that (b) holds for every 
                           
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              W
                           
                         smaller than M. By the power of induction, it is enough to prove that (b) holds for M. So, fix a 
                           
                              d
                              ∈
                              C
                           
                         with 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                              
                              ≠
                              
                              ∅
                           
                         and let 
                           
                              π
                           
                         be a path minimizing 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . Let p be equal the value of 
                           
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                           
                         after the kth execution of the loop 5–16. Clearly 
                           
                              p
                              ∈
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . To finish the proof, it is enough to show that p minimizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        , that is, that 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              p
                              )
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        .

If 
                           
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                           
                         is less than M, then, by the inductive assumption, for some 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              <
                              k
                           
                        , after the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        th execution of the loop 5–16 we have 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                              )
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        . Clearly, the value of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                              )
                           
                         cannot increase during the algorithm’s execution, so after the kth execution of the loop 5–16 still 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              p
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                              )
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        , that is, p minimizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . Therefore, in what follows we can assume that 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              π
                              )
                              =
                              M
                           
                        .

If 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                              =
                              ∅
                           
                        , then, by part (a), for some 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ⩽
                              k
                           
                         (with 
                           
                              
                                 
                                    M
                                 
                                 
                                    ¯
                                 
                              
                              [
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ]
                              =
                              M
                           
                        ), during the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        th execution of the loop 5–16, 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                           
                         becomes a maximizer of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . Then 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                              )
                              =
                              M
                           
                        , since 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                              
                              ∉
                              
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                           
                        . Thus, the execution of lines 12–14 during the same execution of the loop insures that, from this point on, 
                           
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                           
                         also minimizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . So, in what follows we can assume that 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                              
                              ≠
                              
                              ∅
                           
                        .

Since 
                           
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                              
                              ≠
                              
                              ∅
                           
                        , there exists an 
                           
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              W
                           
                         (the largest number in W smaller than M) such that 
                           
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    Π
                                 
                                 
                                    <
                                    M
                                 
                              
                           
                        . In particular, 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              
                              ≠
                              
                              ∅
                           
                        . By the inductive assumption, (
                           
                              •
                           
                        ) holds for 
                           
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                           
                        . So, let 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                         be the largest index with 
                           
                              
                                 
                                    M
                                 
                                 
                                    ¯
                                 
                              
                              [
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ]
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                           
                         and let and 
                           
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                           
                         be the path 
                           
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                           
                         immediately after the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                           
                        th execution of the loop 5–16. Then, 
                           
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                           
                         maximizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        .

Next, notice that 
                           
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              <
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                           
                        . Indeed, the inequality 
                           
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              ⩾
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                           
                         would imply 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    ′
                                 
                              
                              )
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              <
                              M
                              -
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              π
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        , contradicting the fact that 
                           
                              π
                           
                         minimizes 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                        . Therefore, the maximum of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    M
                                 
                              
                           
                         is strictly greater than the maximum of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         on 
                           
                              
                                 
                                    Π
                                 
                                 
                                    S
                                    ,
                                    d
                                 
                              
                              ∩
                              
                                 
                                    Π
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        . So, by (a), there exists a 
                           
                              
                                 
                                    k
                                 
                                 
                                    ″
                                 
                              
                              ∈
                              (
                              
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ,
                              k
                              ]
                           
                         such that during the 
                           
                              
                                 
                                    k
                                 
                                 
                                    ″
                                 
                              
                           
                        th execution of the loop 5–16, the condition on line 9 is satisfied. In particular, directly after the execution of the line 10, 
                           
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              
                                 
                                    π
                                 
                                 
                                    d
                                 
                              
                              )
                              ⩽
                              M
                           
                        , implying that after the execution of lines 12–14, 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    d
                                 
                              
                              )
                              ⩽
                              M
                              -
                              
                                 
                                    m
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        . In particular, 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              p
                              )
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              (
                              π
                              )
                           
                        , finishing the proof.□

The algorithms 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         have the same computation efficiency, when measured in terms of the worst case scenario. So, why do we bother with a more complicated version 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                        ? Actually, it is easy to argue that the execution time of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         is never worse than that of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                         and, in most cases, 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         is more efficient. To see this, let 
                           
                              δ
                           
                         be the degree of the graph (for the images, 
                           
                              δ
                              =
                              4
                           
                         in 2D and 
                           
                              δ
                              =
                              6
                           
                         in 3D), put 
                           
                              U
                              =
                              max
                              {
                              w
                              (
                              s
                              )
                              :
                              s
                              ∈
                              S
                              }
                           
                        , and let 
                           
                              μ
                           
                         be the size of the set 
                           
                              
                                 
                                    W
                                 
                                 
                                    U
                                 
                              
                              =
                              {
                              w
                              (
                              c
                              )
                              ⩽
                              U
                              :
                              c
                              ∈
                              C
                              }
                           
                        . In 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    simple
                                 
                              
                              (
                              S
                              )
                           
                         algorithm, the 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -strength of a path from S to c is checked always (often unnecessarily) between 
                           
                              μ
                           
                        - and 
                           
                              δ
                              μ
                           
                        -many times.

On the other hand, the number of similar checks in 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         for each spel may be considerably smaller than 
                           
                              μ
                           
                        . Certainly, this is the case for each seed. But also, if a spel c is connected to an 
                           
                              s
                              ∈
                              S
                           
                         with a large value 
                           
                              ν
                           
                         of 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                           
                         (meaning that the size 
                           
                              
                                 
                                    μ
                                 
                                 
                                    c
                                 
                              
                           
                         of the set 
                           
                              {
                              w
                              (
                              d
                              )
                              ∈
                              [
                              ν
                              ,
                              w
                              (
                              s
                              )
                              ]
                              :
                              d
                              ∈
                              C
                              }
                           
                         is smaller than 
                           
                              μ
                           
                        ), then the 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -strength of c will be updated at most 
                           
                              δ
                              
                                 
                                    μ
                                 
                                 
                                    c
                                 
                              
                           
                         many times, an improvement from 
                           
                              δ
                              μ
                           
                        .

Also, it is good to mention here that, for some seed sets S and T, the resulted MBD object 
                           
                              P
                              (
                              S
                              ,
                              T
                              )
                           
                         remains unchanged upon small changes of sets S and T. More specifically, this is the case for the seed pairs 
                           
                              〈
                              s
                              ,
                              t
                              〉
                              ∈
                              S
                              ×
                              T
                           
                         that are essentially separated in the barrier sense, that is, when for any 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                           
                        -optimal path p from s to t, 
                           
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    -
                                 
                              
                              (
                              p
                              )
                              <
                              min
                              {
                              w
                              (
                              s
                              )
                              ,
                              w
                              (
                              t
                              )
                              }
                              ⩽
                              max
                              {
                              w
                              (
                              s
                              )
                              ,
                              w
                              (
                              t
                              )
                              }
                              <
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                                 
                                    +
                                 
                              
                              (
                              p
                              )
                           
                        . Of course, this robustness for the seed choice is not as potent as the robustness of RFC; however, it is considerable better than for the segmentations associated with the geodesic or fuzzy distances.

All experiments presented in this section were conducted on a computer HP Proliant ML350 G6 with 2 Intel X5650 6-core processors (2.67Hz) and 104GB memory.

In these experiments we have compared four different versions of the algorithms returning MBD: the novel exact MBD algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                        , the interval Dijkstra’s algorithm 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              S
                              )
                           
                         approximating MBD from above, the 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         executed once for each seed point, which approximates MBD from below with an error 
                           
                              ⩽
                              2
                              ε
                           
                         (see Theorem 1), and 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    ★
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         executed only once even for multiple seeds. The aim for these experiments was to evaluate the practical usefulness of each of these algorithms and to use this information to decide which of them to use in the next set of experiments, comparing MBD with other distance measures.

For the experiments we used 2D images from the grabcut dataset [35], converted to gray scale by using the mean of the three color band values. The images come with the true segmentations. The examples of the images are given in Fig. 2
                        . Their sizes range from 113,032 pixels (for 
                           
                              284
                              ×
                              398
                           
                         image) to 307,200 (for 
                           
                              640
                              ×
                              480
                           
                         image), while the intensity range of the images is 
                           
                              [
                              0
                              ,
                              255
                              ]
                           
                        . The experiments were conducted as follows. For each number 
                           
                              s
                              =
                              1
                              ,
                              …
                              ,
                              25
                           
                        , the following procedure was repeated 100 times: (1) extract a random image from the subset of the images in the grabcut database; (2) generate randomly the set S of s-many seed points in the image; and (3) run each of the four MBD algorithms on this image with the chosen set S. The averages, for each value of s and each of the algorithms, of the execution time and error in computed distance values are presented in Figs. 3 and 4
                        
                        , respectively. See also Fig. 5
                        .

Based on the presented results, we concluded that the algorithms 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    ★
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         are not worth pursuing any further: the first one because of its high computing time cost in the presence of multiple seeds, while the second because its higher level of errors, in comparison with the remaining two algorithms.

The experimental performance of the other two algorithms was better than theoretically insured worst case scenarios: (1) The time performance of the exact MBD algorithm 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         seems to be independent of the number of seeds and is only a bit worst than the execution time of the linear time algorithms 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                                 
                                    ★
                                    appr
                                 
                              
                              (
                              S
                              )
                           
                         and 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              S
                              )
                           
                        . As expected (Theorem 3), we see in Fig. 6
                         that, in practice, the execution time of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         depends on the image size in a linear manner. (2) The error level of 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              S
                              )
                           
                         is clearly smaller than that of the other two algorithms approximating MBD. Moreover, 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              S
                              )
                           
                         is the most efficient in terms of the computing time.

As a result, in the remaining experiments we used only two MBD algorithms: 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         and 
                           
                              DA
                              (
                              
                                 
                                    β
                                 
                                 
                                    w
                                 
                              
                              ,
                              S
                              )
                           
                        .

In this section, we compare the segmentations, as described in Section 2.2, associated with the following distance functions (see Section 2.1) for the 2D gray-scale digital images 
                           
                              f
                              :
                              C
                              →
                              [
                              0
                              ,
                              ∞
                              )
                           
                         obtained from the grabcut dataset, see Fig. 2.
                           
                              •
                              The exact MBD computed with 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             MBD
                                          
                                       
                                       (
                                       S
                                       )
                                    
                                 , where 
                                    
                                       w
                                       (
                                       c
                                       )
                                       =
                                       f
                                       (
                                       c
                                       )
                                    
                                 .

An approximate MBD computed with 
                                    
                                       DA
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             w
                                          
                                       
                                       ,
                                       S
                                       )
                                    
                                 , where 
                                    
                                       w
                                       (
                                       c
                                       )
                                       =
                                       f
                                       (
                                       c
                                       )
                                    
                                 .

The geodesic distance computed with 
                                    
                                       DA
                                       (
                                       Σ
                                       ,
                                       S
                                       )
                                    
                                 , where, for adjacent 
                                    
                                       c
                                       ,
                                       d
                                       ∈
                                       C
                                       ,
                                       w
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       |
                                       f
                                       (
                                       c
                                       )
                                       -
                                       f
                                       (
                                       d
                                       )
                                       |
                                    
                                 .

The fuzzy distance computed with 
                                    
                                       DA
                                       (
                                       
                                          
                                             Σ
                                          
                                          
                                             ^
                                          
                                       
                                       ,
                                       S
                                       )
                                    
                                 , where 
                                    
                                       w
                                       (
                                       c
                                       )
                                       =
                                       f
                                       (
                                       c
                                       )
                                    
                                 .

The Fuzzy Connectedness computed with 
                                    
                                       DA
                                       (
                                       w
                                       ,
                                       S
                                       )
                                    
                                 , where, for adjacent 
                                    
                                       c
                                       ,
                                       d
                                       ∈
                                       C
                                    
                                 , 
                                    
                                       w
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       M
                                       -
                                       κ
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       |
                                       f
                                       (
                                       c
                                       )
                                       -
                                       f
                                       (
                                       d
                                       )
                                       |
                                    
                                 .

We start with comparing how the execution time of these algorithms depends on the image size. The summary of our results is displayed in Fig. 6. The algorithms were executed on the small subimages of the images in Fig. 2. For each side length between 1 and 316, a square centered subset of the original images was extracted. A single seed point was placed in the center pixel in the small images. By this procedure, the frequency representation does not depend on image size as would be the case if the images were upsampled or downsampled.

Notice that, according to these experiments, the execution time of 
                           
                              
                                 
                                    A
                                 
                                 
                                    MBD
                                 
                              
                              (
                              S
                              )
                           
                         depends on the image size in a linear manner, in agreement with Theorem 3.

In these experiments, the seed sets were chosen in the images via erosion of different magnitude of the known true segmentations, see e.g. [34]. Such choice allows varying the seed sets in a more controlled manner, as compared to the alternative of operators specifying seeds interactively or the random seed choice, and thereby we can study the influence of seed sets on results also in a controlled manner. However, there is a concern that such choose may favor the distance measures similar to the Euclidean distance. Although this concern does not seem to be present in our experiments, presented in Fig. 7
                           , we restricted this approach only to the presented small study to avoid any possible bias. (But see also Section 4.3.)

In these experiments, involving the images from Fig. 2, the user defined seeds are used. Four different users have placed seed points in the object and background of each image. A sample of such choice is shown in Fig. 8
                           .


                           Fig. 9
                            shows boxplots, where the central mark of the box is the median and the edges of the box represent the 25th and 75th percentiles. The whiskers extend to the most extreme data points not considered outliers, which are marked by plus-signs. Four different users have provided object and background seed points for all 17 images. These seed points are used to compute the object for the five different distance function.

The images are degraded by Gaussian smoothing with 
                              
                                 σ
                              
                            values between 1 and 10. Fig. 10
                            shows the averaged Dice coefficient results and the execution times for the images with added indicated level of smoothing.

In the experiments presented in Fig. 11
                            the images were degraded by the additive Gaussian noise with zero mean and variance 
                              
                                 σ
                              
                            as indicated on the horizontal axis. The figure shows the averaged Dice coefficient results and the execution times for the images with indicated level of noise.

Finally, Figs. 12 and 13
                           
                            show the similar results for the images with added noise followed by the indicated level of smoothing and for the images with added smoothing followed by the indicated level of noise, respectively.

The experiments presented in this section show that the quality of the segmentations associated with both versions of MBD algorithms compare favorably with those associated the other three methods. This is particularly well visible in the case of blurred images. But the same pattern is also present at the lower level of noise. In the case of the exact MBD distance algorithm, the price of this improvement is a (slightly) higher execution time. (Though, this disadvantage quickly decreases, as a function of level of applied smoothing.) Therefore, if the execution time is an issue, the approximate MBD algorithm 
                              
                                 DA
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       w
                                    
                                 
                                 ,
                                 S
                                 )
                              
                            is the best performer, unless the image is very noisy.

In the last experiment, presented in this section, we compared the performance of the five algorithms on the 3D T1-weighted MRI image of the brain, shown in Fig. 14
                        .

The presented experiments were performed on the image that has been slightly blurred. We added blur, since the segmentation results performed on the original image were so close to the ground truth for all five algorithms, that there was no basis to differentiate between them.

The seeds were chosen by erosion, with respect to the ground truth. However, to avoid a concern expressed in Section 4.2.1, the erosion was done in an asymmetric manner: increasing radius of the structuring element (with origin located at the border of the structuring element). More specifically, an asymmetric erosion of the ground truth object P of radius r was defined as the set of all spels 
                           
                              c
                              =
                              〈
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                              〉
                              ∈
                              C
                           
                         such that the (structuring) set 
                           
                              S
                              (
                              c
                              ,
                              s
                              )
                              =
                              {
                              〈
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              〉
                              ∈
                              C
                              :
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              +
                              r
                              
                              for
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              }
                           
                         is a subset of P.

The results of the experiments are presented in Fig. 15
                        . They show that, in a 3D medical image, the quality of the MBD based segmentations is at least as good (the case of FC) or clearly better (geodesic and fuzzy distances) then those produced by the other methods. This advantage increases, with the decrease of the seed sets.

@&#CONCLUSIONS@&#

In this paper we introduced a new efficient algorithm, 
                        
                           
                              
                                 A
                              
                              
                                 MBD
                              
                           
                        
                     , that computes the exact values of the Minimum Barrier Distance transform, introduced by the authors in [1]. We provided a detailed proof that 
                        
                           
                              
                                 A
                              
                              
                                 MBD
                              
                           
                        
                      indeed returns the exact MBD and that its execution time is, in the worst case scenario, of order 
                        
                           O
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           ln
                           n
                           )
                           ,
                           n
                        
                      being the size of the image. Moreover, the experimental results indicate that, in practice, the execution time of 
                        
                           
                              
                                 A
                              
                              
                                 MBD
                              
                           
                        
                      is actually linear with respect to n, and comparable to the execution time of the standard Dijkstra’s algorithm.

We also investigated an algorithm 
                        
                           DA
                           (
                           
                              
                                 β
                              
                              
                                 w
                              
                           
                           ,
                           S
                           )
                        
                      which is faster than 
                        
                           
                              
                                 A
                              
                              
                                 MBD
                              
                           
                        
                      (has, provably, the same complexity as Dijkstra’s algorithm) but returns only approximate values of MBD. The presented experiments show that the quality of the output of 
                        
                           DA
                           (
                           
                              
                                 β
                              
                              
                                 w
                              
                           
                           ,
                           S
                           )
                        
                      is remarkably similar to that of 
                        
                           
                              
                                 A
                              
                              
                                 MBD
                              
                           
                        
                     .

Finally, we experimentally compared the segmentations associated with both versions of MBD algorithms with that associated with geodesic distance, fuzzy distance, and Fuzzy Connectedness. The segmentation results associated with MBD compare favorable with the other three methods. In particular, MBD is considerable more robust to smoothing than the other algorithms. The same can be also observed when the lower level of noise is added.

@&#REFERENCES@&#

