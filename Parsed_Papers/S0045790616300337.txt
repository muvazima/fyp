@&#MAIN-TITLE@&#A lightweight message authentication scheme for Smart Grid communications in power sector

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Designed an authentication scheme for IoT based smart grid communication.


                        
                        
                           
                           Analyzed the scheme using automated tool ProVerif.


                        
                        
                           
                           The proposed scheme is more lightweight and secure than existing schemes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Authentication

Smart meter security

Lightweight cryptography

IoT

Smart Grid

ProVerif

@&#ABSTRACT@&#


               
               
                  The Internet of Things (IoT) has plenty of applications including Smart Grid (SG). IoT enables smooth and efficient utilization of SG. It is assumed as the prevalent illustration of IoT at the moment. IP-based communication technologies are used for setting SG communication network, but they are challenged by huge volume of delay sensitive data and control information between consumers and utility providers. It is also challenged by numerous security attacks due to resource constraints in smart meters. Sundry schemes proposed for addressing these problems are inappropriate due to high communication, computation overhead and latency. In this paper, we propose a hybrid Diffie–Hellman based lightweight authentication scheme using AES and RSA for session key generation. To ensure message integrity, the advantages of hash based message authentication code are exploited. The scheme provides mutual authentication, thwarting replay and man-in-the-middle attacks and achieves message integrity, while reducing overall communication and computation overheads.
               
            

@&#INTRODUCTION@&#

Internet of things (IoT) refers to the emerging concept of computing in which abundant physical objects are connected to the Internet to form a network. This network enables connected objects to access, interpret, exchange and monitor the information of each other. It has brought a revolution in communication technologies by empowering advanced applications such as Smart Grid (SG). Although, IoT has the ability to provide management of energy at home level, but it also has the potential to facilitate the complete advanced electric power grid known as SG. SG is comprised of millions of interconnected and interacting devices that can be considered as the objects present in IoT. Therefore, due to similar nature of both IoT and SG, IoT can easily facilitate the implementation of SG and integrates its feature of collecting and sharing energy related information in SG. This integration will allow SG to carry out its routine tasks in sustainable, efficient, reliable and cost effective manner.

SG is the replacement for conventional power grid because it brings more reliability and efficiency through smart, intelligent and interactive features. SG not only offers distributed control to power suppliers but also satisfies the current and future needs of the consumers [1]. In recent years, SG is seizing the attention from researchers and also from engineers in electric power generation and communication areas [2]. SG is also referred as the future grid. It is an enhancement of the conventional electrical power grid, by integrating digital computation and communication technologies for providing secure, efficient and reliable delivery of electricity and exchange of information between power generators, utility companies and consumers of the electric power [3]. Some important functionalities provided by SG are as under;

                        
                           1.
                           
                              Self healing: SG has the ability to identify, analyze and respond to particular faults swiftly through intelligent and appropriate action in order to recuperate from that fault [4,5].


                              Motivate and include the consumers: The SG provides interactive options and information, enabling consumers to select an appropriate available tariff and control their power usage accordingly. In this way, the consumers can make better and cost effective plan for themselves.


                              Resist attack: SG can resists against both physical and cyber-attacks.


                              Increase in power quality: These days consumer’s major demand is constant voltage and therefore SG have the ability to maintain constant voltage which can ultimately increase the power quality and reduces the commercial productivity loss, because sudden fluctuations in voltage can be harmful for electric appliances [4].


                              Accommodate all sources of generations and storage options: Conventional power grid doesn’t have the ability to integrate renewable energy sources such as green power, wind power and solar power etc. SG on the contrary has the ability to adapt and integrate these renewable resources [4].


                              Enables electrical markets: SG supports distributed power sources, which attracts new electric power suppliers and service providers towards the power market, also ensures cost effective power supply to consumer.


                              Optimizing assets and operate efficiently: SG automatically assists the equipment conditions, manages its configuration and reduces the maintenance cost as compared to conventional electrical grid.

SG is therefore, an electrical power infrastructure with smart capabilities by allowing power providers, power distributors and power consumers to maintain operating requirements and capabilities in near-real-time [2]. Moreover, SG provides the power to consumers in a stable and reliable way on contrary to conventional power grid [2,6]. The SG sanctions two-way communications among consumers and providers of electrical power, this instinctive feature enable consumers to efficaciously prompt their power requisites to utility providers by which they play an active role and efficiently customize their consumption level [2]. This ability enables the consumers to minimize their energy consumptions by communicating back and forth with the electricity providers. Whereas the conventional grid broadcasts the electricity in one-way fashion and the consumers cannot actively participate, and neither can they customize their consumption level. The demand response capability for the load management can efficiently reduce the load in an emergency situation or in high price situation, so the consumers can reduce their consumption level in these situations accordingly [7]. It was estimated that, the demand response in non-emergency situation can reduce the price from 5% to 15% in peak load.

In SG, a number of sensing devices, smart meters and control-systems lies in the path between providers and consumers of electric power for facilitating the two-way communications [2]. The sensing devices are capable of malfunction detection and the operations that exhibit deviations with respect to normal ranges. It requires a felicitous response from control center, while these responses are converted to control messages and sent to SG segments [2]. For this purpose, the SG communication framework and its functionality must be characterized in order to sanction active consumers participation and facilitate resiliency to sundry security threats. In SG the consumers have smart meters, by which they are capable of identifying their consumption of power in most efficient way as compared to conventional energy meters [2,6].

The smart meters customarily accumulate the electrical consumption information of smart home, which is then amassed by utility company (i.e. for monitoring and billing purposes). Consumers can also access their smart meter for checking their consumption level and adjust the power utilization accordingly (i.e. less utilization of electricity during peak hours for preserving mazuma) [2,6]. For this purpose smart meter sends messages to the utility provider periodically for adjusting their power utilization and participate actively for their power utilization adjustment within SG dynamically. The utility providers can additionally send some special offers by sending messages to smart meters, by which the consumers can preserve mazuma and adjust their utilization accordingly. During peak electrical hours if all the appliances are switched on and the SG are peregrinating to an emergency situation then the utility provider send messages to all consumers by utilizing smart meters to notify about the emergency event and to adjust consumption level accordingly, by which the consumers thwart the situation by shutting down some appliances and participate to the stable environment actively [8]. Whereas the conventional power grid did not have such functionality. The smart meters can efficiently communicate with their appliances and accumulate the energy requisites from all appliances i.e. smart appliances [6].

The SG communication infrastructure consists of homes, buildings and immensely colossal neighborhoods. In order to facilitate SG communication, Internet Protocol (IP) based communications network technologies are the suitable cull for establishing IP-based SG communications. The smart meters and smart appliances (i.e. heater, dishwasher, washing machine, air conditioner, tube light, television etc.) must have a unique IP addresses for supporting SG communication and standards of IETF (Internet Engineering Task Force) for remote management of smart meters located at different places in the hierarchy [2,6].

The electric utilities itself can turn off loads remotely in peak hours demands, and they can manage integration to their distribution systems of power generation, like solar and wind for load balancing [8]. The remote management sanctions the power providers to efficiently amass metering data from smart meters for monitoring and billing purposes and they additionally send some control messages which contains some special offers and error events.

In the current decade SG got attentions from researchers in both distribution and communication sectors, for this purpose different communication models are presented in the literature [7,9–12]. The communication model which is adopted here is presented in [2,6] with a minor enhancement, by superseding wimax technology through optical fiber for long distance communication between control centers and buildings feeders shown in Fig. 1
                        .

The authors in [2,6] proposed the communication model for SG, in which they dissever transmission and distribution system of the power from communication. The Distribution Network (DN) distributes electric power from power plants to consumers by the following two primary systems; (1) Transmission Substations (TSs) at power plant, (2) one or many Distribution Substations (DSs) [2,6,9]. The TSs distributes the electrical power from power generation plants through higher voltage transmission lines (230KV’s) to DSs, resides at different regions. They then transform this high voltage power to a medium voltage power and distribute it to feeders reside at buildings, the feeders at buildings then transform medium voltage to a lower voltage, which is then utilized by smart home appliances [2]. The hand-off between TS to DS of high voltage and the conversion process of this high voltage to medium voltage is done in DS. So in short the TS distributes the electric power from power plant to DS whereas the DS distributes the medium level voltage electric power to feeders, which convert it to lower caliber voltage and is then consumed by consumer’s appliances.

Three hierarchical networks for distribution are composed at lower level, denominated as Neighborhood Area Network (NAN), Building Area Network (BAN), and Home Area Network (HAN). Each DS only covers one neighborhood area, and one NAN contains a number of BANs, and single BAN have multiple HANs [2,6] as shown in Fig. 1, n-DSs covering n neighborhoods, so each DS have one NAN and each NAN have k-BANs and each BAN can have m-HANs. The smart meters shown in Fig. 1 are responsible for sanctioning the two-way communication among consumers and providers of electricity, the smart meters comprises of two interfaces, one is utilized for power reading and another is utilized like gateway (GW) for communication purposes [2,6]. The smart meters located at different places in the hierarchy shown in Fig. 1 are designated as NAN-GW, BAN-GW and HAN-GW, through these smart meters/GWs consumer can check their current consumption level of the electrical power and adjust their consumption by shutting or running some appliances [2,6].

The utilization of IP-based communication network in SG causes the astronomically immense volume of delay sensitive data and control information, such networks are susceptible to man-in-the-middle, denial of service, eaves dropping and replay attacks [2]. As SG networking coalesces different components of electrical power system to collaborate and interact with one another, which requires interaction between these different technologies to work efficaciously by introducing different security risks [1]. The higher degree of interconnection between different components of SG introduces incipient security vulnerabilities [13]. Electric Power Research Institute (ERPI) analyzes the main issue of SG development concerning cyber security, and states in their report that, cyber security becomes a critical component for SG due to sundry cyber attacks and incidents which disconnect the SG network. Cyber security not only addresses deliberate attacks (i.e. from disgruntled employee, industrial espionage, and additionally from terrorists) but withal a compromise to information infrastructure caused by user errors, failure of equipment and natural disasters. The attackers exploit these vulnerabilities and get access to control software facilely and alter the load conditions by destabilizing the grid in an capricious way. Availability, confidentiality and integrity were the only security objectives of the conventional power grid [14].

All wireless networks are inherently insecure [15,16]. Same is the case with SG as the two way communication among different components is IP-based by which the attackers can facilely exploit SG by gaining access to SG environment [1,2]. In SG the consumers of smart homes are equipped with smart meters, which amass the consumer’s consumption information and these smart meters send this information to utility provider on conventional interval for monitoring and billing purposes. So the security of the smart meters are consequential. An efficient and secure authentication mechanism can guarantee the security of such smart devices. If no such authentication mechanism is opted in a SG network then the attacker can facilely modify the critical information like power utilization, leading towards erroneous billing and mendacious power usage approximation. From US power system, $6 billion of worth of power is purloined as per current estimate [17]. So the SG communication framework must consider an efficient authentication mechanism against which the attackers fail to compromise the secrecy or privacy of the information which is exchanged among consumers and utility providers of the electric power [2].

The SG infrastructure is of resource constrained nature, so in order to address the security concerns of smart meters, the message authentication protocols must be lightweight. The subsisting authentication schemes could not work with resource constrained environments [18–20], such traditional schemes lead to scalability issues i.e. multiple requests are not processed at the same time and increment the communication latency and engender delay in providing service to all consumers.

The rest of the paper is organized as follows, related work is elaborated in Section 2, the system model, threat model and design goals are discussed in Section 3. Section 4 introduces the notations used in proposed scheme followed by the proposed scheme itself. Security analysis is discussed in Section 5. Likewise, the ProVerif validation of proposed scheme is solicited in Section 6. Section 7 analyzes and compares the proposed scheme with existing schemes. Finally, Section 8 presents the conclusion of the paper.

@&#RELATED WORK@&#

Fouda et al. [2] proposed an authentication scheme that provides mutual authentication among smart meters reside at different locations in a hierarchical network. Their scheme achieved a secure channel for tardy transmission. The mutual authentication is done on Diffie–Hellman key establishment protocol while authentication of message is done by utilizing keyed Hash-based Message Authentication Code (HMACK
                     ) technique. The computation and communication of their scheme is very high due to the utilization of RSA. In [21] authors identified that HMACK
                      is slow and requires high computation cost and verification time, so it affects the performance of the SG operations, their proposed scheme was predicated on MAC.

An abundance of authentication schemes are proposed till now [2,6,22–25]. Lamentably all these suffer from high computation and communication cost because of the utilization of public-key infrastructure (PKI), as all traditional PKI require signature generation and verification which are having high computation cost and more communication overhead. Some authentication schemes require an exorbitant amount of steps for achieving authentication, which additionally resulted to high communication overhead and high latency. In this paper, the mentioned challenging issues are addressed by proposing an enhanced efficient lightweight message authentication scheme to secure communication between HAN and BAN gateways. The contributions of this paper is twofold:

                        
                           •
                           Firstly, an enhanced message authentication scheme is proposed, which is predicated on hybrid cryptography, the security analysis reveals that the scheme not only resist man-in-the-middle and replay attacks but withal provides forward secrecy.

Secondly, the performance analysis demonstrates that the scheme is lightweight and is opportune for SG environment.

This section elaborates system model, threat model and the design goals.

The system model is very homogeneous to [22], which focuses on building area networks (BAN) for detection of replay attack and ascertains authentication with m home area networks (HANs). A database is maintained at BAN gateway which contains the authentication information, its main responsibilities are not only message source authentication and ascertaining confidentiality and integrity but additionally replay attack detection. While each HAN contains a smart meter having processor, non volatile memory and communication capabilities. HAN and BAN communicate through wimax.

We assume that both HAN and BAN gateways cannot be compromised, the adversary 
                           A
                         can intercept communicating messages but cannot compromise the HAN database, the adversary 
                           A
                         can launch following attacks:

                           
                              1.
                              Replay attack: Adversary 
                                    A
                                  can intercept messages by HAN and replay those archaic messages to BAN gateway.

False message injection: Adversary 
                                    A
                                  can send false messages to BAN gateway, which can cause inopportune actions if not detected.

Message analysis attack: Adversary 
                                    A
                                  can snoop messages from HAN and endeavor to recuperate the electricity consumption reports.

Message modification attack: Adversary 
                                    A
                                  can attempt to alter a HAN message by intercepting it.

The design goal is to develop an authentication scheme for SG in order to cater following two objectives

                           
                              1.
                              The proposed scheme must detect and omit replay, false message injection, message analysis and modification attacks and to remain secure in the mentioned threat model, if these threats are not omitted, the SG performance will be degraded.

The proposed scheme must be defined in order to achieve computational and communicational efficiency, as per the low resource demands of SG infrastructure.

This section elaborates the proposed lightweight authentication scheme for consumer. The notation guide to understand the scheme is listed in Table 1
                     . The proposed scheme can be divided into two parts illustrated as follows:

Let 
                           
                              G
                              =
                              <
                              g
                              >
                           
                         a group of large prime order on q, which gratifies computational Diffie–Hellman (CDH) assumption i.e. if both ga
                         and gb
                         are given to an adversary, it is computationally hard for the adversary to calculate 
                           
                              
                                 g
                                 
                                    a
                                    b
                                 
                              
                              ∈
                              
                                 Z
                                 
                                    q
                                 
                                 *
                              
                           
                        . The authentication commences when the consumer wants to adjust his electric power utilization by sending the on-demand power list to control center for electric current. Each HAN can communicate securely with BAN gateway by engendering a shared key Ki
                        , and the symmetric encryption/decryption algorithm.

Authentication phase is illustrated in Fig. 2
                        , which is explained in three steps as follows:

                           
                              Step 1: 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  of the consumer selects a random number 
                                    
                                       a
                                       ∈
                                       
                                          Z
                                          
                                             q
                                          
                                          *
                                       
                                       ,
                                    
                                  which is selected from a positive integer on large prime order q. 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  computes 
                                    
                                       A
                                       =
                                       a
                                       
                                          
                                             (
                                             
                                                s
                                                i
                                             
                                             +
                                             
                                                t
                                                i
                                             
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       ,
                                    
                                  where ti
                                  is the current time stamp recorded by 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                 . Further 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  computes 
                                    
                                       B
                                       =
                                       
                                          
                                             
                                                P
                                                j
                                             
                                          
                                          a
                                       
                                    
                                 . 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  concatenates (i, j, B, ti
                                 ) and ga
                                  and encrypts the whole concatenated packet by using B as key and through AES symmetric key algorithm computes 
                                    
                                       
                                          C
                                          i
                                       
                                       =
                                       
                                          E
                                          B
                                       
                                       
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                          B
                                          ∥
                                       
                                       
                                          t
                                          i
                                       
                                       
                                          ∥
                                          
                                             g
                                             a
                                          
                                          )
                                       
                                    
                                 . Finally, 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  sends {Ci, ti, A, i} to 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                 .

                                    
                                       (1)
                                       
                                          
                                             H
                                             A
                                             
                                                N
                                                
                                                   G
                                                   
                                                      W
                                                      i
                                                   
                                                
                                             
                                             ⟶
                                             B
                                             A
                                             
                                                N
                                                
                                                   G
                                                   
                                                      W
                                                      j
                                                   
                                                
                                             
                                             :
                                             
                                                C
                                                i
                                             
                                             ,
                                             
                                                t
                                                i
                                             
                                             ,
                                             A
                                             ,
                                             i
                                          
                                       
                                    
                                 
                              

Step 2: Upon receiving {Ci, ti, A, i}, the 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                  first verifies freshness of ti
                                 , then computes 
                                    
                                       B
                                       =
                                       
                                          
                                             (
                                             
                                                P
                                                i
                                             
                                             .
                                             
                                                g
                                                i
                                                t
                                             
                                             )
                                          
                                          
                                             A
                                             .
                                             
                                                s
                                                j
                                             
                                          
                                       
                                       ,
                                    
                                  and decrypts Ci
                                  using B as key on AES algorithm i.e.
                                    
                                       
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                          B
                                          ∥
                                       
                                       
                                          t
                                          i
                                       
                                       
                                          ∥
                                          
                                             g
                                             a
                                          
                                          )
                                       
                                       =
                                       
                                          D
                                          B
                                       
                                       
                                          (
                                          
                                             C
                                             1
                                          
                                          )
                                       
                                    
                                 . Further, 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                  checks the decrypted B is same as computed and ti
                                  decrypted is same as received in plaintext, if any of these are not true, session is aborted by 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                 . Otherwise, 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                  selects a random number 
                                    
                                       b
                                       ∈
                                       
                                          Z
                                          
                                             q
                                          
                                          *
                                       
                                    
                                  and computes 
                                    
                                       
                                          C
                                          j
                                       
                                       =
                                       
                                          E
                                          B
                                       
                                       
                                          (
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                       
                                       
                                          t
                                          j
                                       
                                       
                                          ∥
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          )
                                          )
                                          ∥
                                          H
                                          M
                                          A
                                       
                                       
                                          C
                                          B
                                       
                                       
                                          (
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                       
                                       
                                          t
                                          j
                                       
                                       
                                          ∥
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          )
                                          )
                                          )
                                       
                                    
                                 . Finally, 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                  sends {Cj, tj, j} to 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                       ,
                                    
                                  where tj
                                  is the current time stamp recorded at 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                 .

                                    
                                       (2)
                                       
                                          
                                             B
                                             A
                                             
                                                N
                                                
                                                   G
                                                   
                                                      W
                                                      j
                                                   
                                                
                                             
                                             ⟶
                                             H
                                             A
                                             
                                                N
                                                
                                                   G
                                                   
                                                      W
                                                      i
                                                   
                                                
                                             
                                             :
                                             
                                                C
                                                j
                                             
                                             ,
                                             
                                                t
                                                j
                                             
                                             ,
                                             j
                                          
                                       
                                    
                                 
                              

Step 3: When the 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  receives the {Cj, tj, j} from 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                       ,
                                    
                                  it simply decrypts Cj
                                  using key B i.e. 
                                    
                                       
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                       
                                       
                                          t
                                          j
                                       
                                       
                                          ∥
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          ∥
                                          H
                                          M
                                          A
                                       
                                       
                                          C
                                          B
                                       
                                       
                                          (
                                          i
                                          ∥
                                          j
                                          ∥
                                       
                                       
                                          t
                                          j
                                       
                                       
                                          ∥
                                       
                                       
                                          g
                                          b
                                       
                                       
                                          )
                                          )
                                          )
                                       
                                       =
                                       
                                          D
                                          B
                                       
                                       
                                          (
                                          
                                             C
                                             j
                                          
                                          )
                                       
                                    
                                 . 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  first verifies the freshness of tj
                                  and compares B with B computed in step 1, if any of these are not verified, 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  aborts the session. Otherwise, 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  calculates HMACB
                                 (i‖j‖tj
                                 ‖gb
                                 ) and compares it with the arrived one. If they are equal, the 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  authenticates 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                 . 
                                    
                                       H
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                i
                                             
                                          
                                       
                                    
                                  then calculates the session key as follows:

                                    
                                       (3)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      =
                                                      H
                                                      
                                                         (
                                                         
                                                            i
                                                            ∥
                                                            j
                                                            ∥
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  g
                                                                  b
                                                               
                                                               )
                                                            
                                                            a
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Similarly, 
                                    
                                       B
                                       A
                                       
                                          N
                                          
                                             G
                                             
                                                W
                                                j
                                             
                                          
                                       
                                    
                                  computes the session key as follows:

                                    
                                       (4)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      =
                                                      H
                                                      
                                                         (
                                                         
                                                            i
                                                            ∥
                                                            j
                                                            ∥
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  g
                                                                  a
                                                               
                                                               )
                                                            
                                                            b
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The session key Kij
                         provides a secure channel for late transmission between 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                        . To ensure message integrity the 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         simply generates message authentication code by using Hash-based Message Authentication Code (HMAC) algorithm by using session key Kij
                        . The on demand request message Mi
                         which contains the electricity requirements of the smart appliances for certain period of time, is passed to 
                           
                              H
                              M
                              A
                              
                                 C
                                 
                                    K
                                    
                                       i
                                       j
                                    
                                 
                              
                              ,
                           
                         which generates message authentication code of the message Mi
                        . The 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         then concatenates Mi, tif
                         and 
                           
                              H
                              M
                              A
                              
                                 C
                                 
                                    K
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                         and then encrypts the whole packet by using AES algorithm with key Kij
                        . The 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         then sends the encrypted packet to 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                        . Here, ti
                         is the time stamp used for thwarting possible replay attack. The 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         sends the encrypted packet (as in Eq. 5) to 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                        .

                           
                              (5)
                              
                                 
                                    H
                                    A
                                    
                                       N
                                       
                                          G
                                          
                                             W
                                             i
                                          
                                       
                                    
                                    ⟶
                                    B
                                    A
                                    
                                       N
                                       
                                          G
                                          
                                             W
                                             j
                                          
                                       
                                    
                                    :
                                    
                                       E
                                       
                                          K
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                          i
                                       
                                       
                                          ∥
                                          
                                             t
                                             
                                                i
                                                f
                                             
                                          
                                          ∥
                                       
                                       H
                                       M
                                       A
                                       
                                          C
                                          
                                             K
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          (
                                          
                                             M
                                             i
                                          
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        When 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         receives the encrypted packet from 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                              ,
                           
                         it first decrypts by using session key Kij
                         (i.e. 
                           
                              
                                 D
                                 
                                    K
                                    
                                       i
                                       j
                                    
                                 
                              
                              
                                 (
                              
                              
                                 M
                                 i
                              
                              
                                 ∥
                              
                              
                                 t
                                 
                                    i
                                    f
                                 
                              
                              
                                 ∥
                                 H
                                 M
                                 A
                                 
                                    C
                                    
                                       K
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 
                                    (
                                    
                                       M
                                       i
                                    
                                    )
                                 
                                 )
                              
                              ,
                           
                         then checks the freshness of time stamp tif
                        , if time stamp is fresh, then 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         verifies the integrity of the message by calculating HMACKij
                         of the message. Finally, 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         forwards the authenticated messages to 
                           
                              N
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       k
                                    
                                 
                              
                           
                        .

The proposed scheme fulfills following security requirements of SG.

In step 1 of the proposed scheme, 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         computes 
                           
                              A
                              =
                              a
                              
                                 
                                    (
                                    
                                       s
                                       i
                                    
                                    +
                                    
                                       t
                                       i
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                         and 
                           
                              B
                              =
                              
                                 
                                    
                                       P
                                       j
                                    
                                 
                                 a
                              
                              ,
                           
                         further 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         encrypts ga
                         along with ti
                         and B using B as key. Finally, 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         sends {Ci, ti, A, i} to 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                              ,
                           
                         if the employed public key system is secure then only real 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         can extract B from A using his own private key and public key of the counterpart. The use of public key of 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         ensures the message is from real 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                        . Similarly in step 3, 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         receives gb
                         using the same key B. 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         ensures its counterpart is real 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         as the B can only be recovered by real 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                        . So they both get mutual authentication in step 3. Hence, the proposed scheme provides mutual authentication.

Since the message {Ci, ti, A, i} and {Cj, tj, j} contains freshly generated time stamps. Furthermore, these time stamps are also embedded in the encrypted messages, so each participant first verifies the freshness of time stamp received then verifies whether its the same time stamp present in encrypted message. This double check discards the possibility of replay attacks. Furthermore, the construction and retrieval of B requires both participants private keys as well as public keys, which eliminates the possibility of man in the middle attack.

In the proposed scheme, each session key contains session specific a and b entered by each participant, so even if the private key of one of the participant is compromised then the secrecy of previous keys remains intact. Hence, proposed scheme provides perfect forward secrecy.

Since the session key Kij
                         is only shared among 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                              ,
                           
                         in late transmission, the shared key Kij
                         not only provides confidentiality but also provides authenticity and integrity of user and message. The 
                           
                              H
                              M
                              A
                              
                                 C
                                 
                                    K
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                         is used for verifying integrity of the message, whereas tif
                         is used for thwarting possible replay attack. Hence, the proposed scheme is secure and more suitable candidate for allowing two-party SG communication.

In this section, we use the formal verification tool ProVerif [26] to verify mutual authentication and session key secrecy properties of the proposed scheme. ProVerif is used for verifying security properties of cryptographic protocols using a specification language based on an extension of pure Pi-calculus [27,28]. ProVerif supports a number of cryptographic primitives, including encryption/decryption (symmetric and asymmetric), digital signatures, hash functions, Diffie–Hellman key agreements, and so on [29]. In addition, other primitives such as rewriting rules and equations can be modeled using terms. To analyze the proposed protocol, we have introduced an insecure public channel chan for communication between HAN and BAN.


                     
                        
                     
                  

We have modeled session key as follows:


                     
                        
                     
                  

All public parameters (constants and variables) are defined as follows:


                     
                        
                     
                  

Where i and j are public identities of HAN and BAN respectively, g is group of large prime order on q, si and sj are private keys of HAN and BAN, respectively. Hash, inverse, exponents, multiplication, hashMAC, symmetric encryption, and concatenation are functions defined as constructors.


                     
                        
                     
                  

To achieve the properties of decryption, exponentiation, inverse and inverse exponentiation, we defined following destructors and equations.


                     
                        
                     
                  

Four events are defined to analyze property of certification.


                     
                        
                     
                  

We have modeled begin and end events i.e beginHAN, endHAN and beginBAN, endBAN for HAN and BAN, respectively. Two processes pHAN and pBAN are defined for each HAN and BAN. HAN process (pHAN) computed Pi and sends to BAN through insecure public channel chan, and receives Pj from BANi through insecure public channel chan. After exchanging the public keys, HAN creates time stamp ti. HAN then computes A, B and Ci and sends (Ci, ti, A, i) to BAN through insecure public channel chan. Likewise, after receiving (Cj, tj, j) from BAN, HAN decrypt Cj by using B as decryption key and get i, j, tj, expgb and xHACB. The HAN further computes HMACB and check HMACB = xHACB if true, HAN computes b and secession key kij. Otherwise, HAN discards the authentication process.


                     
                        
                     
                  

Building Area Network process (pBAN) computes Pj and sends it to HAN through insecure public channel chan, then receives Pi from HANi through insecure public channel chan. After exchanging public keys, BAN receives (Ci, ti, A, i) from HAN through insecure public channel chan, and creates time stamp tj. BAN then computes B and decrypts Ci using B as decryption key and gets i, j, xB and xti. The BAN computes B and checks ti = xti, if true BAN further checks B = xB, if true BAN selects a random b, compute Cj and sends (Cj, tj, j) to HAN. Otherwise, BAN discards the authentication process.


                     
                        
                     
                  

We model the proposed scheme as the parallel execution of two distinct processes: the HAN process and the BAN process.


                     
                        
                     
                  

Finally, to verify the properties of secrecy and reachability of the proposed protocol following queries are tested:


                     
                        
                     
                  

Results are as follows:

                        
                           1.
                           inj-event(endBAN(id)) 
                                 
                                    =
                                    =
                                    >
                                 
                               inj-event(beginBAN(id)) is true.

inj-event(endHAN(
                                 
                                    i
                                    d
                                    _
                                    1765
                                 
                              )) 
                                 
                                    =
                                    =
                                    >
                                 
                               inj-event(beginHAN(
                                 
                                    i
                                    d
                                    _
                                    1765
                                 
                              )) is true.

not attacker(Kij[]) is true.

The results (1) and (2) shows that BAN and HAN processes started and terminated successfully, while (3) verifies that the session key Kij is hidden from adversary.

The computation cost, communication overhead, delay and latency are main concerns in any resource constrained environment. Hence, the proposed scheme is analyzed with respect to these parameters.

It is the number of extra bytes transferred between 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                         in each handshake step. For simplicity, we have assumed the size of time stamps as well as identities of both HAN and BAN are of 128 bits/16 bytes. As recommended secure size for RSA encryption is 1024 bits/128 byte for public/private key pair, so in order to encrypt (i‖j‖ga
                        ) in Fouda et al. [2] and Sule et al. [21] schemes, 384 bytes are required in step 1 of each scheme. Similarly, each of the schemes requires 512 bytes to encrypt (i‖j‖ga
                        ‖gb
                        ) in step 2. Finally, in step 3 of both the schemes a pair (gb, i) is transmitted, which is of size 144 bytes. Hence, total bytes transmitted during authentication for each of the Fauda et al. and Sule et al. schemes are 1040 bytes.

During step 1 of proposed scheme, {Ci, ti, A, i} are sent, the size of Ci
                         is 304 bytes, ti
                         is 16 bytes, i 16 bytes and size of A is 128 bytes. So total bytes sent during step 1 are 464 bytes. Similarly, in step 2 of proposed scheme {Cj, tj, j} are sent which are of size 336 bytes. Therefore, total bytes transmitted over communication link in case of proposed scheme are 800 bytes. Hence, the proposed scheme has about 23% low communication overhead than schemes of Fouda et al. and Sule et al. The communication overhead for handshake process in proposed scheme and the schemes presented by Fouda et al. [2] and Sule et al. [21] are also shown in Table 2
                        .

The computation cost analysis is based on major operations performed during handshake process, these major operations include asymmetric encryption, asymmetric decryption, symmetric encryption, symmetric decryption, HMAC generation and verification, Hash generation and verification at each 
                           
                              H
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              B
                              A
                              
                                 N
                                 
                                    G
                                    
                                       W
                                       j
                                    
                                 
                              
                           
                        . For computational cost analysis following notations are introduced:

                           
                              •
                              
                                 TASED
                                 : time for asymmetric encryption/decryption


                                 TSED
                                 : time for symmetric encryption/decryption


                                 Th
                                 : time for hash operation


                                 THMAC
                                 : time for HMAC

According to Kilinc and Yanik [30] 
                        TASED
                        : takes 3.8500 ms, TSED
                        : takes 0.0046 ms ,Th
                        : takes 0.0023 while THMAC
                        : takes 0.0046 ms to complete their processing on a personal computer with Dual CPU E2200 2.20GHz processor, 2048MB of RAM and the Ubuntu operating system by using PBC Library.

The total computation cost for proposed solution is 
                           
                              23.1322
                              
                              ms
                              ,
                           
                         while that of Fouda et al. is 
                           
                              34.6546
                              
                              ms
                           
                         and of Sule et al. is 
                           
                              34.6592
                              
                              ms
                           
                        . Hence, the proposed scheme reduced approximately 33% computation cost. The computation cost comparison is also illustrated in Table 3
                        .

Total time consumed for handshaking process in case of proposed solution is 
                           
                              23.1322
                              
                              ms
                           
                         while that of Fouda et al. [2] is 
                           
                              34.6546
                              
                              ms
                           
                         and Sule et al. [21] is 
                           
                              34.6592
                              
                              ms
                           
                         .

@&#CONCLUSION@&#

IP-based communication facility as well as the error prone nature of the wireless communication makes SG more vulnerably susceptible to security threats, especially devices like smart meters are highly susceptible to different security threats and there are different privacy concerns due to its resource constrained nature. The proposed authentication scheme is predicated on Diffie–Hellman key establishment protocol. The paper presented a Diffie–Hellman predicated authentication scheme, which uses RSA and AES, in order to maintain message integrity, it exploits the advantages of the HMAC. The proposed scheme is lightweight and is felicitous for resource constrained environments like smart meters in the SG environment. It is evident from the results that proposed scheme has reduced 23% communication overhead as compared with the schemes of Fouda et al. and Sule et al. Similarly, the comparison results for computation overhead of the proposed scheme with the schemes of Fouda et al. and Sule et al. show that the proposed scheme has achieved 33% improvement in lowering the computation overhead in handshaking process.

@&#ACKNOWLEDGMENTS@&#

Authors would like to thank the anonymous reviewers and Mr. Shahzad Saddique Chaudhry for their valuable recommendations to improve the quality, correctness, presentation and readability of the manuscript.

@&#REFERENCES@&#

