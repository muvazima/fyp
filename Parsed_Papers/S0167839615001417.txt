@&#MAIN-TITLE@&#On the dimension of spline spaces over T-meshes with smoothing cofactor-conformality method

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A general formula for the dimension of the spline space over the T-mesh is provided.


                        
                        
                           
                           The diagonalizable T-mesh is introduced.


                        
                        
                           
                           A necessary and sufficient condition to characterize the diagonalizable T-meshes is proved.


                        
                        
                           
                           Some new dimension results for the spline space over T-meshes that do not have a nested structure is provided.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dimension

T-splines

Spline space over T-mesh

Smoothing cofactor-conformality

@&#ABSTRACT@&#


               
               
                  This paper provides a general formula for the dimension of spline space over general planar T-meshes (having concave corners or holes) by using the smoothing cofactor-conformality method. We introduce a new notion, the diagonalizable T-mesh, where the dimension formula is only associated with the topological information of the T-mesh. A necessary and sufficient condition for characterization of the diagonalizable T-mesh is also provided. By this new notion, we obtain some new dimension results for the spline spaces over T-meshes.
               
            

@&#INTRODUCTION@&#

NURBS (Non-Uniform Rational B-Spline) is the de facto standard that is used to generate and represent free-form curves and surfaces in CAD (Farin, 2002). It is also a desirable tool for isogeometric analysis (Cottrell et al., 2009). A well-known and significant disadvantage of NURBS is that it is based on a tensor-product structure that uses a global knot insertion operation. It is necessary to generalize NURBS space to spline space which can handle T-junctions, or hanging nodes.

Many researchers have attempted this issue and several different methods have been developed over the years, including Hierarchical B-splines (Forsey and Bartels, 1988; Kraft, 1997; Vuong et al., 2011; Giannelli et al., 2012), T-splines (Sederberg et al., 2003, 2004; Li et al., 2012), Polynomial Splines over T-meshes (Deng et al., 2006, 2008), and LR B-splines (Johannessen et al., 2014; Mourrain, 2014). In order to apply the above locally refinable splines to isogeometric analysis (Bazilevs et al., 2010), a very important topic is to unravel the corresponding spline spaces which have important implications in establishing approximation, stability, and error estimates (Bazilevs et al., 2006). For example, Giannelli and Jüttler (2013) study the completeness of hierarchical B-spline space by calculating the dimension of spline space over some hierarchical T-meshes. Analysis-suitable T-spline spaces (Li et al., 2012; Scott et al., 2012; Li and Scott, 2014) are discovered by using the dimension result of spline space over another T-mesh. The LR B-spline space is characterized according to the dimension formula in Mourrain (2014). Thus, in order to understand the locally refinable spline spaces, one common, foundational, but non-trivial step is to calculate the dimension of the spline space over some T-meshes.

There are several different approaches to calculate the dimension of the spline space over some T-meshes, including the B-net method (Deng et al., 2006), the minimal determining set method (Schumaker and Wang, 2011), the smoothing cofactor-conformality method (Li et al., 2006) and the homological technique (Mourrain, 2014). The present paper focuses on the smoothing cofactor-conformality method. Because the smoothing cofactor-conformality method can convert the smoothness conditions into algebraic forms, we directly focus on the algebraic forms and study the matrix. If the matrix can be formed into a block upper triangular matrix, the dimension of the linear system is not associated with the knot values. Then, we use the condition to find a new notion, (diagonalizable T-mesh), regarding the corresponding T-meshes. A similar notion, (weighted T-mesh, Definition 3.8 in Mourrain, 2014), is independently discovered in Mourrain (2014), where the dimension (Theorems 3.3 and 3.9) is able to be computed in an explicit formula by using the homological techniques. Although the weighted T-mesh is associated with a predefined order for the l-edges, it can also be generalized to the T-mesh when the order for the l-edges exists, which is the same as the diagonalizable T-mesh in the present paper. The other difference of the present paper is that we provide a necessary and sufficient condition for characterization a diagonalizable T-mesh, which can be used to find some new results for the spline space with reduced smoothness (Deng et al., 2006; Schumaker and Wang, 2012a), and when the T-mesh has a sufficient amount of mono-vertices (the definition is in section 2). The present paper is also a generalization of the first dimension of spline space over T-mesh paper with smoothing cofactor-conformality method (Li et al., 2006). There are two main difference between these two papers. Firstly, we generalize the result to handle more general type of T-meshes. Secondly, the notion of diagonalizable T-mesh doesn't require the pre-defined order of l-edges while the papers (Li et al., 2006; Li and Chen, 2011a) are based on the predefined order of l-edges. In summary, the main contributions of the present paper include,
                        
                           •
                           We provide a general formula for the dimension of the spline space over the T-mesh (Theorems 3.1 and 3.3);

We provide a new notion, the diagonalizable T-mesh, where the dimension formula is only associated with the topological information of the T-mesh. We also provide a necessary and sufficient condition that is required characterize diagonalizable T-meshes (Theorems 4.4 and 4.5);

We provide new dimension results for the spline space over T-meshes that do not have a nested structure (in Section 5).


                        Locally refinable splines. Four typical approaches have developed to generalize NURBS space to spline space which can handle T-junctions: the hierarchical B-splines, the T-splines, the splines over T-meshes and the LR B-splines. The hierarchical B-splines are originally introduced in 1988 by Forsey and Bartels (1988), which can be locally refined by using overlays. Then, Kraft suggests a selection mechanism for hierarchical B-splines (Kraft, 1997) to ensure their linear independence. Kraft's construction is further elaborated in Vuong et al. (2011), Giannelli et al. (2012) for the application in isogeometric analysis. T-splines are collections of B-spline functions that are defined on a T-mesh (T-grid) (Sederberg et al., 2003, 2004). T-splines are compatible forwards and backwards with NURBS and they have several advantages over NURBS, including local refinement (Sederberg et al., 2004; Scott et al., 2012) and watertightness (Sederberg et al., 2008). These capabilities make T-splines attractive for both CAD and isogeometric analysis (Bazilevs et al., 2010). Spline space over a T-mesh, or 
                           S
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           α
                           ,
                           β
                           ,
                           T
                           )
                        , is first introduced in Deng et al. (2006), which is a bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                         piecewise polynomial spline space over T-mesh 
                           T
                         with smoothness orders α and β in two directions. Later, this spline is applied in adaptive fitting (Deng et al., 2008), stitching (Li et al., 2007), simplification (Li et al., 2010), and isogeometric analysis (Nguyen-Thanh et al., 2011; Wang et al., 2011), as well as for solving elliptic equations (Tian et al., 2011). The concept is also generalized to spline space over triangulations with hanging nodes (Schumaker and Wang, 2012b). Locally refinable splines (LR-splines) are proposed by Johannessen et al. (2014), with the refining process based on hand-in-hand LR-refinement which starts from a tensor-product mesh.


                        Dimension of spline spaces over T-meshes. In 2006, Deng et al. (2006) study the dimension of the spline space under certain constraint that the order of smoothness is less than half of the degree of the spline functions. If the T-mesh has no cycles, Deng et al. (2006) provide the explicit dimension formula. Schumaker and Wang (2012a) and Li et al. (2006) also give the result by using the minimal determining set method and the smoothing cofactor-conformality method respectively. Later, Buffa et al. (2012) analyze a special T-spline with reduced smoothness by using the dimension formula in Deng et al. (2006). In 2011, Li and Chen (2011b) discover that the dimension of the associated spline space is instable over particular T-meshes, (i.e, the dimension is not only associated with the topological information of the T-mesh but it is also associated with the geometric information of the T-mesh). Additionally, Berdinsky et al. (2012) provide two more examples of spline spaces 
                           S
                           (
                           5
                           ,
                           5
                           ,
                           3
                           ,
                           3
                           ,
                           T
                           )
                         and 
                           S
                           (
                           4
                           ,
                           4
                           ,
                           2
                           ,
                           2
                           ,
                           T
                           )
                         regarding the instability of the dimension. Mourrain (2014) provides a general formula for the spline spaces by using the homological techniques. Unfortunately there is a term in the dimension formula that is very difficult to compute in practice. Thus, they define a class of T-meshes, the weighted T-meshes, over which the dimension can be computed in an explicit formula. The weighted T-mesh is associated with the order of the l-edges. Wu et al. (2013) provide the dimension for spline space 
                           S
                           (
                           d
                           ,
                           d
                           ,
                           d
                           −
                           1
                           ,
                           d
                           −
                           1
                           ,
                           T
                           )
                         over a special hierarchical T-mesh by using the homological algebra technique. Deng et al. (2013), Zeng et al. (2015) derive a dimension formula for 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         biquadratic and 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         bi-cubic spline spaces over hierarchical T-meshes. Giannelli and Jüttler (2013) provide certain conditions that were necessary for the hierarchical spline basis to span the entire space of the piecewise polynomial functions defined on the underlying grid with a given degree and smoothness.

The remainder of the paper is structured as follows. Pertinent background information regarding the spline space over T-mesh is reviewed in Section 2. In Section 3, we review the smoothing cofactor-conformality method to analyze the dimension of the spline space over T-meshes. In Section 4, we provide a condition under which we can explicitly calculate dimension formula for the spline space over the T-mesh. In Section 5, we provide new dimension results for the spline space over T-meshes that do not have a nested structure. The last section discusses our conclusion and future work.

In this section, we briefly review the notions of the T-mesh and the spline space over a T-mesh.

A T-mesh 
                           T
                         is a collection of all of the elements of axis-aligned rectangles 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         such that the interior of the domain Ω is 
                           ∪
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                        , and the distinct rectangles 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         can only intersect at points on their edges. In the present paper, we also require the T-meshes to be regular. Here, regular means that for any vertex in the T-mesh, the set of all of the rectangles that contain the vertex has a connected interior (Schumaker and Wang, 2012a). For example, in Fig. 1
                        , T-mesh b is a regular T-mesh but T-mesh c is not a regular T-mesh because the red vertex v doesn't satisfy the requirement for a regular T-mesh. The rectangles 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         are also called the faces or cells of the T-mesh. The vertices of the rectangles are called the nodes or vertices for a T-mesh. The line segment that contains two adjacent vertices on a grid line is called an edge of the T-mesh. T-meshes include tensor-product meshes as a special case. However, in contrast to tensor-product meshes, T-meshes are allowed to have T-junctions, or T-nodes, which are the vertices of one rectangle that lie in the interior of an edge of another rectangle. The domain Ω does not need to be rectangular, so it may have concave corners and holes (the grey region in Fig. 1).

If a vertex is on the boundary grid line of the T-mesh, it is called a boundary vertex. Otherwise, it is called an interior vertex. For example, in the T-mesh a in Fig. 1, vertex 
                           
                              
                                 V
                              
                              
                                 58
                              
                           
                         is an interior vertex, 
                           
                              
                                 V
                              
                              
                                 15
                              
                           
                        , 
                           
                              
                                 V
                              
                              
                                 16
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 57
                              
                           
                         are boundary vertices. An edge is called a boundary edge if it is part of exactly one face; otherwise, it is called an interior edge. If an interior edge has at least one boundary vertex as an end vertex, the edge is called a neighbor-boundary edge. A composite edge (or c-edge) is a line segment that consists of one or more edges. It is the longest possible line segment where the interior vertices are all T-junctions. An l-edge is a line segment which consists of several interior edges. It is the longest possible line segment, where all the interior edges are connected, and the two end points are T-junctions or boundary vertices. If the two end vertices of an l-edge are interior vertices, the l-edge is called an interior l-edge. For example, in the T-mesh a in Fig. 1, 
                           
                              
                                 V
                              
                              
                                 33
                              
                           
                           
                              
                                 V
                              
                              
                                 43
                              
                           
                        , 
                           
                              
                                 V
                              
                              
                                 57
                              
                           
                           
                              
                                 V
                              
                              
                                 58
                              
                           
                         are c-edges while 
                           
                              
                                 V
                              
                              
                                 57
                              
                           
                           
                              
                                 V
                              
                              
                                 58
                              
                           
                        , 
                           
                              
                                 V
                              
                              
                                 33
                              
                           
                           
                              
                                 V
                              
                              
                                 63
                              
                           
                         are l-edges. 
                           
                              
                                 V
                              
                              
                                 33
                              
                           
                           
                              
                                 V
                              
                              
                                 63
                              
                           
                         is an interior l-edges and edge 
                           
                              
                                 V
                              
                              
                                 57
                              
                           
                           
                              
                                 V
                              
                              
                                 58
                              
                           
                         is a neighbor-boundary edge. If two end vertices of a l-edge are both boundary vertices, the l-edge is called a cross-cut. Otherwise, if one end vertex is a boundary vertex and the other end vertex is an interior vertex, the l-edge is called a ray. For example, in the T-mesh a in Fig. 1, the l-edge 
                           
                              
                                 V
                              
                              
                                 16
                              
                           
                           
                              
                                 V
                              
                              
                                 46
                              
                           
                         is a cross-cut, while 
                           
                              
                                 V
                              
                              
                                 57
                              
                           
                           
                              
                                 V
                              
                              
                                 58
                              
                           
                         is a ray. A mono-vertex is the intersection between an interior l-edge and a cross-cut or a ray, and a free-vertex is the intersection between cross-cuts and rays.


                        
                           Definition 2.1
                           Suppose 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                               is a collection of T-nodes in a T-mesh such that for each 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              , the vertex 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                               lies in the interior of a c-edge with one endpoint at 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              , where we set 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              . Then, we say that 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                               form a c-cycle (this is the definition of the cycle in Schumaker and Wang, 2012a).


                        
                           Definition 2.2
                           Suppose 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                               is a collection of T-nodes in a T-mesh such that for each 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              , the vertex 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                               lies in the interior of an l-edge with one endpoint at 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              , where we set 
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              . Then we say that 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                               form an l-cycle.

It is evident that if a T-mesh has no l-cycles, then it has no c-cycles. However, in contrast, this is not correct (see the T-mesh in Fig. 8 as an example, which has no c-cycles, but has an l-cycle). Now, we introduce some more notations for a T-mesh in Table 1
                         that will be used later.


                        
                           Remark 2.3
                           The notations of l-edges and l-cycles are equivalence to T-segments and T-cycles in Li et al. (2006).

Given a T-mesh 
                           T
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , let 
                           F
                         denote all of the cells in 
                           T
                         and Ω be the region that is occupied by all of the cells in 
                           T
                        . The bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                         polynomial spline space over a T-mesh 
                           T
                         with smoothness order α and β is defined as
                           
                              
                                 
                                    S
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    α
                                    ,
                                    β
                                    ,
                                    T
                                    )
                                    :
                                    =
                                    {
                                    f
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          α
                                          ,
                                          β
                                       
                                    
                                    (
                                    Ω
                                    )
                                    
                                       
                                          |
                                          f
                                          |
                                       
                                       
                                          ϕ
                                       
                                    
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    ∀
                                    ϕ
                                    ∈
                                    F
                                    }
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is the space of all of the polynomials with bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                        , and 
                           
                              
                                 C
                              
                              
                                 α
                                 ,
                                 β
                              
                           
                           (
                           Ω
                           )
                         is the space that consists of all of the bivariate functions that are continuous in Ω, with order α along x direction and with order β along y direction. It is obvious that 
                           S
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           α
                           ,
                           β
                           ,
                           T
                           )
                         is a linear space, which is called the spline space over the given T-mesh 
                           T
                        .

In this section, we review the smoothing cofactor-conformality method that was introduced in Wang (2001) and Schumaker (1979) to compute the dimension of the spline space over T-meshes. In regard to the theory of multi-variate splines, to calculate the dimension of a spline space, one first transfers the smoothness conditions into algebraic forms.

Referring to Fig. 2
                        , for any interior vertex 
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           =
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                        , suppose the four surrounding bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                         polynomials defined on the four faces are 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 k
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , 
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           3
                         respectively (if the vertex 
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is a T-junction, then some of the polynomials will be identical). For example for the left T-junction in Fig. 2b, polynomials 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 0
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 3
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are identical.

Because 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 0
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         and 
                           
                              
                                 p
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are 
                           
                              
                                 C
                              
                              
                                 α
                              
                           
                         continuity, a bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           α
                           −
                           1
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                         polynomial 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 2
                              
                           
                           (
                           y
                           )
                         exists such that
                           
                              (1)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                         Here, 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 2
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 p
                                 =
                                 0
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 α
                                 −
                                 1
                              
                           
                           
                              
                                 ∑
                              
                              
                                 q
                                 =
                                 0
                              
                              
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 p
                                 ,
                                 q
                              
                           
                           
                              
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 p
                              
                           
                           
                              
                                 (
                                 y
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              
                                 q
                              
                           
                         and the vector that contains the coefficients 
                           
                              
                                 e
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 p
                                 ,
                                 q
                              
                           
                         are called the edge cofactors for the common edge. If two polynomials are identical, then the edge cofactor is the zero vector.

Similarly, bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           α
                           −
                           1
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           )
                         polynomial 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           −
                           β
                           −
                           1
                           )
                         polynomials 
                           
                              
                                 μ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         and 
                           
                              
                                 μ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 2
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         exist such that
                           
                              (2)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          β
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          α
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    −
                                    
                                       
                                          p
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          β
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                         Summing all of these equations, we have
                           
                              (5)
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 =
                                 −
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 )
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       β
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

Because 
                           
                              
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 α
                                 +
                                 1
                              
                           
                         and 
                           
                              
                                 (
                                 y
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              
                                 β
                                 +
                                 1
                              
                           
                         are prime to each other, bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           α
                           −
                           1
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           −
                           β
                           −
                           1
                           )
                         polynomial 
                           
                              
                                 d
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         exist such that,
                           
                              (6)
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          β
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    −
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          α
                                          +
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Let
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       p
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       α
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       q
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       β
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       p
                                       ,
                                       q
                                    
                                 
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       q
                                    
                                 
                                 .
                              
                           
                         We call 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         the vertex cofactor, here 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is a vector that contains all of the coefficients 
                           
                              
                                 d
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 p
                                 ,
                                 q
                              
                           
                        ,
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       0
                                       ,
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       α
                                       −
                                       1
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       β
                                       −
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       α
                                       −
                                       1
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       β
                                       −
                                       1
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

For boundary vertices, we only have part of the four equations. Therefore, we do not need to assign the bi-degree 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           α
                           −
                           1
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           −
                           β
                           −
                           1
                           )
                         polynomial 
                           
                              
                                 d
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         for the boundary vertex. Instead, we will assign some polynomials for the corresponding neighbor-boundary edge. For example, in Fig. 3
                        a, we need two polynomials 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                         but for Fig. 3b, we only need one polynomial 
                           
                              
                                 μ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                         because 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                              
                                 1
                              
                           
                           =
                           0
                        .

The vertex cofactors and edge cofactors are not totally free, there are other constraints for the continuity condition along each l-edge in the T-mesh.

We first consider a horizontal interior l-edge (referring to Fig. 4
                        ) with 
                           k
                           +
                           1
                         vertices 
                           
                              
                                 ν
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 j
                              
                           
                           ,
                           t
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           k
                        . According to Equation (7),
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          0
                                       
                                       
                                          =
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                                j
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                α
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          …
                                       
                                    
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       
                                          =
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                j
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                α
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          …
                                       
                                    
                                    
                                       
                                          0
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       
                                          =
                                          −
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                j
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          
                                             
                                                (
                                                x
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                α
                                                +
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         and
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 .
                              
                           
                        
                     

Summing all of these equations, we have the following equation:
                           
                              (9)
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       0
                                    
                                    k
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         Similarly, the constraints for a vertical interior l-edge are
                           
                              (10)
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       0
                                    
                                    l
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       β
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

Now, we consider a horizontal ray with 
                           r
                           +
                           1
                         vertices 
                           
                              
                                 ν
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 j
                              
                           
                           ,
                           t
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           r
                        . Without losing generality, we assume 
                           
                              
                                 ν
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 j
                              
                           
                         is a boundary vertex, then,
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             α
                                             +
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       …
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             α
                                             +
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       …
                                    
                                 
                              
                              
                                 
                                    
                                       0
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             α
                                             +
                                             1
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                         and
                           
                              
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             r
                                             −
                                             1
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 .
                              
                           
                         Summing all of these equations, we have the following equation:
                           
                              (12)
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    r
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 0
                                 .
                              
                           
                        
                     

A vertical ray has a similar equation except x is changed to y. Additionally, we have an equation for a horizontal cross-cut (similar to a vertical cross-cut) with 
                           c
                           +
                           1
                         vertices 
                           
                              
                                 ν
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 j
                              
                           
                        , 
                           t
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           c
                        , where
                           
                              (13)
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       c
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ,
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 0
                                 .
                              
                           
                        
                     

For each interior hole (referring to Fig. 5
                        ), denote all of the polynomials for the surrounding horizontal neighbor-boundary edges 
                           y
                           =
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                         to be 
                           
                              
                                 μ
                              
                              
                                 i
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , 
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           h
                        , and the polynomials for the surrounding vertical neighbor-boundary edges 
                           x
                           =
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                         to be 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , 
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           v
                        , then sum of all of the equations as (1), (2), (3), (4) and we have
                           
                              (14)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    h
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       β
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    v
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       α
                                       +
                                       1
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The linear systems (9), (10), (12), (13) and (14), which are associated with the interior l-edges, rays, cross-cuts and holes can be assembled into a global system as 
                           F
                           y
                           =
                           0
                        . Here, 
                           F
                         is a matrix that is called the full conformality conditions matrix. Additionally, y is a column vector that has elements that include all of the vertex cofactors for the interior vertices and the coefficients for the polynomials for all of the neighbor-boundary edges in the T-mesh. According to Wang (2001), we have


                        
                           Theorem 3.1
                           
                              Given a T-mesh 
                              
                                 T
                              
                              , let matrix 
                              
                                 F
                               
                              be the full conformality conditions matrix, then the dimension of the spline space over the T-mesh is,
                              
                                 
                                    
                                       
                                          dim
                                          ⁡
                                          S
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          α
                                          ,
                                          β
                                          ,
                                          T
                                          )
                                          =
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          1
                                          )
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          1
                                          )
                                          +
                                          dim
                                          ⁡
                                          ker
                                          ⁡
                                          (
                                          F
                                          )
                                          .
                                       
                                    
                                 
                              
                           

If the T-mesh has no holes, then we can simplify the above linear systems into Theorem 3.3.


                        
                           Lemma 3.2
                           
                              Assuming that each 
                              
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       y
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                               
                              are distinct, then the dimensions of the solution space of equations 
                              (9) 
                              and 
                              (10) 
                              are 
                              
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 α
                                 )
                                 
                                    
                                       (
                                       (
                                       k
                                       +
                                       1
                                       )
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       β
                                       )
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       +
                                    
                                 
                               
                              and 
                              
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 β
                                 )
                                 
                                    
                                       (
                                       (
                                       l
                                       +
                                       1
                                       )
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       α
                                       )
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                    
                                       +
                                    
                                 
                              
                              , respectively.
                           


                        
                           Proof
                           See Li et al. (2006) for more details.  □

If the T-mesh has no holes, for a horizontal ray in the T-mesh as that in equation (12), for any vertex cofactors 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         assigned for the interior vertices, we can assign the polynomial 
                           
                              
                                 μ
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 j
                              
                              
                                 2
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         with 
                           −
                           
                              
                                 ∑
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 r
                              
                           
                           
                              
                                 d
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           
                              
                                 (
                                 x
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 α
                                 +
                                 1
                              
                           
                         to satisfy the constraint. For a horizontal cross-cut in the T-mesh, because it has two boundary vertices, we can conclude that it has 
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           +
                           1
                           )
                           (
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           −
                           β
                           )
                         degrees of freedom for any given vertex cofactors for the interior vertices. Similarly, a vertical cross-cut has 
                           (
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           +
                           1
                           )
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           −
                           α
                           )
                         degrees of freedom. Therefore, we can form a matrix as 
                           M
                           x
                           =
                           0
                         for the linear systems (9) or (10) that are associated with each interior l-edge. Here, 
                           M
                         is a 
                           
                              
                                 n
                              
                              
                                 r
                              
                           
                           ×
                           
                              
                                 n
                              
                              
                                 c
                              
                           
                         matrix, which is called conformality conditions matrix. Additionally, x is a column vector whose elements are all of the vertex cofactors for the interior vertices in the T-mesh. According to the above analysis, we can obtain the dimension for the spline space over any general T-mesh without holes which is stated in the following theorem:


                        
                           Theorem 3.3
                           
                              Given a T-mesh 
                              
                                 T
                               
                              that has no holes, let matrix 
                              
                                 M
                               
                              be the conformality conditions matrix, then the dimension of the spline space over the T-mesh is,
                              
                                 
                                    
                                       
                                          
                                             
                                                dim
                                                ⁡
                                                S
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                α
                                                ,
                                                β
                                                ,
                                                T
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                1
                                                )
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                1
                                                )
                                                +
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      h
                                                   
                                                
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                1
                                                )
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                β
                                                )
                                                +
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      v
                                                   
                                                
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             
                                             
                                             
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                α
                                                )
                                                +
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                α
                                                )
                                                (
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                β
                                                )
                                                +
                                                dim
                                                ⁡
                                                ker
                                                ⁡
                                                (
                                                M
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                     Theorem 3.3 indicates that the main difficulty of computing the dimension of the spline space over a T-mesh is to calculate the rank of conformality condition matrix 
                        M
                     . It is obvious that the structure of the matrix is associated with the order of the edge conformality conditions and also the order of vertices cofactors. Most existing methods study the dimension of the matrix by forcing the T-mesh to be a nested structure, including those over the T-subdivision or hierarchical T-meshes. In the present paper, we find out a sufficient condition under which the dimension of spline space over a T-mesh without nested structure is stable.

We should mention that if the number of vertices in a horizontal l-edge is less than 
                        
                           
                              N
                           
                           
                              h
                           
                        
                      or the number of the vertices in a vertical l-edge is less than 
                        
                           
                              N
                           
                           
                              v
                           
                        
                     , then the l-edge will not contribute the dimension of the spline space (we can delete the l-edge without altering the spline space). Thus, we called such an l-edge a vanished l-edge. Because the vanished l-edges cannot make much difference for the analysis, but it will make the dimension formula much more complex. Thus, for simplicity, in the following, we assume that all of the l-edges are not vanished l-edges.


                     
                        Definition 4.1
                        Given a T-mesh 
                              T
                           , with ordered interior l-edges 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                           , then we can compute the new-vertex-vector 
                           
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                           . Here 
                              
                                 
                                    ν
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                            is the number of vertices on l-edge 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    ν
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                            is the number of vertices on l-edge 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                            but not on l-edges 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                              k
                              <
                              j
                           .


                     
                        Definition 4.2
                        A T-mesh is called Diagonalizable if there exists an order of l-edges 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ,
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                            such that the new-vertex-vector 
                           
                              
                                 
                                    ν
                                 
                                 
                                    i
                                 
                              
                            satisfies that 
                              
                                 
                                    ν
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              ≥
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                            if 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                            is horizontal and 
                              
                                 
                                    ν
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              ≥
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                            if 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                            is vertical.


                     
                        Lemma 4.3
                        
                           If a T-mesh is diagonalizable, then the matrix 
                           
                              M
                            
                           has full column rank if all the 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            
                           and 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                            
                           are distinct.
                        


                     
                        Proof
                        Because the T-mesh is diagonalizable, there exists the order for the interior l-edges that satisfies the condition that is stated in Definition 4.2. Without losing generality, we assume the order for the l-edges is 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                           . Then, we arrange the order of the edge conformality conditions that correspond to the l-edge from 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                            to 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           . The order of the vertex cofactors can be arranged in the following fashion: For l-edge 
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                           , if it is horizontal, there exist 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                            vertices that do not appear in the other l-edges. Each vertex corresponds to 
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              α
                              )
                              ×
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                            cofactors, so these 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                            vertices correspond to 
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              α
                              )
                              ×
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              ≥
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                            cofactors. There exist 
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                            cofactors such that the corresponding matrix block has full rank, and we put these cofactors in the beginning of 
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                           . If the l-edge is vertical, similarly we can select 
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              +
                              1
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              α
                              )
                            cofactors such that the corresponding matrix block has full rank. Then we put them in the next of 
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                           . This process can be applied for the remaining l-edges. After the arrangement, an appropriate partition of the linear system of constraints is
                              
                                 (15)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       0
                                    
                                 
                              
                            where 
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            is a 
                              
                                 
                                    n
                                 
                                 
                                    r
                                 
                              
                              ×
                              
                                 
                                    n
                                 
                                 
                                    r
                                 
                              
                            matrix, 
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                            is a 
                              
                                 
                                    n
                                 
                                 
                                    r
                                 
                              
                              ×
                              (
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                              −
                              
                                 
                                    n
                                 
                                 
                                    r
                                 
                              
                              )
                            matrix, 
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                            is a vector of the first 
                              
                                 
                                    n
                                 
                                 
                                    r
                                 
                              
                            vertex cofactors, and 
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                            is a vector of the remaining vertex cofactors.

Because the matrix 
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            is in upper block triangular form and according to Lemma 3.2 each diagonal block 
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              )
                              ×
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              −
                              β
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              )
                            or 
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              α
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              +
                              1
                              )
                              ×
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              −
                              α
                              )
                              (
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              +
                              1
                              )
                            matrix is full rank, thus matrix 
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                            is obviously of full rank.  □


                     
                        Theorem 4.4
                        
                           Suppose T-mesh 
                           
                              T
                            
                           is diagonalizable and has no vanished l-edges and holes, then the dimension of the spline space over the T-mesh is,
                           
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             S
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             α
                                             ,
                                             β
                                             ,
                                             T
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             +
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             +
                                          
                                       
                                       
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   v
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   v
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             +
                                             V
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        Because T-mesh 
                              T
                            is diagonalizable, 
                              dim
                              ⁡
                              ker
                              ⁡
                              (
                              M
                              )
                            is
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          c
                                       
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          r
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    α
                                    )
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    β
                                    )
                                    (
                                    V
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          +
                                       
                                    
                                    )
                                    −
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    β
                                    )
                                    
                                       
                                          T
                                       
                                       
                                          h
                                       
                                    
                                    −
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                    )
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    α
                                    )
                                    
                                       
                                          T
                                       
                                       
                                          v
                                       
                                    
                                    .
                                 
                              
                           
                        

According to Theorem 3.3, we have the dimension 
                              dim
                              ⁡
                              S
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              α
                              ,
                              β
                              ,
                              T
                              )
                            that is
                              
                                 
                                    
                                       
                                          
                                             dim
                                          
                                          
                                             =
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   v
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             +
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   +
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             +
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             (
                                             V
                                             −
                                             
                                                
                                                   V
                                                
                                                
                                                   +
                                                
                                             
                                             )
                                             −
                                          
                                       
                                       
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                             −
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             
                                                
                                                   T
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             +
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             +
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   v
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   v
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             +
                                             V
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                             □


                     
                        Theorem 4.5
                        
                           A necessary and sufficient condition for a T-mesh to be diagonalizable is for any interior l-edges set 
                           
                              S
                           
                           , there exists at least one horizontal l-edge such that the number of vertices on this l-edge but not on the other l-edges in 
                           
                              S
                            
                           is at least 
                           
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                           
                           , or there exists at least one vertical l-edge such that the number of vertices on this l-edge but not on the other l-edges in 
                           
                              S
                            
                           is at least 
                           
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                           
                           .
                        

First, we prove the condition is necessary by reducing absurdity. If the T-mesh is diagonalizable, there exists a set of l-edges 
                              {
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                              }
                            such that any horizontal l-edge in the set has at most 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              −
                              1
                            vertices, which are not on the other l-edges in the set and that any vertical l-edge has at most 
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              −
                              1
                            vertices, which are not on the other l-edges in the set. Because the T-mesh is diagonalizable, without losing of generality, we assume that when the order of the interior l-edges is 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                           , which satisfies the condition of diagonalizable. Let k be the maximal index for all 
                              
                                 
                                    i
                                 
                                 
                                    j
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              s
                           . Now, we consider l-edge 
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                           . Because it has at most 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              −
                              1
                            or 
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              −
                              1
                            vertices, which are not on the other l-edges in the set, it also has at most 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              −
                              1
                            or 
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              −
                              1
                            vertices, which are not on the l-edges for 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                            because 
                              S
                              ⊆
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                              }
                           , which violates the assumption of diagonalizable. Thus, the condition is necessary.

Now, we prove that the condition is sufficient. For the set of l-edges 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                           , according to the assumption, there exists one l-edge that has a sufficient amount of vertices on the l-edge but not on the other l-edges. Without losing generality, we assume it is 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           . Suppose we have ordered the l-edges as 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                            to satisfy the diagonalizable condition. Then for set 
                              {
                              
                                 
                                    e
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              }
                           , according to the assumption, there exists one l-edge which has a sufficient amount of vertices on the l-edge but not on the other l-edges. Without losing generality, we assume it is 
                              
                                 
                                    e
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                           . By using this process, we can order the l-edges as 
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                              ,
                              j
                              =
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    e
                                 
                              
                              −
                              1
                              ,
                              …
                              ,
                              1
                            which satisfies the diagonalizable condition.  □

Now we provide some examples for dimension of the spline space over the following T-meshes.


                     
                        Example 4.1
                        We first consider the spline space 
                              S
                              (
                              3
                              ,
                              3
                              ,
                              2
                              ,
                              2
                              ,
                              T
                              )
                            over the two T-meshes in Fig. 6
                           .

The first T-mesh has a few concave corners and one interior l-edge which is a vanished l-edge because it has only two vertices. Additionally the T-mesh has two cross-cut. Therefore, according to Theorem 3.3, the dimension of the spline space 
                              S
                              (
                              3
                              ,
                              3
                              ,
                              2
                              ,
                              2
                              ,
                              T
                              )
                            over the first T-mesh is 
                              16
                              +
                              2
                              ×
                              4
                              =
                              24
                           .

The second T-mesh has four interior l-edges 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              4
                           , four cross-cuts and five rays. According to the definition of the diagonalizable T-mesh (the order is 
                              
                                 
                                    e
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                           ) or by using Theorem 4.5, we can easily see that the T-mesh is diagonalizable. In the T-mesh, we have 4 cross-cuts, 2 horizontal interior l-edges, 2 vertical interior l-edges and 31 interior vertices. Therefore according to Theorem 4.4, the dimension of the spline space 
                              S
                              (
                              3
                              ,
                              3
                              ,
                              2
                              ,
                              2
                              ,
                              T
                              )
                            over the T-mesh is 
                              16
                              +
                              4
                              (
                              4
                              −
                              4
                              )
                              +
                              31
                              =
                              47
                           . We should mention that the T-mesh is not a T-subdivision or a hierarchical T-mesh.


                     
                        Example 4.2
                        We now consider the spline space 
                              S
                              (
                              3
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              ,
                              T
                              )
                            over the two T-meshes in Fig. 7
                           .

The first T-mesh has four interior l-edges. Additionally we can see that it is not diagonalizable because the new-vertex-vector could be 
                              (
                              3
                              ,
                              2
                              ,
                              2
                              ,
                              1
                              )
                            or 
                              (
                              3
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              )
                            for different orders. Thus, we cannot complete the dimension by using the current method. Actually, according to our knowledge, no existing method can compute the dimension of such a spline space.

The second T-mesh also has four interior l-edges, if we arrange the order of the l-edges to be 
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    e
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    e
                                 
                                 
                                    4
                                 
                              
                           , we can see that the new-vertex-vector is 
                              (
                              3
                              ,
                              2
                              ,
                              2
                              ,
                              2
                              )
                            (i.e., the T-mesh is diagonalizable). Because the T-mesh has 8 cross-cuts, 4 interior l-edges, and 27 interior vertices, the dimension of the spline space 
                              S
                              (
                              3
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              ,
                              T
                              )
                            over the second T-mesh is 
                              16
                              +
                              4
                              ×
                              2
                              ×
                              (
                              8
                              −
                              4
                              )
                              +
                              27
                              ×
                              4
                              =
                              156
                           .

A diagonalizable T-mesh can have l-cycles (e.g., the right T-mesh in Fig. 7, the T-meshes that satisfy the conditions in Theorem 5.1 and extended analysis-suitable T-meshes in Li and Scott, 2014). However, we cannot conclude that a T-mesh without c-cycles is a diagonalizable T-mesh, which is shown in the counterexample that is illustrated in Fig. 8
                     . This means that certain T-meshes exist that can be handled by Deng et al. (2006) and Schumaker and Wang (2011) but cannot be handled by the methods based on the smoothing cofactor-conformality method and the homological technique.

In this section, we will provide new dimension results for the spline space over T-meshes without nested structures. A similar result is also got in Guo et al. (2015) independently from the present paper. But based on the diagonalizable T-meshes, we can have a simple proof.


                     
                        Theorem 5.1
                        
                           Given a regular T-mesh 
                           
                              T
                            
                           without holes, if each horizontal l-edges has at least 
                           
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              −
                              1
                            
                           mono-vertices and each vertical l-edge has at least 
                           
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              −
                              1
                            
                           mono-vertices besides the two end vertices, then the dimension of the spline space over 
                           
                              T
                            
                           is
                           
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             S
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             α
                                             ,
                                             β
                                             ,
                                             T
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             +
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   h
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             +
                                          
                                       
                                       
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   v
                                                
                                             
                                             −
                                             
                                                
                                                   T
                                                
                                                
                                                   v
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             1
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             +
                                             V
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             α
                                             )
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             β
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        We will prove that the T-mesh is diagonalizable under the condition by reducing absurdity. If the T-mesh is not diagonalizable, referring to Fig. 9
                           , for any set of l-edges 
                              {
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    e
                                 
                                 
                                    n
                                 
                              
                              }
                           , if all the l-edges are vertical l-edges, then for any vertical l-edge in the set, it at least has 
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                            vertices which are not on the other l-edges in the set which violates the Theorem 4.5. Otherwise, suppose 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                            is the most bottom horizontal l-edge in the set (if there is more than one l-edge in the set, we will pick the leftmost one). According to the assumption, 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                            has at least 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                              −
                              1
                            mono-vertices (black rectangle vertices in the figure), if one of the two end vertices is not on the other l-edges in the set, then 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                            at least has 
                              
                                 
                                    N
                                 
                                 
                                    h
                                 
                              
                            vertices which are not on the other l-edges in the set. However, this violates the Theorem 4.5. Thus, there exists a vertical l-edge which contains one of the end vertices of 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           . Without losing generality, we assume the right end vertex is on the l-edge 
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                            in the set. Now, we consider l-edge 
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                           , the bottom end vertex of the l-edge cannot lie on the other l-edges in the set because it is on the bottom of 
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                            which is the bottommost l-edge in the set. Therefore, 
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                            at least has 
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                            vertices which are not on the other l-edges in the set which violates the Theorem 4.5. Thus, the T-mesh satisfies the condition in the lemma is a diagonalizable T-mesh. By using Theorem 4.4, we prove the theorem.  □

In this paper, we introduce a class of T-meshes (diagonalizable T-meshes), over which the dimension of spline spaces is stable. We also provide a necessary and sufficient condition that is used to characterize this class of T-meshes. By using the tools, we provide new dimension results for the spline space over the T-meshes without nested structures.

The paper leaves several problems for the future research. Because we have provided the dimension of the spline space, there are many problems that need to be solved. For examples, how to construct a set of basis functions with good properties, how to apply the spline to geometric modeling and iso-geometric analysis, etc. Also, it is an important and interesting question to find out other class of spline space with stable dimension. We will explore all of these problems in the future.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the NSF of China (No. 11031007, No. 60903148, No. 11371341), the Fundamental Research Funds for the Central Universities, SRF for ROCS SE, the Youth Innovation Promotion Association CAS and NKBRPC (2011CB302400).

@&#REFERENCES@&#

