@&#MAIN-TITLE@&#Modeling the dynamics of a multi-product manufacturing system: A real case application

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The proposed model depicts the shop floor dynamics using dynamic modeling.


                        
                        
                           
                           It is applicable to the production of multiple products in a job shop.


                        
                        
                           
                           It was applied to a real production system of polypropylene bags.


                        
                        
                           
                           Simulation results showed that the system could be successfully controlled.


                        
                        
                           
                           Control-based models present advantages in relation to conventional models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Control

Manufacturing

Dynamic modeling

Simulation

Job shop

@&#ABSTRACT@&#


               
               
                  In this paper, a continuous multi-product model is developed to represent the shop floor dynamics of a job shop, based on dynamic modeling and on analogies to electrical components. This approach allows the mathematical formulation of the model (state representation) and the analysis of its dynamic response via simulation. A real case application in the textile industry is presented. Thus, this research contributes in the following ways: first, proposing a model that is suitable for multi-product systems with intricate job shop configuration and that is generalizable to various manufacturing systems; second, presenting a real case application of the proposed model. As practical implications, it provides production managers and practitioners with a prescriptive decision model that considers the dynamics of the production systems and the interdependencies of the decisions made in the shop floor. From the academic perspective, it contributes to the existing literature by presenting the application of an alternative modeling methodology, and by extending this methodology to manufacturing systems with multiple products, instead of single-product systems. Continuous models such as the one proposed can benefit from a wide range of tools for system analysis and control design, come from control theory. Although these tools have been extensively applied to model the supply chain, applications devoted to the plant level seem to be neglected over the past years. This model also aims to contribute in this direction.
               
            

@&#INTRODUCTION@&#

Customers of this era usually expect innovative and differentiated products that are suitable to their individual needs (Jitapaiboon, Dobrzykowski, Ragu-Nathan, & Vonderembse, 2013; Piller, Moeslein, & Stotko, 2004). This trend requests customer-oriented systems that can produce customized products at low costs, aligned to the concept of mass-customization (Liu, Shah, & Schroeder, 2012). Furthermore, in several manufacturing environments, the production systems are subjected to disturbances of many sources, such as changes on product demand and customer requirements, machine breakdowns, urgent jobs, absenteeism, financial fluctuations, and so on. All these factors demand agility. Agile companies distinguish themselves by means of their speed in the planning and execution process, as well as their adaptability to changing conditions in the production environment (Wiendahl & Breithaupt, 2000).

Despite the depicted context, most of the available models to analyze production-inventory systems are based on average performance or steady-state conditions (Ortega & Lin, 2004; Suri & Desiraju, 1997). The same applies to the models for production scheduling. Lately, a reasonable amount of models for dynamic scheduling have been developed (Barrena, Canca, Coelho, & Laporte, 2014; Chiang, Cheng, & Fu, 2010; Jang, 2002; Weng & Fujimura, 2012); however, the vast majority of the scheduling theory considers a static rather than a dynamic situation, as highlighted by Wang and Uzsoy (2002) and Weng, Wei, and Fujimura (2012).

The manufacturing and supply chain management areas can certainly benefit from the application of dynamic modeling and control theory. One contribution refers to possibility of interpreting the planning and execution processes not as isolated domains but as an adaptive process. In addition, the perspective of dynamics allows to capture and cope with the changes in supply chain and the environment, and to optimize performance indicators that are difficult to express in the static and discrete time models. Yet, the utilization of control theory gives way to important kinds of analysis, such as stability, robustness and adaptability analysis of a supply chain or manufacturing system (Ivanov, Dolgui, & Sokolov, 2012).

In spite of these potential benefits, different authors argue that the domain of dynamics in the supply chain area should receive more attention (Ivanov, et al., 2012; Proth, 2007; Sarimveis, Patrinos, Tarantilis, & Kiranoudis, 2008). The literature lacks systematic analyses and documentation of the impact of dynamics on supply chain profitability, both at the planning level—concerning uncertainties and robustness to dynamic events, and at the execution control level—considering adaptive (re)planning and (re)scheduling (Ivanov et al., 2012). Thus, further research on the dynamics and control of manufacturing systems and supply chain is paramount to fulfill these gaps. System Dynamics and Control Theory provide a range of tools for modeling and analyzing dynamic systems that can be suitably applied to production planning and control of manufacturing systems and supply chains.

In this paper, a multi-product model to represent the shop floor dynamics of a job shop is proposed. The model is based on analogies between production entities, such as machines and stocks, and electrical components, such as capacitors and resistors. The equations that represent the system behavior are derived from the properties of these components. The proposed model is applied to depict a manufacturing system of polypropylene woven bags, using real data from a package company. Emphasis is set on the modeling of the system and on the mathematical development of the state equations.

From the academic perspective, this paper aims to present the application of an alternative modeling approach and to evaluate its potential of generalization to different multi-product manufacturing systems. The proposed model is based to some extent on basic manufacturing entities proposed by Ferney (2000), which were only applied to a theoretical single-product production system. Therefore, this paper also contributes to extend the existing approach so that it can be applied to manufacturing systems with multiple products. The case presented illustrates the applicability of the model in a practical situation, using field data and parameters of an actual manufacturing system. As practical implications, this research provides production managers and practitioners with a prescriptive decision model that considers the dynamics of the production systems and show the interdependencies of the decisions made in the shop floor.

Most of the extant control theory research applied to manufacturing concerns production inventory-systems in the context of supply chain, as it can be seen in Ortega and Lin (2004) and Sarimveis et al. (2008). As mentioned, the specific literature lacks a larger variety of models devoted to scheduling and shop floor (short-term) production control. The proposed model also attempts to lessen this gap.

According to Sarimveis et al. (2008) some assumptions on which the dynamic models of supply chain stand upon are not valid in reality. In some models, the stocks are not bounded below by zero neither bounded above due to limited storage capacities. Moreover, the models usually represent single stage systems, considering the production of a single product or the total aggregate production. The proposed model presents limitations, as any other model. The shop floor behavior is not analyzed at the level of individual products, i.e., the model does not consider the scheduling of individual jobs. In addition, differences in the processing times of products belonging to different families are also not taken into account. Nonetheless, the proposed model overcomes one of the usual limitations of the production-inventory and supply chain models by considering the production of several products grouped into different families. The intermediate stocks are also bounded below by zero. If a given intermediate stock reaches this condition, the downstream machine gets idle, which accurately corresponds to a real situation.

In the next section, a literature review of control theory applications to production systems and supply chains is presented. The Section 2.1 specifically addresses the mathematical formulation of the basic production entities used in the model. Section 3 presents the development of this model, encompassing the description of the production process and of the product families, the formulation of the state equations and the simulation of the model, based on the state equations. The preliminary results of the simulation are presented and discussed in section 4. Finally, the conclusions and suggestions for future research are presented in section 5.

Some major research efforts for applying control theoretic methods to production-inventory systems are reviewed by Ortega and Lin (2004) and Sarimveis et al. (2008). The first models date from 1950s, with Simon (1952) and Vassian (1955), followed by Forrester (1961), with the book “Industrial Dynamics” and Axsäter (1976). Later on, the inventory and order based production control system (IOBPCS) was presented by Towill (1982). This model was developed with more analytical support from control theory tools. Its fundamental parameters were the production delay time (i.e. production lead time), the time-to-adjust inventory, and the demand averaging time (Towill, 1982). In Wikner, Naim, and Towill (1992), likewise, three main elements were considered: manufacturing lead times, replenishment rules (or order policies) and forecasting. The lead times and replenishment rules were represented by expressions in the frequency domains. In these production-inventory systems, the inventory and work-in-process levels are usually transmitted as feedback information, while demand forecast is used as feedforward data.

In Ortega and Lin (2004), the production and inventory models are further subdivided into two groups. The first group comprises the “horizontal extensions” of the basic deterministic models, and refers to the models that depict the supply chain dynamics (Arda & Hennet, 2006; Dejonckheere, Disney, Lambrecht, & Towill, 2002, 2003, 2004; Disney, Naim, & Towill, 2000; Evans, Naim, & Towill, 1998; Nabais, Negenborn, Carmona Benitez, & Botto, 2013; Wang, Liu, Zheng, & Wu, 2008; Zhou, Disney, & Towill, 2010). Most of these models aim at finding an optimum order policy to reduce the bullwhip effect, i.e., the variations in the inventory levels.

The second group encompasses multi-echelon models for lot size optimization, i.e., for determining optimum batch sizes and release dates for the production orders (Bogataj & Horvat, 1996; Grubbström, 2005; Grubbström, Bogataj, & Bogataj, 2010; Grubbström & Molinder, 1996; Grubbström & Ovrin, 1992; Grubbström & Tang, 2000). These models are based on the input–output analysis and make use of the bill of materials (BOM) as an input matrix for the production-inventory system. Since the BOM is a hierarchical representation of the assemblies and components that form a final product, these models were categorized by Ortega and Lin (2004) as “hierarchical approaches” or “vertical extensions” of the basic production-inventory systems. Multi-echelon models are also used to represent distribution inventory systems with a central warehouse and a number of retailers, as in Axsäter (2001, 2003) and Axsater, Olsson and Tydesjo, (2007).

As mentioned, many of the studies on the single-echelon or multi-echelon production-inventory models focus on lot sizing optimization, i.e. the definition of optimal ordering policies. From the perspective of dynamics, it is interesting to consider how the information delays affect these models, such as in Bensoussan, Çakanyıldırım, and Sethi (2007). They introduced dynamic information delays as a Markov process into the standard multiperiod stochastic inventory problem with backorders. With these delays, the most recent inventory information is not available to the manager, that is, only an inventory level of some periods ago and related delay statistics can be observed. The authors introduce three statistics/concepts: the reference inventory position, which is the sum of the latest observed inventory level and all the orders placed since that observation; the magnitude of the latest observed delay; the age of this observation, i.e. the number of periods elapsed since the observation. With these statistics, a state reduction was achieved and an optimal policy of state-dependent base-stock type was found.

The classification of the production-inventory and supply chain models into “horizontal” or “vertical” extensions is inspired in Axsäter (1985). This author discusses two approaches two simplify models and deal with non-linear configurations and uncertainties. The first one refers to the assumption of the certainty-equivalence principle; in this case, models with uncertainties are approximated by deterministic models based on averages. The second option is the use of a hierarchical approach. Planning at a higher aggregate level usually leads to fewer (aggregate) variables to deal with. In addition, non-linear effects that occur at lower levels may be disregarded. The classification presented by Ortega and Lin (2004) is based on these two lines of reasoning.

In Hennet (2009), a model that could be considered as both a “horizontal” and a “vertical” extension of the production-inventory system is presented. In this work, a network of autonomous enterprises with distributed decisional structure is represented as a multistage manufacturing model. The product structure (BOM) dictates the organization of the network. Thus, producers of primary products play the role of suppliers, while producers of intermediate products play both roles of suppliers and producers; similarly, producers of end products are both producers and retailers. In the multistage model considered, it is assumed that the information available at each stage is mainly local. It is also supposed that each stage adopts a base-stock policy applied to the inventory positions. As main results, it was found that under some traditional assumptions, such as fixed lead times and common order periodicity, the local base stock policies are equivalent to an integrated policy. In other words, the local ordering and production policies may perform as well as an optimal global policy under some assumptions. As mentioned, this approach considers both the “horizontal” and “vertical” dimensions, since the supply chain behavior is modeled using the hierarchical product structure as a link between the stages.

The review presented by Ortega and Lin (2004) was complemented by Sarimveis et al. (2008), Ivanov et al. (2012) and Sagawa and Nagano (2013). In Sarimveis et al. (2008), besides the classical control methodologies reviewed in Ortega and Lin (2004), applications of advanced control methodologies for supply chain modeling are presented. In the applications of classical control, most of the analysis concerns continuous or discrete linear systems, whose dynamics is modeled using Laplace transfer functions and z transfer functions. Standard analysis tools, such as Bode and Nyquist plots are used to evaluate the alternative designs. The advanced control methodologies, according to Sarimveis et al. (2008), are basically optimal control methods aiming at the optimization of an objective function that measures the performance of the system. As known, the basis of optimal control theory stands on dynamic programming and Hamilton–Jacobi–Bellman equations (Bertsekas, 2000). In addition to the classical control and the dynamic programming approaches to supply chain modeling, three additional categories of papers are reviewed in Sarimveis et al. (2008). The first one concerns model predictive control (MPC) techniques that have been recently used in supply chain management problems. These techniques are applied when the models based on dynamic programming and optimal control cannot be solved analytically, due to its large dimension (the curse of dimensionality). The second additional category comprises applications of robust control theory. In this case, the disturbances that affect the supply chain are modeled as deterministic uncertain-but-bounded quantities. Finally, the last category refers to the alternative methods that have been developed to cope with the curse of dimensionality in dynamic programming and with the lack of an accurate model to represent the stochastic system under study. These methods usually make use of artificial intelligence tools, and are referred to as reinforcement learning techniques, neuro-dynamic programming or approximate dynamic programming.

In the review presented by Ivanov et al. (2012), the control theoretic approaches to supply chain are classified into five problem areas: dynamic inventory control policies, optimal multi-stage and multi-period production planning, analysis of disturbances and fluctuations, integrated marketing-production decisions, and adaptation and real-time control. The first area of classification encompasses all the production-inventory and the multi-echelon systems developed with the aid of Classic Control Theory. In this sense, this category is equivalent to the one proposed by Sarimveis et al. (2008), and includes both the horizontal and vertical extensions proposed by Ortega and Lin (2004). The second area refers to the applications of production planning mainly based on Optimal Control and Dynamic Programming. The third area includes the studies on stability and the bullwhip effect, such as the ones developed by Burns and Sivazlian (1978), Daganzo (2004), Dejonckheere et al. (2002, 2003, 2004), among others. The application of control approaches to production-marketing decisions concerns advertising models and optimal pricing and production models (He, Prasad, & Sethi, 2009; Kogan & Herbon, 2008), constituting the fourth category in the classification proposed by Ivanov et al. (2012). Finally, in the area of adaptation and real-time control, the aforementioned authors group the models based on model predictive control devoted to multi-echelon production-inventory problems.

When specifically considering the second category of classification, the optimal control approach, Ivanov et al. (2012) highlight an important aspect of many models for supply chain optimization: besides being based on information sharing and coordination, they assume full information availability. In most of the times, however, it is not possible to have all the information on the supply chain dynamics at the initial planning time, and the chain is subjected to dynamic changes and coordination problems. These facts reiterate the importance of models for adaptive planning and scheduling. Also, for these cases, the mentioned authors highlight the great applicability of the maximum principle (Pontryagin, Boltyanskii, Gamkrelidze, & Mishchenko, 1964). As known, this principle allows decomposing an optimal control problem into sub-problems, assuring that the optimal solutions of the instantaneous sub-problems lead to the optimal solution to the overall problem.


                     Khmelnitsky, Kogan, and Maimon (1997) developed maximum principle-based methods to cope with production scheduling problems in complex manufacturing systems. They employed a continuous-time optimal control approach and presented a general numerical method for partially sequence-dependent setup scheduling based on the properties of optimality derived from the maximum principle analysis. The computational complexity of the presented algorithm depends on its initialization, i.e. on the proper guess of the initial values for the variables. They showed that the use of an adequate shooting method for seeking these initial values may improve the performance of the algorithm. In addition, the computational complexity is related to the number of machine setups required to meet a given demand profile. The search space of admissible setups is quite large and the scheduling problem has many local optima that satisfy the optimality conditions, due to its combinatorial nature. Thus, the aforementioned authors proposed a maximum principle-based heuristic for reducing the setup alternatives, which speeded up the algorithm. As a result, the proposed algorithm outperformed a traditional algorithm based on a two level hierarchical approach.

A more specific framework to classify the control theory applications in supply chain was proposed by Ivanov and Sokolov (2013) considering the impact of uncertainty on supply chain performance in the dynamic domain. The authors presented a systematic representation of the supply chain dynamics taxonomy, aiming to approximate the terminology used in control theory to the practical problems in supply chains. In addition, they analyzed the existing control tools for synthesis and analysis of performance that can be used in the supply chain domain, concerning the uncertainty-performance relationship. Based on this relationship, the problems were divided into seven classes: stability, robustness, resilience, security, flexibility, disruption-tolerance and complexity.

According to Ivanov and Sokolov (2013), the first class encompasses the problems that investigate the supply chain's ability to continue the planned execution after being subjected to perturbations, such as demand fluctuations. In terms of control theory, this analysis considers the supply chain current state and current performance. The studies found in the literature about this topic usually considered Lyapunov's stability or the BIBO (bounded-input-bounded-output) stability for control systems (Ivanov & Sokolov, 2013; Liao, Wang, & Yu, 2007).

Besides being stable, the supply chain should also bring profits. Thus, the analyses must also include the achievement of performance targets. In the second class of problems defined, the ability to remain stable and achieve the planned performance in the presence of perturbations is investigated. According to the control perspective, this ability is named robustness, and its analysis considers not only the current state of the supply chain, but also a comparison between the planned and the current performance, based on a matrix of performance measures. The robustness is related, among other factors, to the existence of redundancies and reserves, such as safety stocks, time buffers, additional facilities and capacity reserves. The studies in this class usually employ robust and stochastic optimization methods.

The resilience, which is the property analyzed in the third class of studies, refers to the ability to maintain, execute and adapt the planned execution along with the achievement of the planned (or adapted) performance (Ivanov & Sokolov, 2013). During execution, when the supply chain is affected by perturbations and the redundancies are not enough to cope with them, the perturbations lead to disturbance and it becomes necessary to correct the plans by adjustable control actions. Thus, the analysis of resilience should also take into account the updated decision-making space and the disturbance (in addition to the factors considered in the previous classes of problems). According to Ivanov and Sokolov (2013), model predictive control is one methodology often used in the research on supply chain adaptation.

Security, the fourth class of studies presented by the aforementioned authors, is very similar to problem class 2, with the difference that it considers intentional perturbations instead of casual ones.

The fifth problem class investigates the flexibility, which is the ability to avoid disturbance by quickly changing the supply chain structurally and functionally. Disturbances may be compensated and flexibility may be increased by means of: financial asset reserves; product flexibility and modularity; supply chain coordination; monitoring and event management, etc. (Ivanov & Sokolov, 2013). The aforementioned authors highlight the need for further systematic research on the problems of this class.

A disruption occurs when a disturbance in the planned execution of the supply chain cannot be compensated by an adaptive control action to achieve the planned performance outputs. In this case, the replanning of output performance and the generation of new plans are necessary. The sixth class of problems thus investigates the tolerance to disruptions or the adaptability of the supply chain, which is related to the “creation of an adaptation system for the prevention, improvement or acquisition of new characteristics for the achievement of planned performance in existing or updated decision making spaces” (Ivanov & Sokolov, 2013).

Finally, the last problem class pointed out by the mentioned authors concerns to the investigation of complexity in the light of robustness, flexibility and economic performance. Attempts to increase robustness, flexibility or economic performance usually lead to an increased complexity. Nonetheless, if the complexity becomes too high, the system may become too sensitive to perturbations and may even lose controllability.

Besides the different schemes presented so far to classify the control theoretic models applied to supply chain, there is still an alternative classification, presented by Sagawa and Nagano (2013). They adopt the same criterion used by Ortega and Lin (2004) to classify the control theoretic approaches for production and supply chain systems, i.e., the models are classified according to the area of application. Besides the “horizontal” (supply chain systems) and “vertical” dimensions (multi-echelon systems), an additional category is proposed, encompassing the applications of control theory to Operations Scheduling and short-term shop floor control (Fig. 1
                     ). In the previous review presented by Ortega and Lin (2004), only a couple works related to this application were found. Lately, few more models have been developed. A comparative table and discussion of these models is presented in Sagawa and Nagano (2013).

During the period between 1980 and 1990, the concepts of supply chain and supply chain integration were widely spread. Sipper and Bulfin (1997) highlight an important feature of the "new" market driven production systems: the extension of the scope of the business to encompass the relationships of the focal company with its suppliers and customers. From this perspective, manufacturing systems started to be viewed not as isolated systems, but as part of a whole supply chain. Thus, the set of control theoretic applications for supply chain may also include manufacturing applications. In this paper, however, the category “programming and control systems” (Fig. 1) was detached from the category “horizontal/supply chain systems” for the sake of emphasizing the models specifically developed for the plant level of a focal company (and for short term programming).

The Automatic Production Control (APC) system presented by Wiendahl and Breithaupt (1999, 2000) can be classified in this third group of application, i.e., among the models developed for scheduling and shop floor control. The model stands on an analogy with fluid mechanics and depicts the behavior of a stochastic job shop system. The work-in-process (WIP) of a work center is represented as a flow network in continuous time. Thus, the work-in-process of a given work center k is obtained by adding the initial inventory of center k to the actual cumulative input of the upstream work centers flowing to k and to the external input of jobs. From this summation, the cumulative output of center k until time t must be subtracted. Simplifying, these operations represent the difference between the different input flows coming to the center and its output flow. In order to derive the equations of the model, the theory of the logistic operating curves and the funnel formula area also applied. For more details Sagawa and Nagano (2013), Wiendahl (1995), and Wiendahl and Breithaupt (1997, 1999, 2000) must be consulted.

The job shop configuration is represented in the APC system using transition probabilities, which can be derived from a material flow matrix (MFM). This matrix contains real data from the job shop, showing the amount of material or the number of orders that flow from a work center to another. The transition probabilities are obtained with the normalization of the material flow matrix.

In the APC system (Wiendahl & Breithaupt, 2000), two controllers were applied: a backlog controller and a WIP controller. The backlog of a system may be defined as the difference between the planned sum of work and the actual output. Thus, the backlog controller adds capacity to the system when the actual output is below the planned output. In this case, the capacity is the correcting variable whereas the planned output is the reference variable of the system. The WIP controller, on its turn, adjusts the input rate of the system in such a way that there is enough work to be processed but without too long queues. In other words, this controller sets the system to an adequate operating point, maximizing the output rate while at the same time keeping the production lead times at reasonable values.


                     Kim and Duffie (2006) proposed a coupled closed-loop model for short term capacity control that has similarities with the APC system previously discussed. Likewise in the APC model, the input rate is the sum of the output rates from all preceding workstations and any external input, and the actual WIP is given by the accumulated difference between the input and output rates of the kth workstation, plus any work disturbances such as rush orders. The MFM is also employed to compile the different amounts of orders sent to each workstation. The actual work in process level of a given kth workstation is compared to the planned level and, based on this WIP error, the workstation is controlled by a local capacity control policy, taking into account its planned capacity. The initial model proposed (Kim & Duffie, 2005) did not include any coupling between the capacity control of a given station and the capacity decisions made in the upstream stations. In a subsequent model (Kim & Duffie, 2006), these capacity decisions of upstream stations were added as inputs for the capacity control loop of a given downstream station. This model was applied to a manufacturing system with five workstations, using production data from a forging company that supplies components to the automotive industry. The system was simulated based on a characteristic transfer equation and the results showed that the coupling between workstations prevented the propagation of the WIP error to downstream workstations, thus improving the system performance.

An integral controller is used by Cho and Erkoc (2009) and Prabhu and Duffie (1999) for scheduling jobs in a flow shop system. Each job to be scheduled has an embedded controller, named Distributed Arrival Time Controller (DATC), that determines its arrival time (i.e., starting time) in order to minimize lateness. In other words, in each iteration, the controller adjusts the starting time of a given job i so that it may be completed as close as possible to its due date. The completion time of the parts is then calculated by a shop floor simulator based on the current starting times and the processing times of the jobs.

It is important to highlight that, in the aforementioned system, the principles of feedback control are applied to generate the scheduling algorithm, rather than to represent the dynamics of the scheduling system or the dynamics of a manufacturing system. The algorithm that uses the expression of an integral controller is applied to scheduling problems of static nature. The integral controller of DATC works as a search engine that replaces the traditional heuristics used in scheduling problems, but is not directly applied to dynamic problems.

Another model for operations scheduling with a feedback loop is presented by Li (2011). In this model, the jobs are scheduled offline using an extension of Johnson's algorithm. After that, the execution of the proposed schedule is simulated using Petri nets. The jobs are rescheduled based on the simulation and reapplication of the heuristics, until a satisfactory scheduled is attained. At this point, the scheduled is delivered to the shop floor. If any disturbance occurs on the shop floor, this information is fed back to the system, and the jobs are rescheduled and simulated again, according to the updated boundary conditions of the problem. Although presenting a feedback loop, the system proposed by Li (2011) is not a dynamic model, in the strict sense, since the scheduling is performed offline and the schedule is optimized for a specific set of boundary conditions. When these conditions change, the process is repeated offline for the new set of conditions.

A relevant future direction in the application of control theory to supply chain may be the closer approximation of this theory to the Operations Research area (Ivanov et al., 2012). In this sense, Ivanov, Sokolov, and Kaeschel (2010) propose the concept of structure dynamics control, which is based on the combined application of Optimal Control and Mathematical Programming. The structure dynamics considers different execution scenarios according to different structural states of the supply chain. From one time interval to another, for example, the transportation and processing rates and the demand of the regional distribution centers may change. In the proposed approach, the structure dynamics, inventory dynamics and transitions between intervals are modeled in a dynamic optimal control model. On the other hand, a discrete optimization problem of smaller dimensionality is formulated for each interval of structural constancy, being solved by using Mathematical Programming methods. In this way, the stationary parameters (such as warehouse capacities) are described in the static model, and the non-stationary parameters (e.g., changing order quantities) are considered in the dynamic control model (Ivanov et al., 2012).

The application depicted shows the importance of integrating different areas of knowledge and developing multidisciplinary applications of control theory for the supply chain and manufacturing domains. The model presented in the next sections also point to this direction.

An analogy with the ideal properties of electrical components is established by Ferney (2000) to represent the dynamics of the shop floor. In order to develop that, the following basic production entities are defined: machines, intermediate stocks, convergent and divergent junctions, sources of work and stocks of final products. The mathematical formulation of these entities will be detailed in this subsection, since the model presented in this paper uses them.

By analogy, the machines are represented as resistors, while the intermediate stocks are modeled as capacitors. The main variables that have a physical meaning in the model are the production flow f and the production volume q. The production flow variable represents the evolution of the material flow over a given section of the manufacturing system, and is measured in material units per time. Depending on the nature of the studied system, these material units may represent a discrete or continuous amount of material, or even a volume or a surface. The production volume is given by the time-related integration of the production flow, as shown in Eq. (1) (Ferney, 2000):

                           
                              (1)
                              
                                 
                                    q
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       q
                                       0
                                    
                                    +
                                    
                                       ∫
                                       
                                          
                                             t
                                             0
                                          
                                       
                                       t
                                    
                                    f
                                    
                                       (
                                       τ
                                       )
                                    
                                    d
                                    τ
                                 
                              
                           
                        where q0
                         is a constant value that represents the initial production volume, f(t) and q(t) are the flow and production volume mentioned in the previous paragraph and τ is the integration variable (time).

In an ideal resistor, there is a linear relationship between the electrical current f and the voltage e:

                           
                              (2)
                              
                                 
                                    f
                                    =
                                    
                                       1
                                       R
                                    
                                    e
                                 
                              
                           
                        where R is the electrical resistance. Since the machines are modeled as resistors, the following relationship applies to them:

                           
                              (3)
                              
                                 
                                    
                                       f
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       U
                                       i
                                    
                                    
                                       e
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        where Ui
                         is the processing frequency of machine i (which is the inverse of Ri
                        ), fi
                        (t) is the production flow through machine i at time t, and ei
                         is an effort variable, measured in material units (m.u). According to Ferney (2000), the effort variable ei
                         does not have a direct physical meaning, but it reflects the dynamic coupling phenomenon in relation to the material availability in the production entity located upstream. In other words, this variable is important to couple a given machine to its precedent production entity. All the equations of the model are expressed in relation to the variables of flow and effort.

The intermediate stocks of the manufacturing system, as mentioned, are modeled as capacitors. Thus, their behavior is mathematically represented by the expression of an ideal capacitor:

                           
                              (4)
                              
                                 
                                    
                                       e
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          C
                                          i
                                       
                                    
                                    
                                       q
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        where qi
                         is the amount of stored material at time t, Ci
                         is a parameter related to the storage capacity and ei
                         is the effort variable (as known, for an ideal capacitor, ei
                         is the voltage, Ci
                         is the capacitance and qi
                         is the amount of electrical charge stored).

The behavior of a stock involves three elementary flows, as in Eq. (5): an input flow fei
                        (t), an output flow fsi
                        (t), and the difference between them, fi
                        (t), which corresponds to the flow of stored material.

                           
                              (5)
                              
                                 
                                    
                                       f
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       f
                                       
                                          e
                                          i
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    
                                       f
                                       
                                          s
                                          i
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     

The amount of material accumulated in the stock, as a function of the flow fi
                        (t), is given by Eq. (1) previously presented. The amount of stored material must be non-negative (Eq. (6)), which means that the material output is controlled in relation to the volume of material stored.

                           
                              (6)
                              
                                 
                                    
                                       q
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ≥
                                    0
                                 
                              
                           
                        
                     

In the model under discussion, it is assumed that the stocks have infinite capacity, i.e., Ci
                        → ∞. Since qi
                        (t) ≥ 0, then from Eq. (4) it follows that ei
                        (t) → 0. According to Ferney (2000), the stock is a passive element, i.e., it has no proper dynamics: the incoming material flow is imposed upon it by the entity connected upstream and the output flow is withdrawn at the request of the entity located downstream.

Each machine of the manufacturing system is preceded by a correspondent stock; these two entities are connected by means of a coupling structure to constitute a production station. As the output effort of the stock tends to zero, as discussed in the previous paragraph, a source of effort is added to establish the coupling interface between the stock and the machine. This source activates the machine when there is any amount of material in the precedent stock. The amount of effort added by the source is shown in Eq. (7). This expression guarantees a continuous transition when there is less than one unit of material in the precedent stock, i.e., it allows the approximation of discrete systems to continuous systems. For more details, Ferney (2000) should be consulted. When there is at least one unit of material in stock, then ei
                        (t) = 1 material unit, and the machine processes the incoming flow with its full processing frequency Ui
                        , generating an output flow fsi
                        (t) = Ui
                         material units per time (Eq. (3)).

                           
                              (7)
                              
                                 
                                    
                                       e
                                       i
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

A schematic of a production station is shown in Fig. 2
                        .

From Eqs. (3), (4) and (7), it is possible to derive the equations for the stock, the machine and the coupling interface in relation to the effort and flow variables shown in the schematic. These equations are, respectively:
                           
                              (8)
                              
                                 
                                    
                                       e
                                       2
                                    
                                    =
                                    
                                       1
                                       
                                          C
                                          i
                                       
                                    
                                    
                                       q
                                       i
                                    
                                    →
                                    0
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       f
                                       4
                                    
                                    =
                                    
                                       U
                                       i
                                    
                                    
                                       e
                                       4
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       e
                                       3
                                    
                                    =
                                    min
                                    
                                       (
                                       1
                                       ,
                                       
                                          q
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

According to Eqs. (1) and (5), the flow of stored materials given by the difference between the input and the output flows, that is:

                           
                              (11)
                              
                                 
                                    
                                       f
                                       2
                                    
                                    =
                                    
                                       f
                                       
                                          e
                                          i
                                       
                                    
                                    −
                                    
                                       f
                                       1
                                    
                                    =
                                    
                                       q
                                       i
                                       ′
                                    
                                 
                              
                           
                        
                     


                        Fig. 2 shows that a station has two internal junctions. The first one links the stock element into the main flow while the second one integrates the machine and the source of effort into this main flow. In the first junction, the flow is conserved, as expressed in Eq. (11). The stock only stores part of the incoming flow, but it cannot create flow. To keep the compatibility of the model, the efforts around this junction must be equal (Eq. (12)). For the second junction, the opposite situation applies: the flows around the junction are equal, and dictated by the machine, while the total effort is conserved, as expressed in Eqs. (13) and (14). These compatibility equations are derived from the Bond Graph methodology, which is used by Ferney (2000) to define the basic production entities of the shop floor.

                           
                              (12)
                              
                                 
                                    
                                       e
                                       
                                          e
                                          i
                                       
                                    
                                    =
                                    
                                       e
                                       1
                                    
                                    =
                                    
                                       e
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       f
                                       1
                                    
                                    =
                                    
                                       f
                                       3
                                    
                                    =
                                    
                                       f
                                       4
                                    
                                    =
                                    
                                       f
                                       
                                          s
                                          i
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       e
                                       1
                                    
                                    +
                                    
                                       e
                                       3
                                    
                                    −
                                    
                                       e
                                       4
                                    
                                    −
                                    
                                       e
                                       
                                          s
                                          i
                                       
                                    
                                    =
                                    0
                                 
                              
                           
                        
                     

The manipulation of Eqs. (8)–(14) leads to Eq. (15), which expresses the output flow of a station. Supposing that this ith station is linked to a kth station downstream supplying a kth stock, then the effort esi
                         is a linear function of the ratio qk
                        /Ck
                        . As both Ci
                         and Ck
                        → ∞ by definition, then it is possible to simplify Eq. (15) into Eq. (16).

                           
                              (15)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          i
                                       
                                    
                                    =
                                    
                                       U
                                       i
                                    
                                    
                                       [
                                       
                                          
                                             q
                                             i
                                          
                                          /
                                          
                                             C
                                             i
                                          
                                          +
                                          min
                                          
                                             (
                                             1
                                             ,
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                       
                                       −
                                       
                                          e
                                          
                                             s
                                             i
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          i
                                       
                                    
                                    =
                                    
                                       U
                                       i
                                    
                                    min
                                    
                                       (
                                       1
                                       ,
                                       
                                          q
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Finally, the basic state equation for a production station is obtained by substituting Eqs. (16) and (13) into Eq. (11), as follows:

                           
                              (17)
                              
                                 
                                    
                                       q
                                       i
                                       ′
                                    
                                    =
                                    
                                       f
                                       
                                          e
                                          i
                                       
                                    
                                    −
                                    
                                       U
                                       i
                                    
                                    min
                                    
                                       (
                                       1
                                       ,
                                       
                                          q
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

Besides the station, the junctions, the sources and the wells complete the shop floor model presented by Ferney (2000). The convergent and divergent junctions enable the representation of the topology of the manufacturing system. The convergent junctions merge the flows coming from different stations or entities, while the divergent junctions distribute the material flow into the different stations of the system. The sources provide the material input flow to the system, while the wells are similar to stocks with infinite capacity, used to represent the system outputs, i.e., the stocks of final products. The expressions for a convergent and divergent junctions are presented in Eqs. (18) and (19), respectively.

                           
                              (18)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          i
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       f
                                       
                                          e
                                          k
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       f
                                       s
                                    
                                    j
                                    =
                                    
                                       w
                                       j
                                    
                                    
                                       f
                                       
                                          e
                                          i
                                       
                                    
                                    ,
                                    with
                                    
                                    
                                       ∑
                                       
                                          (
                                          j
                                          =
                                          1
                                          )
                                       
                                       n
                                    
                                    
                                       
                                          w
                                          j
                                       
                                       =
                                       1
                                    
                                    
                                    and
                                    
                                    
                                       w
                                       j
                                    
                                    >
                                    0
                                 
                              
                           
                        
                     

where:

                           
                              
                                 fsi
                                  and fek
                                  represent, respectively, the single output flow and the different input flows of a convergent junction;


                                 fsj
                                  represents each of the output flows of a divergent junction and fei
                                  express the single input flow of this junction;


                                 wj
                                  are normalized weights applied to a given output branch of a divergent junction.

This set of production entities is used by Ferney (2000) to model and simulate a fictitious system with four stations for manufacturing a single product. The control objective of the model is to adjust the level of the output flow of the system to attend the demand of the considered product, while, at the same time, keeping the work in process (WIP) at the desired levels. This objective is achieved by controlling the production frequencies of the machines and the sources, represented by the variable Ui
                         in Fig. 2. The simulations carried out showed that the model was able to automatically respond to unexpected events, such as a machine breakdown. In addition, the reference levels set for the intermediate stocks were attained.

The review of the models based on control theory for scheduling and shop floor control demonstrated that this body of knowledge is still incipient, fact that encourages further research. In the next section, a dynamic model for manufacturing multiple products is proposed.

Companies that offer customized products in medium scale usually fabricate them in job shops, in an MTO basis. To attend the mass-customization concept mentioned in the introduction of this paper, it is necessary to associate the flexibility of a job shop with the efficiency of a flow shop. The model presented in this section is applied to the production of multiple families of customized products in a job shop configuration. Job shops were also chosen as the target of application because they usually have a complex flow; from the perspective of the dynamics, this would yield a more interesting analysis. A real production system of polypropylene bags was modeled. The basic steps of this specific production process will be described in the next paragraphs, before the development of the model.

The process of manufacturing polypropylene woven bags involves the following operations: extrusion, weaving, lamination, printing, cutting and stitching. In the extrusion, the polypropylene pellets, additives and pigment are mixed, melted and extruded as a flat film. This film is cooled down and slit into the form of tapes, which are then stretched under heat at a predetermined ratio.

The tapes produced by extrusion are wound on a bobbin that will feed a circular loom. In the looms, the tapes are woven into tubular fabric. After that, the fabric goes through different finishing operations, depending on the customers’ requirements. Some woven bags are laminated, that is, are coated with a polymer film while passing through lamination rolls. Also, the bags (laminated or not) may require different printings. After printed, the fabric is cut into the desired size and sent for stitching. In the company under analysis, the stitching operation could be automatically or manually performed. At the end of the process, the bags that do not go through lamination may receive a plastic liner in order to avoid leakage of the packed content. This is done in an additional manual operation. Table 1
                      shows the number of machines available in the company for each manufacturing operation.

The company under study works in a make-to-order basis, and its main competitive priorities are on-time delivery (i.e. dependability), product quality, and flexibility to manufacture customized products. The polypropylene bags may present differences regarding linear mass density (denier), resistance and finishing. About 80 different products are manufactured in the company, in a job shop configuration. These products can be grouped based on different criteria, such as type of product, geographical market, process routings, volume range and others, as highlighted by Hyer and Wemmerlöv (2002). The original classification adopted by the company's managers is based on the type of product, i.e., the product application. This criterion results in six classes of products:

                        
                           •
                           Class L—Laminated polypropylene bags.

Class R—Conventional polypropylene bags for animal feed.

Class A—Heavy polypropylene bags for sugar.

Class T—Polypropylene woven fabric.

Class S—Woven returnable shopping bags.

Class Z—Heavy bags for a special client.

This classification, however, is not interesting from the perspective of the dynamics. For the development of the model, the products must be grouped according to their process routings. Based on that, nine families of products were identified, as shown in Table 2
                     .

The historical demand for each product family also constitutes relevant data for the model. The absolute values of demand were set as the target values for the outputs of the system, and were also used to compute the product mix. Table 3 shows these data, for each family of products. From the mix data, it is possible to derive the relative amounts of material or work that flow from and to each station. The process routings determine the topology of the system, while the mix determines the transition probabilities, which were also used by Wiendahl and Breithaupt (2000) to model a job shop. The schematic for the multi-product manufacturing system of propylene bags with 11 stations is shown in Fig. 3.

In the schematic, the variables Ui
                      represent the processing frequencies of the machines and the variable U
                     01 refers to frequency of the source of material flow. Each machine is preceded by an intermediate stock. The flow variables are highlighted in bold. As it can be seen, the weaving, printing and automatic cutting and stitching departments have multiple machines, in accordance to the data shown in Table 1. The 12 looms of the weaving department are identical, therefore, they were considered as one single machine, named machine 2. This approach does not compromise the power of the model to depict the dynamics of the system. The breakdown of one loom, for example, may be simulated by imposing a decrement of 1/12 in the capacity of machine 2. On the other hand, this simplification is convenient since it reduces the number of variables, and, therefore, the complexity of mathematical solution. The two printers and the multiple cutting and stitching machines are not identical; they present significantly different capacities, production speed and specifications. The machine 4, for example, is faster than machine 5 and may print in six different colors, while machine 5 may only print in four different colors. The cutting and stitching machines also have different features. For these reasons, these machines were represented separately.

It can be seen that the production flow is somewhat intricate due to the number of distinct possible routings. In order to represent these possibilities, one divergent junction and three divergent-convergent junctions were used, as it can be seen in the schematics.


                        Eqs. (16) and (17) may be applied to each station shown in the schematics. They are complemented by the expressions for the convergent and divergent junctions, which express the conservation of flow. The mathematical formulation for the first three production departments and for the junctions 1 and 2 (Fig. 3) is presented as follows.

First, Eq. (20) shows that an initial material flow f
                        01 is imposed to the system with a frequency U
                        01, which can be controlled. In order to establish continuity and compatibility, the input flow of the weaving station (fe2
                        ) has to be equivalent to the output flow of the extrusion (fs1
                        ), as shown in Eq. (21). Also, the application of Eq. (16) to the first station yields the expression shown in the right side of Eq. (21). The rate of material stored in the first station (Eq. (22)) is given by the difference between its input and output flows, as previously stated in Eq. (17).

The equations employed to model the weaving and lamination stations are analogous to Eqs. (21) and (22).


                        Extrusion:
                        
                           
                              (20)
                              
                                 
                                    
                                       f
                                       01
                                    
                                    =
                                    
                                       U
                                       01
                                    
                                    1
                                    
                                    
                                       meter
                                       
                                       square
                                       
                                       per
                                       
                                       day
                                    
                                    
                                    
                                       (
                                       primary
                                       
                                       source
                                       
                                       of
                                       
                                       flow
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          1
                                       
                                    
                                    =
                                    
                                       f
                                       
                                          e
                                          2
                                       
                                    
                                    =
                                    
                                       U
                                       1
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       q
                                       1
                                       ′
                                    
                                    =
                                    
                                       f
                                       01
                                    
                                    −
                                    
                                       U
                                       1
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       U
                                       01
                                    
                                    −
                                    
                                       U
                                       1
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     


                        Weaving:

                           
                              (23)
                              
                                 
                                    
                                       f
                                       
                                          e
                                          2
                                       
                                    
                                    =
                                    
                                       f
                                       
                                          s
                                          1
                                       
                                    
                                    =
                                    
                                       U
                                       1
                                    
                                    
                                    min
                                    
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          2
                                       
                                    
                                    =
                                    
                                       U
                                       2
                                    
                                    
                                    min
                                    
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       q
                                       2
                                       ′
                                    
                                    =
                                    
                                       U
                                       1
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             1
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       U
                                       2
                                    
                                    
                                    min
                                    
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     


                        Junction 1 (divergent):
                        
                           
                              (26)
                              
                                 
                                    
                                       f
                                       
                                          e
                                          3
                                       
                                    
                                    =
                                    0.4301
                                    
                                       f
                                       
                                          s
                                          2
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       f
                                       
                                          e
                                          p
                                       
                                    
                                    =
                                    0.4900
                                    
                                       f
                                       
                                          s
                                          2
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       f
                                       
                                          e
                                          c
                                          1
                                       
                                    
                                    =
                                    0.0588
                                    
                                       f
                                       
                                          s
                                          2
                                       
                                    
                                 
                              
                           
                        
                     


                        Lamination:
                        
                           
                              (29)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          3
                                       
                                    
                                    =
                                    
                                       U
                                       3
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             3
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             q
                                             3
                                             ′
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.4301
                                             
                                                f
                                                
                                                   s
                                                   2
                                                
                                             
                                             −
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.4301
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Junction 2 (convergent-divergent)
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                e
                                                6
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0347
                                             (
                                             
                                                
                                                   f
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0347
                                             (
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             0.4900
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                s
                                                f
                                                1
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.1262
                                             (
                                             
                                                
                                                   f
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.1262
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             0.0618
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                s
                                                f
                                                5
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0063
                                             (
                                             
                                                
                                                   f
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0063
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             0.0031
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             f
                                             345
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.8258
                                             (
                                             
                                                
                                                   f
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.8258
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             0.4042
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                e
                                                c
                                                2
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0071
                                             (
                                             
                                                
                                                   f
                                                   
                                                      s
                                                      3
                                                   
                                                
                                                +
                                                
                                                   f
                                                   
                                                      e
                                                      p
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.0071
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             −
                                             0.00348
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       f
                                       
                                          s
                                          6
                                       
                                    
                                    =
                                    
                                       f
                                       
                                          s
                                          f
                                          4
                                       
                                    
                                    =
                                    
                                       U
                                       6
                                    
                                    min
                                    
                                       (
                                       
                                          1
                                          ,
                                          
                                             q
                                             6
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             q
                                             6
                                             ′
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                f
                                                
                                                   e
                                                   6
                                                
                                             
                                             −
                                             
                                                f
                                                
                                                   s
                                                   6
                                                
                                             
                                             =
                                             0.0347
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             0.0170
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                U
                                                6
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      6
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the divergent junction between weaving and lamination (junction 1, Fig. 3), part of the flow that leaves the weaving station (fs2
                        ) goes to lamination (fe3
                        ), part of it goes to junction 2 (fep
                        ), part leaves the system in the form of final products of family 6 (fsf6
                        ), and part of the flow skips the lamination and printing stations, going directly to the automatic cutting and stitching operations (fec1
                        ). Thus, Eq. (19) of a divergent junction is applied to this point, resulting in the Eqs. (26)–(28) presented.


                        Eq. (19) is also applied to the divergent portion of junction 2, yielding five distinct output flows: fsf1, fsf5, fe6, f345
                         and fec2
                        . Junction 2 has a convergent portion too; therefore, the weights wj
                         are applied to the sum of input flows, fs3
                         + fep
                        . Summarizing, Eqs. (31)–(35) derive from the application of both Eqs. (18) and (19) to junction 2. Ordinary algebraic manipulation using Eqs. (24), (27), and (29) is also carried out, resulting in the expressions shown in the right side of Eqs. (31)–(35).

Finally, Eq. (36) represents the output flow that leaves the manual stitching station and Eq. (37) corresponds to the amount of material stored in the intermediate stock of this station.

The remaining equations of the model are analogous to the ones presented. Simple algebraic manipulation of the whole set of equations yields the state equation of the model, in which the flow of stored material q′ is a function of the current amount of stored material q and the control variables Ui
                        . The matrix form of the state equation is shown in Eq. (38).


                        
                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         5
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         6
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         7
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         8
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         9
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         10
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               q
                                                               ′
                                                            
                                                         
                                                         11
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.4300
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.2508
                                                      
                                                   
                                                   
                                                      
                                                         0.5118
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.1538
                                                      
                                                   
                                                   
                                                      
                                                         0.3140
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.0170
                                                      
                                                   
                                                   
                                                      
                                                         0.0347
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.0175
                                                      
                                                   
                                                   
                                                      
                                                         0.0020
                                                      
                                                   
                                                   
                                                      
                                                         0.2811
                                                      
                                                   
                                                   
                                                      
                                                         0.2811
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.0087
                                                      
                                                   
                                                   
                                                      
                                                         0.0010
                                                      
                                                   
                                                   
                                                      
                                                         0.1399
                                                      
                                                   
                                                   
                                                      
                                                         0.1399
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.0161
                                                      
                                                   
                                                   
                                                      
                                                         0.0018
                                                      
                                                   
                                                   
                                                      
                                                         0.2588
                                                      
                                                   
                                                   
                                                      
                                                         0.2588
                                                      
                                                   
                                                   
                                                      
                                                         0.2407
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.0200
                                                      
                                                   
                                                   
                                                      
                                                         0.0023
                                                      
                                                   
                                                   
                                                      
                                                         0.3204
                                                      
                                                   
                                                   
                                                      
                                                         0.3204
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         0.2407
                                                      
                                                   
                                                   
                                                      
                                                         0.2407
                                                      
                                                   
                                                   
                                                      
                                                         0.2407
                                                      
                                                   
                                                   
                                                      
                                                         0.2407
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ×
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               1
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  1
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               2
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  2
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               3
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  3
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               4
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  4
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               5
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  5
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               6
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  6
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               7
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  7
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               8
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  8
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               9
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  9
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               10
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  10
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               11
                                                            
                                                            min
                                                            
                                                               (
                                                               1
                                                               ,
                                                               
                                                                  q
                                                                  11
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             +
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            U
                                                            01
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

At the initial moment, if the manufacturing system is empty, the control matrix is reduced to the part related to the supply source U
                        01. As soon as at least one unit of material is stored in each intermediate stock, the machines become autonomous, i.e., not dependent on the stock-machine coupling dynamics. Thus, the flow of stored material q′ starts to depend just on the processing frequencies Ui
                        . In this case, the control problem consists of adjusting the processing frequencies to obtain the desired levels of stock.

In the permanent regime (i.e. steady state), all the stocks must contain more than one unit and the level of stored material should not vary, i.e., q′i
                         = 0 for all i. With this definition, the state equation becomes:


                        
                           
                              (39)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.4300
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.2502
                                                         
                                                      
                                                      
                                                         
                                                            0.5118
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.1538
                                                         
                                                      
                                                      
                                                         
                                                            0.3140
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.0170
                                                         
                                                      
                                                      
                                                         
                                                            0.0347
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.0175
                                                         
                                                      
                                                      
                                                         
                                                            0.0020
                                                         
                                                      
                                                      
                                                         
                                                            0.2811
                                                         
                                                      
                                                      
                                                         
                                                            0.2811
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.0087
                                                         
                                                      
                                                      
                                                         
                                                            0.0010
                                                         
                                                      
                                                      
                                                         
                                                            0.1399
                                                         
                                                      
                                                      
                                                         
                                                            0.1399
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.0161
                                                         
                                                      
                                                      
                                                         
                                                            0.0018
                                                         
                                                      
                                                      
                                                         
                                                            0.2588
                                                         
                                                      
                                                      
                                                         
                                                            0.2588
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.0200
                                                         
                                                      
                                                      
                                                         
                                                            0.0023
                                                         
                                                      
                                                      
                                                         
                                                            0.3204
                                                         
                                                      
                                                      
                                                         
                                                            0.3204
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            0.2407
                                                         
                                                      
                                                      
                                                         
                                                            0.2407
                                                         
                                                      
                                                      
                                                         
                                                            0.2407
                                                         
                                                      
                                                      
                                                         
                                                            0.2407
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ×
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            U
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            4
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            5
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            6
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            7
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            8
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            9
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            10
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            11
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            U
                                                            01
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The steady state solution provides the average processing frequency of the machines and sources in the medium term. It signals which would be the adequate processing frequencies if the system was not subjected to any kind of disturbances. The linear system presented in Eq. (39), however, is underdetermined, since it has 11 equations and 12 variables (U
                        1–U
                        11 plus U
                        01). Hence, the definition of the adequate frequencies depends on boundary conditions.

One of the most relevant goals of a manufacturing system is to attend the required demands on time. As it can be seen in the schematics, the system being modeled has nine different outputs, each one corresponding to a product family. In the medium term, the flow in these outputs must correspond to the respective demands of each product family, presented in Table 3. This condition generates nine additional equations analogous to the following equation (see also Eq. (32)).

                           
                              (40)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                s
                                                f
                                                1
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             0.1262
                                             
                                                U
                                                3
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      3
                                                   
                                                
                                                )
                                             
                                             +
                                             0.0618
                                             
                                                U
                                                2
                                             
                                             min
                                             
                                                (
                                                
                                                   1
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             5286
                                             
                                             
                                                meter
                                                
                                                square
                                                
                                                per
                                                
                                                day
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With the additional equations, the system becomes overdetermined. Thus, nine different steady state solutions were calculated by combining Eq. (39) to each one of the additional equations. The solutions found were identical except for small rounding errors. It shows that the mathematical formulation is consistent, and that some equations of the overdetermined system are linear dependent. Table 4 shows the steady state solution of the system, considering the demands presented in Table 3.

The state equation (Eq. (38)) was implemented in Matlab® and the proposed model was simulated using Simulink®. The control was applied to the processing frequency of the machines and of the source of flow in order to achieve the desired levels of work-in-process (i.e. intermediate stocks) in the plant. For an exploratory understanding of the behavior of the system, a proportional controller was applied. The machines are adjusted to operate with frequencies that are close to the frequencies of permanent regime shown in Table 4. The controller increases or decreases these frequencies by amounts that are proportional to the relative error of the stock that immediately succeeds the machine. If a given machine i is followed by only one subsequent stock, then the proposed control law is given by:

                           
                              (41)
                              
                                 
                                    
                                       U
                                       i
                                    
                                    =
                                    
                                       U
                                       
                                          i
                                          p
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       k
                                       
                                          e
                                          j
                                          ′
                                       
                                       )
                                    
                                    ,
                                    para
                                    
                                    m
                                    =
                                    0
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       e
                                       j
                                       ′
                                    
                                    =
                                    −
                                    
                                       e
                                       j
                                    
                                    =
                                    
                                       
                                          
                                             q
                                             
                                                j
                                                c
                                             
                                          
                                          −
                                          
                                             q
                                             j
                                          
                                       
                                       
                                          q
                                          
                                             j
                                             c
                                          
                                       
                                    
                                 
                              
                           
                        where Ui
                         is the controlled processing frequency of machine i, Uip
                         is the processing frequency of machine i in permanent regime, k is the proportional gain, j is the index of the station downstream of i; e′j
                         is the compensation of the error of stock j (which has the opposite sign of the error ej
                        ); qj
                         is the current level of stock j and qjc
                         is the reference level for stock qj
                        .

For the case where a machine is succeeded by parallel stations, all the compensations are computed and the minimum of them is applied, as shown in Eq. (43).

                           
                              (43)
                              
                                 
                                    
                                       U
                                       i
                                    
                                    =
                                    
                                       U
                                       
                                          i
                                          p
                                       
                                    
                                    
                                       [
                                       
                                          1
                                          +
                                          min
                                          (
                                          
                                             k
                                             
                                                
                                                   
                                                      e
                                                      ′
                                                   
                                                
                                                j
                                             
                                             ,
                                             k
                                             
                                                
                                                   
                                                      e
                                                      ′
                                                   
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             k
                                             
                                                
                                                   
                                                      e
                                                      ′
                                                   
                                                
                                                
                                                   j
                                                   +
                                                   m
                                                
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                              
                           
                        where m + 1 is the number of parallel stations downstream of i. The remaining variables and parameters are defined as in Eqs. (41) and (42).

An exploratory simulation was performed with the controller defined by Eqs. (41)–(43). The results are shown in the next section. The simulation was carried out in a personal computer with the following specifications: Intel® processor Core™ i7-3620M CPU @ 2.90 gigahertz, 6 gigabytes of RAM and operational system of 64 bits. Matlab® release 2012b and Simulink® version 8.0 (R2012b) were used.


                     Fig. 4
                      shows the results of the simulation performed with the proportional controller defined in Section 3.2, with gain k = 0,1. The reference levels for the intermediate stocks were defined as a hundred times the values observed for the open loop system. The transient regime response of the system starting with null initial stocks was observed.

It can be seen that a surplus of material is manufactured at the beginning of the simulation, when the machines are operating with a frequency above the frequency of permanent regime. However, the proportional controller compensates this surplus, so that the intermediate stocks could reach the desired level with relative low error. This result showed that the behavior of the system was automatically adjusted during the transient regime in order to achieve the predetermined levels of work in process. Therefore, the proposed model could successfully represent the system dynamics, and this dynamics was automatically controlled.


                     Fig. 4 shows that the system needs approximately 240 days to reach stability, which may be considered a too long time from the management perspective. Nonetheless, it must be highlighted that the average aggregate demands are being attended during the transient regime, since the products of the different families are continuously manufactured at frequencies that are close to the frequency of the machines in permanent regime. These latter frequencies, on their turn, were set to simultaneously attend the demands for the nine product families.

Additionally, it is possible to observe that the implemented feedback control loop is equivalent to a pulled system, such as the kanban system, for instance. In this case, the information flow is opposite to the material flow, i.e. the information flows upstream. Fig. 4 shows that the stocks that are closer to the outputs of the system, i.e. stocks 6 to 11, tend to reach stability before the remaining ones. They are followed by stocks 4 and 5, then by stocks 3, 2 and 1, respectively. Stock 1 is the last one to reach the reference value. Thus, it is possible to see that the system has an intrinsic inertia, i.e., there is a delay in the transmission of information, from the time it is sent to the machines of the end of the system until the time it reaches the machines of the beginning.

One advantage of the developed model resides in the possibility of representing the process routings of all the different product families in a unified map. In this sense, it differs from other methods, such as the Value Stream Mapping (VSM), where one different map has to be generated for each process routing. This unified model enables the direct computation of the workload of the stations to manufacture all the range of products in the job shop. The processing frequencies of the machines in permanent regime are well-grounded estimates of this workload. As known, the Workload Control (WLC) is an influential factor in the performance of MTO companies with job shop configuration, as the one studied.

The proposed model also requires a set of data that is relatively easy to collect, in comparison to more complex models, such as the one proposed by Wiendahl and Breithaupt (1999, 2000), which require a large amount and variety of data. Another interesting point is that the modeling approach chosen is able to represent the interdependencies among the stations. The dynamic coupling between two consecutive stations is stated by the compatibility equations that express the conservation of flow in the junctions. These equations play the same role as the capacity control couplings added as inputs to the local control loop in the model proposed by Kim and Duffie (2006).

The information about the demand of the products is an explicit parameter of the proposed state model, used to define the steady state processing frequency of the machines. In other models developed for a similar application (Kim & Duffie, 2006; Wiendahl & Breithaupt, 2000), this demand information is implicit in the amount of input orders that arrive at each workstation. The proposed model with explicit demand information might be able to cope with seasonal patterns, provided that the average demand for each family of products is informed to the system.

As seen in the proposed model, the control of the manufacturing system is performed by adjusting the processing frequencies of the machines. However, for the production of different products, specific operating times are required, i.e., the processing frequency of the machine cannot be set to any desired value. Thus, the intent is not to use the results of simulation to physically control the production frequencies of the machines. Based on these results, however, the managers may adjust the downtimes of the machines to reach a reference production frequency, on average, in order to keep the levels of work in process under control. In fact, the proposed mathematical formulation allows performing two managerial analyses: a static and a dynamic capacity analysis. The steady state processing frequencies of the machines express the average load of the machines, for the production mix considered in the model. Thus, managers may compare these loads to the availability of the machines in order to identify static bottlenecks in the system. On the other hand, the system can be simulated in the presence of disturbances and changes in the average demands in order to observe how the capacity requirements change, i.e., to observe the bottlenecks in a dynamical context. A similar analysis can be carried out with the introduction of machine breakdowns. In this case, it is possible to find good policies to adjust the processing frequency of the other machines and to adjust the source of flow (i.e. the release of jobs in the shop floor) in order to avoid deregulated WIP and to attend at least part of the demand. Summarizing, the simulations of the proposed model may provide managerial recommendations on how to dynamically operate the shop floor, depending on its current state and on the events that occur. Different automatic control strategies may be implemented, therefore, a relevant practical deliver of this research is allowing a dynamic analysis of a manufacturing system that does not exclusively depend on the previous knowledge and intuition of the manager.

The presented model may be applied to manufacturing systems with different configurations, such as parallel machines or flow shops, since these systems are composed of the same basic entities used in the presented example: machines, intermediate stocks, final stocks (wells), sources of flow and junctions. For instance, in a flow shop without parallel machines, the flow will be unidirectional, i.e., there will not exist any divergent or convergent junction in any section of the system, except in its end, where a divergent junction will define the product mix, i.e. the percentages of flow that are needed to attend the demand of each product family. In a flow shop with parallel machines, divergent and convergent junctions will exist before and after the parallel stations, respectively, but none of the products will skip any station.

It is worth mentioning that the mathematical representation of different models does not depend on the formulation of a different transfer function for each particular workstation or for each particular system. The mathematical model of the entity “station” is generic and the approach is modular, i.e. the representation of different systems only requires different combinations of the basic entities to form different topologies. The approach may also be applied to MTO or MTS manufacturing systems. In both cases, the average demand data for a given period is needed, not mattering whether this data corresponds to demand forecasts or actual orders.

One limitation for the generalization of the model is the selection of the controller type and the tuning of its parameters, since for each particular manufacturing system, a different type of controller with specific values of parameters would provide the best results. Thus, the control synthesis for different manufacturing systems is still an issue to be tackled.

In the presented example, the demands for the products were expressed in units of area per time instead of in a discrete unit. However, the use of a continuous measuring unit is not a requirement for the application of the model, because the term min(1,qi
                     ) allows the approximation of discrete systems by a continuous systems, as stated by Ferney (2000). This term expresses the transient coupling between a given machine and its precedent stock when less than one unit of material is stored in this stock, assuring a smooth transition. Conversely, when the stock located upstream a given machine is not supplied any longer, the volume of material stored tends asymptotically to zero according to the processing frequency of the downstream machine. Thus, the expression allows the asymptotic convergence (Alla & David, 1988; Ferney, 2000). In practical terms, it means that discrete units, such as material units or orders may be employed in this approach, and they do not constitute an obstacle for the model generalization.

The main limitation of the proposed model regards the level of analysis it is suitable for. Instead of dealing with individual orders, it employs average variables, such as mean work in process, average product mix and average demand rates for different product families. In this sense, the model focus on the “planning level” of Production Planning and Control (PPC), likewise the flow models presented by Wiendahl and Breithaupt (1999, 2000) and Kim and Duffie (2006). It would be of interest that this kind of model could deal more directly with the operational/scheduling level, considering individual orders and set up data.

This paper presented the development of a model that depicts the dynamics of a multi-product manufacturing system. The model was based on analogies between the production entities of the shop floor and ideal properties of electrical components. The state equation of the system was derived from these analogies and from the application of the dynamic modeling methodology. The state representation enables the implementation of a feedback control loop to automatically control the system.

In the proposed model, the control objective was to achieve the desired levels of work in process while simultaneously attending the aggregate demand of each product family manufactured in the plant. An exploratory simulation of the system with a proportional controller was carried out using Simulink®, considering null initial stocks. The results showed that each intermediate stock presented an initial overshoot but, after that, stabilized around the defined reference levels. It demonstrates that the system can be successfully controlled when starting from the initial condition set. Also, the results of simulation reveal that the system has an inherent inertia, that is, the control information flows upstream with a certain delay, from a given station to its antecedent one.

Most of the ordinary tools applied in the manufacturing area presume stationary conditions. Some exceptions are the queuing theory and the discrete events simulation. The proposed methodology has an advantage over these tools since it allows not only to study the response of the system in a dynamic sense, but also to control it over time to reach a desired condition or state. In the conventional simulation (i.e., Discrete Events Simulation), this automatic feedback does not exist. In addition, this modeling methodology provides the opportunity to exploit the conventional tools of control theory to, in future research, tackle the problems of control synthesis for the specific case of manufacturing systems. In this sense, this research has a multidisciplinary perspective, since the field of manufacturing management can benefit from the tools and techniques that come from control theory and dynamic systems modeling, which are originally applied to physical systems (mechanical, electrical, hydraulic and thermal). Actually, some recent reviews showed that control theory has been largely applied to model supply chain systems over the past 40 years. However, the extant dynamic models devoted to depict the shop floor dynamics, in the plant level, seem to be much less numerous than the dynamic models for supply chain representation or lot size optimization. The proposed model intends to be a contribution to this specific area of application.

As presented in Section 2, a dynamic model of a manufacturing system based on analogies with electrical components had previously been developed for the case of a single product system. Thus, this research contributes with the extension of this modeling methodology to multi-product systems and with the report of a practical application. It overcomes one usual limitation of the dynamic production-inventory models and supply chain models, which is the assumption of a single product. The importance of overcoming this limitation is highlighted in the literature of the field, as discussed in the introduction of this paper. The modeling approach presented is an alternative to the approaches used to develop the few existing models devoted to a similar application.

This paper focused on the development of the dynamic model itself, i.e., on the details of the modeling process. The simulation performed was exploratory/preliminary, and aimed to validate the capability of the model to represent the dynamics of the manufacturing system. The development of this model gives room to future research concerning the modeling and simulation of diverse manufacturing systems in a variety of scenarios considering unexpected events, such as machine breakdowns, lack of materials, urgent orders, among others. The methodology allows modeling several configurations of manufacturing systems, such as single machine, parallel machines, flow shop, job shop, batch shop and open shop. This generalization capability is provided mainly by the modularity of the presented approach. The basic manufacturing entities, each one associated to its respective constitutive equation, may be arranged to represent different shop floor configurations. Then, the resulting state model will be a combination of the expressions that represent the involved entities. This modeling approach may be also applied to variables and parameters measured by continuous and discrete units, which confers more flexibility.

Besides the exploration of different scenarios, the design and tuning of effective controllers for the manufacturing systems constitutes another relevant opportunity for future research.

The main limitation of the presented model concerns the considered level of analysis. The model deals with average variables, providing managers with prescriptive actions to control the manufacturing system in a higher level of the PPC hierarchy, not in the operational level. The model is not able to dynamically come up with the scheduling of individual jobs, however, it could be extended to contemplate a higher level of detail, by incorporating parameters such as fixed machine utilization rates, machine setup times and blocking times, waiting times between operations etc. Moreover, the application of the proposed methodology to scheduling problems, where the main variables are individual jobs, processing times and due dates, seem to be a challenging opportunity for future work.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the three anonymous referees for their valuable comments and suggestions. The second author would also like to thank CNPq (Brazilian National Council for Scientific and Technological Development) for partially supporting this research (grants 476753/2011-2 and 303000/2010-4).

@&#REFERENCES@&#

