@&#MAIN-TITLE@&#The component interaction network approach for modeling of complex thermal systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A practical approach for thermal modeling of complex systems is presented.


                        
                        
                           
                           The approach is illustrated by a simple example of an electric furnace.


                        
                        
                           
                           The approach is applied to a rapid thermal processing furnace and validated experimentally.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Component interaction network

Thermal modeling

Rapid thermal processing

Heat transfer

Experimental validation

Electric furnace

@&#ABSTRACT@&#


               
               
                  A practical approach for the thermal modeling of complex thermal systems, called the component interaction network (CIN) is presented. Its stages are explained: description of the thermal system as a set of non-overlapping components and their interactions by heat and mass exchanges, modeling of components with different levels of precision using finite volumes and finite elements, modeling of interactions by conduction, convection, radiation and advection, time resolution scheme and simulation. Non-conventional notions of conditional existence of components or time events are introduced. The approach is illustrated with a simple example of an electric furnace. It is then applied to a rapid thermal processing (RTP) furnace and validated experimentally. The advantages of the CIN approach are demonstrated.
               
            

@&#INTRODUCTION@&#

In light of the growing importance of energy issues worldwide, the need for optimizing the design and operation of thermal systems is becoming more and more relevant and necessary. In order to achieve these objectives, emphasis is put on mathematical modeling and computer simulation [1,2]. Small thermal models that provide insight to specific parts of the systems no longer suffice for obtaining any competitive edge in the industry. Thermal models are now thought after in order to solve real problems relating to design, optimization, and real time supervision. In order to solve these problems, industrial systems have to be modeled as a whole. This requires that the thermal models developed take into account the internal phenomena inside the system, interactions with its surroundings, and the control or driving forces acting on it.

The conservation equations of mass, momentum and energy are very general principles that can be applied either in a local sense, leading to partial differential equations with boundary conditions, or in a more global sense leading to integral–differential equations. Since analytical solutions can only be obtained for a very limited number of simple cases, the use of computational numerical methods is necessary for the modeling and simulation of complex thermal systems. The application of such methods can generally be separated in two main stages: the construction of an algebraic and time differential set of equations via a space discretization, and the simulation of the system using a time resolution scheme. The most popular methods used for spatial discretization are the finite difference method (FDM) [3], the finite element method (FEM) [4], and the finite volume method (FVM) [5]. FDM and FEM transform the partial differential equations and boundary conditions into an algebraic and time differential system using mathematical approximations, while FVM consists in directly applying the conservation equations to discrete finite volumes usually considered as lumped elements. All these methods offer too many degrees of freedom and require fine meshing in order to capture the relevant physics of the problem, especially in radiation dominated environments. Doing otherwise would lead to imprecisions, such as false scattering and ray effect for radiation calculation [6]. Even components that are of little interest have to be finely discretized. Consequently, simulating actual systems with these methods generally requires millions of meshes, which in turn leads to matrices having similar dimensions. These methods can be very accurate but are computationally very expensive and therefore not practical for solving design and optimization problems or real time supervision.

Another, less sophisticated class of methods for modeling heat transfer is the lumped component model (LCM) where spatially distinct components or elements are each represented by one finite point in space. Lumped physical properties, extracted from each element, are used as average values for components having constant geometries. The different nodes are connected and can exchange heat (conduction, convection, and radiation) and mass between each other. This type of modeling is very easy to implement but offers only limited information and precision regarding the system. The lumped component model method was popular when computer power was relatively weak compared with today’s super computers or when fast solutions are required [7].

A different approach for performing heat transfer analysis is by using the component interaction network (CIN) presented in this paper. The CIN is a hybrid approach where a system is decomposed into a set of components, generally possessing physical distinctions, each having its own model with different levels of details. Each component is then attributed an intrinsic model that governs heat transfer inside it. The ability of the CIN to efficiently model heat transfer in industrial furnaces or systems has already been demonstrated. Nemer applied the CIN to simulate transient heat transfer in an aluminum brazing furnace [8]. Ferrand integrated mass flow rates obtained from computational fluid dynamics (CFD) into the CIN to model a steel reheating furnace that uses flameless oxidation regenerative burners [9]. Abdo et al. controlled high temperature treatment of steel slabs in a continuous reheating furnace by the CIN [10]. However, never before has the CIN method been explicitly presented and formulated mathematically in any published work. Thereafter, the main objective of this paper is to present a complete description of the CIN approach for modeling of complex thermal systems. This description covers the mathematical, physical, in addition to technical aspects of the method and its resolution scheme. The capabilities of the method are then demonstrated for modeling and simulating of two systems: the heating of cylindrical rods in an electric furnace and the rapid thermal processing of photovoltaic cells.

The CIN is simple to implement, reduces both the amount of memory storage and computational work, and is conservative. In the CIN approach, the analysis model is decomposed into a number of non-overlapping material components linked together with heat and/or mass exchanges and interacting with their surroundings. Inside each component, an internal intrinsic model governs the heat transfer. As explained later, this represents a major advantage of the CIN approach. The internal model designated for a component depends on the degree of precision required for that component and on the phenomena taking place inside it. The internal models can be finite volume or finite element. Thereafter, each component is discretized into a number of control volumes and nodes. At the boundary limits, the components exchange heat by convection, conduction, and radiation. Energy conservation equations are then formulated for the system inter-linking the components. These equations are used, along with the internal models of the components, to construct the matrix system of equations describing heat transfer in the system. In addition to the different components interaction with each other, outside or driving forces can also influence the system.

An advantage of the CIN is that different degrees and types of discretization can be used simultaneously. Furthermore, finite volume models can be used instead of finite element ones when needed, and vice versa. Consequently, the CIN embodies the advantages of the FVM and FEM methods while discarding some of their disadvantages. A fine meshing is employed when accurate temperatures are needed. In contrast, a coarse meshing is used wherever allowed. The simplicity of the lumped element model can be employed wherever possible. A separate meshing is used for the thermal and radiative models which translates into more flexibility. Radiation meshes are then clustered into bundles in order to recreate the discretization used for thermal simulation.

Solving heat transfer problems using the CIN follows a well defined sequential process. First, the system under consideration is described as a set of non-overlapping material components and their interactions, consisted of heat and mass exchanges. The components may also interact with external driving forces. In a second stage, a mathematical model is constructed. An internal model is chosen for each component and the corresponding space discretization technique is applied: 3D, 2D or 1D with FVM or FEM. Lumped components are simply represented with one unknown temperature. The heat and mass exchanges are then taken into account and the final result of the modeling process is a first order algebrodifferential system of equations including the time derivative of the temperature at each space discretization node and each lumped component. The third and last stage is the simulation of the system: events happening in the system and output variables are defined, and laws of variations are described for the driving forces. The latter may depend on the state of the system in the case of closed loop control. The simulation is carried out for a well defined duration after choosing an adequate time marching scheme. In the following, each one of these stages is developed and explained in details.

As already stated the CIN is composed of a number of components. Each one has a set of conditions and properties that require definition in order for the component to be fully integrated into the CIN.

In a real complex system, objects or components may appear and/or disappear according to some conditions. To take this fact into consideration in the dynamic modeling, an existence condition is associated to each component. The latter exists in the system only if the condition is fulfilled. An existence condition is always defined together with an initializing procedure such to give any component an initial field of temperature when starting its life in the system. For example, an object may be entered in a furnace at a given temperature, when the furnace is considered as preheated, and then taken out of it after undergoing some specific heat treatment.

Each component has a specific geometry and shape that has to be known for space discretization and moreover for radiation calculation.

The thermophysical properties of a component (density, specific heat and conductivity) are defined as a function of space and temperature.

The phenomena that can take place in a component are heat conduction, internal mass flow (advection) and heat generation.

A component in the CIN is attributed a model that defines heat transfer inside it. The model can be finite volume or finite element, zero- (lumped component), one-, two-, or three-dimensional. Thereafter, each component is discretized in space according to its model type. The number, allocation and dimensions of the discretization of each component depend on the influence of the component on overall heat transfer and on required precision.

Interactions may take place between the interfaces of two components or between an interface and an external driving force. They can be of two main types.

They are described with heat exchange coefficients that may be local or global following the context. For example, radiation heat exchanges between two finite isothermal surfaces are described with one global transfer factor, while convective heat exchanges between two flowing fluids (heat exchanger) are described with a local heat exchange coefficient that can be a function of the space variable.

In the thermal modeling of a system, the flow field is supposed to be known. Actually, in many systems fluids flow in ducts with mass flow rates that can be either imposed or controlled. In other systems, the flow field can be the result of a CFD calculation or a less sophisticated zonal model, like those used in the thermal modeling of buildings [11,12]. In the case of natural convection, iterations have to take place between the thermal simulation and the zonal model, as applied by Roy et al. [13]. In all cases, in the context of a CIN, the mass flow rate is given between any pair of zones, each being a component of the system or an external medium.

A driving force is an entity that can vary in space and time and that is not part, mathematically speaking, of the system unknowns. Thus, it can correspond to an internal phenomenon such as heat generation or to an external quantity such as an ambient temperature or an imposed heat flux. In the description of a CIN, it has only to be defined and given a default value for initial guess purposes whenever needed.

A schematic representation of a CIN is presented in Fig. 1
                           .

Taking into account the heat transfer phenomenological laws and the energy conservation principle, and applying a space discretization technique to a component yield a mathematical model that describes the internal interactions in the component and the action of driving forces on it. The matrix form of the model is:
                              
                                 (1)
                                 
                                    AT
                                    +
                                    f
                                    =
                                    C
                                    
                                       
                                          T
                                       
                                       
                                          ̇
                                       
                                    
                                 
                              
                           with T the column vector of unknown node temperatures, A the square matrix of linearized heat exchange coefficients, f the column vector of heat gain rates that may depend on component temperatures and boundary conditions, and C the temperature dependent square matrix of heat capacitance. The model obtained for each component has the same form whatever the applied modeling technique is. Thus, when assembling the models of all the components and their interactions, the global model will have the same form as Eq. (1).

As already stated, each component has an internal model that can be 0-D (lumped), 1-D, 2-D or 3-D, finite volume or finite element having different degrees of precision. These are well known methods and the following paragraphs give only examples of constructing the internal model of a component for some special cases.

The case considered here is that of a component where the temperature is variable in one dimension x, between abscissa values x
                              1 and x
                              2. At each value of x, the cross section of the component is S(x) and its perimeter is P(x). There exists an internal flow characterized by a velocity v, a heat generation rate of volumetric density g, and a lateral heat exchange with an external ambient at temperature T
                              
                                 e
                               characterized by heat exchange coefficient h. The continuous thermal model equation is then:
                                 
                                    (2)
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          
                                             
                                                kS
                                                
                                                   
                                                      ∂
                                                      T
                                                   
                                                   
                                                      ∂
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       ρ
                                       cvS
                                       
                                          
                                             ∂
                                             T
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       -
                                       hP
                                       (
                                       T
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             e
                                          
                                       
                                       )
                                       +
                                       gS
                                       =
                                       ρ
                                       cS
                                       
                                          
                                             ∂
                                             T
                                          
                                          
                                             ∂
                                             t
                                          
                                       
                                    
                                 
                              where k is the conductivity, ρ the density and c the specific heat of the component. After applying the finite elements method, the terms of matrices A and C, and vector f will be:
                                 
                                    (3)
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       -
                                       
                                          ∫
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                kS
                                                
                                                   
                                                      
                                                         
                                                            dN
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      dx
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            dN
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      dx
                                                   
                                                
                                                +
                                                ρ
                                                
                                                   
                                                      cvSN
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            dN
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      dx
                                                   
                                                
                                                +
                                                
                                                   
                                                      hPN
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       dx
                                    
                                 
                              
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          ∫
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ρ
                                       
                                          
                                             ScN
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             j
                                          
                                       
                                       dx
                                    
                                 
                              
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          ∫
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                gS
                                                +
                                                
                                                   
                                                      hPT
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       dx
                                    
                                 
                              
                           


                              N
                              
                                 i
                               and N
                              
                                 j
                               are the polynomial interpolation functions that can be linear or of higher order. The actual mathematical formulations leading to Eqs. (3)–(5) can be found in [4]. The integrals in the equations are evaluated numerically by Gaussian quadratures.

The FVM consists in applying the energy conservation directly on finite volumes obtained after the discretization of the component. The case of two adjacent volumes V
                              
                                 i
                               and V
                              
                                 j
                               is considered here (Fig. 2
                              ). The distance separating the nodes representing the two volumes is L
                              
                                 ij
                              . The contact section between the two volumes is S
                              
                                 ij
                              . A mass flow rate of 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          ij
                                       
                                    
                                 
                               circulates from j to i. In these conditions, the conduction heat flux gained by i from j is:
                                 
                                    (6)
                                    
                                       
                                          
                                             q
                                          
                                          
                                             c
                                             ,
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              The correspondent contributions to the ith line of matrix A are then (k
                              
                                 ij
                              
                              S
                              
                                 ij
                              /L
                              
                                 ij
                              ) for A
                              
                                 ij
                               and (−k
                              
                                 ij
                              
                              S
                              
                                 ij
                              /L
                              
                                 ij
                              ) for A
                              
                                 ii
                              .

The mass flow from j to i transports a heat flow rate 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                 
                              , where h
                              
                                 j
                               is the specific enthalpy of volume j. Due to the mass conservation requirement, an equivalent mass flow rate 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          ij
                                       
                                    
                                 
                               has to go out of volume i, either to another volume or outside the system. This outgoing mass flow corresponds to an outgoing heat flow rate 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                 
                              . Thus, the net contribution of the mass flow from j to i to the energy balance of volume i is:
                                 
                                    (7)
                                    
                                       
                                          
                                             q
                                          
                                          
                                             a
                                             ,
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          ∫
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       cdT
                                    
                                 
                              
                           

Eq. (7) is reformulated using the normalized temperature θ
                              =(T
                              −
                              T
                              
                                 i
                              )/(T
                              
                                 j
                              
                              −
                              T
                              
                                 i
                              ), which yields an expression including the temperatures of the volumes and an integral that can be easily evaluated with a Gaussian quadrature:
                                 
                                    (8)
                                    
                                       
                                          
                                             q
                                          
                                          
                                             a
                                             ,
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       cd
                                       θ
                                    
                                 
                              
                           

The contributions to the ith line of matrix A are then 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             cd
                                             θ
                                          
                                       
                                    
                                 
                               for A
                              
                                 ij
                               and 
                                 
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             cd
                                             θ
                                          
                                       
                                    
                                 
                               for A
                              
                                 ii
                              .

The energy consevation in volume i is written in a generic way as:
                                 
                                    (9)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   dT
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             dt
                                          
                                       
                                    
                                 
                              
                           

Thus, matrix C is diagonal with C
                              
                                 ii
                              
                              =
                              m
                              
                                 i
                              
                              c
                              
                                 i
                              . As for the term f
                              
                                 i
                              , it can be, for example, due to an internal heat generation characterized by its volumetric density g
                              
                                 i
                              , which yields f
                              
                                 i
                              
                              =
                              g
                              
                                 i
                              
                              V
                              
                                 i
                              .

The lumped component model may be considered as a special case of the FVM. The internal model is represented by C
                              =
                              mc and eventually f
                              =
                              gV. As for the unique term of matrix A, it can only be calculated from the heat and mass exchanges with other components.

For a given component, interactions may take place with other components or with the exterior of the system, mainly across its boundaries. Thus, interactions can be treated as boundary conditions in the FEM or FVM.

They can take place by convection, radiation and conduction, and are all represented with linearized heat exchange coefficients G
                              
                                 ik
                               such that the heat flow from a zone of temperature T
                              
                                 k
                               to another one of temperature T
                              
                                 i
                               can be written as:
                                 
                                    (10)
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ik
                                          
                                       
                                       =
                                       
                                          
                                             G
                                          
                                          
                                             ik
                                          
                                       
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              For a node i of a boundary finite volume, a heat exchange with a zone of temperature T
                              
                                 k
                               will be accounted for in its energy balance and will contribute to the term A
                              
                                 ii
                               with (−G
                              
                                 ik
                              ). If the zone k is an external ambient, then the heat exchange will contribute to f
                              
                                 i
                               with (G
                              
                                 ik
                              
                              T
                              
                                 k
                              ). Otherwise, if k represents a finite volume in another component, then the heat exchange will contribute to A
                              
                                 ik
                               with G
                              
                                 ik
                              . In the same way, G
                              
                                 ik
                               should be added to A
                              
                                 ki
                               and (−G
                              
                                 ik
                              ) to A
                              
                                 kk
                              , due to the facts that: in the energy balance of volume k the contribution of volume i will be q
                              
                                 ki
                              
                              =
                              G
                              
                                 ki
                              (T
                              
                                 i
                              
                              −
                              T
                              
                                 k
                              ), and G
                              
                                 ki
                              
                              =
                              G
                              
                                 ik
                               for evident reciprocity reasons.

Convection is represented with heat exchange coefficients that can be local or global as mentioned earlier in this paper. In all cases, G
                              
                                 ik
                              
                              =
                              h
                              
                                 ik
                              
                              S
                              
                                 ik
                              , where h
                              
                                 ik
                               is the convection heat exchange coefficient and S
                              
                                 ik
                               the heat exchange area. As for the convective heat exchange coefficient, it can be obtained by semi-empirical correlations or in some cases through computational fluid dynamics (CFD) calculations.

On another hand, radiation heat exchanges are represented with transfer factors 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ik
                                       
                                    
                                 
                               such that the net heat flow gained by i from k is:
                                 
                                    (11)
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ik
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ik
                                          
                                       
                                       σ
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                          
                                             4
                                          
                                       
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                 
                              where S
                              
                                 i
                               is the radiating area of i and σ the constant of Stefan–Boltzmann. Then:
                                 
                                    (12)
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ij
                                             ,
                                             rad
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ik
                                          
                                       
                                       σ
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

If spectral variation in radiative properties is to be included, a gray-band model can be integrated into the CIN. Reasonable accuracies with minimal additional computational requirements can be achieved with this model. The spectrum is decomposed into a number of sub-domains or bands b where the radiative properties are considered gray within each band. Radiation transfer factors, which determine heat transfer between the two elements, are calculated for each band separately. Radiative heat flux is computed separately for each band and then combined. For this case one radiation conductance between a pair of zones should be defined for each band b as:
                                 
                                    (13)
                                    
                                       
                                          
                                             G
                                          
                                          
                                             ik
                                             ,
                                             b
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             ik
                                             ,
                                             b
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   b
                                                   ,
                                                   i
                                                
                                             
                                             σ
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                                
                                                   4
                                                
                                             
                                             -
                                             
                                                
                                                   w
                                                
                                                
                                                   b
                                                   ,
                                                   k
                                                
                                             
                                             σ
                                             
                                                
                                                   T
                                                
                                                
                                                   k
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   T
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ik
                                          ,
                                          b
                                       
                                    
                                 
                               is the transfer factor between i and k for band b and w
                              
                                 b,i
                               the blackbody fraction of emission for element i and band b at temperature T
                              
                                 i
                              , that can be calculated from the blackbody function f(λT) [14] as:
                                 
                                    (14)
                                    
                                       
                                          
                                             w
                                          
                                          
                                             b
                                             ,
                                             i
                                          
                                       
                                       =
                                       f
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             b
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       f
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             b
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              where λ
                              
                                 b,1 and λ
                              
                                 b,2 are the upper and lower limits of band b respectively.

Calculating transfer factors is a delicate and very time consuming operation. In the present approach, a zonal method based on the flux planes approximation [15] for the calculation of geometric viewfactors, and the re-plating algorithm [16,17] for the calculation of final transfer factors are used. The precision and efficiency of the method have been demonstrated in comparison with the FVM [15] and with benchmark values formulated by Yuen and Takara [18]. For precision purposes, a higher precision mesh is used for these calculations. Then the detailed results are aggregated in a way to fit the CIN model. Actually, in the latter, the physical boundary of a component may be considered as one isothermal surface, while in the radiation modeling it may have been discretized into many smaller surfaces, due to its dimensions and form. In such cases, the aggregation of radiation exchange factors can be simply done by addition operations, since the products 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ik
                                       
                                    
                                 
                               as well as 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ik
                                          ,
                                          b
                                       
                                    
                                 
                               are summable [14]. Finally, it should be noticed from Eqs. (12) and (13) that radiation exchange factors are always temperature dependent. Thus, in the description of the global CIN model, 
                                 
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          ik
                                       
                                    
                                    )
                                 
                              -like factors are calculated and aggregated separately, then the exchange factors G
                              
                                 ik
                               are transferred to the thermal model as functions of temperature and not as constants.

Last, conduction exchanges may take place at a contact between two components. They are taken into account either implicitly by the presence of common nodes at the interface or by the use of exchange factors formulated as a function of contact resistances.

A mass flow from a zone k to a node i is modeled in the same way as described by Eq. (8). Thus, in all cases 
                                 
                                    
                                       
                                          
                                             -
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ik
                                                
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             cd
                                             θ
                                          
                                       
                                    
                                 
                               should be added to A
                              
                                 ii
                              . If k is an external zone, 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ik
                                                
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             cd
                                             θ
                                             
                                             
                                                
                                                   T
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                               will be added to f
                              
                                 i
                              . Otherwise, if k is part of the system, 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   ik
                                                
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             cd
                                             θ
                                          
                                       
                                    
                                 
                               will be added to A
                              
                                 ik
                              . But attention should be drawn to the fact that the flow from k to i does not affect the term A
                              
                                 ki
                              , since the method applied here for the modeling of advection uses an upwind scheme. Therefore, when advection is present, the heat exchange matrix A is no longer symmetric.

Once a complex thermal system is modeled, dynamic simulations can be performed for different cases. Each simulation case has to be described according to the purpose of the simulation.

For each simulation, quantities that need to be observed can be defined. They range from a simple node temperature to much more sophisticated formulas expressing various output variables.

An event is defined by a condition that determines whether it is true or false and is associated to a counter for the number of occurrences and a time value for its last occurrence. Unlike a plain logical variable, if an event becomes false after being true, the system keeps in memory that it has happened. This is useful in many industrial applications. For example, if a body is to be entered to a furnace after the latter is pre-heated, a simple logical condition of type T
                              
                                 furn
                              
                              ⩾
                              T
                              0 may swing between true and false, since the introduction of a cold load in the furnace may lower its temperature. If an event is used instead, once it has happened the load is entered in the furnace and stays in it. On another hand, the time of the last occurrence of a given event can be used as a new time reference if needed. For example, in the thermal modeling of a refrigerator, the cooling power can be a given known function that depends on the time since the last starting of the compressor, i.e. P(t
                              −
                              t
                              
                                 start
                              ). In this case, the starting of the compressor can be defined as an event depending on the air temperature in the refrigerator, and t
                              
                                 start
                               will always be known, even though unpredictable at the beginning of the simulation.

When a CIN is described, the driving forces are defined by their names and types only. In each simulation, their laws of variation in time have to be given precisely. Such a law of variation can be completely defined and predictable at any moment since the beginning of the simulation. But it can also depend on the state of the system in various ways when closed loop controls are used. For example, in a steel reheating furnace using gas burners, the gas and air flows are varied according to specific requirements such as the control of thermal gradients in steel slabs.

Time steps are defined for the whole duration of the simulation. They can be fixed or variable. The variation of time steps can be pre-determined, but it is much more useful to make them depend on the state of the system. For example, in the thermal modeling of the melting of a metal that is being heated, the time step needs to be smaller during phase change, for convergence purposes. Thus, the value given to the time step can depend on the absolute value of the temperature difference between the metallic body and its melting temperature.

In order to perform dynamic simulations, Eq. (1) must be discretized and solved in time. Throughout this work, a first order finite difference and simple step implicit time integration schemes are used. The implicit time scheme has the advantage of being always stable, while the first order differential scheme offers reasonable accuracy for applications lacking sharp temporal-temperature-gradients without much added complexity. Applying both schemes for Eq. (1) yields:
                              
                                 (15)
                                 
                                    
                                       
                                          MT
                                       
                                       
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    y
                                 
                              
                           with
                              
                                 (16)
                                 
                                    M
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          A
                                       
                                       
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                           and
                              
                                 (17)
                                 
                                    y
                                    =
                                    
                                       
                                          f
                                       
                                       
                                          (
                                          n
                                          +
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          T
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                 
                              
                           
                        

The time marching scheme applied for the simulation uses successive iterations at each time step, according to the following algorithm.
                              
                                 
                                    Step 1. Evaluate the existence of the components and the state of the events, using the state of the system at the preceding time step at t
                                    
                                       n
                                    .


                                    Step 2. Calculate initial starting temperatures 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                iter
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                     using a polynomial quadratic predictor [19].


                                    Step 3. Construct matrices A
                                    (n+1) and C
                                    (n+1), and vector f
                                    (n+1), for the current values of temperatures 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                iter
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    .


                                    Step 4. Construct matrix M and vector y using Eqs. (16) and (17).


                                    Step 5. Solve Eq. (15) using the Conjugate Gradient (CG) [20] with Incomplete Cholesky (IC) preconditioner if M is symmetrical, or Conjugate Gradient Squared (CGS) with Incomplete Lower–Upper (ILU) preconditioner otherwise [21]. The solution is 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                new
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    .


                                    Step 6. Compute a norm of the difference between the new calculated temperatures and the preceding ones. If 
                                       
                                          |
                                          |
                                          
                                             
                                                T
                                             
                                             
                                                new
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                iter
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                          |
                                          |
                                          >
                                          ε
                                       
                                    , with ε a given tolerance, replace the previous temperatures 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                iter
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                     with the new ones 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                new
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                     and go back to step 3. Otherwise, convergence is attained for the time step and the solution is 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                T
                                             
                                             
                                                new
                                             
                                             
                                                (
                                                n
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    .

At the first time step, steps 1 and 2 use the known initial component temperatures. It should be noted that successive iterations may be necessary for two different reasons. First, matrices A and C may be temperature dependent because of the temperature dependence of the thermophysical properties of the components, or that of heat transfer coefficients, especially in the presence of radiation or natural convection. Second, the driving forces may depend on the state of the system at time t
                           
                              n+1, because of either temperature dependent actions, such as a temperature dependent internal power generation, or automatic real time control, such as proportional-integral-derivative (PID) controllers.

The CIN is coded into a commercial software called Thermette [22]. Thermette implements the simulation approach described in this paper to model complex thermal systems constituted of 1D or 0D (lumped) components. For 1D components, the cross section and the perimeter can be defined as arbitrary functions of abscissa. Heat exchanges and mass flows can also be defined among components. The internal models can be finite volumes or finite elements (Lagrange or Hermite type). For the definition of any quantity, formulas including pre-defined functions can be used. The library of pre-defined functions contains various mathematical functions, relation functions, tables read on files, control functions (differential relays, time integral, and time derivative), properties of solids and fluids, forced and natural convection correlations, blackbody function, etc. A formula can also contain references to the system parameters (time, time step, and abscissa) the system state (temperatures, heat flows, etc.), or to existing driving forces, output variables and events. These features allow Thermette to be useful in the modeling and simulation of a variety of complex thermal systems, like building envelopes, heating and cooling equipment, solar systems, industrial furnaces, etc. It should be noted that 2D and 3D finite volumes models can be constructed using 0D components as control volumes.

A simple example is presented in this section in order to illustrate the main features of the CIN approach: definition of different levels of precision in space discretization, application of finite elements, finite volumes and lumped components methods, modeling of radiation with a 3D mesh for all components, definition of events and use of existence conditions. The efficiency of the approach for the practical study of this type of thermal systems has been verified by Nemer [8].


                           Fig. 3
                            shows a view of the inside of an electric furnace that is composed of 6 walls made of kerlane and 22 heating elements made of inconel and placed vertically. The dimensions of each wall are 40×40×15cm3. The heating elements are cylindrical resistors each having a 4mm radius and a 35cm height. Starting from a uniform initial temperature of 300K, a 200W power is generated in each emitter. When the temperature of the front wall reaches 1000K, four identical steel cylinders, each having a 4cm radius and 20cm height, are introduced into the furnace. The power generated in the heaters is controlled with an on/off relay such to maintain the temperature of the front wall between 980K and 1020K. The total duration of the operation is 2h.

Each emitter is considered as a lumped component with uniform temperature. The walls are modeled as 1D components in the direction of their thickness (inside-outside). They are meshed with 5 Hermite type finite elements each. The four identical cylinders have different models and discretizations as follows:
                              
                                 Cylinder 1 is represented with a 3D finite volumes model. It is discretized in the directions of the radius (four elements), the circumference (eight elements) and the height (five elements).

Cylinder 2 is represented with a 1D finite elements model in the radius direction, where 8 Hermite type elements are used.

Cylinder 3 is modeled in 2D with finite volumes. The temperature varies according to the radius and the height which are divided into four and five elements repectively.

Cylinder 4 uses a hybrid 1.5D model: four 1D cubic Lagrange type elements for the radius direction at three different levels of height, while conduction in the axial direction is simply modeled with exchange coefficients.

As for the interactions, they are mainly consisted of radiation exchanges among components inside the furnace and of convection and radiation exchanges between the external faces of the walls and their surrounding. The overall external exchange coefficient is taken equal to 10W/m2K. Convection inside the furnace is negligible compared to radiation, especially that the inner dimensions of the enclosure are rather small. Calculations of two sets of radiation transfer factors inside the furnace are carried out using a 3D mesh for all components. The first set is calculated for an empty furnace, it includes a total number of 1284 facets (16 for each wall and 54 for each emitter) that reduce to 28 surfaces after aggregation. The second set of transfer factors is calculated for the whole model with cylinders, as shown in Fig. 3. A total number of 1588 facets is used: 16 for each wall, 54 for each emitter, 104, 72, 64 and 64 for cylinders 1, 2, 3 and 4 respectively. For the thermal model, the 1588 facets are grouped into 124 surfaces. The total calculation time for the radiation models is 13s on a computer with i7 CPU at 2.67GHz and 8Gb RAM.

The thermophysical and radiative properties of materials are given in Table 1
                           .

An event corresponding to the end of the preheating phase of the furnace is defined. It is considered true when the temperature of the front wall is greater or equal to 1000K. The existence condition of the four cylinders is related to the first occurrence of the end of preheating event. The heat radiation exchanges are also related to this event. Thus, since the initial temperature of all components is 300K, the event is initially false and the simulation starts with the set of radiation exchanges corresponding to the empty furnace. When the temperature of the front wall reaches 1000K for the first time, the event becomes true and the model switches automatically to the charged furnace configuration, i.e. the presence of the cylinders with an initial temperature of 300K and the corresponding set of heat radiation exchanges. The maximum number of variables is 322 and the simulation is carried out with a time step of 30s. The calculation time is 5.7s on the aforementioned computer. The evolution of temperatures representing the heating resistances, the cylinders and the walls are presented in Fig. 4
                           .

When the cylinders enter the furnace, their temperature starts to increase while those of the resistances and the walls decrease due to the added cold load. The surface temperature of the cylinders reaches an almost permanent value of 1000K, due to the on/off control.

Focusing on the temperature evolution at the surface of each cylinder in Fig. 5
                           a, it is remarkable that the temperatures are close, even though the models are rather different. Despite the differences observed in the transient regime, all the cylinders reach the pre-specified temperature at almost the same time. But definitely when good precision or more details are needed fine discretization must be adopted. For example, a temperature gradient is observed at the top surface of the cylinder 1 in the direction of the circumference angle. Fig. 5b shows the evolution of the temperature difference between two points at different angles. This gradient is due the position of the cylinder facing the door where no emitters are placed. Its observation has been made possible by the 3D finite volumes model.

Dynamic simulation is highly demanded especially when requirements for fabrication are stringent. Nowadays, energy is becoming expensive which encourages the industry to reduce their consumption. Thus the equipment must be optimized. On the other hand, for micro-scale treatment, such as crystallization, accurate heating is crucial. Fast calculation and good prediction of the thermal behavior of the industrial systems are required.

A rapid thermal processing (RTP) furnace used for heat treatment of CIS thin film photovoltaic cells is modeled and presented in this section. RTP has been applied in semi-conductor wafer fabrication for annealing, thermal oxidation and chemical vapor deposition. Recently, RTP found applications in photovoltaic cells manufacturing due mainly to its flexible heating to high temperatures in a very short time. During the fabrication of CIS PV cells, a heat treatment is required to perform the crystallization and sulfurization of the thin film of few micro-meter deposited on a glass substrate, in order to improve its electrical properties. A given temperature profile must be precisely tracked, otherwise unwanted molecules are developed. Uniform heating over the surface has to be respected. In fact, large temperature gradients cause thermal stresses on the wafer, thus energy conversion is degraded.

Logerais and Bouteville [23] model the RTP system by means of CFD calculation to solve conservation equations of heat and mass transfer. Monte Carlo is applied for radiation calculations. The computation time is long. For the sake of less time consuming, Kim and Cho [24] use low-order model of CFD to model the transient state of two-dimensional application where heat exchange is considered as boundary condition on the wafer. Dassau et al. [25] use finite difference method for transient two-dimensional thermal simulation of an RTP system. The CIN approach was used by Mouawad [26] to develop a fast and sufficiently accurate model of RTP for design and optimization purposes. In the present example, a study meant for the experimental verification of the modeling approach in the case of RTP systems is described.

A schematic cross-section of a generic RTP chamber using linear emitters is illustrated in Fig. 6
                        . The reactor is made of high-reflectivity walls in order to redirect the optical energy to the wafer. The enclosure is kept at low temperature by water cooling from its back side. The wafer is placed in the center of the process chamber between two quartz windows. The reaction chamber is confined, in which the ambient atmosphere is controlled during the process. Banks of linear rod lamps provide radiative energy that heats the wafer. Heating emitters are composed from tungsten filaments which are protected from oxidation by quartz tubes. The quartz tubes are cooled continuously during the process by forced convection. In fact, the quartz becomes optically thick for wavelength greater than 5μm which generates temperature raise.

The chamber being modeled is used to treat a square wafer of 15×15cm2 which is held on four quartz pins. In the real process, temperature measurement is inaccurate due to geometry configuration of RTP furnace and the emissivity change of the wafer during the heating cycle [27]. For that purpose, the PV cell is replaced by an equivalent steel layer of similar radiative properties and thermal mass, and having the same surface. The wafer is placed inside a quartz reactor. Typically, 150m3/h of argon flow inside the reactor. Air flows outside the reactor in order to cool the quartz layers, with an average velocity of 2cm/s. The flow is then laminar, the average convection heat exchange coefficient is estimated using the well known correlation for laminar external flow over a flat plate with uniform temperature:
                           
                              (18)
                              
                                 
                                    
                                       Nu
                                    
                                    
                                       L
                                    
                                 
                                 =
                                 0.664
                                 
                                    
                                       Re
                                    
                                    
                                       L
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       Pr
                                    
                                    
                                       1
                                       /
                                       3
                                    
                                 
                              
                           
                        
                     

The coefficient is then approximated by 0.8W/m2
                        K. The chamber is fixed within an aluminum box which has a 90×50cm2 section and a height of 25cm. Two lamp banks are situated above and below the reactor. Each bank consists of 20 parallel emitters having a regular spacing of 25mm and a lighted length of 70cm. The maximum power of each emitter is 3000W.

Conductive, convective and radiative heat transfers are considered in the thermal model. Typical values of the thermophysical properties of all components are shown in Table 2
                        . During simulation, local variations of thermal conductivities and specific heats of the metallic materials are taken into account according to the calculated local temperatures of components.

Each component of the RTP system is represented differently in the analysis model, depending on its type, degree of influence and relevance. Sensitivity analyzes to different numerical parameters, including mesh precision of components, have been carried out [26]. They lead to the description of the CIN discretization of the RTP chamber presented below:

The walls of the RTP chamber are made of polished aluminum. Overall, 6 components are used to describe the furnace walls. A one-dimensional finite element discretization is used for each component, the boundary nodes of the components being situated on the inner and outer surfaces. The walls are cooled at the outer node by convection with cold water.

The PV cell is composed of an equivalent layer of dimensions 150×150×2mm3. The temperature is considered uniform in the thickness dimension and a two-dimensional finite volume discretization is adopted. Overall, 49 control volumes are used for the model.

The furnace atmosphere is represented by a single lumped component. The inert gas inside the quartz box is represented by another lumped component.

An emitter is composed of a tungsten filament, a quartz cylinder surrounding the tungsten, and halogen inside the quartz cylinder. Each element of an emitter is represented by a single lumped component. Uniformity of the filament temperature assumption is justified by Caratini [28].

The quartz box which engulfs and protects the PV cell is represented by 6 components, each with a two-dimensional finite volume discretization. Overall, 50 nodes are used to represent the quartz box.

Finally, the thermal model includes 370 unknown temperatures. The mesh used for radiative modeling includes a total of 2718 surface elements. The index of refraction of quartz is 1.51. The emissivity of the wafer surface is 0.8. Radiative properties of quartz and tungsten depend on wavelength. Table 3
                            shows the values that are used for the emissivity of tungsten, ε
                           
                              t
                            and the coefficient of absorption of quartz, a
                           
                              q
                            in nine adjacent wavelength bands from 0 to 15μm. Each band is defined by its upper bound (left column). The walls are considered diffuse. In fact, polished walls reflect in a specular way. However, with an enclosure where all the boundaries are specular, the heat fluxes on the wafer are practically the same if a diffuse reflection model is used [14].

Calculation of radiation transfer factors takes 80s for each band. Thermal simulations start from a uniform initial temperature equal to 20°C. They are carried out with a time step of 0.1s for a total duration of 5min. Calculation time for each simulation is 190s.

The test wafer is embedded by 4 thermocouples at different positions. Thermocouple 1 is brazed at the center of the layer using a special filler metal. Thermocouples 2, 3, and 4 are similarly positioned 1cm from the border at three different corners of the square wafer. The thermocouples used are of K-type with 0.2mm diameter and an uncertainty of 0.5K. The first comparison between calculated and measured temperatures is performed with all the emitters at 55% of the maximum power for the first 2min and then at 25% for the following 3min. In Fig. 7
                        a, the temperatures calculated and measured are plotted. This demonstrates the ability of the model to predict the temperature inside the RTP chamber with good accuracy. In Fig. 7b, different temperature measurements performed with 65% emitter power for the first two minutes and 55% power for the following 1.5min are compared with others obtained by the model. As well as in the previous case, the measured and calculated temperatures are close.

@&#CONCLUSION@&#

The component interaction network approach (CIN) for the modeling of complex thermal systems has been presented. Its main interest is its ability to model and simulate a whole practical system while taking into account all the important phenomena and the operating conditions, and with reasonable calculation time. This is made possible by the use of local component models having different degrees of details and coupled together correctly by heat exchanges or mass flows. Some of the main stages used in the construction of finite elements or finite volumes models were recalled. Radiation heat exchanges are modeled in 3D, such to have precise transfer factors, and an aggregation procedure makes it possible to project these accurate models on less detailed meshes. In a CIN, the models can be more detailed where needed and just sufficient or even simplified elsewhere, but no component or operating condition is neglected. Quantities like events, and component characteristics like the existence condition facilitate the modeling of dynamic and non-stationary systems. This is illustrated in a simple example of an electric oven used for the heating of steel cylindrical rods. The results clearly demonstrate the capabilities of the approach. The main application studied is the rapid thermal processing of a PV wafer. A complex model is constructed and simulations are compared to experimental measurements. The results show good agreement, which proves that the CIN approach was able to correctly predict the temperatures inside the furnace with a short calculation time.

@&#REFERENCES@&#

