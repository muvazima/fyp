@&#MAIN-TITLE@&#A fast algorithm for identifying minimum size instances of the equivalence classes of the Pallet Loading Problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The paper deals with minimum size instance of the Pallet Loading Problem.


                        
                        
                           
                           A faster Minimum Size Instance (MSI) identification algorithm is presented.


                        
                        
                           
                           A faster minimum size instance enumerating algorithm is presented.


                        
                        
                           
                           The two algorithms improve solution schemes that require MSI identification.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Packing

Pallet Loading Problem

Equivalence class

@&#ABSTRACT@&#


               
               
                  In this paper, a novel and fast algorithm for identifying the Minimum Size Instance (MSI) of the equivalence class of the Pallet Loading Problem (PLP) is presented. The new algorithm is based on the fact that the PLP instances of the same equivalence class have the property that the aspect ratios of their items belong to an open interval of real numbers. This interval characterises the PLP equivalence classes and is referred to as the Equivalence Ratio Interval (ERI) by authors of this paper. The time complexity of the new algorithm is two polynomial orders lower than that of the best known algorithm. The authors of this paper also suggest that the concept of MSI and its identifying algorithm can be used to transform the non-integer PLP into its equivalent integer MSI.
               
            

@&#INTRODUCTION@&#

The pallet loading problem (PLP) arises in manufacturing workshops (and also in other logistics areas), where small items must be placed onto a large pallet (Dowsland, 1987a, 1987b; Morabito & Morales, 1998; Waescher, Haussner, & Schumann, 2006). The PLP is commonly reduced to its two-dimensional version, in which identical small rectangular items (boxes) must be packed onto a large rectangular pallet; items may be rotated 90°, but only orthogonal packing is allowed. The aim is to pack as many items onto the pallet as possible without overlapping any two items. Using the classification of Dyckhoff (1990) and Waescher et al. (2006), the problem belongs to class 2/B/O/C and IIPP, respectively. This type of PLP problem is also known as the Manufacturer’s Pallet Loading Problem (MPLP) (Ribeiro & Lorena, 2007).

The practical significance of the PLP has been expressed by many authors (Alvarez-Valdes, Parreno, & Tamarit, 2005; Birgin, Lobato, & Morabito, 2010; Dowsland, 1987a; Dyckhoff, 1990; Martins & Dell, 2008; Nelissen, 1993; Ram, 1992; Young-Gun & Maing-Kyu, 2001) in the course of solving the PLP. In these publications, the authors state or imply that the only constraint is the stability and safety of the boxes and thus use orthogonal placement (e.g., Dowsland, 1987a; Martins & Dell, 2008; Nelissen, 1993; Young-Gun & Maing-Kyu, 2001). There are also a small number of authors who consider additional constraints, such as clampability (e.g., Carpenter & Dowsland, 1985). Recently, Kocjan and Holmström (2010) deals with specific loads of PLP, and Bortfeldt and Wäscher (2013) reviews special constraints on general container loading. The PLP also occurs in a number of cutting stock and floor design scenarios (Martins & Dell, 2008).

The PLP is difficult to solve exactly within a short computation time, and sample instances are often used to demonstrate an algorithm’s efficiency (Martins, 2003; Martins & Dell, 2007). Dowsland (1984) first showed that PLP instances can be divided into equivalence classes with the same optimal placement pattern. Such authors as Dowsland (1984, 1987a, 1987b), Scheithauer and Terno (1996), Nelissen (1993), Morabito and Morales (1998), and Pureza and Morabito (2006) used PLP instances of equivalent classes numbering from approximately 10,000 to approximately 50,000. Restrictions on the aspect ratio of the pallet and the items are commonly applied to confine the number of instances investigated. Alvarez-Valdes et al. (2005), Birgin, Morabito, and Nishihara (2005), and Lins, Lins, and Morabito (2003) investigated a common set of approximately 50,000 instances.


                     Martins and Dell (2007) first proposed the idea of identifying a PLP equivalence class by the Minimum Size Instance (MSI). The input of a PLP instance contains four parameters: the length and width of the pallet and the length and width of the boxes. An MSI of an equivalent class is the equivalent instance that has all four parameters minimised. Martins and Dell (2007) proved that the existence and uniqueness of an MSI for a PLP equivalence class is guaranteed. These researchers also found the parameter bounds of the MSI when the PLP’s area ratio (the ratio of pallet area to item area) is bounded. Thus, an enumerating procedure can be designed to generate all equivalence classes of a PLP subject to a given area ratio bound.

According to Martins and Dell (2007), the motivation for determining the MSI is to identify equivalent classes by unique instances and to provide a systematic way of exhaustively enumerating PLP equivalent classes subject to a given boundary (such as the area ratio bound). It should be noted that Dowsland (1984) also demonstrates a method for enumerating PLP equivalent classes subject to given bounding conditions, and Dowsland (1987a) also mentions minimising the smaller dimension of the box such that the solution space is smaller and easier to solve. However, Martin and Dell’s work clarifies the concept of MSI and provides a systematic way to use it.

Exhaustively enumerating PLP equivalence classes also provides an exact solution scheme that reuses MSI solutions. Because most PLP equivalent classes are easily solvable, the hard classes may be tackled at the cost of a long run time or expensive hardware. However, once the classes are solved, the solutions, represented by the solutions of MSIs, can be stored in a database for future reference. Both Dowsland (1987b) and Martins and Dell (2008) suggest using this scheme for completely solving the PLP subject to a given area ratio bound.

The MSI enumeration algorithms presented by Martins and Dell (2007) are of a high-order polynomial. Enumerating all MSIs of area ratio N
                     <101 requires the maximum bearable computing load on a 600-Megahertz computer (with a 2.8-Gigahertz computer, N
                     <151 is bearable).

The input sizes of sample instances for demonstrating PLP algorithms continue to grow over time. The Cover I dataset has an area ratio of N
                     <51 and was used by the earliest authors (Dowsland, 1984, 1987a). Later, a dataset with N
                     <101 (the Cover II dataset) was used by most authors until 2010. In 2010, Birgin et al. (2010) used a Cover III dataset with N
                     <151. To the best of the author’s knowledge, N
                     <151 is currently the largest input size being used in PLP datasets.

Although the Cover I, II, and III datasets are valuable for developing algorithms, they are far from representing the requirements of real applications. For example, the practical wood pulp stowage problem (Birgin et al., 2010) involves area ratios ranging from 147 to 341. The area ratio of the PLP in container loading may reach values in the several thousands (Young-Gun & Maing-Kyu, 2001).

The L-shaped heuristic is a notably effective PLP algorithm and is estimated to be exact (Birgin et al., 2005; Lins et al., 2003). This algorithm has been tested by Cover I (N
                     <51), Cover II (N
                     <101), and Cover III (N
                     <151) but has not been systemically tested by equivalent classes with N
                     ⩾151.

In this paper, the authors introduce a new way for identifying the MSI. The new MSI-identifying algorithm’s computing complexity is two polynomial orders lower than that of the algorithm of Martins and Dell (2007). With a 2.8-Gigahertz computer, the new algorithm enumerates all of the equivalence classes with an area ratio N
                     <101 in approximately two minutes. All equivalence classes with an area ratio N
                     <201 and N
                     <301 are enumerated. Additionally, the new algorithm is based on an item aspect ratio interval (equivalence ratio interval), which provides a new perspective on the nature of equivalence classes and the MSI. The authors of this paper also note that the concept of MSI and its identifying algorithm can be used to transform a non-integer PLP into its equivalent integer MSI. The new algorithm is simple to implement. When programmed in C++, the total code length of the equivalence class enumerating algorithm is only 127 lines.

The following are suggested applications of the algorithm described in this paper:
                        
                           1.
                           As a subroutine of the exact solution scheme that reuses MSI solutions (proposed by Martins & Dell, 2008; Dowsland, 1987b), the MSI-identifying algorithm discussed herein, which has O(N
                              2) complexity, can be used to substitute the corresponding Martins and Dell (2008) MSI-identifying algorithm, which has O(N
                              4) complexity.

The N
                              <201 and the N
                              <301 equivalent class datasets can be used for algorithm testing or demonstration and can also be used to expand the capacity of the exact solution scheme that reuses MSI solutions.

The 127 C++ code lines, which are much easier to distribute and execute much more rapidly, can be used to substitute for the previous N
                              <151 datasets, which are difficult to describe in publication materials or share online. Of course, the code can also serve as the source of the N
                              <201 and N
                              <301 datasets.

For a dataset that has N
                              ⩾301, because the number of instances will grow to be excessively large, the authors suggest using the 127 C++ code lines plus additional constraints and/or selection mechanisms, such as the uniform random selection, to generate sample instances for the purpose of algorithm testing and demonstration.

The MSI identification algorithm can be employed to convert non-integer PLP instances from real applications to their equivalent integer MSIs without losing any precision such that they can be solved using up-to-date algorithms that involve integer assumptions.

As pointed out by Dowsland (1985, 1987a), the MSI reduces the problem to one with fewer potential placement positions, and usually strengthens bounds such as that due to Barnes, thus improving the efficiency of many exact approaches to the problem. This can be done only when we have a high efficiency MSI-identifying algorithm, especially when the area ratio of the problem is large. Thus the O(N
                              2) MSI-identifying algorithm presented in this paper is better than the previous O(N
                              4) algorithm for this purpose.

Presently, the O(N
                     4) algorithm by Martins and Dell (2008) is the only well described MSI-identifying algorithm. In Dowsland (1987a), it is stated that using an idea similar to the aspect ratio interval to minimise the smaller dimension of the box could reduce the search space. However, the detailed procedure is not described. In this paper we will present the O(N
                     2) MSI-identifying algorithm with theoretic details, the computational analysis, and the code realisation along with a numerical test.

The rest of this paper will be organised as follows. In Sections 2.1 and 2.2, basic notation, assumptions, and commonly known properties of the PLP are presented or reviewed. In Section 2.3, the general scheme of the new method is concisely introduced. Details of the new method are introduced in Sections 3–5. Section 6 addresses the implementation issue, where an integer realisation is proposed to avoid the precision issue associated with float computing. Section 7 provides numerical results, and Section 8 concludes the paper.

In this paper, a PLP instance is represented by (X,
                        Y,
                        a,
                        b). X and Y are the pallet’s width and height; a and b are the item’s width and height; X
                        ⩾
                        Y
                        ⩾
                        a
                        ⩾
                        b is assumed. It is also assumed that X, Y, a, b are integers, except when explicitly mentioned otherwise.

It is sometimes convenient to focus only on one pallet dimension. For example, it is sometimes convenient to consider only the relationship between X and (a,
                        b). In this case, the notation (X,
                        a,
                        b) will be used. Similarly, the notation (Y,
                        a,
                        b) may also be used. (S,
                        a,
                        b) will be used for the general case, where S could be either X or Y.

The area ratio of a PLP instance is denoted by N, and N
                        =⌊(XY)/(ab)⌋.

For a pallet dimension S, the set of efficient partitions of S, denoted by E(S,
                        a,
                        b), is defined to be the set of all feasible partitions (n,
                        m) satisfying
                           
                              (1)
                              
                                 n
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 ⌊
                                 S
                                 /
                                 a
                                 ⌋
                                 }
                                 
                                 and
                                 
                                 m
                                 =
                                 ⌊
                                 (
                                 S
                                 -
                                 n
                                 ·
                                 a
                                 )
                                 /
                                 b
                                 ⌋
                                 .
                              
                           
                        
                     

If there are numbers n and m, satisfying
                           
                              
                                 n
                                 ·
                                 a
                                 +
                                 m
                                 ·
                                 b
                                 =
                                 S
                                 ,
                              
                           
                        then (n,
                        m) is called a perfect partition of S.


                        Dowsland (1984) shows that if two instances of the PLP possess the same set of efficient partitions for the pallet width and length, then both instances share the same set of optimal solutions. The class of PLP instances that possess the same efficient partitions for both the pallet width and length are called the equivalent class. Nelissen (1993) shows that two PLP instances (X,
                        Y,
                        a,
                        b) and (X′,
                        Y′,
                        a′,
                        b′) are equivalent if and only if
                           
                              (2)
                              
                                 n
                                 ·
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 m
                                 ·
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 ∀
                                 (
                                 n
                                 ,
                                 m
                                 )
                                 ∈
                                 E
                                 (
                                 X
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 n
                                 ·
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 m
                                 ·
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 >
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 ∀
                                 (
                                 n
                                 ,
                                 m
                                 )
                                 ∈
                                 E
                                 (
                                 X
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 ⌊
                                 X
                                 /
                                 a
                                 ⌋
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       ′
                                    
                                 
                                 >
                                 
                                    
                                       X
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        with a similar set for Y, Y′, and E(Y,
                        a,
                        b).

If (
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) is equivalent to (X,
                        Y,
                        a,
                        b) and for any (X′,
                        Y′,
                        a′,
                        b′) that is equivalent to (X,
                        Y,
                        a,
                        b), then we have 
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    Y
                                 
                                 
                                    ′
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    a
                                 
                                 
                                    ′
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                           
                        , and we say that (
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) is the MSI of (X,
                        Y,
                        a,
                        b). Because a PLP equivalence class is a collection of mutually equivalent PLP instances, all instances that belong to the same equivalence class have the same MSI. The MSI of an equivalence class equals the MSI of any of its member instances.

Considering only one pallet dimension, if two instances (S,
                        a,
                        b) and (S′,
                        a′,
                        b′) possess the same set of efficient partitions, then we state that (S,
                        a,
                        b) and (S′,
                        a′,
                        b′) are equivalent. If (
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) is equivalent to (S,
                        a,
                        b), and 
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                         are the smallest possible values, then we say (
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) is the MSI of (S,
                        a,
                        b).

The pallet size of (X,
                        Y,
                        a,
                        b) may be reduced. Let S be a pallet dimension, which can be X or Y; thus,S can be reduced to S
                        ∗ using the following formula:
                           
                              (5)
                              
                                 
                                    
                                       S
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 {
                                 n
                                 ·
                                 a
                                 +
                                 m
                                 ·
                                 b
                                 :
                                 (
                                 n
                                 ,
                                 m
                                 )
                                 ∈
                                 E
                                 (
                                 S
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 }
                                 .
                              
                           
                        
                     

It is not difficult to verify that (2)–(4) are satisfied if S is reduced to S
                        ∗. This type of reduction is called the perfect partition reduction by Dowsland (1985) and Letchford and Amaral (2001). Let us say that (S,
                        a,
                        b) is perfect-partition-reducible if S
                        ∗
                        <
                        S and that (X,
                        Y,
                        a,
                        b) is perfect-partition-reducible if either (X,
                        a,
                        b) or (Y,
                        a,
                        b) is perfect-partition-reducible.


                        Algorithm 1 is a notably simple pseudo-code for verifying that (S,
                        a,
                        b) is perfect-partition-reducible. The time complexity of Algorithm 1 is linear with respect to ⌊X/a⌋ (this complexity can be improved by a more complex algorithm (see Letchford & Amaral (2001))).
                           Algorithm 1
                           Pseudo-code for determining whether (S,
                              a,
                              b) is perfect-partition-reducible
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: S, a, b
                                             
                                          
                                          
                                             
                                                Output: Answer
                                             
                                          
                                          
                                             1 
                                                Begin
                                             
                                          
                                          
                                             2 
                                                S
                                                ∗
                                                ←max{n
                                                ·
                                                a
                                                +
                                                m
                                                ·
                                                b: (n,
                                                m)∈
                                                E(S,
                                                a,
                                                b)}
                                          
                                          
                                             3 
                                                If 
                                                S
                                                ∗
                                                =
                                                S 
                                                then 
                                                Answer
                                                ′
                                                ←′No′; else 
                                                Answer
                                                ′
                                                ←′Yes′
                                          
                                          
                                             4 
                                                End.
                                          
                                       
                                    
                                 
                              
                           

The general scheme of the method proposed by this paper is as follows:

First, it will be shown that any instance (S,
                        a,
                        b) that belongs to a given equivalence class will have the property that its item size aspect ratio a/b belongs to an open interval (r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ); and, from any item with a size aspect ratio r
                        ∈(r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ), an instance belonging to the same equivalence class can be constructed. If (r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ) is known, then the smaller item size 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                         of the MSI can be identified easily. The procedure is to find the smallest positive integer 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                         such that the interval (br
                        
                           lb
                        ,
                        br
                        
                           ub
                        ) contains a positive integer 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        . Accordingly, (
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) will be the item size of the MSI. The pallet size 
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                         of the MSI can be determined from Eq. (5). The details of this part of the algorithm will be presented in Sections 3 and 4.1 of this paper.

Second, it will be shown that any instance (X,
                        Y,
                        a,
                        b) belonging to an equivalence class will also have the property that its item aspect ratio belongs to an open interval (r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ), which is the intersection of the two aforementioned open intervals determined by (X,
                        a,
                        b) and (Y,
                        a,
                        b), respectively. A similar procedure can be adopted to identify the MSI (
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ). Details of this part of the algorithm will be presented in Section 4.2.

Third, the MSI enumerating procedure is presented. This procedure checks all instances (X,
                        Y,
                        a,
                        b) with an area ratio less than N
                        +1, eliminating all instances that cannot be a MSI by determining whether the MSI is equal to itself. Details of this part of the algorithm will be presented in Section 5.

In this section, we show that there is a strong relationship between an equivalence class and the problem’s item size aspect ratio.
                        Lemma 1
                        
                           Let (S,
                           
                           a,
                           
                           b) be a PLP instance. Thus, there is an open interval (r
                           
                              lb
                           
                           ,
                           
                           r
                           
                              ub
                           
                           ) of real numbers such that for any (S′,
                           
                           a′,
                           
                           b′) that is equivalent to (S,
                           
                           a,
                           
                           b), it is true that a′/b′∈
                           (r
                           
                              lb
                           
                           ,
                           
                           r
                           
                              ub
                           
                           ). In addition, for any positive integers a′ and b′ that satisfy a′/b′∈
                           (r
                           
                              lb
                           
                           ,
                           
                           r
                           
                              ub
                           
                           ), there is an S′ such that (S′,
                           
                           a′,
                           
                           b′) is equivalent to (S,
                           
                           a,
                           
                           b).
                        

Let (S
                           ′,
                           a′,
                           b′) be an equivalent instance of (S,
                           a,
                           b); thus,
                              
                                 (6)
                                 
                                    n
                                    ·
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    m
                                    ·
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ∀
                                    (
                                    n
                                    ,
                                    m
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    n
                                    ·
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    m
                                    ·
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ∀
                                    (
                                    n
                                    ,
                                    m
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    ⌊
                                    S
                                    /
                                    a
                                    ⌋
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                           
                        

We choose to reduce (S
                           ′,
                           a′,
                           b′) to its perfect reduction (S
                           ′∗,
                           a′,
                           b′). For (S
                           ′∗,
                           a′,
                           b′), because of Eq. (5), inequality (6) is automatically followed. Inequalities (7) and (8) can be rewritten as (9) and (10), respectively:
                              
                                 (9)
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    ·
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ·
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                          ∗
                                       
                                    
                                    ⩾
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ·
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    ·
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ∀
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    ⌊
                                    S
                                    /
                                    a
                                    ⌋
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    >
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                          ∗
                                       
                                    
                                    ⩾
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    
                                    ∀
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    .
                                 
                              
                           
                        

Let r
                           =
                           a′/b′. From (9), we have
                              
                                 (11)
                                 
                                    r
                                    >
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    >
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    r
                                    <
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    <
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    .
                                 
                              
                           
                        

From (10), we have
                              
                                 (13)
                                 
                                    r
                                    >
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          ⌊
                                          S
                                          /
                                          a
                                          ⌋
                                          +
                                          1
                                          -
                                          
                                             
                                                n
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    (
                                    
                                       
                                          n
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    .
                                 
                              
                           Let
                              
                                 (14)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          lb
                                       
                                    
                                    =
                                    
                                       max
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      :
                                                      ∀
                                                      (
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      (
                                                      S
                                                      ,
                                                      a
                                                      ,
                                                      b
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            ⌊
                                                            S
                                                            /
                                                            a
                                                            ⌋
                                                            +
                                                            1
                                                            -
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      :
                                                      ∀
                                                      (
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      (
                                                      S
                                                      ,
                                                      a
                                                      ,
                                                      b
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           and let
                              
                                 (15)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ub
                                       
                                    
                                    =
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             :
                                             ∀
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             
                                                
                                                   n
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ∈
                                             E
                                             (
                                             S
                                             ,
                                             a
                                             ,
                                             b
                                             )
                                          
                                       
                                    
                                    ;
                                 
                              
                           therefore, r
                           =
                           a′/b′∈(r
                           
                              lb
                           ,
                           r
                           
                              ub
                           ). We can guarantee that (r
                           
                              lb
                           ,
                           r
                           
                              ub
                           ) exists, i.e., r
                           
                              lb
                           
                           <
                           r
                           
                              ub
                           , because if r
                           
                              lb
                           
                           ⩾
                           r
                           
                              ub
                           , then at least one inequality from (11)–(13) can never be satisfied, and thus, at least one inequality from (6)–(10) can never be satisfied. However, this statement is a contradiction because we know that if we let a′=
                           a and b′=
                           b, inequalities (6)–(8) will be satisfied. Thus, the first part of the lemma is proved.

For the second part of the lemma, if a′/b′∈(r
                           
                              lb
                           ,
                           r
                           
                              ub
                           ), then we can define S
                           ′
                           =
                           S
                           ′∗ using Eq. (5), i.e., we let
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          ′
                                          ∗
                                       
                                    
                                    =
                                    
                                       max
                                    
                                    {
                                    n
                                    ·
                                    
                                       
                                          a
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    m
                                    ·
                                    
                                       
                                          b
                                       
                                       
                                          ′
                                       
                                    
                                    :
                                    (
                                    n
                                    ,
                                    m
                                    )
                                    ∈
                                    E
                                    (
                                    S
                                    ,
                                    a
                                    ,
                                    b
                                    )
                                    }
                                    .
                                 
                              
                           
                        

It is easy to verify that (S′,a′,b′) satisfies inequalities (11)–(13), (9)–(10) and (6)–(8) and thus is equivalent to (S,
                           a,
                           b).□

If we are given an instance (S,
                     a,
                     b), then the interval (r
                     
                        lb
                     ,
                     r
                     
                        ub
                     ) can be determined by Eqs. (14) and (15). (r
                     
                        lb
                     ,
                     r
                     
                        ub
                     ) will be called the Equivalence Ratio Interval (ERI) of (S,
                     a,
                     b) and will be denoted by ERI(S,
                     a,
                     b).

As shown in Algorithm 2, the algorithm for finding (r
                     
                        lb
                     ,
                     r
                     
                        ub
                     ) of (S,
                     a,
                     b) involves two steps. In the first step, E(S,
                     a,
                     b) is calculated using Eq. (1). In the second step, r
                     
                        lb
                      and r
                     
                        ub
                      are calculated using Eqs. (14) and (15). The total time complexity will be O(⌊S/a⌋2), which is dominated by computing Eqs. (14) and (15).
                        Algorithm 2
                        Pseudo-code for finding ERI(S,
                           a,
                           b).
                              
                                 
                                    
                                    
                                       
                                          
                                             Input: S, a, b
                                          
                                       
                                       
                                          
                                             Output: ERI(S,
                                             a,
                                             b)=(r
                                             
                                                lb
                                             ,
                                             r
                                             
                                                ub
                                             )
                                       
                                       
                                          1 
                                             Begin
                                          
                                       
                                       
                                          2 Calculate E(S,
                                             a,
                                             b) using Eq. (1)
                                          
                                       
                                       
                                          3 Calculate r
                                             
                                                lb
                                              and r
                                             
                                                ub
                                              using Eqs. (14) and (15)
                                          
                                       
                                       
                                          4 
                                             End.
                                       
                                    
                                 
                              
                           
                        

Let (S,
                        a,
                        b) be the parameters of a PLP’s dimension instance. We want to find its minimum size instance (
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) from its equivalence ratio interval (r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ).
                           Lemma 2
                           
                              (S′,
                              
                              a′,
                              
                              b′) is equivalent to (S,
                              
                              a,
                              
                              b) for some S′ and a′ if and only if
                              
                                 
                                    (16)
                                    
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       ⌊
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ⌋
                                       )
                                       +
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             ub
                                          
                                       
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       )
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       >
                                       1
                                       ,
                                    
                                 
                              
                              where r
                              
                                 lb
                               
                              and r
                              
                                 ub
                               
                              are the lower bound and the upper bound of ERI(S,
                              
                              a,
                              
                              b), respectively.
                           


                              b′ is a positive integer by implication; we need to guarantee that a′ is also a positive integer. From Lemma 1, we know that a′/b′∈(r
                              
                                 lb
                              ,
                              r
                              
                                 ub
                              ), and thus, a′∈(r
                              
                                 lb
                              
                              b′,
                              r
                              
                                 ub
                              
                              b′). Positive integer a′ exists if the interval (r
                              
                                 lb
                              
                              b′,
                              r
                              
                                 ub
                              
                              b′) contains at least one integer, that is, if
                                 
                                    
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       ⌊
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ⌋
                                       )
                                       +
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             ub
                                          
                                       
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       )
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       >
                                       1
                                       .
                                    
                                 
                              If inequality (16) is satisfied, then we can choose a′ and S′ as follows:
                                 
                                    (17)
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       ⌈
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ⌉
                                       ,
                                    
                                 
                              
                              
                                 
                                    (18)
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             ′
                                             ∗
                                          
                                       
                                       =
                                       
                                          max
                                       
                                       {
                                       n
                                       ·
                                       
                                          
                                             a
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       m
                                       ·
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       :
                                       (
                                       n
                                       ,
                                       m
                                       )
                                       ∈
                                       E
                                       (
                                       S
                                       ,
                                       a
                                       ,
                                       b
                                       )
                                       }
                                       .
                                    
                                 
                              
                           

If inequality (16) is not satisfied, then there will be no positive integer in (r
                              
                                 lb
                              
                              b′,
                              r
                              
                                 ub
                              
                              b′), and because a′∈(r
                              
                                 lb
                              
                              b′,
                              r
                              
                                 ub
                              
                              b′), there will never be an integer a′ such that (S′,
                              a′,
                              b′) is equivalent to (S,
                              a,
                              b). Thus, the lemma is proved.□

The algorithm for determining the minimum instance (
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                        ) is shown in Algorithm 3. The algorithm contains a loop enumerating b′ from b′=1 up to b′=
                        b. The enumeration stops when it finds a b′ that satisfies (16). When the enumeration stops, make 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                         equal to the current b′. 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    ⌣
                                 
                              
                           
                         are determined by (17) and (18). The time complexity of the algorithm is dominated by the cost of finding (r
                        
                           lb
                        ,
                        r
                        
                           ub
                        ) plus the cost of the loop of line 4. The total cost will be O(⌊S/a⌋2
                        +
                        b).
                           Algorithm 3
                           Pseudo-code for finding the MSI of a given PLP dimension
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: S, a, b
                                             
                                          
                                          
                                             
                                                Output: 
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1 
                                                Begin
                                             
                                          
                                          
                                             2 Call Algorithm 2 to calculate E(S,
                                                a,
                                                b) and r
                                                
                                                   lb
                                                , r
                                                
                                                   ub
                                                
                                             
                                          
                                          
                                             3 
                                                b′←1, b
                                                max
                                                ←
                                                b
                                             
                                          
                                          
                                             4 
                                                Loop while 
                                                b′⩽
                                                b
                                                max
                                             
                                          
                                          
                                             5 
                                                
                                                If 
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      ⌊
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⌋
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ub
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      >
                                                      1
                                                   
                                                 
                                                break loop
                                             
                                          
                                          
                                             6 
                                                
                                                Else 
                                                b′←
                                                b′+1
                                          
                                          
                                             7 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             8 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      ⌈
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ⌉
                                                   
                                                
                                             
                                          
                                          
                                             9 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      max
                                                      {
                                                      n
                                                      ·
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      +
                                                      m
                                                      ·
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      :
                                                      (
                                                      n
                                                      ,
                                                      m
                                                      )
                                                      ∈
                                                      E
                                                      (
                                                      S
                                                      ,
                                                      a
                                                      ,
                                                      b
                                                      )
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             10 
                                                End
                                             
                                          
                                       
                                    
                                 
                              
                           

Let us define the Equivalence Ratio Interval (ERI) of a PLP instance to be the intersection of the ERIs of its two dimensional instances. More formally, let (X,
                        Y,
                        a,
                        b) be a PLP instance, let 
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                          
                                             X
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             ub
                                          
                                          
                                             X
                                          
                                       
                                    
                                 
                              
                           
                         be the ERI of (X,
                        a,
                        b), and let 
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                          
                                             Y
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             ub
                                          
                                          
                                             Y
                                          
                                       
                                    
                                 
                              
                           
                         be the ERI of (Y,
                        a,
                        b). Next, the ERI of a PLP instance (X,
                        Y,
                        a,
                        b) is defined as
                           
                              
                                 ERI
                                 (
                                 X
                                 ,
                                 Y
                                 ,
                                 a
                                 ,
                                 b
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                lb
                                             
                                             
                                                X
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ub
                                             
                                             
                                                X
                                             
                                          
                                       
                                    
                                 
                                 ∩
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                lb
                                             
                                             
                                                Y
                                             
                                          
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ub
                                             
                                             
                                                Y
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         lb
                                                      
                                                      
                                                         X
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         lb
                                                      
                                                      
                                                         Y
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ub
                                                      
                                                      
                                                         Y
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ub
                                                      
                                                      
                                                         Y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The existence of ERI(X,
                        Y,
                        a,
                        b) is guaranteed because at least we have (a/b)∈
                        ERI(X,
                        Y,
                        a,
                        b).
                           Lemma 3
                           
                              (X′,
                              
                              Y′,
                              
                              a′,
                              
                              b′) is equivalent to (X,
                              
                              Y,
                              
                              a,
                              
                              b) for some X′, Y′, and a′ if and only if
                              
                                 
                                    (19)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      lb
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                ⌊
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      lb
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⌋
                                             
                                          
                                       
                                       +
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             ub
                                          
                                       
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       )
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       >
                                       1
                                       ,
                                    
                                 
                              
                              where r
                              
                                 lb
                               
                              and r
                              
                                 ub
                               
                              are the lower bound and the upper bound of ERI(X,
                              
                              Y,
                              
                              a,
                              
                              b), respectively.
                           

(X′,
                              Y′,
                              a′,
                              b′) is equivalent to (X,
                              Y,
                              a,
                              b) if and only if (X′,
                              a′,
                              b′) is equivalent to (X,
                              a,
                              b) and (Y′,
                              a′,
                              b′) is equivalent to (Y,
                              a,
                              b). From Lemma 1, we know that the item ratio a′/b′ must be in both ERI(X,
                              a,
                              b) and ERI(Y,
                              a,
                              b). Because a′ is a positive integer, inequality (19) must be satisfied.

If (19) is satisfied, the values of a′, X′, and Y′ can be determined by
                                 
                                    (20)
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       ⌈
                                       
                                          
                                             r
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       ⌉
                                       ,
                                    
                                 
                              
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             ′
                                             ∗
                                          
                                       
                                       =
                                       
                                          max
                                       
                                       {
                                       n
                                       ·
                                       
                                          
                                             a
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       m
                                       ·
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       :
                                       (
                                       n
                                       ,
                                       m
                                       )
                                       ∈
                                       E
                                       (
                                       X
                                       ,
                                       a
                                       ,
                                       b
                                       )
                                       }
                                       .
                                    
                                 
                              
                              
                                 
                                    (22)
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          
                                             Y
                                          
                                          
                                             ′
                                             ∗
                                          
                                       
                                       =
                                       
                                          max
                                       
                                       {
                                       n
                                       ·
                                       
                                          
                                             a
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       m
                                       ·
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       :
                                       (
                                       n
                                       ,
                                       m
                                       )
                                       ∈
                                       E
                                       (
                                       Y
                                       ,
                                       a
                                       ,
                                       b
                                       )
                                       }
                                       .
                                    
                                 
                              
                           

If (19) is not satisfied, the positive integer a′ can never exist. The lemma is proved.□

The pseudo-code for finding the MSI of a PLP instance is shown in Algorithm 4. After calculating the instance’s ERI and partitions, the algorithm enumerates b′ from 1 up to b
                        max
                        =min {b,⌊X/a⌋+⌊Y/a⌋+1}, breaking the loop when inequality (19) is satisfied and setting 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                           
                        . After 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                           
                         is found, 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                           
                         are determined using Eqs. (20)–(22).

The complexity of the algorithm is dominated by the cost of the calculation of the ERIs and the enumerating loop of b′. The complexity is O(⌊X/a⌋2
                        +
                        b
                        max)=
                        O(⌊ X/b⌋2). The corresponding algorithm given by Martins and Dell (2007) is O(⌊X/b⌋4); thus, Algorithm 4 is two polynomial orders more efficient.

Note that at line 5, the algorithm uses the fact that 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              ⌊
                              X
                              /
                              a
                              ⌋
                              +
                              ⌊
                              Y
                              /
                              a
                              ⌋
                              +
                              1
                           
                        , proved by Martins and Dell (2007).
                           Algorithm 4
                           Pseudo-code for identifying the minimum size instance of a PLP
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: X, Y, a, b
                                             
                                          
                                          
                                             
                                                Output: 
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1 
                                                Begin
                                             
                                          
                                          
                                             2 Call Algorithm 2 to calculate 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ub
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                   
                                                 and E(X,
                                                a,
                                                b)
                                          
                                          
                                             3 Call Algorithm 2 to calculate 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ub
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                 and E(Y,
                                                a,
                                                b)
                                          
                                          
                                             4 
                                                
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      ←
                                                      max
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     lb
                                                                  
                                                                  
                                                                     X
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     lb
                                                                  
                                                                  
                                                                     Y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ub
                                                         
                                                      
                                                      ←
                                                      min
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ub
                                                                  
                                                                  
                                                                     X
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ub
                                                                  
                                                                  
                                                                     Y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             5 
                                                b′←1, b
                                                max
                                                ←min{b,⌊X/a⌋+⌊Y/a⌋+1}
                                          
                                          
                                             6 
                                                Loop while 
                                                b′⩽
                                                b
                                                max
                                             
                                          
                                          
                                             7 
                                                
                                                If 
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      ⌊
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ⌋
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ub
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      >
                                                      1
                                                   
                                                 
                                                break loop
                                             
                                          
                                          
                                             8 
                                                
                                                Else 
                                                b′←
                                                b′+1
                                          
                                          
                                             19 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             10 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      ⌈
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            lb
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ⌉
                                                   
                                                
                                             
                                          
                                          
                                             11 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Y
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      max
                                                      {
                                                      n
                                                      ·
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      +
                                                      m
                                                      ·
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      :
                                                      (
                                                      n
                                                      ,
                                                      m
                                                      )
                                                      ∈
                                                      E
                                                      (
                                                      Y
                                                      ,
                                                      a
                                                      ,
                                                      b
                                                      )
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             12 
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      ←
                                                      max
                                                      {
                                                      n
                                                      ·
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      +
                                                      m
                                                      ·
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               ⌣
                                                            
                                                         
                                                      
                                                      :
                                                      (
                                                      n
                                                      ,
                                                      m
                                                      )
                                                      ∈
                                                      E
                                                      (
                                                      X
                                                      ,
                                                      a
                                                      ,
                                                      b
                                                      )
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             14 
                                                End
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Algorithm 4 can provide a natural and convenient way for transforming a non-integer PLP into its equivalent integer MSI. The idea is based on the fact that any non-integer PLP instance can be transformed into one of its integer equivalence instances.

For a non-integer PLP (X,
                        Y,
                        a,
                        b), Eq. (1) is clearly applicable, which indicates that E(X,
                        a,
                        b) and E(Y,
                        a,
                        b) can be defined, making lines 2 and 3 of Algorithm 4 applicable; thus, the whole algorithm will be applicable.

The run time of Algorithm 4 is still O(⌊X/a⌋2). In a sense, Algorithm 4 completely justifies the integer assumption that is commonly adopted by researchers when addressing the PLP.

This section will introduce the ERI method for enumerating all MSIs whose area ratios are smaller than N
                     +1 boxes per pallet. Because the MSI of an equivalence class is unique, the procedure is also a procedure of enumerating equivalence classes.

Let (
                        
                           
                              
                                 X
                              
                              
                                 ⌣
                              
                           
                        
                     , 
                        
                           
                              
                                 Y
                              
                              
                                 ⌣
                              
                           
                        
                     , 
                        
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                        
                     , 
                        
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                     ) be an MSI. It is shown by Martins and Dell (2007) that 
                        
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                      and 
                        
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                        
                      are bounded by
                        
                           
                              
                                 
                                    
                                       1
                                       ⩽
                                       
                                          
                                             b
                                          
                                          
                                             ⌣
                                          
                                       
                                       ⩽
                                       N
                                       +
                                       2
                                       ,
                                       
                                       and
                                    
                                 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ⌣
                                          
                                       
                                       +
                                       1
                                       ⩽
                                       
                                          
                                             a
                                          
                                          
                                             ⌣
                                          
                                       
                                       ⩽
                                       2
                                       N
                                       +
                                       1
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Because the area ratio is bounded by N, 
                        
                           
                              
                                 Y
                              
                              
                                 ⌣
                              
                           
                        
                      is bounded by
                        
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              N
                              (
                              b
                              +
                              1
                              )
                              -
                              1
                              ,
                           
                        
                     where the lower bound 
                        
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                        
                      is chosen following Martins and Dell’s convention. This lower bound is selected because 
                        
                           
                              
                                 Y
                              
                              
                                 ⌣
                              
                           
                           <
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                        
                      disables the 90° rotation freedom of the items and is trivial.


                     
                        
                           
                              
                                 X
                              
                              
                                 ⌣
                              
                           
                        
                      is bounded by
                        
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                              ⩽
                              (
                              N
                              +
                              1
                              )
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                              /
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                              -
                              1
                              .
                           
                        
                     
                  

The pseudo-code for enumerating the MSI is shown in Algorithm 5. The algorithm contains four loops enumerating b, a, Y, and X from the outer loop to the inner loop. At line 4, any instance where a and b have a greatest common divisor greater than 1 is discarded because it cannot be an MSI. At line 6 and 8, every perfect-partition-reducible instance is discarded because it cannot be an MSI, either. Line 9 calls Algorithm 4 to calculate the MSI of (X,
                     Y,
                     a,
                     b). Line 10 verifies whether 
                        
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                           =
                           b
                        
                     ; if the answer is ‘yes’, then the instance is an MSI and is output.

The complexity of the algorithm is dominated by the run time of the four loops, multiplying the cost of line 9 where it calls Algorithm 4 and has a cost of O(⌊X/b⌋2)=
                     O(N
                     2). The total complexity of the algorithm will be O(N
                     6
                     b
                     2). Algorithm 5 is faster than Martins and Dell’s algorithm by two polynomial orders of N based on the improvement of Algorithm 4.
                        Algorithm 5
                        Pseudo-code for enumerating the MSIs of all equivalence classes with an area ratio smaller than N
                           +1.
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Input: N
                                          
                                          
                                       
                                       
                                          
                                             Output: All MSIs with an area ratio smaller than N
                                             +1
                                          
                                       
                                       
                                          1 
                                             Begin
                                          
                                          
                                       
                                       
                                          2 
                                             Loop for 
                                             b
                                             =1 to N
                                             +2
                                          
                                       
                                       
                                          3 
                                             
                                             Loop for 
                                             a
                                             =
                                             b
                                             +1 to 2N
                                             +1
                                          
                                       
                                       
                                          4 
                                             
                                             If 
                                             GCD(a,
                                             b)>1, continue for next a
                                          
                                          
                                       
                                       
                                          5 
                                             
                                             Loop for Y
                                             =
                                             a to N(b
                                             +1)+1
                                          
                                       
                                       
                                          6 
                                             
                                             Call Algorithm 1 to check if (Y,
                                             a,
                                             b) is perfect-partition-reducible; If the answer is yes, continue for next Y
                                          
                                          
                                       
                                       
                                          7 
                                             
                                             
                                             Loop for X
                                             =max{Y,(b
                                             −
                                             Y/a
                                             −1)a} to (N
                                             +1)ab/Y
                                             −1
                                          
                                       
                                       
                                          8 
                                             
                                             Call Algorithm 1 to check if (X,
                                             a,
                                             b) is perfect-partition-reducible; If the answer is yes, continue for next X
                                          
                                          
                                       
                                       
                                          9 
                                             
                                             Call Algorithm 4 to identify the MSI of (X,
                                             Y,
                                             a,
                                             b); let it be (
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                
                                             , 
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                
                                             , 
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                
                                             , 
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                
                                             )
                                          
                                       
                                       
                                          10 
                                             
                                             
                                             If 
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                   =
                                                   b
                                                
                                              and 
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                
                                             /
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ⌣
                                                      
                                                   
                                                   )
                                                   <
                                                   N
                                                   +
                                                   1
                                                
                                              
                                             then output (X,
                                             Y,
                                             a,
                                             b) as a MSI.
                                          
                                       
                                       
                                          11 
                                             End
                                          
                                          
                                       
                                    
                                 
                              
                           
                        

@&#IMPLEMENTATION@&#

There is an implementation issue caused by the computing precision at line 7 in Algorithm 4, where the floor operation and the strict inequality evaluation ‘>1’ should be addressed.

For example, when the input instance is (X,
                        Y,
                        a,
                        b)=(36,9,9,4) and b′=3, a 32-bit computer gives the result (r
                        
                           lb
                        
                        b′−⌊r
                        
                           lb
                        
                        b′⌋)+(r
                        
                           ub
                        
                        −
                        r
                        
                           lb
                        )b′=1+4.440892×10−16
                        >1. The algorithm outputs b′=3 as an MSI. However, the true MSI is an instance with 
                           
                              
                                 
                                    b
                                 
                                 
                                    ⌣
                                 
                              
                              =
                              4
                           
                         because when b′=3, the precise value of (r
                        
                           lb
                        
                        b′−⌊r
                        
                           lb
                        
                        b′⌋)+(r
                        
                           ub
                        
                        −
                        r
                        
                           lb
                        )b′ exactly equals 1, and the inequality (r
                        
                           lb
                        
                        b′−⌊r
                        
                           lb
                        
                        b′⌋)+(r
                        
                           ub
                        
                        −
                        r
                        
                           lb
                        )b′>1 is not satisfied.

There are two ways to cope with this problem. The first way is to choose a very small number ε and change line 7 in Algorithm 4 to
                           
                              
                                 If
                                 
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 -
                                 ⌊
                                 
                                    
                                       r
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 ⌋
                                 )
                                 +
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       ub
                                    
                                 
                                 -
                                 
                                    
                                       r
                                    
                                    
                                       lb
                                    
                                 
                                 )
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 >
                                 1
                                 +
                                 ε
                                 
                                 break
                                 
                                 loop
                                 .
                              
                           
                        
                     

In a computing test, it is determined that when choosing ε
                        =1×10−8, the algorithm performs perfectly.

The second way is to adopt an integer implementation. The integer implementation maintains the values of r
                        
                           lb
                         and r
                        
                           ub
                         as exact fractions.

When r
                        
                           lb
                         and r
                        
                           ub
                         are computed from Eqs. (14) and (15), the division result is not actually recorded. Instead, the values are recorded as fractions, i.e., the algorithm records the integers p
                        
                           lb
                        , q
                        
                           lb
                        , p
                        
                           ub
                        , q
                        
                           ub
                        , such that
                           
                              (23)
                              
                                 
                                    
                                       r
                                    
                                    
                                       lb
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             lb
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       ub
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ub
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Inequality (19) is rewritten as
                           
                              (24)
                              
                                 (
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       lb
                                    
                                 
                                 )
                                 mod
                                 
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 )
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ub
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 )
                                 >
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 .
                              
                           
                        
                     

Accordingly, line 7 in algorithm 4 is rewritten as
                           
                              
                                 If
                                 
                                 (
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       lb
                                    
                                 
                                 )
                                 mod
                                 
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 )
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ub
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 )
                                 >
                                 
                                    
                                       q
                                    
                                    
                                       lb
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ub
                                    
                                 
                                 
                                 break
                                 
                                 loop
                                 .
                              
                           
                        
                     

Because this modification causes only a constant factor of run time change, it will not affect the algorithm’s time complexity. In practice, because the evaluation of inequality (24) only involves integer operations, the integer implementation shows slightly better performance.

At line 9 of Algorithm 5, where the algorithm calls Algorithm 4 to identify the MSI, it is not necessary for Algorithm 4 to calculate 
                           
                              
                                 
                                    X
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , 
                           
                              
                                 
                                    Y
                                 
                                 
                                    ⌣
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    a
                                 
                                 
                                    ⌣
                                 
                              
                           
                        . Thus, for this purpose, lines 10–12 of Algorithm 4 can be omitted.

In the integer implementation, because (b′p
                        
                           lb
                        ) mod q
                        
                           lb
                        
                        ⩽
                        q
                        
                           lb
                        
                        −1, a lower bound for b′ can be obtained from (24):
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 >
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                       -
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       -
                                       1
                                       )
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ub
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The above bound can be used to rewrite line 5 of Algorithm 4 as follows:
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 ←
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                       -
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       -
                                       1
                                       )
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ub
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             lb
                                          
                                       
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             lb
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             ub
                                          
                                       
                                    
                                 
                                 +
                                 1
                                 ,
                                 
                                 
                                    
                                       b
                                    
                                    
                                       max
                                    
                                 
                                 ←
                                 
                                    min
                                 
                                 {
                                 b
                                 ,
                                 ⌊
                                 X
                                 /
                                 a
                                 ⌋
                                 +
                                 ⌊
                                 Y
                                 /
                                 a
                                 ⌋
                                 +
                                 1
                                 }
                              
                           
                        to obtain a moderate improvement in run time.

The algorithms are implemented both in a floating point version and in an integer version. It was determined that the integer version achieves a slightly better run time. Equivalence classes represented by MSIs with an area ratio up to 300 are enumerated, and their data are shown in Tables 1–3
                     
                     
                     .


                     Table 1 shows the run time of the integer implementation. The program is written in C++ and compiled by Microsoft Visual C++ 2008. The hardware used is a personal computer with a 2.8-Gigahertz Intel® Core™2 Duo CPU. Only one thread is in the program, and thus, only one core of the CPU is used. In the table, it can be observed that the new algorithms proposed in this paper are 10–30 times faster. The new algorithm exhibits better performance with a larger input size (the algorithm used for comparison is implemented in the same software and hardware environment).


                     Table 2 gives the distribution of 
                        
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                      of the MSI, and Table 3 shows the distribution of the item aspect ratio 
                        
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                           /
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                      of the MSI. It can be observed that more than 50% of the MSIs have aspect ratios between 1 and 2, but the majority of the MSIs (>80%) have an aspect ratio between 1 and 5.

The ERI-based PLP class enumerating algorithm is simple to implement. The length of the integer version implementation of the C++ code is only 127 lines and is listed as an appendix at the end of this paper.

In this section, we mainly demonstrate the run time improvement of the new algorithm (as shown in Table 1). The results shown in Tables 2 and 3 provide a hint regarding the distribution of 
                        
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                      and 
                        
                           
                              
                                 a
                              
                              
                                 ⌣
                              
                           
                           /
                           
                              
                                 b
                              
                              
                                 ⌣
                              
                           
                        
                     . The traditional Cover I, II, and III datasets all have the restriction that 1⩽
                     a/b
                     ⩽4. If this restriction is set, a dataset will include at least 70% of the total equivalent instances.

@&#CONCLUSIONS@&#

In this paper, it is shown in detail that the item aspect ratios of PLP instances of the same equivalence class will belong to an open interval. This interval characterises the equivalence classes and is referred to as the Equivalence Ratio Interval (ERI).

A rapid MSI-identifying algorithm can be implemented using the concept of ERI. The method can also be applied to transform a non-integer PLP instance into an integer MSI.

New and faster PLP equivalence class enumerating algorithms can be implemented using ERI. The new algorithms based on ERI reduce the time complexity by two polynomial orders compared to that of previous algorithms reported by Martins and Dell (2007), who first introduced the concept of MSI.

The new algorithms are simple to implement. When programmed in C++, the total length of the equivalence class enumeration algorithm is 127 lines. With this feature, the algorithm is a good problem generator that can exhaustively list PLP instances subject to given constraints.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank the anonymous reviewers for their valuable feedback and for pointing out textual and formula errors in the manuscript.


                     
                        
                           
                              
                              
                              
                                 
                                    //********************************************************//
                                    
                                 
                                 
                                    // PLP MSI Enumeration Program, by Yiping Lu, 2012-11-28//
                                    
                                 
                                 
                                    //********************************************************//
                                    
                                 
                                 
                                    #include<iostream>
                                    
                                 
                                 
                                    #include<fstream>
                                    
                                 
                                 
                                    #include<time.h>
                                    
                                 
                                 
                                    int EnMSI (int N),
                                    
                                 
                                 
                                    
                                       MSI (int X, int Y, int a, int b, int & x, int & y, int & a1, int & b1),
                                    
                                 
                                 
                                    
                                       ERI (int S, int a, int b, int & p1,int & q1,int & p2,int & q2),
                                    
                                 
                                 
                                    
                                       ppef (int S, int a, int b), commonDivisor (int a, int b);
                                    
                                 
                                 
                                    const int N=20;// Area ratio; modify this for different input
                                    
                                 
                                 
                                    char *outfile=“output.txt”;// Data will be output to this file
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    void main (void){
                                    
                                 
                                 
                                    
                                       clock_t tStart=clock ();
                                    
                                 
                                 
                                    
                                       EnMSI (N);
                                    
                                 
                                 
                                    
                                       clock_t tFinish=clock ();
                                    
                                 
                                 
                                    
                                       std::cout<<“⧹nEnumeration completed for Area Ratio: <”
                                    
                                 
                                 
                                    
                                       <<N+1<<“. ”;
                                    
                                 
                                 
                                    
                                       std::cout<<“⧹nTime elapsed: ”
                                    
                                 
                                 
                                    
                                       << (double)(tFinish - tStart)/CLOCKS_PER_SEC<<“(sec).”
                                    
                                 
                                 
                                    
                                       <<std::endl;
                                    
                                 
                                 
                                    
                                       std::cout<<“Data outputted to file ⧹”“<<outfile<<”⧹“.”<<std::endl;
                                    
                                 
                                 
                                    
                                       system (“pause”);
                                    
                                 
                                 
                                    }
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    int EnMSI (int N){
                                    
                                 
                                 
                                    
                                       int X, Y, a, b, x, y, a1, b1;
                                    
                                 
                                 
                                    
                                       int as, nCount=0, XT=0;
                                    
                                 
                                 
                                    
                                       double r;
                                    
                                 
                                 
                                    
                                       std::ofstream fcout (outfile);
                                    
                                 
                                 
                                    
                                       for (b=1; b<=N+2; b++){
                                    
                                 
                                 
                                    
                                       if (b==1) as=1;
                                    
                                 
                                 
                                    
                                       else as=b+1;
                                    
                                 
                                 
                                    
                                       for (a=as; a<=2∗N+1; a++){
                                    
                                 
                                 
                                    
                                       
                                       if (commonDivisor (a,b)!=1) continue;
                                    
                                 
                                 
                                    
                                       
                                       for (Y=a; Y<N∗b+1; Y++){
                                    
                                 
                                 
                                    
                                       
                                       y=ppef (Y, a, b);
                                    
                                 
                                 
                                    
                                       
                                       if (y!=Y) continue;
                                    
                                 
                                 
                                    
                                       
                                       X=Y-1;
                                    
                                 
                                 
                                    
                                       
                                       XT=(b-1-Y/a)∗a-1;
                                    
                                 
                                 
                                    
                                       
                                       if (XT>X) X=XT;
                                    
                                 
                                 
                                    
                                       
                                       while (X<N∗a+1){
                                    
                                 
                                 
                                    
                                       
                                       
                                       X++;
                                    
                                 
                                 
                                    
                                       
                                       
                                       x=ppef (X,a, b);
                                    
                                 
                                 
                                    
                                       
                                       
                                       if (x!=X) continue;
                                    
                                 
                                 
                                    
                                       
                                       
                                       if ((double) X∗Y/a/b>=N+1) break;
                                    
                                 
                                 
                                    
                                       
                                       
                                       MSI (X, Y, a, b, x, y, a1, b1);
                                    
                                 
                                 
                                    
                                       
                                       
                                       if ((b1==b)){
                                    
                                 
                                 
                                    
                                       
                                       
                                       nCount++;
                                    
                                 
                                 
                                    
                                       
                                       
                                       fcout <<“(“<<nCount<<”)⧹t”
                                    
                                 
                                 
                                    
                                       
                                       
                                       
                                       <<X<<“,”<<Y<<“,”<<a
                                    
                                 
                                 
                                    
                                       
                                       
                                       
                                       <<“,”<<b<<std::endl;
                                    
                                 
                                 
                                    
                                       
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       }
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       fcout.close ();
                                    
                                 
                                 
                                    
                                       return N;
                                    
                                 
                                 
                                    }
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    int MSI (int X, int Y, int a, int b, int & x, int & y, int & a1, int & b1){
                                    
                                 
                                 
                                    
                                       x=y=b1=0;a1=a;
                                    
                                 
                                 
                                    
                                       int p1, q1, p2, q2, py1, qy1, py2, qy2;
                                    
                                 
                                 
                                    
                                       ERI (X, a, b, p1, q1, p2, q2);
                                    
                                 
                                 
                                    
                                       ERI (Y, a, b, py1, qy1, py2, qy2);
                                    
                                 
                                 
                                    
                                       if (py1∗q1>p1∗qy1){p1=py1; q1=qy1;}
                                    
                                 
                                 
                                    if (py2∗q2<p2∗qy2){p2=py2; q2=qy2;}
                                    
                                 
                                 
                                    
                                       for (b1=1; b1<b; b1++)
                                    
                                 
                                 
                                    
                                       if (((b1∗p1)%q1)∗q2+b1∗(p2∗q1-p1∗q2)>q1∗q2){
                                    
                                 
                                 
                                    
                                       
                                       a1=(int)((double) p1/q1∗b1)+1;
                                    
                                 
                                 
                                    
                                       
                                       break;
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       if (a1==a) b1=b;
                                    
                                 
                                 
                                    
                                       //x=ppf (X, a1, b1);
                                    
                                 
                                 
                                    
                                       //y=ppf (Y, a1, b1);
                                    
                                 
                                 
                                    
                                       return 0;
                                    
                                 
                                 
                                    }
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    int ERI (int S, int a, int b, int & p1,int & q1,int & p2,int & q2){
                                    
                                 
                                 
                                    
                                       int mMax=S/a, n[1100], i, j;
                                    
                                 
                                 
                                    
                                       double r1, r2, rlb=1e-8, rub=1e8;
                                    
                                 
                                 
                                    
                                       for (i=0; i<=mMax; i++) n[i]=(S-i∗a)/b;
                                    
                                 
                                 
                                    
                                       for (i=0; i<mMax; i++){
                                    
                                 
                                 
                                    
                                       for (j=i+1; j<=mMax; j++){
                                    
                                 
                                 
                                    
                                       
                                       r1=((double) n[i]-n[j]-1)/(j-i);
                                    
                                 
                                 
                                    
                                       
                                       r2=((double) n[j]-n[i]-1)/(i-j);
                                    
                                 
                                 
                                    
                                       
                                       if (rlb<r1){
                                    
                                 
                                 
                                    
                                       
                                       rlb=r1;
                                    
                                 
                                 
                                    
                                       
                                       p1=n[i]-n[j]-1;
                                    
                                 
                                 
                                    
                                       
                                       q1=j-i;
                                    
                                 
                                 
                                    
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       if (rub>r2){
                                    
                                 
                                 
                                    
                                       
                                       rub=r2;
                                    
                                 
                                 
                                    
                                       
                                       p2=n[i]-n[j]+1;
                                    
                                 
                                 
                                    
                                       
                                       q2=j-i;
                                    
                                 
                                 
                                    
                                       
                                       }
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       for (i=0; i<=mMax; i++){
                                    
                                 
                                 
                                    
                                       r1=(double) n[i]/(mMax-i+1);
                                    
                                 
                                 
                                    
                                       if (rlb<r1){
                                    
                                 
                                 
                                    
                                       
                                       rlb=r1;
                                    
                                 
                                 
                                    
                                       
                                       p1=n[i];
                                    
                                 
                                 
                                    
                                       
                                       q1=mMax-i+1;
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       return 0;
                                    
                                 
                                 
                                    }
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    int ppef (int S, int a, int b){
                                    
                                 
                                 
                                    
                                       int maxM=S/a;
                                    
                                 
                                 
                                    
                                       int i, j;
                                    
                                 
                                 
                                    
                                       int ppe=0, ppet;
                                    
                                 
                                 
                                    
                                       for (i=0; i<=maxM; i++){
                                    
                                 
                                 
                                    
                                       j=(S-i∗a)/b;
                                    
                                 
                                 
                                    
                                       ppet=i∗a+j∗b;
                                    
                                 
                                 
                                    
                                       if (ppet>ppe) ppe=ppet;
                                    
                                 
                                 
                                    
                                       }
                                    
                                 
                                 
                                    
                                       return ppe;
                                    
                                 
                                 
                                    }
                                    
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    int commonDivisor (int a, int b){
                                    
                                 
                                 
                                    
                                       while (b){int c=a%b;a=b;b=c;}
                                    
                                 
                                 
                                    
                                       return a;
                                    
                                 
                                 
                                    }
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

